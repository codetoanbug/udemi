import { useContext } from "react";
import { StoreContext, USER_DEFINED_STORE_ID_KEY } from "./store-context";

/**
 * useStores()
 * Hook for accessing stores on context
 * @param storeClassNames
 * @returns
 */
export const useStores = (storeClasses) => {
  const { stores } = useContext(StoreContext);
  const foundStores = storeClasses.map((storeClass) => {
    const storeClassName = storeClass[USER_DEFINED_STORE_ID_KEY];
    if (!storeClassName) {
      throw new Error(
        `class "${storeClass.name}" is missing static "${USER_DEFINED_STORE_ID_KEY}" property`
      );
    }
    const store = stores[storeClassName];
    if (!store) {
      // Attempt global fallback
      // This is an interop step that helps us migrate from Django website
      if (typeof globalThis["_STORES"] === "object") {
        const globalStore = globalThis["_STORES"][storeClassName];
        if (globalStore) {
          return globalStore;
        }
      }
      // Unable to locate store (or found in global scope)
      throw new Error(
        `Store "${storeClassName}" has not been registered with the StoreProvider`
      );
    }
    return store;
  });
  return foundStores;
};
//# sourceMappingURL=use-stores.js.map
