/*! For license information please see vendor-videojs.677aa90f813073b4f731.js.LICENSE.txt */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["vendor-videojs"],{"./node_modules/@videojs/vhs-utils/es/byte-helpers.js":function(e,t,r){"use strict";r.d(t,"f",(function(){return u}));r.d(t,"j",(function(){return d}));r.d(t,"i",(function(){return f}));r.d(t,"h",(function(){return c}));r.d(t,"b",(function(){return y}));r.d(t,"e",(function(){return _}));r.d(t,"c",(function(){return b}));r.d(t,"g",(function(){return T}));r.d(t,"d",(function(){return S}));r.d(t,"a",(function(){return w}));var i=r("./node_modules/global/window.js");var n=r.n(i);var a=function e(t,r){var i="";while(r--){i+=t}return i};var s=function e(t){return t.toString(2).length};var o=function e(t){return Math.ceil(s(t)/8)};var u=function e(t,r,i){if(i===void 0){i=" "}return(a(i,r)+t.toString()).slice(-r)};var l=function e(t){return ArrayBuffer.isView(t)};var d=function e(t){if(t instanceof Uint8Array){return t}if(!Array.isArray(t)&&!l(t)&&!(t instanceof ArrayBuffer)){if(typeof t!=="number"||typeof t==="number"&&t!==t){t=0}else{t=[t]}}return new Uint8Array(t&&t.buffer||t,t&&t.byteOffset||0,t&&t.byteLength||0)};var f=function e(t){t=d(t);var r="";for(var i=0;i<t.length;i++){r+=u(t[i].toString(16),2,"0")}return r};var c=function e(t){t=d(t);var r="";for(var i=0;i<t.length;i++){r+=u(t[i].toString(2),8,"0")}return r};var h=n.a.BigInt||Number;var p=[h("0x1"),h("0x100"),h("0x10000"),h("0x1000000"),h("0x100000000"),h("0x10000000000"),h("0x1000000000000"),h("0x100000000000000"),h("0x10000000000000000")];var v=function(){var e=new Uint16Array([65484]);var t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);if(t[0]===255){return"big"}if(t[0]===204){return"little"}return"unknown"}();var m=v==="big";var g=v==="little";var y=function e(t,r){var i=r===void 0?{}:r,n=i.signed,a=n===void 0?false:n,s=i.le,o=s===void 0?false:s;t=d(t);var u=o?"reduce":"reduceRight";var l=t[u]?t[u]:Array.prototype[u];var f=l.call(t,(function(e,r,i){var n=o?i:Math.abs(i+1-t.length);return e+h(r)*p[n]}),h(0));if(a){var c=p[t.length]/h(2)-h(1);f=h(f);if(f>c){f-=c;f-=c;f-=h(2)}}return Number(f)};var _=function e(t,r){var i=r===void 0?{}:r,n=i.le,a=n===void 0?false:n;if(typeof t!=="bigint"&&typeof t!=="number"||typeof t==="number"&&t!==t){t=0}t=h(t);var s=o(t);var u=new Uint8Array(new ArrayBuffer(s));for(var l=0;l<s;l++){var d=a?l:Math.abs(l+1-u.length);u[d]=Number(t/p[l]&h(255));if(t<0){u[d]=Math.abs(~u[d]);u[d]-=l===0?1:2}}return u};var b=function e(t){if(!t){return""}t=Array.prototype.slice.call(t);var r=String.fromCharCode.apply(null,d(t));try{return decodeURIComponent(escape(r))}catch(e){}return r};var T=function e(t,r){if(typeof t!=="string"&&t&&typeof t.toString==="function"){t=t.toString()}if(typeof t!=="string"){return new Uint8Array}if(!r){t=unescape(encodeURIComponent(t))}var i=new Uint8Array(t.length);for(var n=0;n<t.length;n++){i[n]=t.charCodeAt(n)}return i};var S=function e(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++){r[i]=arguments[i]}r=r.filter((function(e){return e&&(e.byteLength||e.length)&&typeof e!=="string"}));if(r.length<=1){return d(r[0])}var n=r.reduce((function(e,t,r){return e+(t.byteLength||t.length)}),0);var a=new Uint8Array(n);var s=0;r.forEach((function(e){e=d(e);a.set(e,s);s+=e.byteLength}));return a};var w=function e(t,r,i){var n=i===void 0?{}:i,a=n.offset,s=a===void 0?0:a,o=n.mask,u=o===void 0?[]:o;t=d(t);r=d(r);var l=r.every?r.every:Array.prototype.every;return r.length&&t.length-s>=r.length&&l.call(r,(function(e,r){var i=u[r]?u[r]&t[s+r]:t[s+r];return e===i}))};var E=function e(t,r,i){if(Uint8Array.prototype.slice){return Uint8Array.prototype.slice.call(t,r,i)}return new Uint8Array(Array.prototype.slice.call(t,r,i))};var k=function e(t){if(t.reverse){return t.reverse()}return Array.prototype.reverse.call(t)}},"./node_modules/@videojs/vhs-utils/es/codecs.js":function(e,t,r){"use strict";r.d(t,"i",(function(){return u}));r.d(t,"h",(function(){return f}));r.d(t,"d",(function(){return c}));r.d(t,"f",(function(){return p}));r.d(t,"e",(function(){return m}));r.d(t,"c",(function(){return g}));r.d(t,"g",(function(){return y}));r.d(t,"a",(function(){return _}));r.d(t,"b",(function(){return b}));var i=r("./node_modules/global/window.js");var n=r.n(i);var a={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/};var s=["video","audio","text"];var o=["Video","Audio","Text"];var u=function e(t){if(!t){return t}return t.replace(/avc1\.(\d+)\.(\d+)/i,(function(e,t,r){var i=("00"+Number(t).toString(16)).slice(-2);var n=("00"+Number(r).toString(16)).slice(-2);return"avc1."+i+"00"+n}))};var l=function e(t){return t.map(u)};var d=function e(t){return t.replace(/avc1\.(\d+)\.(\d+)/i,(function(e){return l([e])[0]}))};var f=function e(t){if(t===void 0){t=""}var r=t.split(",");var i=[];r.forEach((function(e){e=e.trim();var t;s.forEach((function(r){var n=a[r].exec(e.toLowerCase());if(!n||n.length<=1){return}t=r;var s=e.substring(0,n[1].length);var o=e.replace(s,"");i.push({type:s,details:o,mediaType:r})}));if(!t){i.push({type:e,details:"",mediaType:"unknown"})}}));return i};var c=function e(t,r){if(!t.mediaGroups.AUDIO||!r){return null}var i=t.mediaGroups.AUDIO[r];if(!i){return null}for(var n in i){var a=i[n];if(a.default&&a.playlists){return f(a.playlists[0].attributes.CODECS)}}return null};var h=function e(t){if(t===void 0){t=""}return a.video.test(t.trim().toLowerCase())};var p=function e(t){if(t===void 0){t=""}return a.audio.test(t.trim().toLowerCase())};var v=function e(t){if(t===void 0){t=""}return a.text.test(t.trim().toLowerCase())};var m=function e(t){if(!t||typeof t!=="string"){return}var r=t.toLowerCase().split(",").map((function(e){return u(e.trim())}));var i="video";if(r.length===1&&p(r[0])){i="audio"}else if(r.length===1&&v(r[0])){i="application"}var n="mp4";if(r.every((function(e){return a.mp4.test(e)}))){n="mp4"}else if(r.every((function(e){return a.webm.test(e)}))){n="webm"}else if(r.every((function(e){return a.ogg.test(e)}))){n="ogg"}return i+"/"+n+';codecs="'+t+'"'};var g=function e(t){if(t===void 0){t=""}return n.a.MediaSource&&n.a.MediaSource.isTypeSupported&&n.a.MediaSource.isTypeSupported(m(t))||false};var y=function e(t){if(t===void 0){t=""}return t.toLowerCase().split(",").every((function(e){e=e.trim();for(var t=0;t<o.length;t++){var r=o[t];if(a["muxer"+r].test(e)){return true}}return false}))};var _="mp4a.40.2";var b="avc1.4d400d"},"./node_modules/@videojs/vhs-utils/es/containers.js":function(e,t,r){"use strict";var i=r("./node_modules/@videojs/vhs-utils/es/byte-helpers.js");var n=function e(t){var r="";var n=t[1]>>>3;var a=t[1]&31;var s=t[2]>>>7;var o=(t[2]&64)>>6;var u=(t[2]&32)>>5;var l=(t[2]&16)>>4;var d=(t[2]&8)>>3;var f=(t[2]&4)>>2;var c=t[2]&3;r+=n+"."+Object(i["f"])(a,2,"0");if(s===0){r+="M"}else if(s===1){r+="H"}var h;if(n===2&&o){h=u?12:10}else{h=o?10:8}r+="."+Object(i["f"])(h,2,"0");r+="."+l;r+="."+d+f+c;return r};var a=function e(t){var r=Object(i["i"])(t[1]);var n=Object(i["i"])(t[2]&252);var a=Object(i["i"])(t[3]);return""+r+n+a};var s=function e(t){var r="";var n=t[1]>>6;var a=t[1]&31;var s=(t[1]&32)>>5;var o=t.subarray(2,6);var u=t.subarray(6,12);var l=t[12];if(n===1){r+="A"}else if(n===2){r+="B"}else if(n===3){r+="C"}r+=a+".";var d=parseInt(Object(i["h"])(o).split("").reverse().join(""),2);if(d>255){d=parseInt(Object(i["h"])(o),2)}r+=d.toString(16)+".";if(s===0){r+="L"}else{r+="H"}r+=l;var f="";for(var c=0;c<u.length;c++){var h=u[c];if(h){if(f){f+="."}f+=h.toString(16)}}if(f){r+="."+f}return r};var o=new Uint8Array([79,112,117,115,72,101,97,100]);var u=function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);var i=r.getUint8(0);var n=i!==0;var a={version:i,channels:r.getUint8(1),preSkip:r.getUint16(2,n),sampleRate:r.getUint32(4,n),outputGain:r.getUint16(8,n),channelMappingFamily:r.getUint8(10)};if(a.channelMappingFamily>0&&t.length>10){a.streamCount=r.getUint8(11);a.twoChannelStreamCount=r.getUint8(12);a.channelMapping=[];for(var s=0;s<a.channels;s++){a.channelMapping.push(r.getUint8(13+s))}}return a};var l=function e(t){var r=t.channelMappingFamily<=0?11:12+t.channels;var i=new DataView(new ArrayBuffer(r));var n=t.version!==0;i.setUint8(0,t.version);i.setUint8(1,t.channels);i.setUint16(2,t.preSkip,n);i.setUint32(4,t.sampleRate,n);i.setUint16(8,t.outputGain,n);i.setUint8(10,t.channelMappingFamily);if(t.channelMappingFamily>0){i.setUint8(11,t.streamCount);t.channelMapping.foreach((function(e,t){i.setUint8(12+t,e)}))}return new Uint8Array(i.buffer)};var d=function e(t){if(typeof t==="string"){return Object(i["g"])(t)}if(typeof t==="number"){return t}return t};var f=function e(t){if(!Array.isArray(t)){return[d(t)]}return t.map((function(e){return d(e)}))};var c;var h=function e(t){t=Object(i["j"])(t);var r=[];var n=0;while(t.length>n){var a=t[n];var s=0;var o=0;o++;var u=t[o];o++;while(u&128){s=(u&127)<<7;u=t[o];o++}s+=u&127;for(var l=0;l<c.length;l++){var d=c[l],f=d.id,h=d.parser;if(a===f){r.push(h(t.subarray(o,o+s)));break}}n+=s+o}return r};c=[{id:3,parser:function e(t){var r={tag:3,id:t[0]<<8|t[1],flags:t[2],size:3,dependsOnEsId:0,ocrEsId:0,descriptors:[],url:""};if(r.flags&128){r.dependsOnEsId=t[r.size]<<8|t[r.size+1];r.size+=2}if(r.flags&64){var n=t[r.size];r.url=Object(i["c"])(t.subarray(r.size+1,r.size+1+n));r.size+=n}if(r.flags&32){r.ocrEsId=t[r.size]<<8|t[r.size+1];r.size+=2}r.descriptors=h(t.subarray(r.size))||[];return r}},{id:4,parser:function e(t){var r={tag:4,oti:t[0],streamType:t[1],bufferSize:t[2]<<16|t[3]<<8|t[4],maxBitrate:t[5]<<24|t[6]<<16|t[7]<<8|t[8],avgBitrate:t[9]<<24|t[10]<<16|t[11]<<8|t[12],descriptors:h(t.subarray(13))};return r}},{id:5,parser:function e(t){return{tag:5,bytes:t}}},{id:6,parser:function e(t){return{tag:6,bytes:t}}}];var p=function e(t,r,n){if(n===void 0){n=false}r=f(r);t=Object(i["j"])(t);var a=[];if(!r.length){return a}var s=0;while(s<t.length){var o=(t[s]<<24|t[s+1]<<16|t[s+2]<<8|t[s+3])>>>0;var u=t.subarray(s+4,s+8);if(o===0){break}var l=s+o;if(l>t.length){if(n){break}l=t.length}var d=t.subarray(s+8,l);if(Object(i["a"])(u,r[0])){if(r.length===1){a.push(d)}else{a.push.apply(a,e(d,r.slice(1),n))}}s=l}return a};var v=function e(t,r){r=d(r);if(!r.length){return t.subarray(t.length)}var n=0;while(n<t.length){if(Object(i["a"])(t.subarray(n,n+r.length),r)){var a=(t[n-4]<<24|t[n-3]<<16|t[n-2]<<8|t[n-1])>>>0;var s=a>1?n+a:t.byteLength;return t.subarray(n+4,s)}n++}return t.subarray(t.length)};var m=function e(t,r,n){if(r===void 0){r=4}if(n===void 0){n=function e(t){return Object(i["b"])(t)}}var a=[];if(!t||!t.length){return a}var s=Object(i["b"])(t.subarray(4,8));for(var o=8;s;o+=r,s--){a.push(n(t.subarray(o,o+r)))}return a};var g=function e(t,r){var n=m(p(t,["stss"])[0]);var a=m(p(t,["stco"])[0]);var s=m(p(t,["stts"])[0],8,(function(e){return{sampleCount:Object(i["b"])(e.subarray(0,4)),sampleDelta:Object(i["b"])(e.subarray(4,8))}}));var o=m(p(t,["stsc"])[0],12,(function(e){return{firstChunk:Object(i["b"])(e.subarray(0,4)),samplesPerChunk:Object(i["b"])(e.subarray(4,8)),sampleDescriptionIndex:Object(i["b"])(e.subarray(8,12))}}));var u=p(t,["stsz"])[0];var l=m(u&&u.length&&u.subarray(4)||null);var d=[];for(var f=0;f<a.length;f++){var c=void 0;for(var h=0;h<o.length;h++){var v=o[h];var g=f+1>=v.firstChunk&&(h+1>=o.length||f+1<o[h+1].firstChunk);if(g){c=v.samplesPerChunk;break}}var y=a[f];for(var _=0;_<c;_++){var b=l[d.length];var T=!n.length;if(n.length&&n.indexOf(d.length+1)!==-1){T=true}var S={keyframe:T,start:y,end:y+b};for(var w=0;w<s.length;w++){var E=s[w],k=E.sampleCount,A=E.sampleDelta;if(d.length<=k){var C=d.length?d[d.length-1].timestamp:0;S.timestamp=C+A/r*1e3;S.duration=A;break}}d.push(S);y+=b}}return d};var y=function e(t,r){var o=Object(i["c"])(r.subarray(0,4));if(t.type==="video"){t.info=t.info||{};t.info.width=r[28]<<8|r[29];t.info.height=r[30]<<8|r[31]}else if(t.type==="audio"){t.info=t.info||{};t.info.channels=r[20]<<8|r[21];t.info.bitDepth=r[22]<<8|r[23];t.info.sampleRate=r[28]<<8|r[29]}if(o==="avc1"){var l=v(r,"avcC");o+="."+a(l);t.info.avcC=l}else if(o==="hvc1"||o==="hev1"){o+="."+s(v(r,"hvcC"))}else if(o==="mp4a"||o==="mp4v"){var d=v(r,"esds");var f=h(d.subarray(4))[0];var c=f&&f.descriptors.filter((function(e){var t=e.tag;return t===4}))[0];if(c){o+="."+Object(i["i"])(c.oti);if(c.oti===64){o+="."+(c.descriptors[0].bytes[0]>>3).toString()}else if(c.oti===32){o+="."+c.descriptors[0].bytes[4].toString()}else if(c.oti===221){o="vorbis"}}else if(t.type==="audio"){o+=".40.2"}else{o+=".20.9"}}else if(o==="av01"){o+="."+n(v(r,"av1C"))}else if(o==="vp09"){var p=v(r,"vpcC");var m=p[0];var g=p[1];var y=p[2]>>4;var _=(p[2]&15)>>1;var b=(p[2]&15)>>3;var T=p[3];var S=p[4];var w=p[5];o+="."+Object(i["f"])(m,2,"0");o+="."+Object(i["f"])(g,2,"0");o+="."+Object(i["f"])(y,2,"0");o+="."+Object(i["f"])(_,2,"0");o+="."+Object(i["f"])(T,2,"0");o+="."+Object(i["f"])(S,2,"0");o+="."+Object(i["f"])(w,2,"0");o+="."+Object(i["f"])(b,2,"0")}else if(o==="theo"){o="theora"}else if(o==="spex"){o="speex"}else if(o===".mp3"){o="mp4a.40.34"}else if(o==="msVo"){o="vorbis"}else if(o==="Opus"){o="opus";var E=v(r,"dOps");t.info.opus=u(E);t.info.codecDelay=65e5}else{o=o.toLowerCase()}t.codec=o};var _=function e(t,r){if(r===void 0){r=true}t=Object(i["j"])(t);var n=p(t,["moov","trak"],true);var a=[];n.forEach((function(e){var t={bytes:e};var n=p(e,["mdia"])[0];var s=p(n,["hdlr"])[0];var o=Object(i["c"])(s.subarray(8,12));if(o==="soun"){t.type="audio"}else if(o==="vide"){t.type="video"}else{t.type=o}var u=p(e,["tkhd"])[0];if(u){var l=new DataView(u.buffer,u.byteOffset,u.byteLength);var d=l.getUint8(0);t.number=d===0?l.getUint32(12):l.getUint32(20)}var f=p(n,["mdhd"])[0];if(f){var c=f[0];var h=c===0?12:20;t.timescale=(f[h]<<24|f[h+1]<<16|f[h+2]<<8|f[h+3])>>>0}var v=p(n,["minf","stbl"])[0];var m=p(v,["stsd"])[0];var _=Object(i["b"])(m.subarray(4,8));var b=8;while(_--){var T=Object(i["b"])(m.subarray(b,b+4));var S=m.subarray(b+4,b+4+T);y(t,S);b+=4+T}if(r){t.frameTable=g(v,t.timescale)}a.push(t)}));return a};var b=function e(t){var r=p(t,["moov","mvhd"],true)[0];if(!r||!r.length){return}var n={};if(r[0]===1){n.timestampScale=Object(i["b"])(r.subarray(20,24));n.duration=Object(i["b"])(r.subarray(24,32))}else{n.timestampScale=Object(i["b"])(r.subarray(12,16));n.duration=Object(i["b"])(r.subarray(16,20))}n.bytes=r;return n};var T={EBML:Object(i["j"])([26,69,223,163]),DocType:Object(i["j"])([66,130]),Segment:Object(i["j"])([24,83,128,103]),SegmentInfo:Object(i["j"])([21,73,169,102]),Tracks:Object(i["j"])([22,84,174,107]),Track:Object(i["j"])([174]),TrackNumber:Object(i["j"])([215]),DefaultDuration:Object(i["j"])([35,227,131]),TrackEntry:Object(i["j"])([174]),TrackType:Object(i["j"])([131]),FlagDefault:Object(i["j"])([136]),CodecID:Object(i["j"])([134]),CodecPrivate:Object(i["j"])([99,162]),VideoTrack:Object(i["j"])([224]),AudioTrack:Object(i["j"])([225]),Cluster:Object(i["j"])([31,67,182,117]),Timestamp:Object(i["j"])([231]),TimestampScale:Object(i["j"])([42,215,177]),BlockGroup:Object(i["j"])([160]),BlockDuration:Object(i["j"])([155]),Block:Object(i["j"])([161]),SimpleBlock:Object(i["j"])([163])};var S=[128,64,32,16,8,4,2,1];var w=function e(t){var r=1;for(var i=0;i<S.length;i++){if(t&S[i]){break}r++}return r};var E=function e(t,r,n,a){if(n===void 0){n=true}if(a===void 0){a=false}var s=w(t[r]);var o=t.subarray(r,r+s);if(n){o=Array.prototype.slice.call(t,r,r+s);o[0]^=S[s-1]}return{length:s,value:Object(i["b"])(o,{signed:a}),bytes:o}};var k=function e(t){if(typeof t==="string"){return t.match(/.{1,2}/g).map((function(t){return e(t)}))}if(typeof t==="number"){return Object(i["e"])(t)}return t};var A=function e(t){if(!Array.isArray(t)){return[k(t)]}return t.map((function(e){return k(e)}))};var C=function e(t,r,n){if(n>=r.length){return r.length}var a=E(r,n,false);if(Object(i["a"])(t.bytes,a.bytes)){return n}var s=E(r,n+a.length);return e(t,r,n+s.length+s.value+a.length)};var I=function e(t,r){r=A(r);t=Object(i["j"])(t);var n=[];if(!r.length){return n}var a=0;while(a<t.length){var s=E(t,a,false);var o=E(t,a+s.length);var u=a+s.length+o.length;if(o.value===127){o.value=C(s,t,u);if(o.value!==t.length){o.value-=u}}var l=u+o.value>t.length?t.length:u+o.value;var d=t.subarray(u,l);if(Object(i["a"])(r[0],s.bytes)){if(r.length===1){n.push(d)}else{n=n.concat(e(d,r.slice(1)))}}var f=s.length+o.length+d.length;a+=f}return n};var D=function e(t,r,n,a){var s;if(r==="group"){s=I(t,[T.BlockDuration])[0];if(s){s=Object(i["b"])(s);s=1/n*s*n/1e3}t=I(t,[T.Block])[0];r="block"}var o=new DataView(t.buffer,t.byteOffset,t.byteLength);var u=E(t,0);var l=o.getInt16(u.length,false);var d=t[u.length+2];var f=t.subarray(u.length+3);var c=1/n*(a+l)*n/1e3;var h={duration:s,trackNumber:u.value,keyframe:r==="simple"&&d>>7===1,invisible:(d&8)>>3===1,lacing:(d&6)>>1,discardable:r==="simple"&&(d&1)===1,frames:[],pts:c,dts:c,timestamp:l};if(!h.lacing){h.frames.push(f);return h}var p=f[0]+1;var v=[];var m=1;if(h.lacing===2){var g=(f.length-m)/p;for(var y=0;y<p;y++){v.push(g)}}if(h.lacing===1){for(var _=0;_<p-1;_++){var b=0;do{b+=f[m];m++}while(f[m-1]===255);v.push(b)}}if(h.lacing===3){var S=0;for(var w=0;w<p-1;w++){var k=w===0?E(f,m):E(f,m,true,true);S+=k.value;v.push(S);m+=k.length}}v.forEach((function(e){h.frames.push(f.subarray(m,m+e));m+=e}));return h};var x=function e(t){var r=0;var i={};while(r<t.length){var n=t[r]&127;var a=t[r+1];var s=void 0;if(a===1){s=t[r+2]}else{s=t.subarray(r+2,r+2+a)}if(n===1){i.profile=s}else if(n===2){i.level=s}else if(n===3){i.bitDepth=s}else if(n===4){i.chromaSubsampling=s}else{i[n]=s}r+=2+a}return i};var L=function e(t){t=Object(i["j"])(t);var r=[];var o=I(t,[T.Segment,T.Tracks,T.Track]);if(!o.length){o=I(t,[T.Tracks,T.Track])}if(!o.length){o=I(t,[T.Track])}if(!o.length){return r}o.forEach((function(e){var t=I(e,T.TrackType)[0];if(!t||!t.length){return}if(t[0]===1){t="video"}else if(t[0]===2){t="audio"}else if(t[0]===17){t="subtitle"}else{return}var o={rawCodec:Object(i["c"])(I(e,[T.CodecID])[0]),type:t,codecPrivate:I(e,[T.CodecPrivate])[0],number:Object(i["b"])(I(e,[T.TrackNumber])[0]),defaultDuration:Object(i["b"])(I(e,[T.DefaultDuration])[0]),default:I(e,[T.FlagDefault])[0],rawData:e};var u="";if(/V_MPEG4\/ISO\/AVC/.test(o.rawCodec)){u="avc1."+a(o.codecPrivate)}else if(/V_MPEGH\/ISO\/HEVC/.test(o.rawCodec)){u="hev1."+s(o.codecPrivate)}else if(/V_MPEG4\/ISO\/ASP/.test(o.rawCodec)){if(o.codecPrivate){u="mp4v.20."+o.codecPrivate[4].toString()}else{u="mp4v.20.9"}}else if(/^V_THEORA/.test(o.rawCodec)){u="theora"}else if(/^V_VP8/.test(o.rawCodec)){u="vp8"}else if(/^V_VP9/.test(o.rawCodec)){if(o.codecPrivate){var l=x(o.codecPrivate),d=l.profile,f=l.level,c=l.bitDepth,h=l.chromaSubsampling;u="vp09.";u+=Object(i["f"])(d,2,"0")+".";u+=Object(i["f"])(f,2,"0")+".";u+=Object(i["f"])(c,2,"0")+".";u+=""+Object(i["f"])(h,2,"0");var p=I(e,[224,[85,176],[85,177]])[0]||[];var v=I(e,[224,[85,176],[85,185]])[0]||[];var m=I(e,[224,[85,176],[85,186]])[0]||[];var g=I(e,[224,[85,176],[85,187]])[0]||[];if(p.length||v.length||m.length||g.length){u+="."+Object(i["f"])(g[0],2,"0");u+="."+Object(i["f"])(m[0],2,"0");u+="."+Object(i["f"])(p[0],2,"0");u+="."+Object(i["f"])(v[0],2,"0")}}else{u="vp9"}}else if(/^V_AV1/.test(o.rawCodec)){u="av01."+n(o.codecPrivate)}else if(/A_ALAC/.test(o.rawCodec)){u="alac"}else if(/A_MPEG\/L2/.test(o.rawCodec)){u="mp2"}else if(/A_MPEG\/L3/.test(o.rawCodec)){u="mp3"}else if(/^A_AAC/.test(o.rawCodec)){if(o.codecPrivate){u="mp4a.40."+(o.codecPrivate[0]>>>3).toString()}else{u="mp4a.40.2"}}else if(/^A_AC3/.test(o.rawCodec)){u="ac-3"}else if(/^A_PCM/.test(o.rawCodec)){u="pcm"}else if(/^A_MS\/ACM/.test(o.rawCodec)){u="speex"}else if(/^A_EAC3/.test(o.rawCodec)){u="ec-3"}else if(/^A_VORBIS/.test(o.rawCodec)){u="vorbis"}else if(/^A_FLAC/.test(o.rawCodec)){u="flac"}else if(/^A_OPUS/.test(o.rawCodec)){u="opus"}o.codec=u;r.push(o)}));return r.sort((function(e,t){return e.number-t.number}))};var O=function e(t,r){var n=[];var a=I(t,[T.Segment])[0];var s=I(a,[T.SegmentInfo,T.TimestampScale])[0];if(s&&s.length){s=Object(i["b"])(s)}else{s=1e6}var o=I(a,[T.Cluster]);if(!r){r=L(a)}o.forEach((function(e,t){var r=I(e,[T.SimpleBlock]).map((function(e){return{type:"simple",data:e}}));var a=I(e,[T.BlockGroup]).map((function(e){return{type:"group",data:e}}));var o=I(e,[T.Timestamp])[0]||0;if(o&&o.length){o=Object(i["b"])(o)}var u=r.concat(a).sort((function(e,t){return e.data.byteOffset-t.data.byteOffset}));u.forEach((function(e,t){var r=D(e.data,e.type,s,o);n.push(r)}))}));return{tracks:r,blocks:n}};var P=r("./node_modules/@videojs/vhs-utils/es/id3-helpers.js");var R=Object(i["j"])([0,0,0,1]);var U=Object(i["j"])([0,0,1]);var M=Object(i["j"])([0,0,3]);var N=function e(t){var r=[];var n=1;while(n<t.length-2){if(Object(i["a"])(t.subarray(n,n+3),M)){r.push(n+2);n++}n++}if(r.length===0){return t}var a=t.length-r.length;var s=new Uint8Array(a);var o=0;for(n=0;n<a;o++,n++){if(o===r[0]){o++;r.shift()}s[n]=t[o]}return s};var B=function e(t,r,n,a){if(a===void 0){a=Infinity}t=Object(i["j"])(t);n=[].concat(n);var s=0;var o;var u=0;while(s<t.length&&(u<a||o)){var l=void 0;if(Object(i["a"])(t.subarray(s),R)){l=4}else if(Object(i["a"])(t.subarray(s),U)){l=3}if(!l){s++;continue}u++;if(o){return N(t.subarray(o,s))}var d=void 0;if(r==="h264"){d=t[s+l]&31}else if(r==="h265"){d=t[s+l]>>1&63}if(n.indexOf(d)!==-1){o=s+l}s+=l+(r==="h264"?1:2)}return t.subarray(0,0)};var F=function e(t,r,i){return B(t,"h264",r,i)};var j=function e(t,r,i){return B(t,"h265",r,i)};r.d(t,"a",(function(){return W}));r.d(t,"b",(function(){return z}));var q={webm:Object(i["j"])([119,101,98,109]),matroska:Object(i["j"])([109,97,116,114,111,115,107,97]),flac:Object(i["j"])([102,76,97,67]),ogg:Object(i["j"])([79,103,103,83]),ac3:Object(i["j"])([11,119]),riff:Object(i["j"])([82,73,70,70]),avi:Object(i["j"])([65,86,73]),wav:Object(i["j"])([87,65,86,69]),"3gp":Object(i["j"])([102,116,121,112,51,103]),mp4:Object(i["j"])([102,116,121,112]),fmp4:Object(i["j"])([115,116,121,112]),mov:Object(i["j"])([102,116,121,112,113,116]),moov:Object(i["j"])([109,111,111,118]),moof:Object(i["j"])([109,111,111,102])};var H={aac:function e(t){var r=Object(P["a"])(t);return Object(i["a"])(t,[255,16],{offset:r,mask:[255,22]})},mp3:function e(t){var r=Object(P["a"])(t);return Object(i["a"])(t,[255,2],{offset:r,mask:[255,6]})},webm:function e(t){var r=I(t,[T.EBML,T.DocType])[0];return Object(i["a"])(r,q.webm)},mkv:function e(t){var r=I(t,[T.EBML,T.DocType])[0];return Object(i["a"])(r,q.matroska)},mp4:function e(t){if(H["3gp"](t)||H.mov(t)){return false}if(Object(i["a"])(t,q.mp4,{offset:4})||Object(i["a"])(t,q.fmp4,{offset:4})){return true}if(Object(i["a"])(t,q.moof,{offset:4})||Object(i["a"])(t,q.moov,{offset:4})){return true}},mov:function e(t){return Object(i["a"])(t,q.mov,{offset:4})},"3gp":function e(t){return Object(i["a"])(t,q["3gp"],{offset:4})},ac3:function e(t){var r=Object(P["a"])(t);return Object(i["a"])(t,q.ac3,{offset:r})},ts:function e(t){if(t.length<189&&t.length>=1){return t[0]===71}var r=0;while(r+188<t.length&&r<188){if(t[r]===71&&t[r+188]===71){return true}r+=1}return false},flac:function e(t){var r=Object(P["a"])(t);return Object(i["a"])(t,q.flac,{offset:r})},ogg:function e(t){return Object(i["a"])(t,q.ogg)},avi:function e(t){return Object(i["a"])(t,q.riff)&&Object(i["a"])(t,q.avi,{offset:8})},wav:function e(t){return Object(i["a"])(t,q.riff)&&Object(i["a"])(t,q.wav,{offset:8})},h264:function e(t){return F(t,7,3).length},h265:function e(t){return j(t,[32,33],3).length}};var G=Object.keys(H).filter((function(e){return e!=="ts"&&e!=="h264"&&e!=="h265"})).concat(["ts","h264","h265"]);G.forEach((function(e){var t=H[e];H[e]=function(e){return t(Object(i["j"])(e))}}));var V=H;var W=function e(t){t=Object(i["j"])(t);for(var r=0;r<G.length;r++){var n=G[r];if(V[n](t)){return n}}return""};var z=function e(t){return p(t,["moof"]).length>0}},"./node_modules/@videojs/vhs-utils/es/decode-b64-to-uint8-array.js":function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return s}));var i=r("./node_modules/global/window.js");var n=r.n(i);var a=function t(r){return n.a.atob?n.a.atob(r):e.from(r,"base64").toString("binary")};function s(e){var t=a(e);var r=new Uint8Array(t.length);for(var i=0;i<t.length;i++){r[i]=t.charCodeAt(i)}return r}}).call(this,r("./node_modules/buffer/index.js").Buffer)},"./node_modules/@videojs/vhs-utils/es/id3-helpers.js":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r("./node_modules/@videojs/vhs-utils/es/byte-helpers.js");var n=Object(i["j"])([73,68,51]);var a=function e(t,r){if(r===void 0){r=0}t=Object(i["j"])(t);var n=t[r+5];var a=t[r+6]<<21|t[r+7]<<14|t[r+8]<<7|t[r+9];var s=(n&16)>>4;if(s){return a+20}return a+10};var s=function e(t,r){if(r===void 0){r=0}t=Object(i["j"])(t);if(t.length-r<10||!Object(i["a"])(t,n,{offset:r})){return r}r+=a(t,r);return e(t,r)}},"./node_modules/@videojs/vhs-utils/es/media-types.js":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i;var n=/^application\/dash\+xml/i;var a=function e(t){if(i.test(t)){return"hls"}if(n.test(t)){return"dash"}if(t==="application/vnd.videojs.vhs+json"){return"vhs-json"}return null}},"./node_modules/@videojs/vhs-utils/es/resolve-url.js":function(e,t,r){"use strict";var i=r("./node_modules/url-toolkit/src/url-toolkit.js");var n=r.n(i);var a=r("./node_modules/global/window.js");var s=r.n(a);var o="http://example.com";var u=function e(t,r){if(/^[a-z]+:/i.test(r)){return r}if(/^data:/.test(t)){t=s.a.location&&s.a.location.href||""}var i=typeof s.a.URL==="function";var a=/^\/\//.test(t);var u=!s.a.location&&!/\/\//i.test(t);if(i){t=new s.a.URL(t,s.a.location||o)}else if(!/\/\//i.test(t)){t=n.a.buildAbsoluteURL(s.a.location&&s.a.location.href||"",t)}if(i){var l=new URL(r,t);if(u){return l.href.slice(o.length)}else if(a){return l.href.slice(l.protocol.length)}return l.href}return n.a.buildAbsoluteURL(t,r)};t["a"]=u},"./node_modules/@videojs/xhr/lib/http-handler.js":function(e,t,r){"use strict";var i=r("./node_modules/global/window.js");var n=function e(t,r){if(r===void 0){r=false}return function(e,n,s){if(e){t(e);return}if(n.statusCode>=400&&n.statusCode<=599){var o=s;if(r){if(i.TextDecoder){var u=a(n.headers&&n.headers["content-type"]);try{o=new TextDecoder(u).decode(s)}catch(e){}}else{o=String.fromCharCode.apply(null,new Uint8Array(s))}}t({cause:o});return}t(null,s)}};function a(e){if(e===void 0){e=""}return e.toLowerCase().split(";").reduce((function(e,t){var r=t.split("="),i=r[0],n=r[1];if(i.trim()==="charset"){return n.trim()}return e}),"utf-8")}e.exports=n},"./node_modules/@videojs/xhr/lib/index.js":function(e,t,r){"use strict";var i=r("./node_modules/global/window.js");var n=r("./node_modules/@babel/runtime/helpers/extends.js");var a=r("./node_modules/is-function/index.js");d.httpHandler=r("./node_modules/@videojs/xhr/lib/http-handler.js");var s=function e(t){var r={};if(!t){return r}t.trim().split("\n").forEach((function(e){var t=e.indexOf(":");var i=e.slice(0,t).trim().toLowerCase();var n=e.slice(t+1).trim();if(typeof r[i]==="undefined"){r[i]=n}else if(Array.isArray(r[i])){r[i].push(n)}else{r[i]=[r[i],n]}}));return r};e.exports=d;e.exports.default=d;d.XMLHttpRequest=i.XMLHttpRequest||h;d.XDomainRequest="withCredentials"in new d.XMLHttpRequest?d.XMLHttpRequest:i.XDomainRequest;o(["get","put","post","patch","head","delete"],(function(e){d[e==="delete"?"del":e]=function(t,r,i){r=l(t,r,i);r.method=e.toUpperCase();return f(r)}}));function o(e,t){for(var r=0;r<e.length;r++){t(e[r])}}function u(e){for(var t in e){if(e.hasOwnProperty(t))return false}return true}function l(e,t,r){var i=e;if(a(t)){r=t;if(typeof e==="string"){i={uri:e}}}else{i=n({},t,{uri:e})}i.callback=r;return i}function d(e,t,r){t=l(e,t,r);return f(t)}function f(e){if(typeof e.callback==="undefined"){throw new Error("callback argument missing")}var t=false;var r=function r(i,n,a){if(!t){t=true;e.callback(i,n,a)}};function i(){if(l.readyState===4){setTimeout(o,0)}}function n(){var e=undefined;if(l.response){e=l.response}else{e=l.responseText||c(l)}if(_){try{e=JSON.parse(e)}catch(e){}}return e}function a(e){clearTimeout(b);if(!(e instanceof Error)){e=new Error(""+(e||"Unknown XMLHttpRequest Error"))}e.statusCode=0;return r(e,T)}function o(){if(h)return;var t;clearTimeout(b);if(e.useXDR&&l.status===undefined){t=200}else{t=l.status===1223?204:l.status}var i=T;var a=null;if(t!==0){i={body:n(),statusCode:t,method:v,headers:{},url:p,rawRequest:l};if(l.getAllResponseHeaders){i.headers=s(l.getAllResponseHeaders())}}else{a=new Error("Internal XMLHttpRequest Error")}return r(a,i,i.body)}var l=e.xhr||null;if(!l){if(e.cors||e.useXDR){l=new d.XDomainRequest}else{l=new d.XMLHttpRequest}}var f;var h;var p=l.url=e.uri||e.url;var v=l.method=e.method||"GET";var m=e.body||e.data;var g=l.headers=e.headers||{};var y=!!e.sync;var _=false;var b;var T={body:undefined,headers:{},statusCode:0,method:v,url:p,rawRequest:l};if("json"in e&&e.json!==false){_=true;g["accept"]||g["Accept"]||(g["Accept"]="application/json");if(v!=="GET"&&v!=="HEAD"){g["content-type"]||g["Content-Type"]||(g["Content-Type"]="application/json");m=JSON.stringify(e.json===true?m:e.json)}}l.onreadystatechange=i;l.onload=o;l.onerror=a;l.onprogress=function(){};l.onabort=function(){h=true};l.ontimeout=a;l.open(v,p,!y,e.username,e.password);if(!y){l.withCredentials=!!e.withCredentials}if(!y&&e.timeout>0){b=setTimeout((function(){if(h)return;h=true;l.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT";a(e)}),e.timeout)}if(l.setRequestHeader){for(f in g){if(g.hasOwnProperty(f)){l.setRequestHeader(f,g[f])}}}else if(e.headers&&!u(e.headers)){throw new Error("Headers cannot be set on an XDomainRequest object")}if("responseType"in e){l.responseType=e.responseType}if("beforeSend"in e&&typeof e.beforeSend==="function"){e.beforeSend(l)}l.send(m||null);return l}function c(e){try{if(e.responseType==="document"){return e.responseXML}var t=e.responseXML&&e.responseXML.documentElement.nodeName==="parsererror";if(e.responseType===""&&!t){return e.responseXML}}catch(e){}return null}function h(){}},"./node_modules/hls.js/dist/hls.light.js":function(e,t,r){typeof window!=="undefined"&&function t(r,i){if(true)e.exports=i();else{}}(this,(function(){return function(e){var t={};function r(i){if(t[i]){return t[i].exports}var n=t[i]={i:i,l:false,exports:{}};e[i].call(n.exports,n,n.exports,r);n.l=true;return n.exports}r.m=e;r.c=t;r.d=function(e,t,i){if(!r.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:i})}};r.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};r.t=function(e,t){if(t&1)e=r(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var i=Object.create(null);r.r(i);Object.defineProperty(i,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="/dist/";return r(r.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(e,t,r){"use strict";var i=Object.prototype.hasOwnProperty,n="~";function a(){}if(Object.create){a.prototype=Object.create(null);if(!(new a).__proto__)n=false}function s(e,t,r){this.fn=e;this.context=t;this.once=r||false}function o(e,t,r,i,a){if(typeof r!=="function"){throw new TypeError("The listener must be a function")}var o=new s(r,i||e,a),u=n?n+t:t;if(!e._events[u])e._events[u]=o,e._eventsCount++;else if(!e._events[u].fn)e._events[u].push(o);else e._events[u]=[e._events[u],o];return e}function u(e,t){if(--e._eventsCount===0)e._events=new a;else delete e._events[t]}function l(){this._events=new a;this._eventsCount=0}l.prototype.eventNames=function e(){var t=[],r,a;if(this._eventsCount===0)return t;for(a in r=this._events){if(i.call(r,a))t.push(n?a.slice(1):a)}if(Object.getOwnPropertySymbols){return t.concat(Object.getOwnPropertySymbols(r))}return t};l.prototype.listeners=function e(t){var r=n?n+t:t,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var a=0,s=i.length,o=new Array(s);a<s;a++){o[a]=i[a].fn}return o};l.prototype.listenerCount=function e(t){var r=n?n+t:t,i=this._events[r];if(!i)return 0;if(i.fn)return 1;return i.length};l.prototype.emit=function e(t,r,i,a,s,o){var u=n?n+t:t;if(!this._events[u])return false;var l=this._events[u],d=arguments.length,f,c;if(l.fn){if(l.once)this.removeListener(t,l.fn,undefined,true);switch(d){case 1:return l.fn.call(l.context),true;case 2:return l.fn.call(l.context,r),true;case 3:return l.fn.call(l.context,r,i),true;case 4:return l.fn.call(l.context,r,i,a),true;case 5:return l.fn.call(l.context,r,i,a,s),true;case 6:return l.fn.call(l.context,r,i,a,s,o),true}for(c=1,f=new Array(d-1);c<d;c++){f[c-1]=arguments[c]}l.fn.apply(l.context,f)}else{var h=l.length,p;for(c=0;c<h;c++){if(l[c].once)this.removeListener(t,l[c].fn,undefined,true);switch(d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,r);break;case 3:l[c].fn.call(l[c].context,r,i);break;case 4:l[c].fn.call(l[c].context,r,i,a);break;default:if(!f)for(p=1,f=new Array(d-1);p<d;p++){f[p-1]=arguments[p]}l[c].fn.apply(l[c].context,f)}}}return true};l.prototype.on=function e(t,r,i){return o(this,t,r,i,false)};l.prototype.once=function e(t,r,i){return o(this,t,r,i,true)};l.prototype.removeListener=function e(t,r,i,a){var s=n?n+t:t;if(!this._events[s])return this;if(!r){u(this,s);return this}var o=this._events[s];if(o.fn){if(o.fn===r&&(!a||o.once)&&(!i||o.context===i)){u(this,s)}}else{for(var l=0,d=[],f=o.length;l<f;l++){if(o[l].fn!==r||a&&!o[l].once||i&&o[l].context!==i){d.push(o[l])}}if(d.length)this._events[s]=d.length===1?d[0]:d;else u(this,s)}return this};l.prototype.removeAllListeners=function e(t){var r;if(t){r=n?n+t:t;if(this._events[r])u(this,r)}else{this._events=new a;this._eventsCount=0}return this};l.prototype.off=l.prototype.removeListener;l.prototype.addListener=l.prototype.on;l.prefixed=n;l.EventEmitter=l;if(true){e.exports=l}},"./node_modules/url-toolkit/src/url-toolkit.js":function(e,t,r){(function(t){var r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/;var i=/^([^\/?#]*)(.*)$/;var n=/(?:\/|^)\.(?=\/)/g;var a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g;var s={buildAbsoluteURL:function(e,t,r){r=r||{};e=e.trim();t=t.trim();if(!t){if(!r.alwaysNormalize){return e}var n=s.parseURL(e);if(!n){throw new Error("Error trying to parse base URL.")}n.path=s.normalizePath(n.path);return s.buildURLFromParts(n)}var a=s.parseURL(t);if(!a){throw new Error("Error trying to parse relative URL.")}if(a.scheme){if(!r.alwaysNormalize){return t}a.path=s.normalizePath(a.path);return s.buildURLFromParts(a)}var o=s.parseURL(e);if(!o){throw new Error("Error trying to parse base URL.")}if(!o.netLoc&&o.path&&o.path[0]!=="/"){var u=i.exec(o.path);o.netLoc=u[1];o.path=u[2]}if(o.netLoc&&!o.path){o.path="/"}var l={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc){l.netLoc=o.netLoc;if(a.path[0]!=="/"){if(!a.path){l.path=o.path;if(!a.params){l.params=o.params;if(!a.query){l.query=o.query}}}else{var d=o.path;var f=d.substring(0,d.lastIndexOf("/")+1)+a.path;l.path=s.normalizePath(f)}}}if(l.path===null){l.path=r.alwaysNormalize?s.normalizePath(a.path):a.path}return s.buildURLFromParts(l)},parseURL:function(e){var t=r.exec(e);if(!t){return null}return{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}},normalizePath:function(e){e=e.split("").reverse().join("").replace(n,"");while(e.length!==(e=e.replace(a,"")).length){}return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};if(true)e.exports=s;else{}})(this)},"./node_modules/webworkify-webpack/index.js":function(e,t,r){function i(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:false,exports:{}};e[i].call(n.exports,n,n.exports,r);n.l=true;return n.exports}r.m=e;r.c=t;r.i=function(e){return e};r.d=function(e,t,i){if(!r.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:i})}};r.r=function(e){Object.defineProperty(e,"__esModule",{value:true})};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="/";r.oe=function(e){console.error(e);throw e};var i=r(r.s=ENTRY_MODULE);return i.default||i}var n="[\\.|\\-|\\+|\\w|/|@]+";var a="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+n+").*?\\)";function s(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function o(e){return!isNaN(1*e)}function u(e,t,i){var u={};u[i]=[];var l=t.toString();var d=l.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!d)return u;var f=d[1];var c=new RegExp("(\\\\n|\\W)"+s(f)+a,"g");var h;while(h=c.exec(l)){if(h[3]==="dll-reference")continue;u[i].push(h[3])}c=new RegExp("\\("+s(f)+'\\("(dll-reference\\s('+n+'))"\\)\\)'+a,"g");while(h=c.exec(l)){if(!e[h[2]]){u[i].push(h[1]);e[h[2]]=r(h[1]).m}u[h[2]]=u[h[2]]||[];u[h[2]].push(h[4])}var p=Object.keys(u);for(var v=0;v<p.length;v++){for(var m=0;m<u[p[v]].length;m++){if(o(u[p[v]][m])){u[p[v]][m]=1*u[p[v]][m]}}}return u}function l(e){var t=Object.keys(e);return t.reduce((function(t,r){return t||e[r].length>0}),false)}function d(e,t){var r={main:[t]};var i={main:[]};var n={main:{}};while(l(r)){var a=Object.keys(r);for(var s=0;s<a.length;s++){var o=a[s];var d=r[o];var f=d.pop();n[o]=n[o]||{};if(n[o][f]||!e[o][f])continue;n[o][f]=true;i[o]=i[o]||[];i[o].push(f);var c=u(e,e[o][f],o);var h=Object.keys(c);for(var p=0;p<h.length;p++){r[h[p]]=r[h[p]]||[];r[h[p]]=r[h[p]].concat(c[h[p]])}}}return i}e.exports=function(e,t){t=t||{};var n={main:r.m};var a=t.all?{main:Object.keys(n.main)}:d(n,e);var s="";Object.keys(a).filter((function(e){return e!=="main"})).forEach((function(e){var t=0;while(a[e][t]){t++}a[e].push(t);n[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })";s=s+"var "+e+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a[e].map((function(t){return""+JSON.stringify(t)+": "+n[e][t].toString()})).join(",")+"});\n"}));s=s+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a.main.map((function(e){return""+JSON.stringify(e)+": "+n.main[e].toString()})).join(",")+"}))(self);";var o=new window.Blob([s],{type:"text/javascript"});if(t.bare){return o}var u=window.URL||window.webkitURL||window.mozURL||window.msURL;var l=u.createObjectURL(o);var f=new window.Worker(l);f.objectURL=l;return f}},"./src/demux/demuxer-inline.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/events.js");var n=r("./src/errors.ts");var a=function(){function e(e,t){this.subtle=e;this.aesIV=t}var t=e.prototype;t.decrypt=function e(t,r){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},r,t)};return e}();var s=function(){function e(e,t){this.subtle=e;this.key=t}var t=e.prototype;t.expandKey=function e(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},false,["encrypt","decrypt"])};return e}();var o=s;function u(e){var t=e.byteLength;var r=t&&new DataView(e).getUint8(t-1);if(r){return e.slice(0,t-r)}else{return e}}var l=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54];this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.sBox=new Uint32Array(256);this.invSBox=new Uint32Array(256);this.key=new Uint32Array(0);this.initTable()}var t=e.prototype;t.uint8ArrayToUint32Array_=function e(t){var r=new DataView(t);var i=new Uint32Array(4);for(var n=0;n<4;n++){i[n]=r.getUint32(n*4)}return i};t.initTable=function e(){var t=this.sBox;var r=this.invSBox;var i=this.subMix;var n=i[0];var a=i[1];var s=i[2];var o=i[3];var u=this.invSubMix;var l=u[0];var d=u[1];var f=u[2];var c=u[3];var h=new Uint32Array(256);var p=0;var v=0;var m=0;for(m=0;m<256;m++){if(m<128){h[m]=m<<1}else{h[m]=m<<1^283}}for(m=0;m<256;m++){var g=v^v<<1^v<<2^v<<3^v<<4;g=g>>>8^g&255^99;t[p]=g;r[g]=p;var y=h[p];var _=h[y];var b=h[_];var T=h[g]*257^g*16843008;n[p]=T<<24|T>>>8;a[p]=T<<16|T>>>16;s[p]=T<<8|T>>>24;o[p]=T;T=b*16843009^_*65537^y*257^p*16843008;l[g]=T<<24|T>>>8;d[g]=T<<16|T>>>16;f[g]=T<<8|T>>>24;c[g]=T;if(!p){p=v=1}else{p=y^h[h[h[b^y]]];v^=h[h[v]]}}};t.expandKey=function e(t){var r=this.uint8ArrayToUint32Array_(t);var i=true;var n=0;while(n<r.length&&i){i=r[n]===this.key[n];n++}if(i){return}this.key=r;var a=this.keySize=r.length;if(a!==4&&a!==6&&a!==8){throw new Error("Invalid aes key size="+a)}var s=this.ksRows=(a+6+1)*4;var o;var u;var l=this.keySchedule=new Uint32Array(s);var d=this.invKeySchedule=new Uint32Array(s);var f=this.sBox;var c=this.rcon;var h=this.invSubMix;var p=h[0];var v=h[1];var m=h[2];var g=h[3];var y;var _;for(o=0;o<s;o++){if(o<a){y=l[o]=r[o];continue}_=y;if(o%a===0){_=_<<8|_>>>24;_=f[_>>>24]<<24|f[_>>>16&255]<<16|f[_>>>8&255]<<8|f[_&255];_^=c[o/a|0]<<24}else if(a>6&&o%a===4){_=f[_>>>24]<<24|f[_>>>16&255]<<16|f[_>>>8&255]<<8|f[_&255]}l[o]=y=(l[o-a]^_)>>>0}for(u=0;u<s;u++){o=s-u;if(u&3){_=l[o]}else{_=l[o-4]}if(u<4||o<=4){d[u]=_}else{d[u]=p[f[_>>>24]]^v[f[_>>>16&255]]^m[f[_>>>8&255]]^g[f[_&255]]}d[u]=d[u]>>>0}};t.networkToHostOrderSwap=function e(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24};t.decrypt=function e(t,r,i,n){var a=this.keySize+6;var s=this.invKeySchedule;var o=this.invSBox;var l=this.invSubMix;var d=l[0];var f=l[1];var c=l[2];var h=l[3];var p=this.uint8ArrayToUint32Array_(i);var v=p[0];var m=p[1];var g=p[2];var y=p[3];var _=new Int32Array(t);var b=new Int32Array(_.length);var T,S,w,E;var k,A,C,I;var D,x,L,O;var P,R;var U=this.networkToHostOrderSwap;while(r<_.length){D=U(_[r]);x=U(_[r+1]);L=U(_[r+2]);O=U(_[r+3]);k=D^s[0];A=O^s[1];C=L^s[2];I=x^s[3];P=4;for(R=1;R<a;R++){T=d[k>>>24]^f[A>>16&255]^c[C>>8&255]^h[I&255]^s[P];S=d[A>>>24]^f[C>>16&255]^c[I>>8&255]^h[k&255]^s[P+1];w=d[C>>>24]^f[I>>16&255]^c[k>>8&255]^h[A&255]^s[P+2];E=d[I>>>24]^f[k>>16&255]^c[A>>8&255]^h[C&255]^s[P+3];k=T;A=S;C=w;I=E;P=P+4}T=o[k>>>24]<<24^o[A>>16&255]<<16^o[C>>8&255]<<8^o[I&255]^s[P];S=o[A>>>24]<<24^o[C>>16&255]<<16^o[I>>8&255]<<8^o[k&255]^s[P+1];w=o[C>>>24]<<24^o[I>>16&255]<<16^o[k>>8&255]<<8^o[A&255]^s[P+2];E=o[I>>>24]<<24^o[k>>16&255]<<16^o[A>>8&255]<<8^o[C&255]^s[P+3];P=P+3;b[r]=U(T^v);b[r+1]=U(E^m);b[r+2]=U(w^g);b[r+3]=U(S^y);v=D;m=x;g=L;y=O;r=r+4}return n?u(b.buffer):b.buffer};t.destroy=function e(){this.key=undefined;this.keySize=undefined;this.ksRows=undefined;this.sBox=undefined;this.invSBox=undefined;this.subMix=undefined;this.invSubMix=undefined;this.keySchedule=undefined;this.invKeySchedule=undefined;this.rcon=undefined};return e}();var d=l;var f=r("./src/utils/logger.js");var c=r("./src/utils/get-self-scope.js");var h=Object(c["getSelfScope"])();var p=function(){function e(e,t,r){var i=r===void 0?{}:r,n=i.removePKCS7Padding,a=n===void 0?true:n;this.logEnabled=true;this.observer=e;this.config=t;this.removePKCS7Padding=a;if(a){try{var s=h.crypto;if(s){this.subtle=s.subtle||s.webkitSubtle}}catch(e){}}this.disableWebCrypto=!this.subtle}var t=e.prototype;t.isSync=function e(){return this.disableWebCrypto&&this.config.enableSoftwareAES};t.decrypt=function e(t,r,i,n){var s=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){if(this.logEnabled){f["logger"].log("JS AES decrypt");this.logEnabled=false}var u=this.decryptor;if(!u){this.decryptor=u=new d}u.expandKey(r);n(u.decrypt(t,0,i,this.removePKCS7Padding))}else{if(this.logEnabled){f["logger"].log("WebCrypto AES decrypt");this.logEnabled=false}var l=this.subtle;if(this.key!==r){this.key=r;this.fastAesKey=new o(l,r)}this.fastAesKey.expandKey().then((function(e){var o=new a(l,i);o.decrypt(t,e).catch((function(e){s.onWebCryptoError(e,t,r,i,n)})).then((function(e){n(e)}))})).catch((function(e){s.onWebCryptoError(e,t,r,i,n)}))}};t.onWebCryptoError=function e(t,r,a,s,o){if(this.config.enableSoftwareAES){f["logger"].log("WebCrypto Error, disable WebCrypto API");this.disableWebCrypto=true;this.logEnabled=true;this.decrypt(r,a,s,o)}else{f["logger"].error("decrypting error : "+t.message);this.observer.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].FRAG_DECRYPT_ERROR,fatal:true,reason:t.message})}};t.destroy=function e(){var t=this.decryptor;if(t){t.destroy();this.decryptor=undefined}};return e}();var v=p;var m=r("./src/polyfills/number.js");function g(e,t,r,a){var s,o,u,l,d,c=navigator.userAgent.toLowerCase(),h=a,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];s=((t[r+2]&192)>>>6)+1;o=(t[r+2]&60)>>>2;if(o>p.length-1){e.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].FRAG_PARSING_ERROR,fatal:true,reason:"invalid ADTS sampling index:"+o});return}l=(t[r+2]&1)<<2;l|=(t[r+3]&192)>>>6;f["logger"].log("manifest codec:"+a+",ADTS data:type:"+s+",sampleingIndex:"+o+"["+p[o]+"Hz],channelConfig:"+l);if(/firefox/i.test(c)){if(o>=6){s=5;d=new Array(4);u=o-3}else{s=2;d=new Array(2);u=o}}else if(c.indexOf("android")!==-1){s=2;d=new Array(2);u=o}else{s=5;d=new Array(4);if(a&&(a.indexOf("mp4a.40.29")!==-1||a.indexOf("mp4a.40.5")!==-1)||!a&&o>=6){u=o-3}else{if(a&&a.indexOf("mp4a.40.2")!==-1&&(o>=6&&l===1||/vivaldi/i.test(c))||!a&&l===1){s=2;d=new Array(2)}u=o}}d[0]=s<<3;d[0]|=(o&14)>>1;d[1]|=(o&1)<<7;d[1]|=l<<3;if(s===5){d[1]|=(u&14)>>1;d[2]=(u&1)<<7;d[2]|=2<<2;d[3]=0}return{config:d,samplerate:p[o],channelCount:l,codec:"mp4a.40."+s,manifestCodec:h}}function y(e,t){return e[t]===255&&(e[t+1]&246)===240}function _(e,t){return e[t+1]&1?7:9}function b(e,t){return(e[t+3]&3)<<11|e[t+4]<<3|(e[t+5]&224)>>>5}function T(e,t){if(t+1<e.length&&y(e,t)){return true}return false}function S(e,t){if(T(e,t)){var r=_(e,t);if(t+r>=e.length){return false}var i=b(e,t);if(i<=r){return false}var n=t+i;if(n===e.length||n+1<e.length&&y(e,n)){return true}}return false}function w(e,t,r,i,n){if(!e.samplerate){var a=g(t,r,i,n);e.config=a.config;e.samplerate=a.samplerate;e.channelCount=a.channelCount;e.codec=a.codec;e.manifestCodec=a.manifestCodec;f["logger"].log("parsed codec:"+e.codec+",rate:"+a.samplerate+",nb channel:"+a.channelCount)}}function E(e){return 1024*9e4/e}function k(e,t,r,i,n){var a,s,o;var u=e.length;a=_(e,t);s=b(e,t);s-=a;if(s>0&&t+a+s<=u){o=r+i*n;return{headerLength:a,frameLength:s,stamp:o}}return undefined}function A(e,t,r,i,n){var a=E(e.samplerate);var s=k(t,r,i,n,a);if(s){var o=s.stamp;var u=s.headerLength;var l=s.frameLength;var d={unit:t.subarray(r+u,r+u+l),pts:o,dts:o};e.samples.push(d);return{sample:d,length:l+u}}return undefined}var C=r("./src/demux/id3.js");var I=function(){function e(e,t,r){this.observer=e;this.config=r;this.remuxer=t}var t=e.prototype;t.resetInitSegment=function e(t,r,i,n){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:true,samples:[],len:0,manifestCodec:r,duration:n,inputTimeScale:9e4}};t.resetTimeStamp=function e(){};e.probe=function e(t){if(!t){return false}var r=C["default"].getID3Data(t,0)||[];var i=r.length;for(var n=t.length;i<n;i++){if(S(t,i)){f["logger"].log("ADTS sync word found !");return true}}return false};t.append=function e(t,r,i,n){var a=this._audioTrack;var s=C["default"].getID3Data(t,0)||[];var o=C["default"].getTimeStamp(s);var u=Object(m["isFiniteNumber"])(o)?o*90:r*9e4;var l=0;var d=u;var c=t.length;var h=s.length;var p=[{pts:d,dts:d,data:s}];while(h<c-1){if(T(t,h)&&h+5<c){w(a,this.observer,t,h,a.manifestCodec);var v=A(a,t,h,u,l);if(v){h+=v.length;d=v.sample.pts;l++}else{f["logger"].log("Unable to parse AAC frame");break}}else if(C["default"].isHeader(t,h)){s=C["default"].getID3Data(t,h);p.push({pts:d,dts:d,data:s});h+=s.length}else{h++}}this.remuxer.remux(a,{samples:[]},{samples:p,inputTimeScale:9e4},{samples:[]},r,i,n)};t.destroy=function e(){};return e}();var D=I;var x=r("./src/demux/mp4demuxer.js");var L={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function e(t,r,i,n,a){if(i+24>r.length){return undefined}var s=this.parseHeader(r,i);if(s&&i+s.frameLength<=r.length){var o=s.samplesPerFrame*9e4/s.sampleRate;var u=n+a*o;var l={unit:r.subarray(i,i+s.frameLength),pts:u,dts:u};t.config=[];t.channelCount=s.channelCount;t.samplerate=s.sampleRate;t.samples.push(l);return{sample:l,length:s.frameLength}}return undefined},parseHeader:function e(t,r){var i=t[r+1]>>3&3;var n=t[r+1]>>1&3;var a=t[r+2]>>4&15;var s=t[r+2]>>2&3;var o=t[r+2]>>1&1;if(i!==1&&a!==0&&a!==15&&s!==3){var u=i===3?3-n:n===3?3:4;var l=L.BitratesMap[u*14+a-1]*1e3;var d=i===3?0:i===2?1:2;var f=L.SamplingRateMap[d*3+s];var c=t[r+3]>>6===3?1:2;var h=L.SamplesCoefficients[i][n];var p=L.BytesInSlot[n];var v=h*8*p;var m=parseInt(h*l/f+o,10)*p;return{sampleRate:f,channelCount:c,frameLength:m,samplesPerFrame:v}}return undefined},isHeaderPattern:function e(t,r){return t[r]===255&&(t[r+1]&224)===224&&(t[r+1]&6)!==0},isHeader:function e(t,r){if(r+1<t.length&&this.isHeaderPattern(t,r)){return true}return false},probe:function e(t,r){if(r+1<t.length&&this.isHeaderPattern(t,r)){var i=4;var n=this.parseHeader(t,r);var a=i;if(n&&n.frameLength){a=n.frameLength}var s=r+a;if(s===t.length||s+1<t.length&&this.isHeaderPattern(t,s)){return true}}return false}};var O=L;var P=function(){function e(e){this.data=e;this.bytesAvailable=e.byteLength;this.word=0;this.bitsAvailable=0}var t=e.prototype;t.loadWord=function e(){var t=this.data,r=this.bytesAvailable,i=t.byteLength-r,n=new Uint8Array(4),a=Math.min(4,r);if(a===0){throw new Error("no bytes available")}n.set(t.subarray(i,i+a));this.word=new DataView(n.buffer).getUint32(0);this.bitsAvailable=a*8;this.bytesAvailable-=a};t.skipBits=function e(t){var r;if(this.bitsAvailable>t){this.word<<=t;this.bitsAvailable-=t}else{t-=this.bitsAvailable;r=t>>3;t-=r>>3;this.bytesAvailable-=r;this.loadWord();this.word<<=t;this.bitsAvailable-=t}};t.readBits=function e(t){var r=Math.min(this.bitsAvailable,t),i=this.word>>>32-r;if(t>32){f["logger"].error("Cannot read more than 32 bits at a time")}this.bitsAvailable-=r;if(this.bitsAvailable>0){this.word<<=r}else if(this.bytesAvailable>0){this.loadWord()}r=t-r;if(r>0&&this.bitsAvailable){return i<<r|this.readBits(r)}else{return i}};t.skipLZ=function e(){var t;for(t=0;t<this.bitsAvailable;++t){if((this.word&2147483648>>>t)!==0){this.word<<=t;this.bitsAvailable-=t;return t}}this.loadWord();return t+this.skipLZ()};t.skipUEG=function e(){this.skipBits(1+this.skipLZ())};t.skipEG=function e(){this.skipBits(1+this.skipLZ())};t.readUEG=function e(){var t=this.skipLZ();return this.readBits(t+1)-1};t.readEG=function e(){var t=this.readUEG();if(1&t){return 1+t>>>1}else{return-1*(t>>>1)}};t.readBoolean=function e(){return this.readBits(1)===1};t.readUByte=function e(){return this.readBits(8)};t.readUShort=function e(){return this.readBits(16)};t.readUInt=function e(){return this.readBits(32)};t.skipScalingList=function e(t){var r=8,i=8,n,a;for(n=0;n<t;n++){if(i!==0){a=this.readEG();i=(r+a+256)%256}r=i===0?r:i}};t.readSPS=function e(){var t=0,r=0,i=0,n=0,a,s,o,u,l,d,f,c,h,p=this.readUByte.bind(this),v=this.readBits.bind(this),m=this.readUEG.bind(this),g=this.readBoolean.bind(this),y=this.skipBits.bind(this),_=this.skipEG.bind(this),b=this.skipUEG.bind(this),T=this.skipScalingList.bind(this);p();a=p();s=v(5);y(3);o=p();b();if(a===100||a===110||a===122||a===244||a===44||a===83||a===86||a===118||a===128){var S=m();if(S===3){y(1)}b();b();y(1);if(g()){c=S!==3?8:12;for(h=0;h<c;h++){if(g()){if(h<6){T(16)}else{T(64)}}}}}b();var w=m();if(w===0){m()}else if(w===1){y(1);_();_();u=m();for(h=0;h<u;h++){_()}}b();y(1);l=m();d=m();f=v(1);if(f===0){y(1)}y(1);if(g()){t=m();r=m();i=m();n=m()}var E=[1,1];if(g()){if(g()){var k=p();switch(k){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:{E=[p()<<8|p(),p()<<8|p()];break}}}}return{width:Math.ceil((l+1)*16-t*2-r*2),height:(2-f)*(d+1)*16-(f?2:4)*(i+n),pixelRatio:E}};t.readSliceType=function e(){this.readUByte();this.readUEG();return this.readUEG()};return e}();var R=P;var U=function(){function e(e,t,r,i){this.decryptdata=r;this.discardEPB=i;this.decrypter=new v(e,t,{removePKCS7Padding:false})}var t=e.prototype;t.decryptBuffer=function e(t,r){this.decrypter.decrypt(t,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,r)};t.decryptAacSample=function e(t,r,i,n){var a=t[r].unit;var s=a.subarray(16,a.length-a.length%16);var o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);var u=this;this.decryptBuffer(o,(function(e){e=new Uint8Array(e);a.set(e,16);if(!n){u.decryptAacSamples(t,r+1,i)}}))};t.decryptAacSamples=function e(t,r,i){for(;;r++){if(r>=t.length){i();return}if(t[r].unit.length<32){continue}var n=this.decrypter.isSync();this.decryptAacSample(t,r,i,n);if(!n){return}}};t.getAvcEncryptedData=function e(t){var r=Math.floor((t.length-48)/160)*16+16;var i=new Int8Array(r);var n=0;for(var a=32;a<=t.length-16;a+=160,n+=16){i.set(t.subarray(a,a+16),n)}return i};t.getAvcDecryptedUnit=function e(t,r){r=new Uint8Array(r);var i=0;for(var n=32;n<=t.length-16;n+=160,i+=16){t.set(r.subarray(i,i+16),n)}return t};t.decryptAvcSample=function e(t,r,i,n,a,s){var o=this.discardEPB(a.data);var u=this.getAvcEncryptedData(o);var l=this;this.decryptBuffer(u.buffer,(function(e){a.data=l.getAvcDecryptedUnit(o,e);if(!s){l.decryptAvcSamples(t,r,i+1,n)}}))};t.decryptAvcSamples=function e(t,r,i,n){for(;;r++,i=0){if(r>=t.length){n();return}var a=t[r].units;for(;;i++){if(i>=a.length){break}var s=a[i];if(s.data.length<=48||s.type!==1&&s.type!==5){continue}var o=this.decrypter.isSync();this.decryptAvcSample(t,r,i,n,s,o);if(!o){return}}}};return e}();var M=U;var N={video:1,audio:2,id3:3,text:4};var B=function(){function e(e,t,r,i){this.observer=e;this.config=r;this.typeSupported=i;this.remuxer=t;this.sampleAes=null;this.pmtUnknownTypes={}}var t=e.prototype;t.setDecryptData=function e(t){if(t!=null&&t.key!=null&&t.method==="SAMPLE-AES"){this.sampleAes=new M(this.observer,this.config,t,this.discardEPB)}else{this.sampleAes=null}};e.probe=function t(r){var i=e._syncOffset(r);if(i<0){return false}else{if(i){f["logger"].warn("MPEG2-TS detected but first sync word found @ offset "+i+", junk ahead ?")}return true}};e._syncOffset=function e(t){var r=Math.min(1e3,t.length-3*188);var i=0;while(i<r){if(t[i]===71&&t[i+188]===71&&t[i+2*188]===71){return i}else{i++}}return-1};e.createTrack=function e(t,r){return{container:t==="video"||t==="audio"?"video/mp2t":undefined,type:t,id:N[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:t==="video"?0:undefined,isAAC:t==="audio"?true:undefined,duration:t==="audio"?r:undefined}};t.resetInitSegment=function t(r,i,n,a){this.pmtParsed=false;this._pmtId=-1;this.pmtUnknownTypes={};this._avcTrack=e.createTrack("video",a);this._audioTrack=e.createTrack("audio",a);this._id3Track=e.createTrack("id3",a);this._txtTrack=e.createTrack("text",a);this.aacOverFlow=null;this.aacLastPTS=null;this.avcSample=null;this.audioCodec=i;this.videoCodec=n;this._duration=a};t.resetTimeStamp=function e(){};t.append=function t(r,a,s,o){var u,l=r.length,d,c,h,p,v,m=false;this.pmtUnknownTypes={};this.contiguous=s;var g=this.pmtParsed,y=this._avcTrack,_=this._audioTrack,b=this._id3Track,T=y.pid,S=_.pid,w=b.pid,E=this._pmtId,k=y.pesData,A=_.pesData,C=b.pesData,I=this._parsePAT,D=this._parsePMT.bind(this),x=this._parsePES,L=this._parseAVCPES.bind(this),O=this._parseAACPES.bind(this),P=this._parseMPEGPES.bind(this),R=this._parseID3PES.bind(this);var U=e._syncOffset(r);l-=(l+U)%188;for(u=U;u<l;u+=188){if(r[u]===71){d=!!(r[u+1]&64);c=((r[u+1]&31)<<8)+r[u+2];h=(r[u+3]&48)>>4;if(h>1){p=u+5+r[u+4];if(p===u+188){continue}}else{p=u+4}switch(c){case T:if(d){if(k&&(v=x(k))){L(v,false)}k={data:[],size:0}}if(k){k.data.push(r.subarray(p,u+188));k.size+=u+188-p}break;case S:if(d){if(A&&(v=x(A))){if(_.isAAC){O(v)}else{P(v)}}A={data:[],size:0}}if(A){A.data.push(r.subarray(p,u+188));A.size+=u+188-p}break;case w:if(d){if(C&&(v=x(C))){R(v)}C={data:[],size:0}}if(C){C.data.push(r.subarray(p,u+188));C.size+=u+188-p}break;case 0:if(d){p+=r[p]+1}E=this._pmtId=I(r,p);break;case E:if(d){p+=r[p]+1}var M=D(r,p,this.typeSupported.mpeg===true||this.typeSupported.mp3===true,this.sampleAes!=null);T=M.avc;if(T>0){y.pid=T}S=M.audio;if(S>0){_.pid=S;_.isAAC=M.isAAC}w=M.id3;if(w>0){b.pid=w}if(m&&!g){f["logger"].log("reparse from beginning");m=false;u=U-188}g=this.pmtParsed=true;break;case 17:case 8191:break;default:m=true;break}}else{this.observer.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].FRAG_PARSING_ERROR,fatal:false,reason:"TS packet did not start with 0x47"})}}if(k&&(v=x(k))){L(v,true);y.pesData=null}else{y.pesData=k}if(A&&(v=x(A))){if(_.isAAC){O(v)}else{P(v)}_.pesData=null}else{if(A&&A.size){f["logger"].log("last AAC PES packet truncated,might overlap between fragments")}_.pesData=A}if(C&&(v=x(C))){R(v);b.pesData=null}else{b.pesData=C}if(this.sampleAes==null){this.remuxer.remux(_,y,b,this._txtTrack,a,s,o)}else{this.decryptAndRemux(_,y,b,this._txtTrack,a,s,o)}};t.decryptAndRemux=function e(t,r,i,n,a,s,o){if(t.samples&&t.isAAC){var u=this;this.sampleAes.decryptAacSamples(t.samples,0,(function(){u.decryptAndRemuxAvc(t,r,i,n,a,s,o)}))}else{this.decryptAndRemuxAvc(t,r,i,n,a,s,o)}};t.decryptAndRemuxAvc=function e(t,r,i,n,a,s,o){if(r.samples){var u=this;this.sampleAes.decryptAvcSamples(r.samples,0,0,(function(){u.remuxer.remux(t,r,i,n,a,s,o)}))}else{this.remuxer.remux(t,r,i,n,a,s,o)}};t.destroy=function e(){this._initPTS=this._initDTS=undefined;this._duration=0};t._parsePAT=function e(t,r){return(t[r+10]&31)<<8|t[r+11]};t._trackUnknownPmt=function e(t,r,i){var n=this.pmtUnknownTypes[t]||0;if(n===0){this.pmtUnknownTypes[t]=0;r.call(f["logger"],i)}this.pmtUnknownTypes[t]++;return n};t._parsePMT=function e(t,r,i,n){var a,s,o,u,l={audio:-1,avc:-1,id3:-1,isAAC:true};a=(t[r+1]&15)<<8|t[r+2];s=r+3+a-4;o=(t[r+10]&15)<<8|t[r+11];r+=12+o;while(r<s){u=(t[r+1]&31)<<8|t[r+2];switch(t[r]){case 207:if(!n){this._trackUnknownPmt(t[r],f["logger"].warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:if(l.audio===-1){l.audio=u}break;case 21:if(l.id3===-1){l.id3=u}break;case 219:if(!n){this._trackUnknownPmt(t[r],f["logger"].warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:if(l.avc===-1){l.avc=u}break;case 3:case 4:if(!i){this._trackUnknownPmt(t[r],f["logger"].warn,"MPEG audio found, not supported in this browser")}else if(l.audio===-1){l.audio=u;l.isAAC=false}break;case 36:this._trackUnknownPmt(t[r],f["logger"].warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(t[r],f["logger"].log,"Unknown stream type:"+t[r]);break}r+=((t[r+3]&15)<<8|t[r+4])+5}return l};t._parsePES=function e(t){var r=0,i,n,a,s,o,u,l,d,c,h=t.data;if(!t||t.size===0){return null}while(h[0].length<19&&h.length>1){var p=new Uint8Array(h[0].length+h[1].length);p.set(h[0]);p.set(h[1],h[0].length);h[0]=p;h.splice(1,1)}i=h[0];a=(i[0]<<16)+(i[1]<<8)+i[2];if(a===1){s=(i[4]<<8)+i[5];if(s&&s>t.size-6){return null}n=i[7];if(n&192){l=(i[9]&14)*536870912+(i[10]&255)*4194304+(i[11]&254)*16384+(i[12]&255)*128+(i[13]&254)/2;if(n&64){d=(i[14]&14)*536870912+(i[15]&255)*4194304+(i[16]&254)*16384+(i[17]&255)*128+(i[18]&254)/2;if(l-d>60*9e4){f["logger"].warn(Math.round((l-d)/9e4)+"s delta between PTS and DTS, align them");l=d}}else{d=l}}o=i[8];c=o+9;if(t.size<=c){return null}t.size-=c;u=new Uint8Array(t.size);for(var v=0,m=h.length;v<m;v++){i=h[v];var g=i.byteLength;if(c){if(c>g){c-=g;continue}else{i=i.subarray(c);g-=c;c=0}}u.set(i,r);r+=g}if(s){s-=o+3}return{data:u,pts:l,dts:d,len:s}}else{return null}};t.pushAccesUnit=function e(t,r){if(t.units.length&&t.frame){var i=r.samples;var n=i.length;if(isNaN(t.pts)){if(n){var a=i[n-1];t.pts=a.pts;t.dts=a.dts}else{r.dropped++;return}}if(!this.config.forceKeyFrameOnDiscontinuity||t.key===true||r.sps&&(n||this.contiguous)){t.id=n;i.push(t)}else{r.dropped++}}if(t.debug.length){f["logger"].log(t.pts+"/"+t.dts+":"+t.debug)}};t._parseAVCPES=function e(t,r){var i=this;var n=this._avcTrack,a=this._parseAVCNALu(t.data),s=false,o,u=this.avcSample,l,d=false,f,c=this.pushAccesUnit.bind(this),h=function e(t,r,i,n){return{key:t,pts:r,dts:i,units:[],debug:n}};t.data=null;if(u&&a.length&&!n.audFound){c(u,n);u=this.avcSample=h(false,t.pts,t.dts,"")}a.forEach((function(e){switch(e.type){case 1:l=true;if(!u){u=i.avcSample=h(true,t.pts,t.dts,"")}if(s){u.debug+="NDR "}u.frame=true;var r=e.data;if(d&&r.length>4){var a=new R(r).readSliceType();if(a===2||a===4||a===7||a===9){u.key=true}}break;case 5:l=true;if(!u){u=i.avcSample=h(true,t.pts,t.dts,"")}if(s){u.debug+="IDR "}u.key=true;u.frame=true;break;case 6:l=true;if(s&&u){u.debug+="SEI "}o=new R(i.discardEPB(e.data));o.readUByte();var p=0;var v=0;var m=false;var g=0;while(!m&&o.bytesAvailable>1){p=0;do{g=o.readUByte();p+=g}while(g===255);v=0;do{g=o.readUByte();v+=g}while(g===255);if(p===4&&o.bytesAvailable!==0){m=true;var y=o.readUByte();if(y===181){var _=o.readUShort();if(_===49){var b=o.readUInt();if(b===1195456820){var T=o.readUByte();if(T===3){var S=o.readUByte();var w=o.readUByte();var E=31&S;var k=[S,w];for(f=0;f<E;f++){k.push(o.readUByte());k.push(o.readUByte());k.push(o.readUByte())}i._insertSampleInOrder(i._txtTrack.samples,{type:3,pts:t.pts,bytes:k})}}}}}else if(p===5&&o.bytesAvailable!==0){m=true;if(v>16){var A=[];for(f=0;f<16;f++){A.push(o.readUByte().toString(16));if(f===3||f===5||f===7||f===9){A.push("-")}}var I=v-16;var D=new Uint8Array(I);for(f=0;f<I;f++){D[f]=o.readUByte()}i._insertSampleInOrder(i._txtTrack.samples,{pts:t.pts,payloadType:p,uuid:A.join(""),userDataBytes:D,userData:Object(C["utf8ArrayToStr"])(D.buffer)})}}else if(v<o.bytesAvailable){for(f=0;f<v;f++){o.readUByte()}}}break;case 7:l=true;d=true;if(s&&u){u.debug+="SPS "}if(!n.sps){o=new R(e.data);var x=o.readSPS();n.width=x.width;n.height=x.height;n.pixelRatio=x.pixelRatio;n.sps=[e.data];n.duration=i._duration;var L=e.data.subarray(1,4);var O="avc1.";for(f=0;f<3;f++){var P=L[f].toString(16);if(P.length<2){P="0"+P}O+=P}n.codec=O}break;case 8:l=true;if(s&&u){u.debug+="PPS "}if(!n.pps){n.pps=[e.data]}break;case 9:l=false;n.audFound=true;if(u){c(u,n)}u=i.avcSample=h(false,t.pts,t.dts,s?"AUD ":"");break;case 12:l=false;break;default:l=false;if(u){u.debug+="unknown NAL "+e.type+" "}break}if(u&&l){var U=u.units;U.push(e)}}));if(r&&u){c(u,n);this.avcSample=null}};t._insertSampleInOrder=function e(t,r){var i=t.length;if(i>0){if(r.pts>=t[i-1].pts){t.push(r)}else{for(var n=i-1;n>=0;n--){if(r.pts<t[n].pts){t.splice(n,0,r);break}}}}else{t.push(r)}};t._getLastNalUnit=function e(){var t=this.avcSample,r;if(!t||t.units.length===0){var i=this._avcTrack,n=i.samples;t=n[n.length-1]}if(t){var a=t.units;r=a[a.length-1]}return r};t._parseAVCNALu=function e(t){var r=0,i=t.byteLength,n,a,s=this._avcTrack,o=s.naluState||0,u=o;var l=[],d,f,c=-1,h;if(o===-1){c=0;h=t[0]&31;o=0;r=1}while(r<i){n=t[r++];if(!o){o=n?0:1;continue}if(o===1){o=n?0:2;continue}if(!n){o=3}else if(n===1){if(c>=0){d={data:t.subarray(c,r-o-1),type:h};l.push(d)}else{var p=this._getLastNalUnit();if(p){if(u&&r<=4-u){if(p.state){p.data=p.data.subarray(0,p.data.byteLength-u)}}a=r-o-1;if(a>0){var v=new Uint8Array(p.data.byteLength+a);v.set(p.data,0);v.set(t.subarray(0,a),p.data.byteLength);p.data=v}}}if(r<i){f=t[r]&31;c=r;h=f;o=0}else{o=-1}}else{o=0}}if(c>=0&&o>=0){d={data:t.subarray(c,i),type:h,state:o};l.push(d)}if(l.length===0){var m=this._getLastNalUnit();if(m){var g=new Uint8Array(m.data.byteLength+t.byteLength);g.set(m.data,0);g.set(t,m.data.byteLength);m.data=g}}s.naluState=o;return l};t.discardEPB=function e(t){var r=t.byteLength,i=[],n=1,a,s;while(n<r-2){if(t[n]===0&&t[n+1]===0&&t[n+2]===3){i.push(n+2);n+=2}else{n++}}if(i.length===0){return t}a=r-i.length;s=new Uint8Array(a);var o=0;for(n=0;n<a;o++,n++){if(o===i[0]){o++;i.shift()}s[n]=t[o]}return s};t._parseAACPES=function e(t){var r=this._audioTrack,a=t.data,s=t.pts,o=0,u=this.aacOverFlow,l=this.aacLastPTS,d,c,h,p,v;if(u){var m=new Uint8Array(u.byteLength+a.byteLength);m.set(u,0);m.set(a,u.byteLength);a=m}for(h=o,v=a.length;h<v-1;h++){if(T(a,h)){break}}if(h){var g,y;if(h<v-1){g="AAC PES did not start with ADTS header,offset:"+h;y=false}else{g="no ADTS header found in AAC PES";y=true}f["logger"].warn("parsing error:"+g);this.observer.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].FRAG_PARSING_ERROR,fatal:y,reason:g});if(y){return}}w(r,this.observer,a,h,this.audioCodec);c=0;d=E(r.samplerate);if(u&&l){var _=l+d;if(Math.abs(_-s)>1){f["logger"].log("AAC: align PTS for overlapping frames by "+Math.round((_-s)/90));s=_}}while(h<v){if(T(a,h)){if(h+5<v){var b=A(r,a,h,s,c);if(b){h+=b.length;p=b.sample.pts;c++;continue}}break}else{h++}}if(h<v){u=a.subarray(h,v)}else{u=null}this.aacOverFlow=u;this.aacLastPTS=p};t._parseMPEGPES=function e(t){var r=t.data;var i=r.length;var n=0;var a=0;var s=t.pts;while(a<i){if(O.isHeader(r,a)){var o=O.appendFrame(this._audioTrack,r,a,s,n);if(o){a+=o.length;n++}else{break}}else{a++}}};t._parseID3PES=function e(t){this._id3Track.samples.push(t)};return e}();var F=B;var j=function(){function e(e,t,r){this.observer=e;this.config=r;this.remuxer=t}var t=e.prototype;t.resetInitSegment=function e(t,r,i,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:false,samples:[],len:0,manifestCodec:r,duration:n,inputTimeScale:9e4}};t.resetTimeStamp=function e(){};e.probe=function e(t){var r,i;var n=C["default"].getID3Data(t,0);if(n&&C["default"].getTimeStamp(n)!==undefined){for(r=n.length,i=Math.min(t.length-1,r+100);r<i;r++){if(O.probe(t,r)){f["logger"].log("MPEG Audio sync word found !");return true}}}return false};t.append=function e(t,r,i,n){var a=C["default"].getID3Data(t,0)||[];var s=C["default"].getTimeStamp(a);var o=s!==undefined?90*s:r*9e4;var u=a.length;var l=t.length;var d=0,f=0;var c=this._audioTrack;var h=[{pts:o,dts:o,data:a}];while(u<l){if(O.isHeader(t,u)){var p=O.appendFrame(c,t,u,o,d);if(p){u+=p.length;f=p.sample.pts;d++}else{break}}else if(C["default"].isHeader(t,u)){a=C["default"].getID3Data(t,u);h.push({pts:f,dts:f,data:a});u+=a.length}else{u++}}this.remuxer.remux(c,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},r,i,n)};t.destroy=function e(){};return e}();var q=j;var H=function(){function e(){}e.getSilentFrame=function e(t,r){switch(t){case"mp4a.40.2":if(r===1){return new Uint8Array([0,200,0,128,35,128])}else if(r===2){return new Uint8Array([33,0,73,144,2,25,0,35,128])}else if(r===3){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142])}else if(r===4){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56])}else if(r===5){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56])}else if(r===6){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}break;default:if(r===1){return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}else if(r===2){return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}else if(r===3){return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}break}return null};return e}();var G=H;var V=Math.pow(2,32)-1;var W=function(){function e(){}e.init=function t(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var r;for(r in e.types){if(e.types.hasOwnProperty(r)){e.types[r]=[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3)]}}var i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);var n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:i,audio:n};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);var s=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=s;e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]);e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]);var u=new Uint8Array([97,118,99,49]);var l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,u);e.DINF=e.box(e.types.dinf,e.box(e.types.dref,a))};e.box=function e(t){var r=Array.prototype.slice.call(arguments,1),i=8,n=r.length,a=n,s;while(n--){i+=r[n].byteLength}s=new Uint8Array(i);s[0]=i>>24&255;s[1]=i>>16&255;s[2]=i>>8&255;s[3]=i&255;s.set(t,4);for(n=0,i=8;n<a;n++){s.set(r[n],i);i+=r[n].byteLength}return s};e.hdlr=function t(r){return e.box(e.types.hdlr,e.HDLR_TYPES[r])};e.mdat=function t(r){return e.box(e.types.mdat,r)};e.mdhd=function t(r,i){i*=r;var n=Math.floor(i/(V+1));var a=Math.floor(i%(V+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,r&255,n>>24,n>>16&255,n>>8&255,n&255,a>>24,a>>16&255,a>>8&255,a&255,85,196,0,0]))};e.mdia=function t(r){return e.box(e.types.mdia,e.mdhd(r.timescale,r.duration),e.hdlr(r.type),e.minf(r))};e.mfhd=function t(r){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255]))};e.minf=function t(r){if(r.type==="audio"){return e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(r))}else{return e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(r))}};e.moof=function t(r,i,n){return e.box(e.types.moof,e.mfhd(r),e.traf(n,i))};e.moov=function t(r){var i=r.length,n=[];while(i--){n[i]=e.trak(r[i])}return e.box.apply(null,[e.types.moov,e.mvhd(r[0].timescale,r[0].duration)].concat(n).concat(e.mvex(r)))};e.mvex=function t(r){var i=r.length,n=[];while(i--){n[i]=e.trex(r[i])}return e.box.apply(null,[e.types.mvex].concat(n))};e.mvhd=function t(r,i){i*=r;var n=Math.floor(i/(V+1));var a=Math.floor(i%(V+1));var s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,r&255,n>>24,n>>16&255,n>>8&255,n&255,a>>24,a>>16&255,a>>8&255,a&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,s)};e.sdtp=function t(r){var i=r.samples||[],n=new Uint8Array(4+i.length),a,s;for(s=0;s<i.length;s++){a=i[s].flags;n[s+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy}return e.box(e.types.sdtp,n)};e.stbl=function t(r){return e.box(e.types.stbl,e.stsd(r),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))};e.avc1=function t(r){var i=[],n=[],a,s,o;for(a=0;a<r.sps.length;a++){s=r.sps[a];o=s.byteLength;i.push(o>>>8&255);i.push(o&255);i=i.concat(Array.prototype.slice.call(s))}for(a=0;a<r.pps.length;a++){s=r.pps[a];o=s.byteLength;n.push(o>>>8&255);n.push(o&255);n=n.concat(Array.prototype.slice.call(s))}var u=e.box(e.types.avcC,new Uint8Array([1,i[3],i[4],i[5],252|3,224|r.sps.length].concat(i).concat([r.pps.length]).concat(n))),l=r.width,d=r.height,f=r.pixelRatio[0],c=r.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([f>>24,f>>16&255,f>>8&255,f&255,c>>24,c>>16&255,c>>8&255,c&255])))};e.esds=function e(t){var r=t.config.length;return new Uint8Array([0,0,0,0,3,23+r,0,1,0,4,15+r,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([r]).concat(t.config).concat([6,1,2]))};e.mp4a=function t(r){var i=r.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,r.channelCount,0,16,0,0,0,0,i>>8&255,i&255,0,0]),e.box(e.types.esds,e.esds(r)))};e.mp3=function t(r){var i=r.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,r.channelCount,0,16,0,0,0,0,i>>8&255,i&255,0,0]))};e.stsd=function t(r){if(r.type==="audio"){if(!r.isAAC&&r.codec==="mp3"){return e.box(e.types.stsd,e.STSD,e.mp3(r))}return e.box(e.types.stsd,e.STSD,e.mp4a(r))}else{return e.box(e.types.stsd,e.STSD,e.avc1(r))}};e.tkhd=function t(r){var i=r.id,n=r.duration*r.timescale,a=r.width,s=r.height,o=Math.floor(n/(V+1)),u=Math.floor(n%(V+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,i&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,u>>24,u>>16&255,u>>8&255,u&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,a&255,0,0,s>>8&255,s&255,0,0]))};e.traf=function t(r,i){var n=e.sdtp(r),a=r.id,s=Math.floor(i/(V+1)),o=Math.floor(i%(V+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,o>>24,o>>16&255,o>>8&255,o&255])),e.trun(r,n.length+16+20+8+16+8+8),n)};e.trak=function t(r){r.duration=r.duration||4294967295;return e.box(e.types.trak,e.tkhd(r),e.mdia(r))};e.trex=function t(r){var i=r.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))};e.trun=function t(r,i){var n=r.samples||[],a=n.length,s=12+16*a,o=new Uint8Array(s),u,l,d,f,c,h;i+=8+s;o.set([0,0,15,1,a>>>24&255,a>>>16&255,a>>>8&255,a&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255],0);for(u=0;u<a;u++){l=n[u];d=l.duration;f=l.size;c=l.flags;h=l.cts;o.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,c.degradPrio&240<<8,c.degradPrio&15,h>>>24&255,h>>>16&255,h>>>8&255,h&255],12+16*u)}return e.box(e.types.trun,o)};e.initSegment=function t(r){if(!e.types){e.init()}var i=e.moov(r),n;n=new Uint8Array(e.FTYP.byteLength+i.byteLength);n.set(e.FTYP);n.set(i,e.FTYP.byteLength);return n};return e}();var z=W;var K=9e4;function X(e,t,r,i){if(r===void 0){r=1}if(i===void 0){i=false}return Y(e,t,1/r)}function Y(e,t,r,i){if(r===void 0){r=1}if(i===void 0){i=false}var n=e*t*r;return i?Math.round(n):n}function Q(e,t){if(t===void 0){t=false}return Y(e,1e3,1/K,t)}function $(e,t){if(t===void 0){t=1}return Y(e,K,1/t)}var J=$(10);var Z=$(.2);var ee=null;var te=function(){function e(e,t,r,i){this.observer=e;this.config=t;this.typeSupported=r;this.ISGenerated=false;if(ee===null){var n=navigator.userAgent.match(/Chrome\/(\d+)/i);ee=n?parseInt(n[1]):0}}var t=e.prototype;t.destroy=function e(){};t.resetTimeStamp=function e(t){this._initPTS=this._initDTS=t};t.resetInitSegment=function e(){this.ISGenerated=false};t.getVideoStartPts=function e(t){var r=false;var i=t.reduce((function(e,t){var i=t.pts-e;if(i<-4294967296){r=true;return re(e,t.pts)}else if(i>0){return e}else{return t.pts}}),t[0].pts);if(r){f["logger"].debug("PTS rollover detected")}return i};t.remux=function e(t,r,n,a,s,o,u){if(!this.ISGenerated){this.generateIS(t,r,s)}if(this.ISGenerated){var l=t.samples.length;var d=r.samples.length;var c=s;var h=s;if(l&&d){var p=this.getVideoStartPts(r.samples);var v=re(t.samples[0].pts,p)-p;var m=v/r.inputTimeScale;c+=Math.max(0,m);h+=Math.max(0,-m)}if(l){if(!t.timescale){f["logger"].warn("regenerate InitSegment as audio detected");this.generateIS(t,r,s)}var g=this.remuxAudio(t,c,o,u);if(d){var y;if(g){y=g.endPTS-g.startPTS}if(!r.timescale){f["logger"].warn("regenerate InitSegment as video detected");this.generateIS(t,r,s)}this.remuxVideo(r,h,o,y)}}else{if(d){var _=this.remuxVideo(r,h,o,0,u);if(_&&t.codec){this.remuxEmptyAudio(t,c,o,_)}}}}if(n.samples.length){this.remuxID3(n,s)}if(a.samples.length){this.remuxText(a,s)}this.observer.trigger(i["default"].FRAG_PARSED)};t.generateIS=function e(t,r,a){var s=this.observer,o=t.samples,u=r.samples,l=this.typeSupported,d="audio/mp4",c={},h={tracks:c},p=this._initPTS===undefined,v,m;if(p){v=m=Infinity}if(t.config&&o.length){t.timescale=t.samplerate;f["logger"].log("audio sampling rate : "+t.samplerate);if(!t.isAAC){if(l.mpeg){d="audio/mpeg";t.codec=""}else if(l.mp3){t.codec="mp3"}}c.audio={container:d,codec:t.codec,initSegment:!t.isAAC&&l.mpeg?new Uint8Array:z.initSegment([t]),metadata:{channelCount:t.channelCount}};if(p){v=m=o[0].pts-Math.round(t.inputTimeScale*a)}}if(r.sps&&r.pps&&u.length){var g=r.inputTimeScale;r.timescale=g;c.video={container:"video/mp4",codec:r.codec,initSegment:z.initSegment([r]),metadata:{width:r.width,height:r.height}};if(p){var y=this.getVideoStartPts(u);var _=Math.round(g*a);m=Math.min(m,re(u[0].dts,y)-_);v=Math.min(v,y-_);this.observer.trigger(i["default"].INIT_PTS_FOUND,{initPTS:v})}}else if(p&&c.audio){this.observer.trigger(i["default"].INIT_PTS_FOUND,{initPTS:v})}if(Object.keys(c).length){s.trigger(i["default"].FRAG_PARSING_INIT_SEGMENT,h);this.ISGenerated=true;if(p){this._initPTS=v;this._initDTS=m}}else{s.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].FRAG_PARSING_ERROR,fatal:false,reason:"no audio/video samples found"})}};t.remuxVideo=function e(t,r,a,s){var o=t.timescale;var u=t.samples;var l=[];var d=u.length;var c=this._initPTS;var h=8;var p;var v;var m;var g;var y;var _=Number.POSITIVE_INFINITY;var b=Number.NEGATIVE_INFINITY;var T=0;var S=false;var w=this.nextAvcDts;if(d===0){return}if(!a){var E=r*o;var k=u[0].pts-re(u[0].dts,u[0].pts);w=E-k}for(var A=0;A<d;A++){var C=u[A];C.pts=re(C.pts-c,w);C.dts=re(C.dts-c,w);if(C.dts>C.pts){T=Math.max(Math.min(T,C.pts-C.dts),-1*Z)}if(C.dts<u[A>0?A-1:A].dts){S=true}}if(S){u.sort((function(e,t){var r=e.dts-t.dts;var i=e.pts-t.pts;return r||i||e.id-t.id}))}g=u[0].dts;y=u[d-1].dts;var I=Math.round((y-g)/(d-1));if(T<0){if(T<I*-2){f["logger"].warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Q(-I,true)+" ms");var D=T;for(var x=0;x<d;x++){u[x].dts=D=Math.max(D,u[x].pts-I);u[x].pts=Math.max(D,u[x].pts)}}else{f["logger"].warn("PTS < DTS detected in video samples, shifting DTS by "+Q(T,true)+" ms to overcome this issue");for(var L=0;L<d;L++){u[L].dts=u[L].dts+T}}g=u[0].dts;y=u[d-1].dts}if(a){var O=g-w;var P=O>I;var R=O<-1;if(P||R){if(P){f["logger"].warn("AVC: "+Q(O,true)+" ms ("+O+"dts) hole between fragments detected, filling it")}else{f["logger"].warn("AVC: "+Q(-O,true)+" ms ("+O+"dts) overlapping between fragments detected")}g=w;var U=u[0].pts-O;u[0].dts=g;u[0].pts=U;f["logger"].log("Video: First PTS/DTS adjusted: "+Q(U,true)+"/"+Q(g,true)+", delta: "+Q(O,true)+" ms")}}if(ee&&ee<75){g=Math.max(0,g)}var M=0;var N=0;for(var B=0;B<d;B++){var F=u[B];var j=F.units;var q=j.length;var H=0;for(var G=0;G<q;G++){H+=j[G].data.length}N+=H;M+=q;F.length=H;F.dts=Math.max(F.dts,g);F.pts=Math.max(F.pts,F.dts,0);_=Math.min(F.pts,_);b=Math.max(F.pts,b)}y=u[d-1].dts;var V=N+4*M+8;try{v=new Uint8Array(V)}catch(e){this.observer.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MUX_ERROR,details:n["ErrorDetails"].REMUX_ALLOC_ERROR,fatal:false,bytes:V,reason:"fail allocating video mdat "+V});return}var W=new DataView(v.buffer);W.setUint32(0,V);v.set(z.types.mdat,4);for(var K=0;K<d;K++){var X=u[K];var Y=X.units;var $=0;var J=void 0;for(var te=0,ie=Y.length;te<ie;te++){var ne=Y[te];var ae=ne.data;var se=ne.data.byteLength;W.setUint32(h,se);h+=4;v.set(ae,h);h+=se;$+=4+se}if(K<d-1){p=u[K+1].dts-X.dts}else{var oe=this.config;var ue=X.dts-u[K>0?K-1:K].dts;if(oe.stretchShortVideoTrack){var le=oe.maxBufferHole;var de=Math.floor(le*o);var fe=(s?_+s*o:this.nextAudioPts)-X.pts;if(fe>de){p=fe-ue;if(p<0){p=ue}f["logger"].log("It is approximately "+Q(fe,false)+" ms to the next segment; using duration "+Q(p,false)+" ms for the last video frame.")}else{p=ue}}else{p=ue}}J=Math.round(X.pts-X.dts);l.push({size:$,duration:p,cts:J,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:X.key?2:1,isNonSync:X.key?0:1}})}this.nextAvcDts=y+p;var ce=t.dropped;t.nbNalu=0;t.dropped=0;if(l.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var he=l[0].flags;he.dependsOn=2;he.isNonSync=0}t.samples=l;m=z.moof(t.sequenceNumber++,g,t);t.samples=[];var pe={data1:m,data2:v,startPTS:_/o,endPTS:(b+p)/o,startDTS:g/o,endDTS:this.nextAvcDts/o,type:"video",hasAudio:false,hasVideo:true,nb:l.length,dropped:ce};this.observer.trigger(i["default"].FRAG_PARSING_DATA,pe);return pe};t.remuxAudio=function e(t,r,a,s){var o=t.inputTimeScale;var u=t.timescale;var l=o/u;var d=t.isAAC?1024:1152;var c=d*l;var h=this._initPTS;var p=!t.isAAC&&this.typeSupported.mpeg;var v;var m;var g;var y;var _;var b;var T=p?0:8;var S=t.samples;var w=[];var E=this.nextAudioPts;a|=S.length&&E&&(s&&Math.abs(r-E/o)<.1||Math.abs(S[0].pts-E-h)<20*c);S.forEach((function(e){e.pts=e.dts=re(e.pts-h,r*o)}));S=S.filter((function(e){return e.pts>=0}));if(S.length===0){return}if(!a){if(!s){E=S[0].pts}else{E=Math.max(0,r*o)}}if(t.isAAC){var k=this.config.maxAudioFramesDrift;for(var A=0,C=E;A<S.length;){var I=S[A];var D=I.pts;var x=D-C;if(x<=-k*c){if(a||A>0){f["logger"].warn("Dropping 1 audio frame @ "+Q(C,true)/1e3+"s due to "+Q(x,true)+" ms overlap.");S.splice(A,1)}else{f["logger"].warn("Audio frame @ "+Q(D,true)/1e3+"s overlaps nextAudioPts by "+Q(x,true)+" ms.");C=D+c;A++}}else if(x>=k*c&&x<J&&C){var L=Math.round(x/c);f["logger"].warn("Injecting "+L+" audio frames @ "+Q(C,true)/1e3+"s due to "+Q(x,true)+" ms gap.");for(var O=0;O<L;O++){var P=Math.max(C,0);m=G.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(!m){f["logger"].log("Unable to get silent frame for given audio codec; duplicating last frame instead.");m=I.unit.subarray()}S.splice(A,0,{unit:m,pts:P,dts:P});C+=c;A++}I.pts=I.dts=C;C+=c;A++}else{if(Math.abs(x)>.1*c){}I.pts=I.dts=C;C+=c;A++}}}var R=S.length;var U=0;while(R--){U+=S[R].unit.byteLength}for(var M=0,N=S.length;M<N;M++){var B=S[M];var F=B.unit;var j=B.pts;if(b!==undefined&&v){v.duration=Math.round((j-b)/l)}else{var q=j-E;var H=0;if(a&&t.isAAC){if(q){if(q>0&&q<J){H=Math.round((j-E)/c);f["logger"].log(Q(q,true)+" ms hole between AAC samples detected,filling it");if(H>0){m=G.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(!m){m=F.subarray()}U+=H*m.length}}else if(q<-12){f["logger"].log("drop overlapping AAC sample, expected/parsed/delta: "+Q(E,true)+" ms / "+Q(j,true)+" ms / "+Q(-q,true)+" ms");U-=F.byteLength;continue}j=E}}_=j;if(U>0){U+=T;try{g=new Uint8Array(U)}catch(e){this.observer.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MUX_ERROR,details:n["ErrorDetails"].REMUX_ALLOC_ERROR,fatal:false,bytes:U,reason:"fail allocating audio mdat "+U});return}if(!p){var V=new DataView(g.buffer);V.setUint32(0,U);g.set(z.types.mdat,4)}}else{return}for(var W=0;W<H;W++){m=G.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(!m){f["logger"].log("Unable to get silent frame for given audio codec; duplicating this frame instead.");m=F.subarray()}g.set(m,T);T+=m.byteLength;v={size:m.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};w.push(v)}}g.set(F,T);var K=F.byteLength;T+=K;v={size:K,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};w.push(v);b=j}var X=0;R=w.length;if(R>=2){X=w[R-2].duration;v.duration=X}if(R){this.nextAudioPts=E=b+l*X;t.samples=w;if(p){y=new Uint8Array}else{y=z.moof(t.sequenceNumber++,_/l,t)}t.samples=[];var Y=_/o;var $=E/o;var Z={data1:y,data2:g,startPTS:Y,endPTS:$,startDTS:Y,endDTS:$,type:"audio",hasAudio:true,hasVideo:false,nb:R};this.observer.trigger(i["default"].FRAG_PARSING_DATA,Z);return Z}return null};t.remuxEmptyAudio=function e(t,r,i,n){var a=t.inputTimeScale;var s=t.samplerate?t.samplerate:a;var o=a/s;var u=this.nextAudioPts;var l=(u!==undefined?u:n.startDTS*a)+this._initDTS;var d=n.endDTS*a+this._initDTS;var c=1024;var h=o*c;var p=Math.ceil((d-l)/h);var v=G.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);f["logger"].warn("remux empty Audio");if(!v){f["logger"].trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");return}var m=[];for(var g=0;g<p;g++){var y=l+g*h;m.push({unit:v,pts:y,dts:y})}t.samples=m;this.remuxAudio(t,r,i)};t.remuxID3=function e(t,r){var n=t.samples.length;if(!n){return}var a=t.inputTimeScale;var s=this._initPTS;var o=this._initDTS;for(var u=0;u<n;u++){var l=t.samples[u];l.pts=re(l.pts-s,r*a)/a;l.dts=re(l.dts-o,r*a)/a}this.observer.trigger(i["default"].FRAG_PARSING_METADATA,{samples:t.samples});t.samples=[]};t.remuxText=function e(t,r){var n=t.samples.length;var a=t.inputTimeScale;var s=this._initPTS;if(n){for(var o=0;o<n;o++){var u=t.samples[o];u.pts=re(u.pts-s,r*a)/a}t.samples.sort((function(e,t){return e.pts-t.pts}));this.observer.trigger(i["default"].FRAG_PARSING_USERDATA,{samples:t.samples})}t.samples=[]};return e}();function re(e,t){var r;if(t===undefined){return e}if(t<e){r=-8589934592}else{r=8589934592}while(Math.abs(e-t)>4294967296){e+=r}return e}var ie=te;var ne=function(){function e(e){this.observer=e}var t=e.prototype;t.destroy=function e(){};t.resetTimeStamp=function e(){};t.resetInitSegment=function e(){};t.remux=function e(t,r,n,a,s,o,u,l){var d=this.observer;var f="";if(t){f+="audio"}if(r){f+="video"}d.trigger(i["default"].FRAG_PARSING_DATA,{data1:l,startPTS:s,startDTS:s,type:f,hasAudio:!!t,hasVideo:!!r,nb:1,dropped:0});d.trigger(i["default"].FRAG_PARSED)};return e}();var ae=ne;var se=Object(c["getSelfScope"])();var oe;try{oe=se.performance.now.bind(se.performance)}catch(e){f["logger"].debug("Unable to use Performance API on this environment");oe=se.Date.now}var ue=function(){function e(e,t,r,i){this.observer=e;this.typeSupported=t;this.config=r;this.vendor=i}var t=e.prototype;t.destroy=function e(){var t=this.demuxer;if(t){t.destroy()}};t.push=function e(t,r,n,a,s,o,u,l,d,f,c,h){var p=this;if(t.byteLength>0&&r!=null&&r.key!=null&&r.method==="AES-128"){var m=this.decrypter;if(m==null){m=this.decrypter=new v(this.observer,this.config)}var g=oe();m.decrypt(t,r.key.buffer,r.iv.buffer,(function(e){var t=oe();p.observer.trigger(i["default"].FRAG_DECRYPTED,{stats:{tstart:g,tdecrypt:t}});p.pushDecrypted(new Uint8Array(e),r,new Uint8Array(n),a,s,o,u,l,d,f,c,h)}))}else{this.pushDecrypted(new Uint8Array(t),r,new Uint8Array(n),a,s,o,u,l,d,f,c,h)}};t.pushDecrypted=function e(t,r,a,s,o,u,l,d,f,c,h,p){var v=this.demuxer;var m=this.remuxer;if(!v||l||d){var g=this.observer;var y=this.typeSupported;var _=this.config;var b=[{demux:F,remux:ie},{demux:x["default"],remux:ae},{demux:D,remux:ie},{demux:q,remux:ie}];var T;for(var S=0,w=b.length;S<w;S++){T=b[S];if(T.demux.probe(t)){break}}if(!T){g.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].FRAG_PARSING_ERROR,fatal:true,reason:"no demux matching with content found"});return}if(!m||!(m instanceof T.remux)){m=new T.remux(g,_,y,this.vendor)}if(!v||!(v instanceof T.demux)){v=new T.demux(g,m,_,y);this.probe=T.demux.probe}this.demuxer=v;this.remuxer=m}if(l||d){v.resetInitSegment(a,s,o,c);m.resetInitSegment()}if(l){v.resetTimeStamp(p);m.resetTimeStamp(p)}if(typeof v.setDecryptData==="function"){v.setDecryptData(r)}v.append(t,u,f,h)};return e}();var le=t["default"]=ue},"./src/demux/demuxer-worker.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/demux/demuxer-inline.js");var n=r("./src/events.js");var a=r("./src/utils/logger.js");var s=r("./node_modules/eventemitter3/index.js");var o=r.n(s);var u=function e(t){var r=new s["EventEmitter"];r.trigger=function e(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),a=1;a<i;a++){n[a-1]=arguments[a]}r.emit.apply(r,[t,t].concat(n))};r.off=function e(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),a=1;a<i;a++){n[a-1]=arguments[a]}r.removeListener.apply(r,[t].concat(n))};var o=function e(r,i){t.postMessage({event:r,data:i})};t.addEventListener("message",(function(e){var n=e.data;switch(n.cmd){case"init":var s=JSON.parse(n.config);t.demuxer=new i["default"](r,n.typeSupported,s,n.vendor);Object(a["enableLogs"])(s.debug);o("init",null);break;case"demux":t.demuxer.push(n.data,n.decryptdata,n.initSegment,n.audioCodec,n.videoCodec,n.timeOffset,n.discontinuity,n.trackSwitch,n.contiguous,n.duration,n.accurateTimeOffset,n.defaultInitPTS);break;default:break}}));r.on(n["default"].FRAG_DECRYPTED,o);r.on(n["default"].FRAG_PARSING_INIT_SEGMENT,o);r.on(n["default"].FRAG_PARSED,o);r.on(n["default"].ERROR,o);r.on(n["default"].FRAG_PARSING_METADATA,o);r.on(n["default"].FRAG_PARSING_USERDATA,o);r.on(n["default"].INIT_PTS_FOUND,o);r.on(n["default"].FRAG_PARSING_DATA,(function(e,r){var i=[];var n={event:e,data:r};if(r.data1){n.data1=r.data1.buffer;i.push(r.data1.buffer);delete r.data1}if(r.data2){n.data2=r.data2.buffer;i.push(r.data2.buffer);delete r.data2}t.postMessage(n,i)}))};t["default"]=u},"./src/demux/id3.js":function(e,t,r){"use strict";r.r(t);r.d(t,"utf8ArrayToStr",(function(){return o}));var i=r("./src/utils/get-self-scope.js");var n=function(){function e(){}e.isHeader=function e(t,r){if(r+10<=t.length){if(t[r]===73&&t[r+1]===68&&t[r+2]===51){if(t[r+3]<255&&t[r+4]<255){if(t[r+6]<128&&t[r+7]<128&&t[r+8]<128&&t[r+9]<128){return true}}}}return false};e.isFooter=function e(t,r){if(r+10<=t.length){if(t[r]===51&&t[r+1]===68&&t[r+2]===73){if(t[r+3]<255&&t[r+4]<255){if(t[r+6]<128&&t[r+7]<128&&t[r+8]<128&&t[r+9]<128){return true}}}}return false};e.getID3Data=function t(r,i){var n=i;var a=0;while(e.isHeader(r,i)){a+=10;var s=e._readSize(r,i+6);a+=s;if(e.isFooter(r,i+10)){a+=10}i+=a}if(a>0){return r.subarray(n,n+a)}return undefined};e._readSize=function e(t,r){var i=0;i=(t[r]&127)<<21;i|=(t[r+1]&127)<<14;i|=(t[r+2]&127)<<7;i|=t[r+3]&127;return i};e.getTimeStamp=function t(r){var i=e.getID3Frames(r);for(var n=0;n<i.length;n++){var a=i[n];if(e.isTimeStampFrame(a)){return e._readTimeStamp(a)}}return undefined};e.isTimeStampFrame=function e(t){return t&&t.key==="PRIV"&&t.info==="com.apple.streaming.transportStreamTimestamp"};e._getFrameData=function t(r){var i=String.fromCharCode(r[0],r[1],r[2],r[3]);var n=e._readSize(r,4);var a=10;return{type:i,size:n,data:r.subarray(a,a+n)}};e.getID3Frames=function t(r){var i=0;var n=[];while(e.isHeader(r,i)){var a=e._readSize(r,i+6);i+=10;var s=i+a;while(i+8<s){var o=e._getFrameData(r.subarray(i));var u=e._decodeFrame(o);if(u){n.push(u)}i+=o.size+10}if(e.isFooter(r,i)){i+=10}}return n};e._decodeFrame=function t(r){if(r.type==="PRIV"){return e._decodePrivFrame(r)}else if(r.type[0]==="T"){return e._decodeTextFrame(r)}else if(r.type[0]==="W"){return e._decodeURLFrame(r)}return undefined};e._readTimeStamp=function e(t){if(t.data.byteLength===8){var r=new Uint8Array(t.data);var i=r[3]&1;var n=(r[4]<<23)+(r[5]<<15)+(r[6]<<7)+r[7];n/=45;if(i){n+=47721858.84}return Math.round(n)}return undefined};e._decodePrivFrame=function t(r){if(r.size<2){return undefined}var i=e._utf8ArrayToStr(r.data,true);var n=new Uint8Array(r.data.subarray(i.length+1));return{key:r.type,info:i,data:n.buffer}};e._decodeTextFrame=function t(r){if(r.size<2){return undefined}if(r.type==="TXXX"){var i=1;var n=e._utf8ArrayToStr(r.data.subarray(i),true);i+=n.length+1;var a=e._utf8ArrayToStr(r.data.subarray(i));return{key:r.type,info:n,data:a}}else{var s=e._utf8ArrayToStr(r.data.subarray(1));return{key:r.type,data:s}}};e._decodeURLFrame=function t(r){if(r.type==="WXXX"){if(r.size<2){return undefined}var i=1;var n=e._utf8ArrayToStr(r.data.subarray(i),true);i+=n.length+1;var a=e._utf8ArrayToStr(r.data.subarray(i));return{key:r.type,info:n,data:a}}else{var s=e._utf8ArrayToStr(r.data);return{key:r.type,data:s}}};e._utf8ArrayToStr=function e(t,r){if(r===void 0){r=false}var i=s();if(i){var n=i.decode(t);if(r){var a=n.indexOf("\0");return a!==-1?n.substring(0,a):n}return n.replace(/\0/g,"")}var o=t.length;var u;var l;var d;var f="";var c=0;while(c<o){u=t[c++];if(u===0&&r){return f}else if(u===0||u===3){continue}switch(u>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:f+=String.fromCharCode(u);break;case 12:case 13:l=t[c++];f+=String.fromCharCode((u&31)<<6|l&63);break;case 14:l=t[c++];d=t[c++];f+=String.fromCharCode((u&15)<<12|(l&63)<<6|(d&63)<<0);break;default:}}return f};return e}();var a;function s(){var e=Object(i["getSelfScope"])();if(!a&&typeof e.TextDecoder!=="undefined"){a=new e.TextDecoder("utf-8")}return a}var o=n._utf8ArrayToStr;t["default"]=n},"./src/demux/mp4demuxer.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/utils/logger.js");var n=r("./src/events.js");var a=Math.pow(2,32)-1;var s=function(){function e(e,t){this.observer=e;this.remuxer=t}var t=e.prototype;t.resetTimeStamp=function e(t){this.initPTS=t};t.resetInitSegment=function t(r,i,a,s){if(r&&r.byteLength){var o=this.initData=e.parseInitSegment(r);if(i==null){i="mp4a.40.5"}if(a==null){a="avc1.42e01e"}var u={};if(o.audio&&o.video){u.audiovideo={container:"video/mp4",codec:i+","+a,initSegment:s?r:null}}else{if(o.audio){u.audio={container:"audio/mp4",codec:i,initSegment:s?r:null}}if(o.video){u.video={container:"video/mp4",codec:a,initSegment:s?r:null}}}this.observer.trigger(n["default"].FRAG_PARSING_INIT_SEGMENT,{tracks:u})}else{if(i){this.audioCodec=i}if(a){this.videoCodec=a}}};e.probe=function t(r){return e.findBox({data:r,start:0,end:Math.min(r.length,16384)},["moof"]).length>0};e.bin2str=function e(t){return String.fromCharCode.apply(null,t)};e.readUint16=function e(t,r){if(t.data){r+=t.start;t=t.data}var i=t[r]<<8|t[r+1];return i<0?65536+i:i};e.readUint32=function e(t,r){if(t.data){r+=t.start;t=t.data}var i=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3];return i<0?4294967296+i:i};e.writeUint32=function e(t,r,i){if(t.data){r+=t.start;t=t.data}t[r]=i>>24;t[r+1]=i>>16&255;t[r+2]=i>>8&255;t[r+3]=i&255};e.findBox=function t(r,i){var n=[],a,s,o,u,l,d,f;if(r.data){d=r.start;u=r.end;r=r.data}else{d=0;u=r.byteLength}if(!i.length){return null}for(a=d;a<u;){s=e.readUint32(r,a);o=e.bin2str(r.subarray(a+4,a+8));f=s>1?a+s:u;if(o===i[0]){if(i.length===1){n.push({data:r,start:a+8,end:f})}else{l=e.findBox({data:r,start:a+8,end:f},i.slice(1));if(l.length){n=n.concat(l)}}}a=f}return n};e.parseSegmentIndex=function t(r){var i=e.findBox(r,["moov"])[0];var n=i?i.end:null;var a=0;var s=e.findBox(r,["sidx"]);var o;if(!s||!s[0]){return null}o=[];s=s[0];var u=s.data[0];a=u===0?8:16;var l=e.readUint32(s,a);a+=4;var d=0;var f=0;if(u===0){a+=8}else{a+=16}a+=2;var c=s.end+f;var h=e.readUint16(s,a);a+=2;for(var p=0;p<h;p++){var v=a;var m=e.readUint32(s,v);v+=4;var g=m&2147483647;var y=(m&2147483648)>>>31;if(y===1){console.warn("SIDX has hierarchical references (not supported)");return}var _=e.readUint32(s,v);v+=4;o.push({referenceSize:g,subsegmentDuration:_,info:{duration:_/l,start:c,end:c+g-1}});c+=g;v+=4;a=v}return{earliestPresentationTime:d,timescale:l,version:u,referencesCount:h,references:o,moovEndOffset:n}};e.parseInitSegment=function t(r){var n=[];var a=e.findBox(r,["moov","trak"]);a.forEach((function(t){var r=e.findBox(t,["tkhd"])[0];if(r){var a=r.data[r.start];var s=a===0?12:20;var o=e.readUint32(r,s);var u=e.findBox(t,["mdia","mdhd"])[0];if(u){a=u.data[u.start];s=a===0?12:20;var l=e.readUint32(u,s);var d=e.findBox(t,["mdia","hdlr"])[0];if(d){var f=e.bin2str(d.data.subarray(d.start+8,d.start+12));var c={soun:"audio",vide:"video"}[f];if(c){var h=e.findBox(t,["mdia","minf","stbl","stsd"]);if(h.length){h=h[0];var p=e.bin2str(h.data.subarray(h.start+12,h.start+16));i["logger"].log("MP4Demuxer:"+c+":"+p+" found")}n[o]={timescale:l,type:c};n[c]={timescale:l,id:o}}}}}}));return n};e.getStartDTS=function t(r,i){var n,a,s;n=e.findBox(i,["moof","traf"]);a=[].concat.apply([],n.map((function(t){return e.findBox(t,["tfhd"]).map((function(i){var n,a,s;n=e.readUint32(i,4);a=r[n].timescale||9e4;s=e.findBox(t,["tfdt"]).map((function(t){var r,i;r=t.data[t.start];i=e.readUint32(t,4);if(r===1){i*=Math.pow(2,32);i+=e.readUint32(t,8)}return i}))[0];return s/a}))})));s=Math.min.apply(null,a);return isFinite(s)?s:0};e.offsetStartDTS=function t(r,i,n){e.findBox(i,["moof","traf"]).map((function(t){return e.findBox(t,["tfhd"]).map((function(i){var s=e.readUint32(i,4);var o=r[s].timescale||9e4;e.findBox(t,["tfdt"]).map((function(t){var r=t.data[t.start];var i=e.readUint32(t,4);if(r===0){e.writeUint32(t,4,i-n*o)}else{i*=Math.pow(2,32);i+=e.readUint32(t,8);i-=n*o;i=Math.max(i,0);var s=Math.floor(i/(a+1));var u=Math.floor(i%(a+1));e.writeUint32(t,4,s);e.writeUint32(t,8,u)}}))}))}))};t.append=function t(r,i,a,s){var o=this.initData;if(!o){this.resetInitSegment(r,this.audioCodec,this.videoCodec,false);o=this.initData}var u,l=this.initPTS;if(l===undefined){var d=e.getStartDTS(o,r);this.initPTS=l=d-i;this.observer.trigger(n["default"].INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(o,r,l);u=e.getStartDTS(o,r);this.remuxer.remux(o.audio,o.video,null,null,u,a,s,r)};t.destroy=function e(){};return e}();t["default"]=s},"./src/empty.js":function(e,t){e.exports=void 0},"./src/errors.ts":function(e,t,r){"use strict";r.r(t);r.d(t,"ErrorTypes",(function(){return i}));r.d(t,"ErrorDetails",(function(){return n}));var i;(function(e){e["NETWORK_ERROR"]="networkError";e["MEDIA_ERROR"]="mediaError";e["KEY_SYSTEM_ERROR"]="keySystemError";e["MUX_ERROR"]="muxError";e["OTHER_ERROR"]="otherError"})(i||(i={}));var n;(function(e){e["KEY_SYSTEM_NO_KEYS"]="keySystemNoKeys";e["KEY_SYSTEM_NO_ACCESS"]="keySystemNoAccess";e["KEY_SYSTEM_NO_SESSION"]="keySystemNoSession";e["KEY_SYSTEM_LICENSE_REQUEST_FAILED"]="keySystemLicenseRequestFailed";e["KEY_SYSTEM_NO_INIT_DATA"]="keySystemNoInitData";e["MANIFEST_LOAD_ERROR"]="manifestLoadError";e["MANIFEST_LOAD_TIMEOUT"]="manifestLoadTimeOut";e["MANIFEST_PARSING_ERROR"]="manifestParsingError";e["MANIFEST_INCOMPATIBLE_CODECS_ERROR"]="manifestIncompatibleCodecsError";e["LEVEL_EMPTY_ERROR"]="levelEmptyError";e["LEVEL_LOAD_ERROR"]="levelLoadError";e["LEVEL_LOAD_TIMEOUT"]="levelLoadTimeOut";e["LEVEL_SWITCH_ERROR"]="levelSwitchError";e["AUDIO_TRACK_LOAD_ERROR"]="audioTrackLoadError";e["AUDIO_TRACK_LOAD_TIMEOUT"]="audioTrackLoadTimeOut";e["FRAG_LOAD_ERROR"]="fragLoadError";e["FRAG_LOAD_TIMEOUT"]="fragLoadTimeOut";e["FRAG_DECRYPT_ERROR"]="fragDecryptError";e["FRAG_PARSING_ERROR"]="fragParsingError";e["REMUX_ALLOC_ERROR"]="remuxAllocError";e["KEY_LOAD_ERROR"]="keyLoadError";e["KEY_LOAD_TIMEOUT"]="keyLoadTimeOut";e["BUFFER_ADD_CODEC_ERROR"]="bufferAddCodecError";e["BUFFER_APPEND_ERROR"]="bufferAppendError";e["BUFFER_APPENDING_ERROR"]="bufferAppendingError";e["BUFFER_STALLED_ERROR"]="bufferStalledError";e["BUFFER_FULL_ERROR"]="bufferFullError";e["BUFFER_SEEK_OVER_HOLE"]="bufferSeekOverHole";e["BUFFER_NUDGE_ON_STALL"]="bufferNudgeOnStall";e["INTERNAL_EXCEPTION"]="internalException"})(n||(n={}))},"./src/events.js":function(e,t,r){"use strict";r.r(t);var i={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"};t["default"]=i},"./src/hls.ts":function(e,t,r){"use strict";r.r(t);r.d(t,"default",(function(){return tr}));var i=r("./node_modules/url-toolkit/src/url-toolkit.js");var n=r("./src/errors.ts");var a=r("./src/polyfills/number.js");var s=r("./src/events.js");var o=r("./src/utils/logger.js");var u={hlsEventGeneric:true,hlsHandlerDestroying:true,hlsHandlerDestroyed:true};var l=function(){function e(e){this.hls=void 0;this.handledEvents=void 0;this.useGenericHandler=void 0;this.hls=e;this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++){r[i-1]=arguments[i]}this.handledEvents=r;this.useGenericHandler=true;this.registerListeners()}var t=e.prototype;t.destroy=function e(){this.onHandlerDestroying();this.unregisterListeners();this.onHandlerDestroyed()};t.onHandlerDestroying=function e(){};t.onHandlerDestroyed=function e(){};t.isEventHandler=function e(){return typeof this.handledEvents==="object"&&this.handledEvents.length&&typeof this.onEvent==="function"};t.registerListeners=function e(){if(this.isEventHandler()){this.handledEvents.forEach((function(e){if(u[e]){throw new Error("Forbidden event-name: "+e)}this.hls.on(e,this.onEvent)}),this)}};t.unregisterListeners=function e(){if(this.isEventHandler()){this.handledEvents.forEach((function(e){this.hls.off(e,this.onEvent)}),this)}};t.onEvent=function e(t,r){this.onEventGeneric(t,r)};t.onEventGeneric=function e(t,r){var i=function e(t,r){var i="on"+t.replace("hls","");if(typeof this[i]!=="function"){throw new Error("Event "+t+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")")}return this[i].bind(this,r)};try{i.call(this,t,r).call()}catch(e){o["logger"].error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e);this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].OTHER_ERROR,details:n["ErrorDetails"].INTERNAL_EXCEPTION,fatal:false,event:t,err:e})}};return e}();var d=l;var f;(function(e){e["MANIFEST"]="manifest";e["LEVEL"]="level";e["AUDIO_TRACK"]="audioTrack";e["SUBTITLE_TRACK"]="subtitleTrack"})(f||(f={}));var c;(function(e){e["MAIN"]="main";e["AUDIO"]="audio";e["SUBTITLE"]="subtitle"})(c||(c={}));var h=r("./src/demux/mp4demuxer.js");function p(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function v(e,t,r){if(t)p(e.prototype,t);if(r)p(e,r);return e}var m=function(){function e(e,t){this._uri=null;this.baseuri=void 0;this.reluri=void 0;this.method=null;this.key=null;this.iv=null;this.baseuri=e;this.reluri=t}v(e,[{key:"uri",get:function e(){if(!this._uri&&this.reluri){this._uri=Object(i["buildAbsoluteURL"])(this.baseuri,this.reluri,{alwaysNormalize:true})}return this._uri}}]);return e}();function g(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function y(e,t,r){if(t)g(e.prototype,t);if(r)g(e,r);return e}var _;(function(e){e["AUDIO"]="audio";e["VIDEO"]="video"})(_||(_={}));var b=function(){function e(){var e;this._url=null;this._byteRange=null;this._decryptdata=null;this._elementaryStreams=(e={},e[_.AUDIO]=false,e[_.VIDEO]=false,e);this.deltaPTS=0;this.rawProgramDateTime=null;this.programDateTime=null;this.title=null;this.tagList=[];this.cc=void 0;this.type=void 0;this.relurl=void 0;this.baseurl=void 0;this.duration=void 0;this.start=void 0;this.sn=0;this.urlId=0;this.level=0;this.levelkey=void 0;this.loader=void 0}var t=e.prototype;t.setByteRange=function e(t,r){var i=t.split("@",2);var n=[];if(i.length===1){n[0]=r?r.byteRangeEndOffset:0}else{n[0]=parseInt(i[1])}n[1]=parseInt(i[0])+n[0];this._byteRange=n};t.addElementaryStream=function e(t){this._elementaryStreams[t]=true};t.hasElementaryStream=function e(t){return this._elementaryStreams[t]===true};t.createInitializationVector=function e(t){var r=new Uint8Array(16);for(var i=12;i<16;i++){r[i]=t>>8*(15-i)&255}return r};t.setDecryptDataFromLevelKey=function e(t,r){var i=t;if((t===null||t===void 0?void 0:t.method)&&t.uri&&!t.iv){i=new m(t.baseuri,t.reluri);i.method=t.method;i.iv=this.createInitializationVector(r)}return i};y(e,[{key:"url",get:function e(){if(!this._url&&this.relurl){this._url=Object(i["buildAbsoluteURL"])(this.baseurl,this.relurl,{alwaysNormalize:true})}return this._url},set:function e(t){this._url=t}},{key:"byteRange",get:function e(){if(!this._byteRange){return[]}return this._byteRange}},{key:"byteRangeStartOffset",get:function e(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function e(){return this.byteRange[1]}},{key:"decryptdata",get:function e(){if(!this.levelkey&&!this._decryptdata){return null}if(!this._decryptdata&&this.levelkey){var t=this.sn;if(typeof t!=="number"){if(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv){o["logger"].warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue')}t=0}this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,t)}return this._decryptdata}},{key:"endProgramDateTime",get:function e(){if(this.programDateTime===null){return null}if(!Object(a["isFiniteNumber"])(this.programDateTime)){return null}var t=!Object(a["isFiniteNumber"])(this.duration)?0:this.duration;return this.programDateTime+t*1e3}},{key:"encrypted",get:function e(){return!!(this.decryptdata&&this.decryptdata.uri!==null&&this.decryptdata.key===null)}}]);return e}();function T(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function S(e,t,r){if(t)T(e.prototype,t);if(r)T(e,r);return e}var w=function(){function e(e){this.endCC=0;this.endSN=0;this.fragments=[];this.initSegment=null;this.live=true;this.needSidxRanges=false;this.startCC=0;this.startSN=0;this.startTimeOffset=null;this.targetduration=0;this.totalduration=0;this.type=null;this.url=e;this.version=null}S(e,[{key:"hasProgramDateTime",get:function e(){return!!(this.fragments[0]&&Object(a["isFiniteNumber"])(this.fragments[0].programDateTime))}}]);return e}();var E=/^(\d+)x(\d+)$/;var k=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g;var A=function(){function e(t){if(typeof t==="string"){t=e.parseAttrList(t)}for(var r in t){if(t.hasOwnProperty(r)){this[r]=t[r]}}}var t=e.prototype;t.decimalInteger=function e(t){var r=parseInt(this[t],10);if(r>Number.MAX_SAFE_INTEGER){return Infinity}return r};t.hexadecimalInteger=function e(t){if(this[t]){var r=(this[t]||"0x").slice(2);r=(r.length&1?"0":"")+r;var i=new Uint8Array(r.length/2);for(var n=0;n<r.length/2;n++){i[n]=parseInt(r.slice(n*2,n*2+2),16)}return i}else{return null}};t.hexadecimalIntegerAsNumber=function e(t){var r=parseInt(this[t],16);if(r>Number.MAX_SAFE_INTEGER){return Infinity}return r};t.decimalFloatingPoint=function e(t){return parseFloat(this[t])};t.enumeratedString=function e(t){return this[t]};t.decimalResolution=function e(t){var r=E.exec(this[t]);if(r===null){return undefined}return{width:parseInt(r[1],10),height:parseInt(r[2],10)}};e.parseAttrList=function e(t){var r,i={};k.lastIndex=0;while((r=k.exec(t))!==null){var n=r[2],a='"';if(n.indexOf(a)===0&&n.lastIndexOf(a)===n.length-1){n=n.slice(1,-1)}i[r[1]]=n}return i};return e}();var C=A;var I={audio:{a3ds:true,"ac-3":true,"ac-4":true,alac:true,alaw:true,dra1:true,"dts+":true,"dts-":true,dtsc:true,dtse:true,dtsh:true,"ec-3":true,enca:true,g719:true,g726:true,m4ae:true,mha1:true,mha2:true,mhm1:true,mhm2:true,mlpa:true,mp4a:true,"raw ":true,Opus:true,samr:true,sawb:true,sawp:true,sevc:true,sqcp:true,ssmv:true,twos:true,ulaw:true},video:{avc1:true,avc2:true,avc3:true,avc4:true,avcp:true,drac:true,dvav:true,dvhe:true,encv:true,hev1:true,hvc1:true,mjp2:true,mp4v:true,mvc1:true,mvc2:true,mvc3:true,mvc4:true,resv:true,rv60:true,s263:true,svc1:true,svc2:true,"vc-1":true,vp08:true,vp09:true}};function D(e,t){var r=I[t];return!!r&&r[e.slice(0,4)]===true}function x(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var L=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g;var O=/#EXT-X-MEDIA:(.*)/g;var P=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g");var R=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/;var U=/\.(mp4|m4s|m4v|m4a)$/i;var M=function(){function e(){}e.findGroup=function e(t,r){for(var i=0;i<t.length;i++){var n=t[i];if(n.id===r){return n}}};e.convertAVC1ToAVCOTI=function e(t){var r=t.split(".");var i;if(r.length>2){i=r.shift()+".";i+=parseInt(r.shift()).toString(16);i+=("000"+parseInt(r.shift()).toString(16)).substr(-4)}else{i=t}return i};e.resolve=function e(t,r){return i["buildAbsoluteURL"](r,t,{alwaysNormalize:true})};e.parseMasterPlaylist=function t(r,i){var n=[];var a={};var s=false;L.lastIndex=0;function o(e,t){["video","audio"].forEach((function(r){var i=e.filter((function(e){return D(e,r)}));if(i.length){var n=i.filter((function(e){return e.lastIndexOf("avc1",0)===0||e.lastIndexOf("mp4a",0)===0}));t[r+"Codec"]=n.length>0?n[0]:i[0];e=e.filter((function(e){return i.indexOf(e)===-1}))}}));t.unknownCodecs=e}var u;while((u=L.exec(r))!=null){if(u[1]){var l={};var d=l.attrs=new C(u[1]);l.url=e.resolve(u[2],i);var f=d.decimalResolution("RESOLUTION");if(f){l.width=f.width;l.height=f.height}l.bitrate=d.decimalInteger("AVERAGE-BANDWIDTH")||d.decimalInteger("BANDWIDTH");l.name=d.NAME;o([].concat((d.CODECS||"").split(/[ ,]+/)),l);if(l.videoCodec&&l.videoCodec.indexOf("avc1")!==-1){l.videoCodec=e.convertAVC1ToAVCOTI(l.videoCodec)}n.push(l)}else if(u[3]){var c=new C(u[3]);if(c["DATA-ID"]){s=true;a[c["DATA-ID"]]=c}}}return{levels:n,sessionData:s?a:null}};e.parseMasterPlaylistMedia=function t(r,i,n,a){if(a===void 0){a=[]}var s;var o=[];var u=0;O.lastIndex=0;while((s=O.exec(r))!==null){var l=new C(s[1]);if(l.TYPE===n){var d={attrs:l,id:u++,groupId:l["GROUP-ID"],instreamId:l["INSTREAM-ID"],name:l.NAME||l.LANGUAGE,type:n,default:l.DEFAULT==="YES",autoselect:l.AUTOSELECT==="YES",forced:l.FORCED==="YES",lang:l.LANGUAGE};if(l.URI){d.url=e.resolve(l.URI,i)}if(a.length){var f=e.findGroup(a,d.groupId);d.audioCodec=f?f.codec:a[0].codec}o.push(d)}}return o};e.parseLevelPlaylist=function e(t,r,i,n,s){var u=0;var l=0;var d=new w(r);var f=0;var c=null;var h=new b;var p;var v;var g;var y=null;P.lastIndex=0;while((p=P.exec(t))!==null){var _=p[1];if(_){h.duration=parseFloat(_);var T=(" "+p[2]).slice(1);h.title=T||null;h.tagList.push(T?["INF",_,T]:["INF",_])}else if(p[3]){if(Object(a["isFiniteNumber"])(h.duration)){var S=u++;h.type=n;h.start=l;if(g){h.levelkey=g}h.sn=S;h.level=i;h.cc=f;h.urlId=s;h.baseurl=r;h.relurl=(" "+p[3]).slice(1);B(h,c);d.fragments.push(h);c=h;l+=h.duration;h=new b}}else if(p[4]){var E=(" "+p[4]).slice(1);if(c){h.setByteRange(E,c)}else{h.setByteRange(E)}}else if(p[5]){h.rawProgramDateTime=(" "+p[5]).slice(1);h.tagList.push(["PROGRAM-DATE-TIME",h.rawProgramDateTime]);if(y===null){y=d.fragments.length}}else{p=p[0].match(R);if(!p){o["logger"].warn("No matches on slow regex match for level playlist!");continue}for(v=1;v<p.length;v++){if(typeof p[v]!=="undefined"){break}}var k=(" "+p[v+1]).slice(1);var A=(" "+p[v+2]).slice(1);switch(p[v]){case"#":h.tagList.push(A?[k,A]:[k]);break;case"PLAYLIST-TYPE":d.type=k.toUpperCase();break;case"MEDIA-SEQUENCE":u=d.startSN=parseInt(k);break;case"TARGETDURATION":d.targetduration=parseFloat(k);break;case"VERSION":d.version=parseInt(k);break;case"EXTM3U":break;case"ENDLIST":d.live=false;break;case"DIS":f++;h.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":f=parseInt(k);break;case"KEY":{var I=k;var D=new C(I);var x=D.enumeratedString("METHOD");var L=D.URI;var O=D.hexadecimalInteger("IV");var M=D.KEYFORMAT||"identity";if(M==="com.apple.streamingkeydelivery"){o["logger"].warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}if(x){g=new m(r,L);if(L&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(x)>=0){g.method=x;g.key=null;g.iv=O}}break}case"START":{var F=new C(k);var j=F.decimalFloatingPoint("TIME-OFFSET");if(Object(a["isFiniteNumber"])(j)){d.startTimeOffset=j}break}case"MAP":{var q=new C(k);h.relurl=q.URI;if(q.BYTERANGE){h.setByteRange(q.BYTERANGE)}h.baseurl=r;h.level=i;h.type=n;h.sn="initSegment";d.initSegment=h;h=new b;h.rawProgramDateTime=d.initSegment.rawProgramDateTime;break}default:o["logger"].warn("line parsed but not handled: "+p);break}}}h=c;if(h&&!h.relurl){d.fragments.pop();l-=h.duration}d.totalduration=l;d.averagetargetduration=l/d.fragments.length;d.endSN=u-1;d.startCC=d.fragments[0]?d.fragments[0].cc:0;d.endCC=f;if(!d.initSegment&&d.fragments.length){if(d.fragments.every((function(e){return U.test(e.relurl)}))){o["logger"].warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX");h=new b;h.relurl=d.fragments[0].relurl;h.baseurl=r;h.level=i;h.type=n;h.sn="initSegment";d.initSegment=h;d.needSidxRanges=true}}if(y){N(d.fragments,y)}return d};return e}();function N(e,t){var r=e[t];for(var i=t-1;i>=0;i--){var n=e[i];n.programDateTime=r.programDateTime-n.duration*1e3;r=n}}function B(e,t){if(e.rawProgramDateTime){e.programDateTime=Date.parse(e.rawProgramDateTime)}else if(t===null||t===void 0?void 0:t.programDateTime){e.programDateTime=t.endProgramDateTime}if(!Object(a["isFiniteNumber"])(e.programDateTime)){e.programDateTime=null;e.rawProgramDateTime=null}}function F(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var j=window,q=j.performance;var H=function(e){F(t,e);function t(t){var r;r=e.call(this,t,s["default"].MANIFEST_LOADING,s["default"].LEVEL_LOADING,s["default"].AUDIO_TRACK_LOADING,s["default"].SUBTITLE_TRACK_LOADING)||this;r.loaders={};return r}t.canHaveQualityLevels=function e(t){return t!==f.AUDIO_TRACK&&t!==f.SUBTITLE_TRACK};t.mapContextToLevelType=function e(t){var r=t.type;switch(r){case f.AUDIO_TRACK:return c.AUDIO;case f.SUBTITLE_TRACK:return c.SUBTITLE;default:return c.MAIN}};t.getResponseUrl=function e(t,r){var i=t.url;if(i===undefined||i.indexOf("data:")===0){i=r.url}return i};var r=t.prototype;r.createInternalLoader=function e(t){var r=this.hls.config;var i=r.pLoader;var n=r.loader;var a=i||n;var s=new a(r);t.loader=s;this.loaders[t.type]=s;return s};r.getInternalLoader=function e(t){return this.loaders[t.type]};r.resetInternalLoader=function e(t){if(this.loaders[t]){delete this.loaders[t]}};r.destroyInternalLoaders=function e(){for(var t in this.loaders){var r=this.loaders[t];if(r){r.destroy()}this.resetInternalLoader(t)}};r.destroy=function t(){this.destroyInternalLoaders();e.prototype.destroy.call(this)};r.onManifestLoading=function e(t){this.load({url:t.url,type:f.MANIFEST,level:0,id:null,responseType:"text"})};r.onLevelLoading=function e(t){this.load({url:t.url,type:f.LEVEL,level:t.level,id:t.id,responseType:"text"})};r.onAudioTrackLoading=function e(t){this.load({url:t.url,type:f.AUDIO_TRACK,level:null,id:t.id,responseType:"text"})};r.onSubtitleTrackLoading=function e(t){this.load({url:t.url,type:f.SUBTITLE_TRACK,level:null,id:t.id,responseType:"text"})};r.load=function e(t){var r=this.hls.config;o["logger"].debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var i=this.getInternalLoader(t);if(i){var n=i.context;if(n&&n.url===t.url){o["logger"].trace("playlist request ongoing");return false}else{o["logger"].warn("aborting previous loader for type: "+t.type);i.abort()}}var a;var s;var u;var l;switch(t.type){case f.MANIFEST:a=r.manifestLoadingMaxRetry;s=r.manifestLoadingTimeOut;u=r.manifestLoadingRetryDelay;l=r.manifestLoadingMaxRetryTimeout;break;case f.LEVEL:a=0;l=0;u=0;s=r.levelLoadingTimeOut;break;default:a=r.levelLoadingMaxRetry;s=r.levelLoadingTimeOut;u=r.levelLoadingRetryDelay;l=r.levelLoadingMaxRetryTimeout;break}i=this.createInternalLoader(t);var d={timeout:s,maxRetry:a,retryDelay:u,maxRetryDelay:l};var c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};o["logger"].debug("Calling internal loader delegate for URL: "+t.url);i.load(t,d,c);return true};r.loadsuccess=function e(t,r,i,n){if(n===void 0){n=null}if(i.isSidxRequest){this._handleSidxRequest(t,i);this._handlePlaylistLoaded(t,r,i,n);return}this.resetInternalLoader(i.type);if(typeof t.data!=="string"){throw new Error('expected responseType of "text" for PlaylistLoader')}var a=t.data;r.tload=q.now();if(a.indexOf("#EXTM3U")!==0){this._handleManifestParsingError(t,i,"no EXTM3U delimiter",n);return}if(a.indexOf("#EXTINF:")>0||a.indexOf("#EXT-X-TARGETDURATION:")>0){this._handleTrackOrLevelPlaylist(t,r,i,n)}else{this._handleMasterPlaylist(t,r,i,n)}};r.loaderror=function e(t,r,i){if(i===void 0){i=null}this._handleNetworkError(r,i,false,t)};r.loadtimeout=function e(t,r,i){if(i===void 0){i=null}this._handleNetworkError(r,i,true)};r._handleMasterPlaylist=function e(r,i,n,a){var u=this.hls;var l=r.data;var d=t.getResponseUrl(r,n);var f=M.parseMasterPlaylist(l,d),c=f.levels,h=f.sessionData;if(!c.length){this._handleManifestParsingError(r,n,"no level found in manifest",a);return}var p=c.map((function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}));var v=M.parseMasterPlaylistMedia(l,d,"AUDIO",p);var m=M.parseMasterPlaylistMedia(l,d,"SUBTITLES");var g=M.parseMasterPlaylistMedia(l,d,"CLOSED-CAPTIONS");if(v.length){var y=false;v.forEach((function(e){if(!e.url){y=true}}));if(y===false&&c[0].audioCodec&&!c[0].attrs.AUDIO){o["logger"].log("audio codec signaled in quality level, but no embedded audio track signaled, create one");v.unshift({type:"main",name:"main",default:false,autoselect:false,forced:false,id:-1,attrs:{},url:""})}}u.trigger(s["default"].MANIFEST_LOADED,{levels:c,audioTracks:v,subtitles:m,captions:g,url:d,stats:i,networkDetails:a,sessionData:h})};r._handleTrackOrLevelPlaylist=function e(r,i,o,u){var l=this.hls;var d=o.id,c=o.level,h=o.type;var p=t.getResponseUrl(r,o);var v=Object(a["isFiniteNumber"])(d)?d:0;var m=Object(a["isFiniteNumber"])(c)?c:v;var g=t.mapContextToLevelType(o);var y=M.parseLevelPlaylist(r.data,p,m,g,v);y.tload=i.tload;if(!y.fragments.length){l.trigger(s["default"].ERROR,{type:n["ErrorTypes"].NETWORK_ERROR,details:n["ErrorDetails"].LEVEL_EMPTY_ERROR,fatal:false,url:p,reason:"no fragments found in level",level:typeof o.level==="number"?o.level:undefined});return}if(h===f.MANIFEST){var _={url:p,details:y};l.trigger(s["default"].MANIFEST_LOADED,{levels:[_],audioTracks:[],url:p,stats:i,networkDetails:u,sessionData:null})}i.tparsed=q.now();if(y.needSidxRanges){var b=y.initSegment.url;this.load({url:b,isSidxRequest:true,type:h,level:c,levelDetails:y,id:d,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"});return}o.levelDetails=y;this._handlePlaylistLoaded(r,i,o,u)};r._handleSidxRequest=function e(t,r){if(typeof t.data==="string"){throw new Error("sidx request must be made with responseType of array buffer")}var i=h["default"].parseSegmentIndex(new Uint8Array(t.data));if(!i){return}var n=i.references;var a=r.levelDetails;n.forEach((function(e,t){var r=e.info;if(!a){return}var i=a.fragments[t];if(i.byteRange.length===0){i.setByteRange(String(1+r.end-r.start)+"@"+String(r.start))}}));if(a){a.initSegment.setByteRange(String(i.moovEndOffset)+"@0")}};r._handleManifestParsingError=function e(t,r,i,a){this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].NETWORK_ERROR,details:n["ErrorDetails"].MANIFEST_PARSING_ERROR,fatal:true,url:t.url,reason:i,networkDetails:a})};r._handleNetworkError=function e(t,r,i,a){if(i===void 0){i=false}if(a===void 0){a=null}o["logger"].info("A network error occured while loading a "+t.type+"-type playlist");var u;var l;var d=this.getInternalLoader(t);switch(t.type){case f.MANIFEST:u=i?n["ErrorDetails"].MANIFEST_LOAD_TIMEOUT:n["ErrorDetails"].MANIFEST_LOAD_ERROR;l=true;break;case f.LEVEL:u=i?n["ErrorDetails"].LEVEL_LOAD_TIMEOUT:n["ErrorDetails"].LEVEL_LOAD_ERROR;l=false;break;case f.AUDIO_TRACK:u=i?n["ErrorDetails"].AUDIO_TRACK_LOAD_TIMEOUT:n["ErrorDetails"].AUDIO_TRACK_LOAD_ERROR;l=false;break;default:l=false}if(d){d.abort();this.resetInternalLoader(t.type)}var c={type:n["ErrorTypes"].NETWORK_ERROR,details:u,fatal:l,url:t.url,loader:d,context:t,networkDetails:r};if(a){c.response=a}this.hls.trigger(s["default"].ERROR,c)};r._handlePlaylistLoaded=function e(r,i,n,a){var o=n.type,u=n.level,l=n.id,d=n.levelDetails;if(!d||!d.targetduration){this._handleManifestParsingError(r,n,"invalid target duration",a);return}var c=t.canHaveQualityLevels(n.type);if(c){this.hls.trigger(s["default"].LEVEL_LOADED,{details:d,level:u||0,id:l||0,stats:i,networkDetails:a})}else{switch(o){case f.AUDIO_TRACK:this.hls.trigger(s["default"].AUDIO_TRACK_LOADED,{details:d,id:l,stats:i,networkDetails:a});break;case f.SUBTITLE_TRACK:this.hls.trigger(s["default"].SUBTITLE_TRACK_LOADED,{details:d,id:l,stats:i,networkDetails:a});break}}};return t}(d);var G=H;function V(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var W=function(e){V(t,e);function t(t){var r;r=e.call(this,t,s["default"].FRAG_LOADING)||this;r.loaders={};return r}var r=t.prototype;r.destroy=function t(){var r=this.loaders;for(var i in r){var n=r[i];if(n){n.destroy()}}this.loaders={};e.prototype.destroy.call(this)};r.onFragLoading=function e(t){var r=t.frag,i=r.type,n=this.loaders,s=this.hls.config,u=s.fLoader,l=s.loader;r.loaded=0;var d=n[i];if(d){o["logger"].warn("abort previous fragment loader for type: "+i);d.abort()}d=n[i]=r.loader=s.fLoader?new u(s):new l(s);var f,c,h;f={url:r.url,frag:r,responseType:"arraybuffer",progressData:false};var p=r.byteRangeStartOffset,v=r.byteRangeEndOffset;if(Object(a["isFiniteNumber"])(p)&&Object(a["isFiniteNumber"])(v)){f.rangeStart=p;f.rangeEnd=v}c={timeout:s.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:s.fragLoadingMaxRetryTimeout};h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)};d.load(f,c,h)};r.loadsuccess=function e(t,r,i,n){if(n===void 0){n=null}var a=t.data,o=i.frag;o.loader=undefined;this.loaders[o.type]=undefined;this.hls.trigger(s["default"].FRAG_LOADED,{payload:a,frag:o,stats:r,networkDetails:n})};r.loaderror=function e(t,r,i){if(i===void 0){i=null}var a=r.frag;var o=a.loader;if(o){o.abort()}this.loaders[a.type]=undefined;this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].NETWORK_ERROR,details:n["ErrorDetails"].FRAG_LOAD_ERROR,fatal:false,frag:r.frag,response:t,networkDetails:i})};r.loadtimeout=function e(t,r,i){if(i===void 0){i=null}var a=r.frag;var o=a.loader;if(o){o.abort()}this.loaders[a.type]=undefined;this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].NETWORK_ERROR,details:n["ErrorDetails"].FRAG_LOAD_TIMEOUT,fatal:false,frag:r.frag,networkDetails:i})};r.loadprogress=function e(t,r,i,n){if(n===void 0){n=null}var a=r.frag;a.loaded=t.loaded;this.hls.trigger(s["default"].FRAG_LOAD_PROGRESS,{frag:a,stats:t,networkDetails:n})};return t}(d);var z=W;function K(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var X=function(e){K(t,e);function t(t){var r;r=e.call(this,t,s["default"].KEY_LOADING)||this;r.loaders={};r.decryptkey=null;r.decrypturl=null;return r}var r=t.prototype;r.destroy=function t(){for(var r in this.loaders){var i=this.loaders[r];if(i){i.destroy()}}this.loaders={};e.prototype.destroy.call(this)};r.onKeyLoading=function e(t){var r=t.frag;var i=r.type;var n=this.loaders[i];if(!r.decryptdata){o["logger"].warn("Missing decryption data on fragment in onKeyLoading");return}var a=r.decryptdata.uri;if(a!==this.decrypturl||this.decryptkey===null){var u=this.hls.config;if(n){o["logger"].warn("abort previous key loader for type:"+i);n.abort()}if(!a){o["logger"].warn("key uri is falsy");return}r.loader=this.loaders[i]=new u.loader(u);this.decrypturl=a;this.decryptkey=null;var l={url:a,frag:r,responseType:"arraybuffer"};var d={timeout:u.fragLoadingTimeOut,maxRetry:0,retryDelay:u.fragLoadingRetryDelay,maxRetryDelay:u.fragLoadingMaxRetryTimeout};var f={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};r.loader.load(l,d,f)}else if(this.decryptkey){r.decryptdata.key=this.decryptkey;this.hls.trigger(s["default"].KEY_LOADED,{frag:r})}};r.loadsuccess=function e(t,r,i){var n=i.frag;if(!n.decryptdata){o["logger"].error("after key load, decryptdata unset");return}this.decryptkey=n.decryptdata.key=new Uint8Array(t.data);n.loader=undefined;delete this.loaders[n.type];this.hls.trigger(s["default"].KEY_LOADED,{frag:n})};r.loaderror=function e(t,r){var i=r.frag;var a=i.loader;if(a){a.abort()}delete this.loaders[i.type];this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].NETWORK_ERROR,details:n["ErrorDetails"].KEY_LOAD_ERROR,fatal:false,frag:i,response:t})};r.loadtimeout=function e(t,r){var i=r.frag;var a=i.loader;if(a){a.abort()}delete this.loaders[i.type];this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].NETWORK_ERROR,details:n["ErrorDetails"].KEY_LOAD_TIMEOUT,fatal:false,frag:i})};return t}(d);var Y=X;function Q(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var $={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};var J=function(e){Q(t,e);function t(t){var r;r=e.call(this,t,s["default"].BUFFER_APPENDED,s["default"].FRAG_BUFFERED,s["default"].FRAG_LOADED)||this;r.bufferPadding=.2;r.fragments=Object.create(null);r.timeRanges=Object.create(null);r.config=t.config;return r}var r=t.prototype;r.destroy=function t(){this.fragments=Object.create(null);this.timeRanges=Object.create(null);this.config=null;d.prototype.destroy.call(this);e.prototype.destroy.call(this)};r.getBufferedFrag=function e(t,r){var i=this.fragments;var n=Object.keys(i).filter((function(e){var n=i[e];if(n.body.type!==r){return false}if(!n.buffered){return false}var a=n.body;return a.startPTS<=t&&t<=a.endPTS}));if(n.length===0){return null}else{var a=n.pop();return i[a].body}};r.detectEvictedFragments=function e(t,r){var i=this;Object.keys(this.fragments).forEach((function(e){var n=i.fragments[e];if(!n||!n.buffered){return}var a=n.range[t];if(!a){return}var s=a.time;for(var o=0;o<s.length;o++){var u=s[o];if(!i.isTimeBuffered(u.startPTS,u.endPTS,r)){i.removeFragment(n.body);break}}}))};r.detectPartialFragments=function e(t){var r=this;var i=this.getFragmentKey(t);var n=this.fragments[i];if(n){n.buffered=true;Object.keys(this.timeRanges).forEach((function(e){if(t.hasElementaryStream(e)){var i=r.timeRanges[e];n.range[e]=r.getBufferedTimes(t.startPTS,t.endPTS,i)}}))}};r.getBufferedTimes=function e(t,r,i){var n=[];var a,s;var o=false;for(var u=0;u<i.length;u++){a=i.start(u)-this.bufferPadding;s=i.end(u)+this.bufferPadding;if(t>=a&&r<=s){n.push({startPTS:Math.max(t,i.start(u)),endPTS:Math.min(r,i.end(u))});break}else if(t<s&&r>a){n.push({startPTS:Math.max(t,i.start(u)),endPTS:Math.min(r,i.end(u))});o=true}else if(r<=a){break}}return{time:n,partial:o}};r.getFragmentKey=function e(t){return t.type+"_"+t.level+"_"+t.urlId+"_"+t.sn};r.getPartialFragment=function e(t){var r=this;var i,n,a;var s=null;var o=0;Object.keys(this.fragments).forEach((function(e){var u=r.fragments[e];if(r.isPartial(u)){n=u.body.startPTS-r.bufferPadding;a=u.body.endPTS+r.bufferPadding;if(t>=n&&t<=a){i=Math.min(t-n,a-t);if(o<=i){s=u.body;o=i}}}}));return s};r.getState=function e(t){var r=this.getFragmentKey(t);var i=this.fragments[r];var n=$.NOT_LOADED;if(i!==undefined){if(!i.buffered){n=$.APPENDING}else if(this.isPartial(i)===true){n=$.PARTIAL}else{n=$.OK}}return n};r.isPartial=function e(t){return t.buffered===true&&(t.range.video!==undefined&&t.range.video.partial===true||t.range.audio!==undefined&&t.range.audio.partial===true)};r.isTimeBuffered=function e(t,r,i){var n,a;for(var s=0;s<i.length;s++){n=i.start(s)-this.bufferPadding;a=i.end(s)+this.bufferPadding;if(t>=n&&r<=a){return true}if(r<=n){return false}}return false};r.onFragLoaded=function e(t){var r=t.frag;if(!Object(a["isFiniteNumber"])(r.sn)||r.bitrateTest){return}this.fragments[this.getFragmentKey(r)]={body:r,range:Object.create(null),buffered:false}};r.onBufferAppended=function e(t){var r=this;this.timeRanges=t.timeRanges;Object.keys(this.timeRanges).forEach((function(e){var t=r.timeRanges[e];r.detectEvictedFragments(e,t)}))};r.onFragBuffered=function e(t){this.detectPartialFragments(t.frag)};r.hasFragment=function e(t){var r=this.getFragmentKey(t);return this.fragments[r]!==undefined};r.removeFragment=function e(t){var r=this.getFragmentKey(t);delete this.fragments[r]};r.removeAllFragments=function e(){this.fragments=Object.create(null)};return t}(d);var Z={search:function e(t,r){var i=0;var n=t.length-1;var a=null;var s=null;while(i<=n){a=(i+n)/2|0;s=t[a];var o=r(s);if(o>0){i=a+1}else if(o<0){n=a-1}else{return s}}return null}};var ee=Z;var te=function(){function e(){}e.isBuffered=function e(t,r){try{if(t){var i=t.buffered;for(var n=0;n<i.length;n++){if(r>=i.start(n)&&r<=i.end(n)){return true}}}}catch(e){}return false};e.bufferInfo=function e(t,r,i){try{if(t){var n=t.buffered;var a=[];var s;for(s=0;s<n.length;s++){a.push({start:n.start(s),end:n.end(s)})}return this.bufferedInfo(a,r,i)}}catch(e){}return{len:0,start:r,end:r,nextStart:undefined}};e.bufferedInfo=function e(t,r,i){t.sort((function(e,t){var r=e.start-t.start;if(r){return r}else{return t.end-e.end}}));var n=[];if(i){for(var a=0;a<t.length;a++){var s=n.length;if(s){var o=n[s-1].end;if(t[a].start-o<i){if(t[a].end>o){n[s-1].end=t[a].end}}else{n.push(t[a])}}else{n.push(t[a])}}}else{n=t}var u=0;var l;var d=r;var f=r;for(var c=0;c<n.length;c++){var h=n[c].start,p=n[c].end;if(r+i>=h&&r<p){d=h;f=p;u=f-r}else if(r+i<h){l=h;break}}return{len:u,start:d,end:f,nextStart:l}};return e}();var re=r("./node_modules/eventemitter3/index.js");var ie=r("./node_modules/webworkify-webpack/index.js");var ne=r("./src/demux/demuxer-inline.js");function ae(){return window.MediaSource||window.WebKitMediaSource}var se=r("./src/utils/get-self-scope.js");function oe(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var ue=function(e){oe(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.trigger=function e(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++){i[n-1]=arguments[n]}this.emit.apply(this,[t,t].concat(i))};return t}(re["EventEmitter"]);var le=Object(se["getSelfScope"])();var de=ae()||{isTypeSupported:function e(){return false}};var fe=function(){function e(e,t){var r=this;this.hls=e;this.id=t;var i=this.observer=new ue;var a=e.config;var u=function t(i,n){n=n||{};n.frag=r.frag;n.id=r.id;e.trigger(i,n)};i.on(s["default"].FRAG_DECRYPTED,u);i.on(s["default"].FRAG_PARSING_INIT_SEGMENT,u);i.on(s["default"].FRAG_PARSING_DATA,u);i.on(s["default"].FRAG_PARSED,u);i.on(s["default"].ERROR,u);i.on(s["default"].FRAG_PARSING_METADATA,u);i.on(s["default"].FRAG_PARSING_USERDATA,u);i.on(s["default"].INIT_PTS_FOUND,u);var l={mp4:de.isTypeSupported("video/mp4"),mpeg:de.isTypeSupported("audio/mpeg"),mp3:de.isTypeSupported('audio/mp4; codecs="mp3"')};var d=navigator.vendor;if(a.enableWorker&&typeof Worker!=="undefined"){o["logger"].log("demuxing in webworker");var f;try{f=this.w=ie("./src/demux/demuxer-worker.js");this.onwmsg=this.onWorkerMessage.bind(this);f.addEventListener("message",this.onwmsg);f.onerror=function(t){e.trigger(s["default"].ERROR,{type:n["ErrorTypes"].OTHER_ERROR,details:n["ErrorDetails"].INTERNAL_EXCEPTION,fatal:true,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})};f.postMessage({cmd:"init",typeSupported:l,vendor:d,id:t,config:JSON.stringify(a)})}catch(e){o["logger"].warn("Error in worker:",e);o["logger"].error("Error while initializing DemuxerWorker, fallback on DemuxerInline");if(f){le.URL.revokeObjectURL(f.objectURL)}this.demuxer=new ne["default"](i,l,a,d);this.w=undefined}}else{this.demuxer=new ne["default"](i,l,a,d)}}var t=e.prototype;t.destroy=function e(){var t=this.w;if(t){t.removeEventListener("message",this.onwmsg);t.terminate();this.w=null}else{var r=this.demuxer;if(r){r.destroy();this.demuxer=null}}var i=this.observer;if(i){i.removeAllListeners();this.observer=null}};t.push=function e(t,r,i,n,s,u,l,d){var f=this.w;var c=Object(a["isFiniteNumber"])(s.startPTS)?s.startPTS:s.start;var h=s.decryptdata;var p=this.frag;var v=!(p&&s.cc===p.cc);var m=!(p&&s.level===p.level);var g=p&&s.sn===p.sn+1;var y=!m&&g;if(v){o["logger"].log(this.id+":discontinuity detected")}if(m){o["logger"].log(this.id+":switch detected")}this.frag=s;if(f){f.postMessage({cmd:"demux",data:t,decryptdata:h,initSegment:r,audioCodec:i,videoCodec:n,timeOffset:c,discontinuity:v,trackSwitch:m,contiguous:y,duration:u,accurateTimeOffset:l,defaultInitPTS:d},t instanceof ArrayBuffer?[t]:[])}else{var _=this.demuxer;if(_){_.push(t,h,r,i,n,c,v,m,y,u,l,d)}}};t.onWorkerMessage=function e(t){var r=t.data,i=this.hls;switch(r.event){case"init":le.URL.revokeObjectURL(this.w.objectURL);break;case s["default"].FRAG_PARSING_DATA:r.data.data1=new Uint8Array(r.data1);if(r.data2){r.data.data2=new Uint8Array(r.data2)}default:r.data=r.data||{};r.data.frag=this.frag;r.data.id=this.id;i.trigger(r.event,r.data);break}};return e}();var ce=fe;function he(e,t,r){switch(t){case"audio":if(!e.audioGroupIds){e.audioGroupIds=[]}e.audioGroupIds.push(r);break;case"text":if(!e.textGroupIds){e.textGroupIds=[]}e.textGroupIds.push(r);break}}function pe(e,t,r){var i=e[t],n=e[r],s=n.startPTS;if(Object(a["isFiniteNumber"])(s)){if(r>t){i.duration=s-i.start;if(i.duration<0){o["logger"].warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")}}else{n.duration=i.start-s;if(n.duration<0){o["logger"].warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")}}}else{if(r>t){var u=i.cc===n.cc;n.start=i.start+(u&&i.minEndPTS?i.minEndPTS-i.start:i.duration)}else{n.start=Math.max(i.start-n.duration,0)}}}function ve(e,t,r,i,n,s){var o=r;var u=i;if(Object(a["isFiniteNumber"])(t.startPTS)){var l=Math.abs(t.startPTS-r);if(!Object(a["isFiniteNumber"])(t.deltaPTS)){t.deltaPTS=l}else{t.deltaPTS=Math.max(l,t.deltaPTS)}o=Math.max(r,t.startPTS);r=Math.min(r,t.startPTS);u=Math.min(i,t.endPTS);i=Math.max(i,t.endPTS);n=Math.min(n,t.startDTS);s=Math.max(s,t.endDTS)}var d=r-t.start;t.start=t.startPTS=r;t.maxStartPTS=o;t.endPTS=i;t.minEndPTS=u;t.startDTS=n;t.endDTS=s;t.duration=i-r;var f=t.sn;if(!e||f<e.startSN||f>e.endSN){return 0}var c,h,p;c=f-e.startSN;h=e.fragments;h[c]=t;for(p=c;p>0;p--){pe(h,p,p-1)}for(p=c;p<h.length-1;p++){pe(h,p,p+1)}e.PTSKnown=true;return d}function me(e,t){if(t.initSegment&&e.initSegment){t.initSegment=e.initSegment}var r=0;var i;ye(e,t,(function(e,n){r=e.cc-n.cc;if(Object(a["isFiniteNumber"])(e.startPTS)){n.start=n.startPTS=e.startPTS;n.endPTS=e.endPTS;n.duration=e.duration;n.backtracked=e.backtracked;n.dropped=e.dropped;i=n}t.PTSKnown=true}));if(!t.PTSKnown){return}if(r){o["logger"].log("discontinuity sliding from playlist, take drift into account");var n=t.fragments;for(var s=0;s<n.length;s++){n[s].cc+=r}}if(i){ve(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS)}else{_e(e,t)}t.PTSKnown=e.PTSKnown}function ge(e,t,r){if(r===void 0){r=0}var i=-1;ye(e,t,(function(e,t,r){t.start=e.start;i=r}));var n=t.fragments;if(i<0){n.forEach((function(e){e.start+=r}));return}for(var a=i+1;a<n.length;a++){n[a].start=n[a-1].start+n[a-1].duration}}function ye(e,t,r){if(!e||!t){return}var i=Math.max(e.startSN,t.startSN)-t.startSN;var n=Math.min(e.endSN,t.endSN)-t.startSN;var a=t.startSN-e.startSN;for(var s=i;s<=n;s++){var o=e.fragments[a+s];var u=t.fragments[s];if(!o||!u){break}r(o,u,s)}}function _e(e,t){var r=t.startSN-e.startSN;var i=e.fragments;var n=t.fragments;if(r<0||r>i.length){return}for(var a=0;a<n.length;a++){n[a].start+=i[r].start}}function be(e,t,r){var i=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration);var n=i/2;if(e&&t.endSN===e.endSN){i=n}if(r){i=Math.max(n,i-(window.performance.now()-r))}return Math.round(i)}var Te={toString:function e(t){var r="";var i=t.length;for(var n=0;n<i;n++){r+="["+t.start(n).toFixed(3)+","+t.end(n).toFixed(3)+"]"}return r}};var Se=Te;function we(e,t){var r=null;for(var i=0;i<e.length;i+=1){var n=e[i];if(n&&n.cc===t){r=n;break}}return r}function Ee(e,t){return ee.search(e,(function(e){if(e.cc<t){return 1}else if(e.cc>t){return-1}else{return 0}}))}function ke(e,t,r){var i=false;if(t&&t.details&&r){if(r.endCC>r.startCC||e&&e.cc<r.startCC){i=true}}return i}function Ae(e,t){var r=e.fragments;var i=t.fragments;if(!i.length||!r.length){o["logger"].log("No fragments to align");return}var n=we(r,i[0].cc);if(!n||n&&!n.startPTS){o["logger"].log("No frag in previous level to align on");return}return n}function Ce(e,t){t.fragments.forEach((function(t){if(t){var r=t.start+e;t.start=t.startPTS=r;t.endPTS=r+t.duration}}));t.PTSKnown=true}function Ie(e,t,r){De(e,r,t);if(!r.PTSKnown&&t){xe(r,t.details)}}function De(e,t,r){if(ke(e,r,t)){var i=Ae(r.details,t);if(i){o["logger"].log("Adjusting PTS using last level due to CC increase within current level");Ce(i.start,t)}}}function xe(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime){return}var r=t.fragments[0].programDateTime;var i=e.fragments[0].programDateTime;var n=(i-r)/1e3+t.fragments[0].start;if(Object(a["isFiniteNumber"])(n)){o["logger"].log("adjusting PTS using programDateTime delta, sliding:"+n.toFixed(3));Ce(n,e)}}}function Le(e,t,r){if(t===null||!Array.isArray(e)||!e.length||!Object(a["isFiniteNumber"])(t)){return null}var i=e[0].programDateTime;if(t<(i||0)){return null}var n=e[e.length-1].endProgramDateTime;if(t>=(n||0)){return null}r=r||0;for(var s=0;s<e.length;++s){var o=e[s];if(Re(t,r,o)){return o}}return null}function Oe(e,t,r,i){if(r===void 0){r=0}if(i===void 0){i=0}var n=null;if(e){n=t[e.sn-t[0].sn+1]}else if(r===0&&t[0].start===0){n=t[0]}if(n&&Pe(r,i,n)===0){return n}var a=ee.search(t,Pe.bind(null,r,i));if(a){return a}return n}function Pe(e,t,r){if(e===void 0){e=0}if(t===void 0){t=0}var i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));if(r.start+r.duration-i<=e){return 1}else if(r.start-i>e&&r.start){return-1}return 0}function Re(e,t,r){var i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0))*1e3;var n=r.endProgramDateTime||0;return n-i>e}var Ue=250;var Me=2;var Ne=.1;var Be=.05;var Fe=function(){function e(e,t,r,i){this.config=e;this.media=t;this.fragmentTracker=r;this.hls=i;this.nudgeRetry=0;this.stallReported=false;this.stalled=null;this.moved=false;this.seeking=false}var t=e.prototype;t.poll=function e(t){var r=this.config,i=this.media,n=this.stalled;var a=i.currentTime,s=i.seeking;var u=this.seeking&&!s;var l=!this.seeking&&s;this.seeking=s;if(a!==t){this.moved=true;if(n!==null){if(this.stallReported){var d=self.performance.now()-n;o["logger"].warn("playback not stuck anymore @"+a+", after "+Math.round(d)+"ms");this.stallReported=false}this.stalled=null;this.nudgeRetry=0}return}if(l||u){this.stalled=null}if(i.paused||i.ended||i.playbackRate===0||!i.buffered.length){return}var f=te.bufferInfo(i,a,0);var c=f.len>0;var h=f.nextStart||0;if(!c&&!h){return}if(s){var p=f.len>Me;var v=!h||h-a>Me&&!this.fragmentTracker.getPartialFragment(a);if(p||v){return}this.moved=false}if(!this.moved&&this.stalled){var m=Math.max(h,f.start||0)-a;if(m>0&&m<=Me){this._trySkipBufferHole(null);return}}var g=self.performance.now();if(n===null){this.stalled=g;return}var y=g-n;if(!s&&y>=Ue){this._reportStall(f.len)}var _=te.bufferInfo(i,a,r.maxBufferHole);this._tryFixBufferStall(_,y)};t._tryFixBufferStall=function e(t,r){var i=this.config,n=this.fragmentTracker,a=this.media;var s=a.currentTime;var u=n.getPartialFragment(s);if(u){var l=this._trySkipBufferHole(u);if(l){return}}if(t.len>i.maxBufferHole&&r>i.highBufferWatchdogPeriod*1e3){o["logger"].warn("Trying to nudge playhead over buffer-hole");this.stalled=null;this._tryNudgeBuffer()}};t._reportStall=function e(t){var r=this.hls,i=this.media,a=this.stallReported;if(!a){this.stallReported=true;o["logger"].warn("Playback stalling at @"+i.currentTime+" due to low buffer (buffer="+t+")");r.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].BUFFER_STALLED_ERROR,fatal:false,buffer:t})}};t._trySkipBufferHole=function e(t){var r=this.config,i=this.hls,a=this.media;var u=a.currentTime;var l=0;for(var d=0;d<a.buffered.length;d++){var f=a.buffered.start(d);if(u+r.maxBufferHole>=l&&u<f){var c=Math.max(f+Be,a.currentTime+Ne);o["logger"].warn("skipping hole, adjusting currentTime from "+u+" to "+c);this.moved=true;this.stalled=null;a.currentTime=c;if(t){i.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].BUFFER_SEEK_OVER_HOLE,fatal:false,reason:"fragment loaded with buffer holes, seeking from "+u+" to "+c,frag:t})}return c}l=a.buffered.end(d)}return 0};t._tryNudgeBuffer=function e(){var t=this.config,r=this.hls,i=this.media;var a=i.currentTime;var u=(this.nudgeRetry||0)+1;this.nudgeRetry=u;if(u<t.nudgeMaxRetry){var l=a+u*t.nudgeOffset;o["logger"].warn("Nudging 'currentTime' from "+a+" to "+l);i.currentTime=l;r.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].BUFFER_NUDGE_ON_STALL,fatal:false})}else{o["logger"].error("Playhead still not moving while enough data buffered @"+a+" after "+t.nudgeMaxRetry+" nudges");r.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].BUFFER_STALLED_ERROR,fatal:true})}};return e}();function je(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function qe(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var He=function(e){qe(t,e);function t(t){var r;for(var i=arguments.length,n=new Array(i>1?i-1:0),a=1;a<i;a++){n[a-1]=arguments[a]}r=e.call.apply(e,[this,t].concat(n))||this;r._boundTick=void 0;r._tickTimer=null;r._tickInterval=null;r._tickCallCount=0;r._boundTick=r.tick.bind(je(r));return r}var r=t.prototype;r.onHandlerDestroying=function e(){this.clearNextTick();this.clearInterval()};r.hasInterval=function e(){return!!this._tickInterval};r.hasNextTick=function e(){return!!this._tickTimer};r.setInterval=function e(t){if(!this._tickInterval){this._tickInterval=self.setInterval(this._boundTick,t);return true}return false};r.clearInterval=function e(){if(this._tickInterval){self.clearInterval(this._tickInterval);this._tickInterval=null;return true}return false};r.clearNextTick=function e(){if(this._tickTimer){self.clearTimeout(this._tickTimer);this._tickTimer=null;return true}return false};r.tick=function e(){this._tickCallCount++;if(this._tickCallCount===1){this.doTick();if(this._tickCallCount>1){this.clearNextTick();this._tickTimer=self.setTimeout(this._boundTick,0)}this._tickCallCount=0}};r.doTick=function e(){};return t}(d);function Ge(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Ve={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};var We=function(e){Ge(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.doTick=function e(){};r.startLoad=function e(){};r.stopLoad=function e(){var t=this.fragCurrent;if(t){if(t.loader){t.loader.abort()}this.fragmentTracker.removeFragment(t)}if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.fragCurrent=null;this.fragPrevious=null;this.clearInterval();this.clearNextTick();this.state=Ve.STOPPED};r._streamEnded=function e(t,r){var i=this.fragCurrent,n=this.fragmentTracker;if(!r.live&&i&&!i.backtracked&&i.sn===r.endSN&&!t.nextStart){var a=n.getState(i);return a===$.PARTIAL||a===$.OK}return false};r.onMediaSeeking=function e(){var t=this.config,r=this.media,i=this.mediaBuffer,n=this.state;var s=r?r.currentTime:null;var u=te.bufferInfo(i||r,s,this.config.maxBufferHole);o["logger"].log("media seeking to "+(Object(a["isFiniteNumber"])(s)?s.toFixed(3):s));if(n===Ve.FRAG_LOADING){var l=this.fragCurrent;if(u.len===0&&l){var d=t.maxFragLookUpTolerance;var f=l.start-d;var c=l.start+l.duration+d;if(s<f||s>c){if(l.loader){o["logger"].log("seeking outside of buffer while fragment load in progress, cancel fragment load");l.loader.abort()}this.fragCurrent=null;this.fragPrevious=null;this.state=Ve.IDLE}else{o["logger"].log("seeking outside of buffer but within currently loaded fragment range")}}}else if(n===Ve.ENDED){if(u.len===0){this.fragPrevious=null;this.fragCurrent=null}this.state=Ve.IDLE}if(r){this.lastCurrentTime=s}if(!this.loadedmetadata){this.nextLoadPosition=this.startPosition=s}this.tick()};r.onMediaEnded=function e(){this.startPosition=this.lastCurrentTime=0};r.onHandlerDestroying=function t(){this.stopLoad();e.prototype.onHandlerDestroying.call(this)};r.onHandlerDestroyed=function e(){this.state=Ve.STOPPED;this.fragmentTracker=null};r.computeLivePosition=function e(t,r){var i=this.config.liveSyncDuration!==undefined?this.config.liveSyncDuration:this.config.liveSyncDurationCount*r.targetduration;return t+Math.max(0,r.totalduration-i)};return t}(He);function ze(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function Ke(e,t,r){if(t)ze(e.prototype,t);if(r)ze(e,r);return e}function Xe(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Ye=100;var Qe=function(e){Xe(t,e);function t(t,r){var i;i=e.call(this,t,s["default"].MEDIA_ATTACHED,s["default"].MEDIA_DETACHING,s["default"].MANIFEST_LOADING,s["default"].MANIFEST_PARSED,s["default"].LEVEL_LOADED,s["default"].LEVELS_UPDATED,s["default"].KEY_LOADED,s["default"].FRAG_LOADED,s["default"].FRAG_LOAD_EMERGENCY_ABORTED,s["default"].FRAG_PARSING_INIT_SEGMENT,s["default"].FRAG_PARSING_DATA,s["default"].FRAG_PARSED,s["default"].ERROR,s["default"].AUDIO_TRACK_SWITCHING,s["default"].AUDIO_TRACK_SWITCHED,s["default"].BUFFER_CREATED,s["default"].BUFFER_APPENDED,s["default"].BUFFER_FLUSHED)||this;i.fragmentTracker=r;i.config=t.config;i.audioCodecSwap=false;i._state=Ve.STOPPED;i.stallReported=false;i.gapController=null;i.altAudio=false;i.audioOnly=false;i.bitrateTest=false;return i}var r=t.prototype;r.startLoad=function e(t){if(this.levels){var r=this.lastCurrentTime,i=this.hls;this.stopLoad();this.setInterval(Ye);this.level=-1;this.fragLoadError=0;if(!this.startFragRequested){var n=i.startLevel;if(n===-1){if(i.config.testBandwidth){n=0;this.bitrateTest=true}else{n=i.nextAutoLevel}}this.level=i.nextLoadLevel=n;this.loadedmetadata=false}if(r>0&&t===-1){o["logger"].log("override startPosition with lastCurrentTime @"+r.toFixed(3));t=r}this.state=Ve.IDLE;this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t;this.tick()}else{this.forceStartLoad=true;this.state=Ve.STOPPED}};r.stopLoad=function t(){this.forceStartLoad=false;e.prototype.stopLoad.call(this)};r.doTick=function e(){switch(this.state){case Ve.BUFFER_FLUSHING:this.fragLoadError=0;break;case Ve.IDLE:this._doTickIdle();break;case Ve.WAITING_LEVEL:var t=this.levels[this.level];if(t&&t.details){this.state=Ve.IDLE}break;case Ve.FRAG_LOADING_WAITING_RETRY:var r=window.performance.now();var i=this.retryDate;if(!i||r>=i||this.media&&this.media.seeking){o["logger"].log("mediaController: retryDate reached, switch back to IDLE state");this.state=Ve.IDLE}break;case Ve.ERROR:case Ve.STOPPED:case Ve.FRAG_LOADING:case Ve.PARSING:case Ve.PARSED:case Ve.ENDED:break;default:break}this._checkBuffer();this._checkFragmentChanged()};r._doTickIdle=function e(){var t=this.hls,r=t.config,i=this.media;if(this.levelLastLoaded===undefined||!i&&(this.startFragRequested||!r.startFragPrefetch)){return}if(this.altAudio&&this.audioOnly){this.demuxer.frag=null;return}var n;if(this.loadedmetadata){n=i.currentTime}else{n=this.nextLoadPosition}var a=t.nextLoadLevel,u=this.levels[a];if(!u){return}var l=u.bitrate,d;if(l){d=Math.max(8*r.maxBufferSize/l,r.maxBufferLength)}else{d=r.maxBufferLength}d=Math.min(d,r.maxMaxBufferLength);var f=n<r.maxBufferHole?Math.max(Me,r.maxBufferHole):r.maxBufferHole;var c=te.bufferInfo(this.mediaBuffer?this.mediaBuffer:i,n,f);var h=c.len;if(h>=d){return}o["logger"].trace("buffer length of "+h.toFixed(3)+" is below max of "+d.toFixed(3)+". checking for more payload ...");this.level=t.nextLoadLevel=a;var p=u.details;if(!p||p.live&&this.levelLastLoaded!==a){this.state=Ve.WAITING_LEVEL;return}if(this._streamEnded(c,p)){var v={};if(this.altAudio){v.type="video"}this.hls.trigger(s["default"].BUFFER_EOS,v);this.state=Ve.ENDED;return}this._fetchPayloadOrEos(n,c,p)};r._fetchPayloadOrEos=function e(t,r,i){var n=this.fragPrevious,a=this.level,s=i.fragments,u=s.length;if(u===0){return}var l=s[0].start,d=s[u-1].start+s[u-1].duration,f=r.end,c;if(i.initSegment&&!i.initSegment.data){c=i.initSegment}else{if(i.live){var h=this.config.initialLiveManifestSize;if(u<h){o["logger"].warn("Can not start playback of a level, reason: not enough fragments "+u+" < "+h);return}c=this._ensureFragmentAtLivePoint(i,f,l,d,n,s);if(c===null){return}}else{if(f<l){c=s[0]}}}if(!c){c=this._findFragment(l,n,u,s,f,d,i)}if(c){if(c.encrypted){this._loadKey(c,i)}else{this._loadFragment(c,i,t,f)}}};r._ensureFragmentAtLivePoint=function e(t,r,i,n,s,u){var l=this.hls.config,d=this.media;var f;var c=Infinity;if(l.liveMaxLatencyDuration!==undefined){c=l.liveMaxLatencyDuration}else if(Object(a["isFiniteNumber"])(l.liveMaxLatencyDurationCount)){c=l.liveMaxLatencyDurationCount*t.targetduration}if(r<Math.max(i-l.maxFragLookUpTolerance,n-c)){var h=this.liveSyncPosition=this.computeLivePosition(i,t);r=h;if(d&&!d.paused&&d.readyState&&d.duration>h&&h>d.currentTime){o["logger"].log("buffer end: "+r.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3));d.currentTime=h}this.nextLoadPosition=h}if(t.PTSKnown&&r>n&&d&&d.readyState){return null}if(this.startFragRequested&&!t.PTSKnown){if(s){if(t.hasProgramDateTime){o["logger"].log("live playlist, switching playlist, load frag with same PDT: "+s.programDateTime);f=Le(u,s.endProgramDateTime,l.maxFragLookUpTolerance)}else{var p=s.sn+1;if(p>=t.startSN&&p<=t.endSN){var v=u[p-t.startSN];if(s.cc===v.cc){f=v;o["logger"].log("live playlist, switching playlist, load frag with next SN: "+f.sn)}}if(!f){f=ee.search(u,(function(e){return s.cc-e.cc}));if(f){o["logger"].log("live playlist, switching playlist, load frag with same CC: "+f.sn)}}}}}return f};r._findFragment=function e(t,r,i,n,a,s,u){var l=this.hls.config;var d;if(a<s){var f=a>s-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance;d=Oe(r,n,a,f)}else{d=n[i-1]}if(d){var c=d.sn-u.startSN;var h=r&&d.level===r.level;var p=n[c-1];var v=n[c+1];if(r&&d.sn===r.sn){if(h&&!d.backtracked){if(d.sn<u.endSN){var m=r.deltaPTS;if(m&&m>l.maxBufferHole&&r.dropped&&c){d=p;o["logger"].warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")}else{d=v;if(this.fragmentTracker.getState(d)!==$.OK){o["logger"].log("Re-loading fragment with SN: "+d.sn)}}}else{d=null}}else if(d.backtracked){if(v&&v.backtracked){o["logger"].warn("Already backtracked from fragment "+v.sn+", will not backtrack to fragment "+d.sn+". Loading fragment "+v.sn);d=v}else{o["logger"].warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe");d.dropped=0;if(p){d=p;d.backtracked=true}else if(c){d=null}}}}}return d};r._loadKey=function e(t,r){o["logger"].log("Loading key for "+t.sn+" of ["+r.startSN+"-"+r.endSN+"], level "+this.level);this.state=Ve.KEY_LOADING;this.hls.trigger(s["default"].KEY_LOADING,{frag:t})};r._loadFragment=function e(t,r,i,n){var u=this.fragmentTracker.getState(t);this.fragCurrent=t;if(t.sn!=="initSegment"){this.startFragRequested=true}if(Object(a["isFiniteNumber"])(t.sn)&&!t.bitrateTest){this.nextLoadPosition=t.start+t.duration}if(t.backtracked||u===$.NOT_LOADED||u===$.PARTIAL){t.autoLevel=this.hls.autoLevelEnabled;t.bitrateTest=this.bitrateTest;o["logger"].log("Loading "+t.sn+" of ["+r.startSN+"-"+r.endSN+"], level "+this.level+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+parseFloat(i.toFixed(3))+", bufferEnd: "+parseFloat(n.toFixed(3)));this.hls.trigger(s["default"].FRAG_LOADING,{frag:t});if(!this.demuxer){this.demuxer=new ce(this.hls,"main")}this.state=Ve.FRAG_LOADING}else if(u===$.APPENDING){if(this._reduceMaxBufferLength(t.duration)){this.fragmentTracker.removeFragment(t)}}};r.getBufferedFrag=function e(t){return this.fragmentTracker.getBufferedFrag(t,c.MAIN)};r.followingBufferedFrag=function e(t){if(t){return this.getBufferedFrag(t.endPTS+.5)}return null};r._checkFragmentChanged=function e(){var t,r,i=this.media;if(i&&i.readyState&&i.seeking===false){r=i.currentTime;if(r>this.lastCurrentTime){this.lastCurrentTime=r}if(te.isBuffered(i,r)){t=this.getBufferedFrag(r)}else if(te.isBuffered(i,r+.1)){t=this.getBufferedFrag(r+.1)}if(t){var n=t;if(n!==this.fragPlaying){this.hls.trigger(s["default"].FRAG_CHANGED,{frag:n});var a=n.level;if(!this.fragPlaying||this.fragPlaying.level!==a){this.hls.trigger(s["default"].LEVEL_SWITCHED,{level:a})}this.fragPlaying=n}}}};r.immediateLevelSwitch=function e(){o["logger"].log("immediateLevelSwitch");if(!this.immediateSwitch){this.immediateSwitch=true;var t=this.media,r;if(t){r=t.paused;if(!r){t.pause()}}else{r=true}this.previouslyPaused=r}var i=this.fragCurrent;if(i&&i.loader){i.loader.abort()}this.fragCurrent=null;this.flushMainBuffer(0,Number.POSITIVE_INFINITY)};r.immediateLevelSwitchEnd=function e(){var t=this.media;if(t&&t.buffered.length){this.immediateSwitch=false;if(t.currentTime>0&&te.isBuffered(t,t.currentTime)){t.currentTime-=1e-4}if(!this.previouslyPaused){t.play()}}};r.nextLevelSwitch=function e(){var t=this.media;if(t&&t.readyState){var r;var i=this.getBufferedFrag(t.currentTime);if(i&&i.startPTS>1){this.flushMainBuffer(0,i.startPTS-1)}if(!t.paused){var n=this.hls.nextLoadLevel,a=this.levels[n],s=this.fragLastKbps;if(s&&this.fragCurrent){r=this.fragCurrent.duration*a.bitrate/(1e3*s)+1}else{r=0}}else{r=0}var o=this.getBufferedFrag(t.currentTime+r);if(o){var u=this.followingBufferedFrag(o);if(u){var l=this.fragCurrent;if(l&&l.loader){l.loader.abort()}this.fragCurrent=null;var d=Math.max(o.endPTS,u.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,u.duration));this.flushMainBuffer(d,Number.POSITIVE_INFINITY)}}}};r.flushMainBuffer=function e(t,r){this.state=Ve.BUFFER_FLUSHING;var i={startOffset:t,endOffset:r};if(this.altAudio){i.type="video"}this.hls.trigger(s["default"].BUFFER_FLUSHING,i)};r.onMediaAttached=function e(t){var r=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvseeked=this.onMediaSeeked.bind(this);this.onvended=this.onMediaEnded.bind(this);r.addEventListener("seeking",this.onvseeking);r.addEventListener("seeked",this.onvseeked);r.addEventListener("ended",this.onvended);var i=this.config;if(this.levels&&i.autoStartLoad){this.hls.startLoad(i.startPosition)}this.gapController=new Fe(i,r,this.fragmentTracker,this.hls)};r.onMediaDetaching=function e(){var t=this.media;if(t&&t.ended){o["logger"].log("MSE detaching and video ended, reset startPosition");this.startPosition=this.lastCurrentTime=0}var r=this.levels;if(r){r.forEach((function(e){if(e.details){e.details.fragments.forEach((function(e){e.backtracked=undefined}))}}))}if(t){t.removeEventListener("seeking",this.onvseeking);t.removeEventListener("seeked",this.onvseeked);t.removeEventListener("ended",this.onvended);this.onvseeking=this.onvseeked=this.onvended=null}this.fragmentTracker.removeAllFragments();this.media=this.mediaBuffer=null;this.loadedmetadata=false;this.stopLoad()};r.onMediaSeeked=function e(){var t=this.media;var r=t?t.currentTime:undefined;if(Object(a["isFiniteNumber"])(r)){o["logger"].log("media seeked to "+r.toFixed(3))}this.tick()};r.onManifestLoading=function e(){o["logger"].log("trigger BUFFER_RESET");this.hls.trigger(s["default"].BUFFER_RESET);this.fragmentTracker.removeAllFragments();this.stalled=false;this.startPosition=this.lastCurrentTime=0};r.onManifestParsed=function e(t){var r=false,i=false,n;t.levels.forEach((function(e){n=e.audioCodec;if(n){if(n.indexOf("mp4a.40.2")!==-1){r=true}if(n.indexOf("mp4a.40.5")!==-1){i=true}}}));this.audioCodecSwitch=r&&i;if(this.audioCodecSwitch){o["logger"].log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC")}this.altAudio=t.altAudio;this.levels=t.levels;this.startFragRequested=false;var a=this.config;if(a.autoStartLoad||this.forceStartLoad){this.hls.startLoad(a.startPosition)}};r.onLevelLoaded=function e(t){var r=t.details;var i=t.level;var n=this.levels[this.levelLastLoaded];var u=this.levels[i];var l=r.totalduration;var d=0;o["logger"].log("level "+i+" loaded ["+r.startSN+","+r.endSN+"],duration:"+l);if(r.live||u.details&&u.details.live){var f=u.details;if(f&&r.fragments.length>0){me(f,r);d=r.fragments[0].start;this.liveSyncPosition=this.computeLivePosition(d,f);if(r.PTSKnown&&Object(a["isFiniteNumber"])(d)){o["logger"].log("live playlist sliding:"+d.toFixed(3))}else{o["logger"].log("live playlist - outdated PTS, unknown sliding");Ie(this.fragPrevious,n,r)}}else{o["logger"].log("live playlist - first load, unknown sliding");r.PTSKnown=false;Ie(this.fragPrevious,n,r)}}else{r.PTSKnown=false}u.details=r;this.levelLastLoaded=i;this.hls.trigger(s["default"].LEVEL_UPDATED,{details:r,level:i});if(this.startFragRequested===false){if(this.startPosition===-1||this.lastCurrentTime===-1){var c=r.startTimeOffset;if(Object(a["isFiniteNumber"])(c)){if(c<0){o["logger"].log("negative start time offset "+c+", count from end of last fragment");c=d+l+c}o["logger"].log("start time offset found in playlist, adjust startPosition to "+c);this.startPosition=c}else{if(r.live){this.startPosition=this.computeLivePosition(d,r);o["logger"].log("configure startPosition to "+this.startPosition)}else{this.startPosition=0}}this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}if(this.state===Ve.WAITING_LEVEL){this.state=Ve.IDLE}this.tick()};r.onKeyLoaded=function e(){if(this.state===Ve.KEY_LOADING){this.state=Ve.IDLE;this.tick()}};r.onFragLoaded=function e(t){var r=this.fragCurrent,i=this.hls,n=this.levels,a=this.media;var u=t.frag;if(this.state===Ve.FRAG_LOADING&&r&&u.type==="main"&&u.level===r.level&&u.sn===r.sn){var l=t.stats;var d=n[r.level];var f=d.details;this.bitrateTest=false;this.stats=l;o["logger"].log("Loaded "+r.sn+" of ["+f.startSN+" ,"+f.endSN+"],level "+r.level);if(u.bitrateTest&&i.nextLoadLevel){this.state=Ve.IDLE;this.startFragRequested=false;l.tparsed=l.tbuffered=window.performance.now();i.trigger(s["default"].FRAG_BUFFERED,{stats:l,frag:r,id:"main"});this.tick()}else if(u.sn==="initSegment"){this.state=Ve.IDLE;l.tparsed=l.tbuffered=window.performance.now();f.initSegment.data=t.payload;i.trigger(s["default"].FRAG_BUFFERED,{stats:l,frag:r,id:"main"});this.tick()}else{o["logger"].log("Parsing "+r.sn+" of ["+f.startSN+" ,"+f.endSN+"],level "+r.level+", cc "+r.cc);this.state=Ve.PARSING;this.pendingBuffering=true;this.appended=false;if(u.bitrateTest){u.bitrateTest=false;this.fragmentTracker.onFragLoaded({frag:u})}var c=!(a&&a.seeking)&&(f.PTSKnown||!f.live);var h=f.initSegment?f.initSegment.data:[];var p=this._getAudioCodec(d);var v=this.demuxer=this.demuxer||new ce(this.hls,"main");v.push(t.payload,h,p,d.videoCodec,r,f.totalduration,c)}}this.fragLoadError=0};r.onFragParsingInitSegment=function e(t){var r=this.fragCurrent;var i=t.frag;if(r&&t.id==="main"&&i.sn===r.sn&&i.level===r.level&&this.state===Ve.PARSING){var n=t.tracks,a,u;this.audioOnly=n.audio&&!n.video;if(this.altAudio&&!this.audioOnly){delete n.audio}u=n.audio;if(u){var l=this.levels[this.level].audioCodec,d=navigator.userAgent.toLowerCase();if(l&&this.audioCodecSwap){o["logger"].log("swapping playlist audio codec");if(l.indexOf("mp4a.40.5")!==-1){l="mp4a.40.2"}else{l="mp4a.40.5"}}if(this.audioCodecSwitch){if(u.metadata.channelCount!==1&&d.indexOf("firefox")===-1){l="mp4a.40.5"}}if(d.indexOf("android")!==-1&&u.container!=="audio/mpeg"){l="mp4a.40.2";o["logger"].log("Android: force audio codec to "+l)}u.levelCodec=l;u.id=t.id}u=n.video;if(u){u.levelCodec=this.levels[this.level].videoCodec;u.id=t.id}this.hls.trigger(s["default"].BUFFER_CODECS,n);for(a in n){u=n[a];o["logger"].log("main track:"+a+",container:"+u.container+",codecs[level/parsed]=["+u.levelCodec+"/"+u.codec+"]");var f=u.initSegment;if(f){this.appended=true;this.pendingBuffering=true;this.hls.trigger(s["default"].BUFFER_APPENDING,{type:a,data:f,parent:"main",content:"initSegment"})}}this.tick()}};r.onFragParsingData=function e(t){var r=this;var i=this.fragCurrent;var n=t.frag;if(i&&t.id==="main"&&n.sn===i.sn&&n.level===i.level&&!(t.type==="audio"&&this.altAudio)&&this.state===Ve.PARSING){var u=this.levels[this.level],l=i;if(!Object(a["isFiniteNumber"])(t.endPTS)){t.endPTS=t.startPTS+i.duration;t.endDTS=t.startDTS+i.duration}if(t.hasAudio===true){l.addElementaryStream(_.AUDIO)}if(t.hasVideo===true){l.addElementaryStream(_.VIDEO)}o["logger"].log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0));if(t.type==="video"){l.dropped=t.dropped;if(l.dropped){if(!l.backtracked){var d=u.details;if(d&&l.sn===d.startSN){o["logger"].warn("missing video frame(s) on first frag, appending with gap",l.sn)}else{o["logger"].warn("missing video frame(s), backtracking fragment",l.sn);this.fragmentTracker.removeFragment(l);l.backtracked=true;this.nextLoadPosition=t.startPTS;this.state=Ve.IDLE;this.fragPrevious=l;if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.tick();return}}else{o["logger"].warn("Already backtracked on this fragment, appending with the gap",l.sn)}}else{l.backtracked=false}}var f=ve(u.details,l,t.startPTS,t.endPTS,t.startDTS,t.endDTS),c=this.hls;c.trigger(s["default"].LEVEL_PTS_UPDATED,{details:u.details,level:this.level,drift:f,type:t.type,start:t.startPTS,end:t.endPTS});[t.data1,t.data2].forEach((function(e){if(e&&e.length&&r.state===Ve.PARSING){r.appended=true;r.pendingBuffering=true;c.trigger(s["default"].BUFFER_APPENDING,{type:t.type,data:e,parent:"main",content:"data"})}}));this.tick()}};r.onFragParsed=function e(t){var r=this.fragCurrent;var i=t.frag;if(r&&t.id==="main"&&i.sn===r.sn&&i.level===r.level&&this.state===Ve.PARSING){this.stats.tparsed=window.performance.now();this.state=Ve.PARSED;this._checkAppendedParsed()}};r.onAudioTrackSwitching=function e(t){var r=this.altAudio;var i=!!t.url;var n=t.id;if(!i){if(this.mediaBuffer!==this.media){o["logger"].log("switching on main audio, use media.buffered to schedule main fragment loading");this.mediaBuffer=this.media;var a=this.fragCurrent;if(a.loader){o["logger"].log("switching to main audio track, cancel main fragment load");a.loader.abort()}this.fragCurrent=null;this.fragPrevious=null;if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.state=Ve.IDLE}var u=this.hls;if(r){u.trigger(s["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}u.trigger(s["default"].AUDIO_TRACK_SWITCHED,{id:n})}};r.onAudioTrackSwitched=function e(t){var r=t.id,i=!!this.hls.audioTracks[r].url;if(i){var n=this.videoBuffer;if(n&&this.mediaBuffer!==n){o["logger"].log("switching on alternate audio, use video.buffered to schedule main fragment loading");this.mediaBuffer=n}}this.altAudio=i;this.tick()};r.onBufferCreated=function e(t){var r=t.tracks,i,n,a=false;for(var s in r){var u=r[s];if(u.id==="main"){n=s;i=u;if(s==="video"){this.videoBuffer=r[s].buffer}}else{a=true}}if(a&&i){o["logger"].log("alternate track found, use "+n+".buffered to schedule main fragment loading");this.mediaBuffer=i.buffer}else{this.mediaBuffer=this.media}};r.onBufferAppended=function e(t){if(t.parent==="main"){var r=this.state;if(r===Ve.PARSING||r===Ve.PARSED){this.pendingBuffering=t.pending>0;this._checkAppendedParsed()}}};r._checkAppendedParsed=function e(){if(this.state===Ve.PARSED&&(!this.appended||!this.pendingBuffering)){var t=this.fragCurrent;if(t){var r=this.mediaBuffer?this.mediaBuffer:this.media;o["logger"].log("main buffered : "+Se.toString(r.buffered));this.fragPrevious=t;var i=this.stats;i.tbuffered=window.performance.now();this.fragLastKbps=Math.round(8*i.total/(i.tbuffered-i.tfirst));this.hls.trigger(s["default"].FRAG_BUFFERED,{stats:i,frag:t,id:"main"});this.state=Ve.IDLE}if(this.loadedmetadata||this.startPosition<=0){this.tick()}}};r.onError=function e(t){var r=t.frag||this.fragCurrent;if(r&&r.type!=="main"){return}var i=!!this.media&&te.isBuffered(this.media,this.media.currentTime)&&te.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case n["ErrorDetails"].FRAG_LOAD_ERROR:case n["ErrorDetails"].FRAG_LOAD_TIMEOUT:case n["ErrorDetails"].KEY_LOAD_ERROR:case n["ErrorDetails"].KEY_LOAD_TIMEOUT:if(!t.fatal){if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var a=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);o["logger"].warn("mediaController: frag loading failed, retry in "+a+" ms");this.retryDate=window.performance.now()+a;if(!this.loadedmetadata){this.startFragRequested=false;this.nextLoadPosition=this.startPosition}this.fragLoadError++;this.state=Ve.FRAG_LOADING_WAITING_RETRY}else{o["logger"].error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ...");t.fatal=true;this.state=Ve.ERROR}}break;case n["ErrorDetails"].LEVEL_LOAD_ERROR:case n["ErrorDetails"].LEVEL_LOAD_TIMEOUT:if(this.state!==Ve.ERROR){if(t.fatal){this.state=Ve.ERROR;o["logger"].warn("streamController: "+t.details+",switch to "+this.state+" state ...")}else{if(!t.levelRetry&&this.state===Ve.WAITING_LEVEL){this.state=Ve.IDLE}}}break;case n["ErrorDetails"].BUFFER_FULL_ERROR:if(t.parent==="main"&&(this.state===Ve.PARSING||this.state===Ve.PARSED)){if(i){this._reduceMaxBufferLength(this.config.maxBufferLength);this.state=Ve.IDLE}else{o["logger"].warn("buffer full error also media.currentTime is not buffered, flush everything");this.fragCurrent=null;this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}}break;default:break}};r._reduceMaxBufferLength=function e(t){var r=this.config;if(r.maxMaxBufferLength>=t){r.maxMaxBufferLength/=2;o["logger"].warn("main:reduce max buffer length to "+r.maxMaxBufferLength+"s");return true}return false};r._checkBuffer=function e(){var t=this.media;if(!t||t.readyState===0){return}var r=this.mediaBuffer?this.mediaBuffer:t;var i=r.buffered;if(!this.loadedmetadata&&i.length){this.loadedmetadata=true;this._seekToStartPos()}else if(this.immediateSwitch){this.immediateLevelSwitchEnd()}else{this.gapController.poll(this.lastCurrentTime,i)}};r.onFragLoadEmergencyAborted=function e(){this.state=Ve.IDLE;if(!this.loadedmetadata){this.startFragRequested=false;this.nextLoadPosition=this.startPosition}this.tick()};r.onBufferFlushed=function e(){var t=this.mediaBuffer?this.mediaBuffer:this.media;if(t){var r=this.audioOnly?_.AUDIO:_.VIDEO;this.fragmentTracker.detectEvictedFragments(r,t.buffered)}this.state=Ve.IDLE;this.fragPrevious=null};r.onLevelsUpdated=function e(t){this.levels=t.levels};r.swapAudioCodec=function e(){this.audioCodecSwap=!this.audioCodecSwap};r._seekToStartPos=function e(){var t=this.media;var r=t.currentTime;var i=this.startPosition;if(r!==i&&i>=0){if(t.seeking){o["logger"].log("could not seek to "+i+", already seeking at "+r);return}var n=t.buffered.length?t.buffered.start(0):0;var a=n-i;if(a>0&&a<this.config.maxBufferHole){o["logger"].log("adjusting start position by "+a+" to match buffer start");i+=a;this.startPosition=i}o["logger"].log("seek to target start position "+i+" from current time "+r+". ready state "+t.readyState);t.currentTime=i}};r._getAudioCodec=function e(t){var r=this.config.defaultAudioCodec||t.audioCodec;if(this.audioCodecSwap){o["logger"].log("swapping playlist audio codec");if(r){if(r.indexOf("mp4a.40.5")!==-1){r="mp4a.40.2"}else{r="mp4a.40.5"}}}return r};Ke(t,[{key:"state",set:function e(t){if(this.state!==t){var r=this.state;this._state=t;o["logger"].log("main stream-controller: "+r+"->"+t);this.hls.trigger(s["default"].STREAM_STATE_TRANSITION,{previousState:r,nextState:t})}},get:function e(){return this._state}},{key:"currentLevel",get:function e(){var t=this.media;if(t){var r=this.getBufferedFrag(t.currentTime);if(r){return r.level}}return-1}},{key:"nextBufferedFrag",get:function e(){var t=this.media;if(t){return this.followingBufferedFrag(this.getBufferedFrag(t.currentTime))}else{return null}}},{key:"nextLevel",get:function e(){var t=this.nextBufferedFrag;if(t){return t.level}else{return-1}}},{key:"liveSyncPosition",get:function e(){return this._liveSyncPosition},set:function e(t){this._liveSyncPosition=t}}]);return t}(We);var $e=Qe;function Je(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function Ze(e,t,r){if(t)Je(e.prototype,t);if(r)Je(e,r);return e}function et(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var tt;var rt=function(e){et(t,e);function t(t){var r;r=e.call(this,t,s["default"].MANIFEST_LOADED,s["default"].LEVEL_LOADED,s["default"].AUDIO_TRACK_SWITCHED,s["default"].FRAG_LOADED,s["default"].ERROR)||this;r.canload=false;r.currentLevelIndex=null;r.manualLevelIndex=-1;r.timer=null;tt=/chrome|firefox/.test(navigator.userAgent.toLowerCase());return r}var r=t.prototype;r.onHandlerDestroying=function e(){this.clearTimer();this.manualLevelIndex=-1};r.clearTimer=function e(){if(this.timer!==null){clearTimeout(this.timer);this.timer=null}};r.startLoad=function e(){var t=this._levels;this.canload=true;this.levelRetryCount=0;if(t){t.forEach((function(e){e.loadError=0;var t=e.details;if(t&&t.live){e.details=undefined}}))}if(this.timer!==null){this.loadLevel()}};r.stopLoad=function e(){this.canload=false};r.onManifestLoaded=function e(t){var r=[];var i=[];var a;var u={};var l=null;var d=false;var f=false;t.levels.forEach((function(e){var t=e.attrs;e.loadError=0;e.fragmentError=false;d=d||!!e.videoCodec;f=f||!!e.audioCodec;if(tt&&e.audioCodec&&e.audioCodec.indexOf("mp4a.40.34")!==-1){e.audioCodec=undefined}l=u[e.bitrate];if(!l){e.url=[e.url];e.urlId=0;u[e.bitrate]=e;r.push(e)}else{l.url.push(e.url)}if(t){if(t.AUDIO){he(l||e,"audio",t.AUDIO)}if(t.SUBTITLES){he(l||e,"text",t.SUBTITLES)}}}));if(d&&f){r=r.filter((function(e){var t=e.videoCodec;return!!t}))}r=r.filter((function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||x(t,"audio"))&&(!r||x(r,"video"))}));if(t.audioTracks){i=t.audioTracks.filter((function(e){return!e.audioCodec||x(e.audioCodec,"audio")}));i.forEach((function(e,t){e.id=t}))}if(r.length>0){a=r[0].bitrate;r.sort((function(e,t){return e.bitrate-t.bitrate}));this._levels=r;for(var c=0;c<r.length;c++){if(r[c].bitrate===a){this._firstLevel=c;o["logger"].log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+a);break}}var h=f&&!d;this.hls.trigger(s["default"].MANIFEST_PARSED,{levels:r,audioTracks:i,firstLevel:this._firstLevel,stats:t.stats,audio:f,video:d,altAudio:!h&&i.some((function(e){return!!e.url}))})}else{this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:true,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})}};r.setLevelInternal=function e(t){var r=this._levels;var i=this.hls;if(t>=0&&t<r.length){this.clearTimer();if(this.currentLevelIndex!==t){o["logger"].log("switching to level "+t);this.currentLevelIndex=t;var a=r[t];a.level=t;i.trigger(s["default"].LEVEL_SWITCHING,a)}var u=r[t];var l=u.details;if(!l||l.live){var d=u.urlId;i.trigger(s["default"].LEVEL_LOADING,{url:u.url[d],level:t,id:d})}}else{i.trigger(s["default"].ERROR,{type:n["ErrorTypes"].OTHER_ERROR,details:n["ErrorDetails"].LEVEL_SWITCH_ERROR,level:t,fatal:false,reason:"invalid level idx"})}};r.onError=function e(t){if(t.fatal){if(t.type===n["ErrorTypes"].NETWORK_ERROR){this.clearTimer()}return}var r=false,i=false;var a;switch(t.details){case n["ErrorDetails"].FRAG_LOAD_ERROR:case n["ErrorDetails"].FRAG_LOAD_TIMEOUT:case n["ErrorDetails"].KEY_LOAD_ERROR:case n["ErrorDetails"].KEY_LOAD_TIMEOUT:a=t.frag.level;i=true;break;case n["ErrorDetails"].LEVEL_LOAD_ERROR:case n["ErrorDetails"].LEVEL_LOAD_TIMEOUT:a=t.context.level;r=true;break;case n["ErrorDetails"].REMUX_ALLOC_ERROR:a=t.level;r=true;break}if(a!==undefined){this.recoverLevel(t,a,r,i)}};r.recoverLevel=function e(t,r,i,n){var a=this;var s=this.hls.config;var u=t.details;var l=this._levels[r];var d,f,c;l.loadError++;l.fragmentError=n;if(i){if(this.levelRetryCount+1<=s.levelLoadingMaxRetry){f=Math.min(Math.pow(2,this.levelRetryCount)*s.levelLoadingRetryDelay,s.levelLoadingMaxRetryTimeout);this.timer=setTimeout((function(){return a.loadLevel()}),f);t.levelRetry=true;this.levelRetryCount++;o["logger"].warn("level controller, "+u+", retry in "+f+" ms, current retry count is "+this.levelRetryCount)}else{o["logger"].error("level controller, cannot recover from "+u+" error");this.currentLevelIndex=null;this.clearTimer();t.fatal=true;return}}if(i||n){d=l.url.length;if(d>1&&l.loadError<d){l.urlId=(l.urlId+1)%d;l.details=undefined;o["logger"].warn("level controller, "+u+" for level "+r+": switching to redundant URL-id "+l.urlId)}else{if(this.manualLevelIndex===-1){c=r===0?this._levels.length-1:r-1;o["logger"].warn("level controller, "+u+": switch to "+c);this.hls.nextAutoLevel=this.currentLevelIndex=c}else if(n){o["logger"].warn("level controller, "+u+": reload a fragment");this.currentLevelIndex=null}}}};r.onFragLoaded=function e(t){var r=t.frag;if(r!==undefined&&r.type==="main"){var i=this._levels[r.level];if(i!==undefined){i.fragmentError=false;i.loadError=0;this.levelRetryCount=0}}};r.onLevelLoaded=function e(t){var r=this;var i=t.level,n=t.details;if(i!==this.currentLevelIndex){return}var a=this._levels[i];if(!a.fragmentError){a.loadError=0;this.levelRetryCount=0}if(n.live){var s=be(a.details,n,t.stats.trequest);o["logger"].log("live playlist, reload in "+Math.round(s)+" ms");this.timer=setTimeout((function(){return r.loadLevel()}),s)}else{this.clearTimer()}};r.onAudioTrackSwitched=function e(t){var r=this.hls.audioTracks[t.id].groupId;var i=this.hls.levels[this.currentLevelIndex];if(!i){return}if(i.audioGroupIds){var n=-1;for(var a=0;a<i.audioGroupIds.length;a++){if(i.audioGroupIds[a]===r){n=a;break}}if(n!==i.urlId){i.urlId=n;this.startLoad()}}};r.loadLevel=function e(){o["logger"].debug("call to loadLevel");if(this.currentLevelIndex!==null&&this.canload){var t=this._levels[this.currentLevelIndex];if(typeof t==="object"&&t.url.length>0){var r=this.currentLevelIndex;var i=t.urlId;var n=t.url[i];o["logger"].log("Attempt loading level index "+r+" with URL-id "+i);this.hls.trigger(s["default"].LEVEL_LOADING,{url:n,level:r,id:i})}}};r.removeLevel=function e(t,r){var i=this.levels.filter((function(e,i){if(i!==t){return true}if(e.url.length>1&&r!==undefined){e.url=e.url.filter((function(e,t){return t!==r}));e.urlId=0;return true}return false})).map((function(e,t){var r=e.details;if(r&&r.fragments){r.fragments.forEach((function(e){e.level=t}))}return e}));this._levels=i;this.hls.trigger(s["default"].LEVELS_UPDATED,{levels:i})};Ze(t,[{key:"levels",get:function e(){return this._levels}},{key:"level",get:function e(){return this.currentLevelIndex},set:function e(t){var r=this._levels;if(r){t=Math.min(t,r.length-1);if(this.currentLevelIndex!==t||!r[t].details){this.setLevelInternal(t)}}}},{key:"manualLevel",get:function e(){return this.manualLevelIndex},set:function e(t){this.manualLevelIndex=t;if(this._startLevel===undefined){this._startLevel=t}if(t!==-1){this.level=t}}},{key:"firstLevel",get:function e(){return this._firstLevel},set:function e(t){this._firstLevel=t}},{key:"startLevel",get:function e(){if(this._startLevel===undefined){var t=this.hls.config.startLevel;if(t!==undefined){return t}else{return this._firstLevel}}else{return this._startLevel}},set:function e(t){this._startLevel=t}},{key:"nextLoadLevel",get:function e(){if(this.manualLevelIndex!==-1){return this.manualLevelIndex}else{return this.hls.nextAutoLevel}},set:function e(t){this.level=t;if(this.manualLevelIndex===-1){this.hls.nextAutoLevel=t}}}]);return t}(d);var it=r("./src/demux/id3.js");function nt(e,t){var r;try{r=new Event("addtrack")}catch(e){r=document.createEvent("Event");r.initEvent("addtrack",false,false)}r.track=e;t.dispatchEvent(r)}function at(e){if(e===null||e===void 0?void 0:e.cues){while(e.cues.length>0){e.removeCue(e.cues[0])}}}function st(e,t){if(t<e[0].endTime){return e[0]}if(t>e[e.length-1].endTime){return e[e.length-1]}var r=0;var i=e.length-1;while(r<=i){var n=Math.floor((i+r)/2);if(t<e[n].endTime){i=n-1}else if(t>e[n].endTime){r=n+1}else{return e[n]}}return e[r].endTime-t<t-e[i].endTime?e[r]:e[i]}function ot(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var ut=.25;var lt=function(e){ot(t,e);function t(t){var r;r=e.call(this,t,s["default"].MEDIA_ATTACHED,s["default"].MEDIA_DETACHING,s["default"].FRAG_PARSING_METADATA,s["default"].LIVE_BACK_BUFFER_REACHED)||this;r.id3Track=undefined;r.media=undefined;return r}var r=t.prototype;r.destroy=function e(){d.prototype.destroy.call(this)};r.onMediaAttached=function e(t){this.media=t.media;if(!this.media){}};r.onMediaDetaching=function e(){at(this.id3Track);this.id3Track=undefined;this.media=undefined};r.getID3Track=function e(t){for(var r=0;r<t.length;r++){var i=t[r];if(i.kind==="metadata"&&i.label==="id3"){nt(i,this.media);return i}}return this.media.addTextTrack("metadata","id3")};r.onFragParsingMetadata=function e(t){var r=t.frag;var i=t.samples;if(!this.id3Track){this.id3Track=this.getID3Track(this.media.textTracks);this.id3Track.mode="hidden"}var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue;for(var a=0;a<i.length;a++){var s=it["default"].getID3Frames(i[a].data);if(s){var o=Math.max(i[a].pts,0);var u=a<i.length-1?i[a+1].pts:r.endPTS;if(!u){u=r.start+r.duration}var l=u-o;if(l<=0){u=o+ut}for(var d=0;d<s.length;d++){var f=s[d];if(!it["default"].isTimeStampFrame(f)){var c=new n(o,u,"");c.value=f;this.id3Track.addCue(c)}}}}};r.onLiveBackBufferReached=function e(t){var r=t.bufferEnd;var i=this.id3Track;if(!i||!i.cues||!i.cues.length){return}var n=st(i.cues,r);if(!n){return}while(i.cues[0]!==n){i.removeCue(i.cues[0])}};return t}(d);var dt=lt;function ft(){var e=ae();if(!e){return false}var t=self.SourceBuffer||self.WebKitSourceBuffer;var r=e&&typeof e.isTypeSupported==="function"&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');var i=!t||t.prototype&&typeof t.prototype.appendBuffer==="function"&&typeof t.prototype.remove==="function";return!!r&&!!i}var ct=function(){function e(e){this.alpha_=void 0;this.estimate_=void 0;this.totalWeight_=void 0;this.alpha_=e?Math.exp(Math.log(.5)/e):0;this.estimate_=0;this.totalWeight_=0}var t=e.prototype;t.sample=function e(t,r){var i=Math.pow(this.alpha_,t);this.estimate_=r*(1-i)+i*this.estimate_;this.totalWeight_+=t};t.getTotalWeight=function e(){return this.totalWeight_};t.getEstimate=function e(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/t}else{return this.estimate_}};return e}();var ht=ct;var pt=function(){function e(e,t,r,i){this.hls=void 0;this.defaultEstimate_=void 0;this.minWeight_=void 0;this.minDelayMs_=void 0;this.slow_=void 0;this.fast_=void 0;this.hls=e;this.defaultEstimate_=i;this.minWeight_=.001;this.minDelayMs_=50;this.slow_=new ht(t);this.fast_=new ht(r)}var t=e.prototype;t.sample=function e(t,r){t=Math.max(t,this.minDelayMs_);var i=8*r,n=t/1e3,a=i/n;this.fast_.sample(n,a);this.slow_.sample(n,a)};t.canEstimate=function e(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_};t.getEstimate=function e(){if(this.canEstimate()){return Math.min(this.fast_.getEstimate(),this.slow_.getEstimate())}else{return this.defaultEstimate_}};t.destroy=function e(){};return e}();var vt=pt;function mt(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function gt(e,t,r){if(t)mt(e.prototype,t);if(r)mt(e,r);return e}function yt(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function _t(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var bt=window,Tt=bt.performance;var St=function(e){_t(t,e);function t(t){var r;r=e.call(this,t,s["default"].FRAG_LOADING,s["default"].FRAG_LOADED,s["default"].FRAG_BUFFERED,s["default"].ERROR)||this;r.lastLoadedFragLevel=0;r._nextAutoLevel=-1;r.hls=t;r.timer=null;r._bwEstimator=null;r.onCheck=r._abandonRulesCheck.bind(yt(r));return r}var r=t.prototype;r.destroy=function e(){this.clearTimer();d.prototype.destroy.call(this)};r.onFragLoading=function e(t){var r=t.frag;if(r.type==="main"){if(!this.timer){this.fragCurrent=r;this.timer=setInterval(this.onCheck,100)}if(!this._bwEstimator){var i=this.hls;var n=i.config;var a=r.level;var s=i.levels[a].details.live;var o;var u;if(s){o=n.abrEwmaFastLive;u=n.abrEwmaSlowLive}else{o=n.abrEwmaFastVoD;u=n.abrEwmaSlowVoD}this._bwEstimator=new vt(i,u,o,n.abrEwmaDefaultEstimate)}}};r._abandonRulesCheck=function e(){var t=this.hls;var r=t.media;var i=this.fragCurrent;if(!i){return}var n=i.loader;if(!n||n.stats&&n.stats.aborted){o["logger"].warn("frag loader destroy or aborted, disarm abandonRules");this.clearTimer();this._nextAutoLevel=-1;return}var a=n.stats;if(r&&a&&(!r.paused&&r.playbackRate!==0||!r.readyState)&&i.autoLevel&&i.level){var u=Tt.now()-a.trequest;var l=Math.abs(r.playbackRate);if(u>500*i.duration/l){var d=t.levels;var f=Math.max(1,a.bw?a.bw/8:a.loaded*1e3/u);var c=d[i.level];if(!c){return}var h=c.realBitrate?Math.max(c.realBitrate,c.bitrate):c.bitrate;var p=a.total?a.total:Math.max(a.loaded,Math.round(i.duration*h/8));var v=r.currentTime;var m=(p-a.loaded)/f;var g=(te.bufferInfo(r,v,t.config.maxBufferHole).end-v)/l;if(g<2*i.duration/l&&m>g){var y=t.minAutoLevel;var _;var b;for(b=i.level-1;b>y;b--){var T=d[b].realBitrate?Math.max(d[b].realBitrate,d[b].bitrate):d[b].bitrate;var S=i.duration*T/(8*.8*f);if(S<g){break}}if(_<m){o["logger"].warn("loading too slow, abort fragment loading and switch to level "+b+":fragLoadedDelay["+b+"]<fragLoadedDelay["+(i.level-1)+"];bufferStarvationDelay:"+_.toFixed(1)+"<"+m.toFixed(1)+":"+g.toFixed(1));t.nextLoadLevel=b;this._bwEstimator.sample(u,a.loaded);n.abort();this.clearTimer();t.trigger(s["default"].FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,stats:a})}}}}};r.onFragLoaded=function e(t){var r=t.frag;if(r.type==="main"&&Object(a["isFiniteNumber"])(r.sn)){this.clearTimer();this.lastLoadedFragLevel=r.level;this._nextAutoLevel=-1;if(this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[r.level];var n=(i.loaded?i.loaded.bytes:0)+t.stats.loaded;var s=(i.loaded?i.loaded.duration:0)+t.frag.duration;i.loaded={bytes:n,duration:s};i.realBitrate=Math.round(8*n/s)}if(t.frag.bitrateTest){var o=t.stats;o.tparsed=o.tbuffered=o.tload;this.onFragBuffered(t)}}};r.onFragBuffered=function e(t){var r=t.stats;var i=t.frag;if(r.aborted!==true&&i.type==="main"&&Object(a["isFiniteNumber"])(i.sn)&&(!i.bitrateTest||r.tload===r.tbuffered)){var n=r.tparsed-r.trequest;o["logger"].log("latency/loading/parsing/append/kbps:"+Math.round(r.tfirst-r.trequest)+"/"+Math.round(r.tload-r.tfirst)+"/"+Math.round(r.tparsed-r.tload)+"/"+Math.round(r.tbuffered-r.tparsed)+"/"+Math.round(8*r.loaded/(r.tbuffered-r.trequest)));this._bwEstimator.sample(n,r.loaded);r.bwEstimate=this._bwEstimator.getEstimate();if(i.bitrateTest){this.bitrateTestDelay=n/1e3}else{this.bitrateTestDelay=0}}};r.onError=function e(t){switch(t.details){case n["ErrorDetails"].FRAG_LOAD_ERROR:case n["ErrorDetails"].FRAG_LOAD_TIMEOUT:this.clearTimer();break;default:break}};r.clearTimer=function e(){clearInterval(this.timer);this.timer=null};r._findBestLevel=function e(t,r,i,n,a,s,u,l,d){for(var f=a;f>=n;f--){var c=d[f];if(!c){continue}var h=c.details;var p=h?h.totalduration/h.fragments.length:r;var v=h?h.live:false;var m=void 0;if(f<=t){m=u*i}else{m=l*i}var g=d[f].realBitrate?Math.max(d[f].realBitrate,d[f].bitrate):d[f].bitrate;var y=g*p/m;o["logger"].trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+f+"/"+Math.round(m)+"/"+g+"/"+p+"/"+s+"/"+y);if(m>g&&(!y||v&&!this.bitrateTestDelay||y<s)){return f}}return-1};gt(t,[{key:"nextAutoLevel",get:function e(){var t=this._nextAutoLevel;var r=this._bwEstimator;if(t!==-1&&(!r||!r.canEstimate())){return t}var i=this._nextABRAutoLevel;if(t!==-1){i=Math.min(t,i)}return i},set:function e(t){this._nextAutoLevel=t}},{key:"_nextABRAutoLevel",get:function e(){var t=this.hls;var r=t.maxAutoLevel,i=t.levels,n=t.config,a=t.minAutoLevel;var s=t.media;var u=this.lastLoadedFragLevel;var l=this.fragCurrent?this.fragCurrent.duration:0;var d=s?s.currentTime:0;var f=s&&s.playbackRate!==0?Math.abs(s.playbackRate):1;var c=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate;var h=(te.bufferInfo(s,d,n.maxBufferHole).end-d)/f;var p=this._findBestLevel(u,l,c,a,r,h,n.abrBandWidthFactor,n.abrBandWidthUpFactor,i);if(p>=0){return p}else{o["logger"].trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var v=l?Math.min(l,n.maxStarvationDelay):n.maxStarvationDelay;var m=n.abrBandWidthFactor;var g=n.abrBandWidthUpFactor;if(h===0){var y=this.bitrateTestDelay;if(y){var _=l?Math.min(l,n.maxLoadingDelay):n.maxLoadingDelay;v=_-y;o["logger"].trace("bitrate test took "+Math.round(1e3*y)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*v)+" ms");m=g=1}}p=this._findBestLevel(u,l,c,a,r,h+v,m,g,i);return Math.max(p,0)}}}]);return t}(d);var wt=St;function Et(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var kt=ae();var At=function(e){Et(t,e);function t(t){var r;r=e.call(this,t,s["default"].MEDIA_ATTACHING,s["default"].MEDIA_DETACHING,s["default"].MANIFEST_PARSED,s["default"].BUFFER_RESET,s["default"].BUFFER_APPENDING,s["default"].BUFFER_CODECS,s["default"].BUFFER_EOS,s["default"].BUFFER_FLUSHING,s["default"].LEVEL_PTS_UPDATED,s["default"].LEVEL_UPDATED)||this;r._msDuration=null;r._levelDuration=null;r._levelTargetDuration=10;r._live=null;r._objectUrl=null;r._needsFlush=false;r._needsEos=false;r.config=void 0;r.audioTimestampOffset=void 0;r.bufferCodecEventsExpected=0;r._bufferCodecEventsTotal=0;r.media=null;r.mediaSource=null;r.segments=[];r.parent=void 0;r.appending=false;r.appended=0;r.appendError=0;r.flushBufferCounter=0;r.tracks={};r.pendingTracks={};r.sourceBuffer={};r.flushRange=[];r._onMediaSourceOpen=function(){o["logger"].log("media source opened");r.hls.trigger(s["default"].MEDIA_ATTACHED,{media:r.media});var e=r.mediaSource;if(e){e.removeEventListener("sourceopen",r._onMediaSourceOpen)}r.checkPendingTracks()};r._onMediaSourceClose=function(){o["logger"].log("media source closed")};r._onMediaSourceEnded=function(){o["logger"].log("media source ended")};r._onSBUpdateEnd=function(){if(r.audioTimestampOffset&&r.sourceBuffer.audio){var e=r.sourceBuffer.audio;o["logger"].warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+r.audioTimestampOffset);e.timestampOffset=r.audioTimestampOffset;delete r.audioTimestampOffset}if(r._needsFlush){r.doFlush()}if(r._needsEos){r.checkEos()}r.appending=false;var t=r.parent;var i=r.segments.reduce((function(e,r){return r.parent===t?e+1:e}),0);var n={};var a=r.sourceBuffer;for(var u in a){var l=a[u];if(!l){throw Error("handling source buffer update end error: source buffer for "+u+" uninitilized and unable to update buffered TimeRanges.")}n[u]=l.buffered}r.hls.trigger(s["default"].BUFFER_APPENDED,{parent:t,pending:i,timeRanges:n});if(!r._needsFlush){r.doAppending()}r.updateMediaElementDuration();if(i===0){r.flushLiveBackBuffer()}};r._onSBUpdateError=function(e){o["logger"].error("sourceBuffer error:",e);r.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].BUFFER_APPENDING_ERROR,fatal:false})};r.config=t.config;return r}var r=t.prototype;r.destroy=function e(){d.prototype.destroy.call(this)};r.onLevelPtsUpdated=function e(t){var r=t.type;var i=this.tracks.audio;if(r==="audio"&&i&&i.container==="audio/mpeg"){var n=this.sourceBuffer.audio;if(!n){throw Error("Level PTS Updated and source buffer for audio uninitalized")}var a=Math.abs(n.timestampOffset-t.start);if(a>.1){var s=n.updating;try{n.abort()}catch(e){o["logger"].warn("can not abort audio buffer: "+e)}if(!s){o["logger"].warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+t.start);n.timestampOffset=t.start}else{this.audioTimestampOffset=t.start}}}};r.onManifestParsed=function e(t){var r=2;if(t.audio&&!t.video||!t.altAudio){r=1}this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r;o["logger"].log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")};r.onMediaAttaching=function e(t){var r=this.media=t.media;if(r&&kt){var i=this.mediaSource=new kt;i.addEventListener("sourceopen",this._onMediaSourceOpen);i.addEventListener("sourceended",this._onMediaSourceEnded);i.addEventListener("sourceclose",this._onMediaSourceClose);r.src=window.URL.createObjectURL(i);this._objectUrl=r.src}};r.onMediaDetaching=function e(){o["logger"].log("media source detaching");var t=this.mediaSource;if(t){if(t.readyState==="open"){try{t.endOfStream()}catch(e){o["logger"].warn("onMediaDetaching:"+e.message+" while calling endOfStream")}}t.removeEventListener("sourceopen",this._onMediaSourceOpen);t.removeEventListener("sourceended",this._onMediaSourceEnded);t.removeEventListener("sourceclose",this._onMediaSourceClose);if(this.media){if(this._objectUrl){window.URL.revokeObjectURL(this._objectUrl)}if(this.media.src===this._objectUrl){this.media.removeAttribute("src");this.media.load()}else{o["logger"].warn("media.src was changed by a third party - skip cleanup")}}this.mediaSource=null;this.media=null;this._objectUrl=null;this.bufferCodecEventsExpected=this._bufferCodecEventsTotal;this.pendingTracks={};this.tracks={};this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0}this.hls.trigger(s["default"].MEDIA_DETACHED)};r.checkPendingTracks=function e(){var t=this.bufferCodecEventsExpected,r=this.pendingTracks;var i=Object.keys(r).length;if(i&&!t||i===2){this.createSourceBuffers(r);this.pendingTracks={};this.doAppending()}};r.onBufferReset=function e(){var t=this.sourceBuffer;for(var r in t){var i=t[r];try{if(i){if(this.mediaSource){this.mediaSource.removeSourceBuffer(i)}i.removeEventListener("updateend",this._onSBUpdateEnd);i.removeEventListener("error",this._onSBUpdateError)}}catch(e){}}this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0};r.onBufferCodecs=function e(t){var r=this;if(Object.keys(this.sourceBuffer).length){return}Object.keys(t).forEach((function(e){r.pendingTracks[e]=t[e]}));this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0);if(this.mediaSource&&this.mediaSource.readyState==="open"){this.checkPendingTracks()}};r.createSourceBuffers=function e(t){var r=this.sourceBuffer,i=this.mediaSource;if(!i){throw Error("createSourceBuffers called when mediaSource was null")}for(var a in t){if(!r[a]){var u=t[a];if(!u){throw Error("source buffer exists for track "+a+", however track does not")}var l=u.levelCodec||u.codec;var d=u.container+";codecs="+l;o["logger"].log("creating sourceBuffer("+d+")");try{var f=r[a]=i.addSourceBuffer(d);f.addEventListener("updateend",this._onSBUpdateEnd);f.addEventListener("error",this._onSBUpdateError);this.tracks[a]={buffer:f,codec:l,id:u.id,container:u.container,levelCodec:u.levelCodec}}catch(e){o["logger"].error("error while trying to add sourceBuffer:"+e.message);this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].BUFFER_ADD_CODEC_ERROR,fatal:false,err:e,mimeType:d})}}}this.hls.trigger(s["default"].BUFFER_CREATED,{tracks:this.tracks})};r.onBufferAppending=function e(t){if(!this._needsFlush){if(!this.segments){this.segments=[t]}else{this.segments.push(t)}this.doAppending()}};r.onBufferEos=function e(t){for(var r in this.sourceBuffer){if(!t.type||t.type===r){var i=this.sourceBuffer[r];if(i&&!i.ended){i.ended=true;o["logger"].log(r+" sourceBuffer now EOS")}}}this.checkEos()};r.checkEos=function e(){var t=this.sourceBuffer,r=this.mediaSource;if(!r||r.readyState!=="open"){this._needsEos=false;return}for(var i in t){var n=t[i];if(!n)continue;if(!n.ended){return}if(n.updating){this._needsEos=true;return}}o["logger"].log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{r.endOfStream()}catch(e){o["logger"].warn("exception while calling mediaSource.endOfStream()")}this._needsEos=false};r.onBufferFlushing=function e(t){if(t.type){this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type})}else{this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"video"});this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"audio"})}this.flushBufferCounter=0;this.doFlush()};r.flushLiveBackBuffer=function e(){if(!this._live){return}var t=this.config.liveBackBufferLength;if(!isFinite(t)||t<0){return}if(!this.media){o["logger"].error("flushLiveBackBuffer called without attaching media");return}var r=this.media.currentTime;var i=this.sourceBuffer;var n=Object.keys(i);var a=r-Math.max(t,this._levelTargetDuration);for(var u=n.length-1;u>=0;u--){var l=n[u];var d=i[l];if(d){var f=d.buffered;if(f.length>0&&a>f.start(0)){if(this.removeBufferRange(l,d,0,a)){this.hls.trigger(s["default"].LIVE_BACK_BUFFER_REACHED,{bufferEnd:a})}}}}};r.onLevelUpdated=function e(t){var r=t.details;if(r.fragments.length>0){this._levelDuration=r.totalduration+r.fragments[0].start;this._levelTargetDuration=r.averagetargetduration||r.targetduration||10;this._live=r.live;this.updateMediaElementDuration()}};r.updateMediaElementDuration=function e(){var t=this.config;var r;if(this._levelDuration===null||!this.media||!this.mediaSource||!this.sourceBuffer||this.media.readyState===0||this.mediaSource.readyState!=="open"){return}for(var i in this.sourceBuffer){var n=this.sourceBuffer[i];if(n&&n.updating===true){return}}r=this.media.duration;if(this._msDuration===null){this._msDuration=this.mediaSource.duration}if(this._live===true&&t.liveDurationInfinity===true){o["logger"].log("Media Source duration is set to Infinity");this._msDuration=this.mediaSource.duration=Infinity}else if(this._levelDuration>this._msDuration&&this._levelDuration>r||!Object(a["isFiniteNumber"])(r)){o["logger"].log("Updating Media Source duration to "+this._levelDuration.toFixed(3));this._msDuration=this.mediaSource.duration=this._levelDuration}};r.doFlush=function e(){while(this.flushRange.length){var t=this.flushRange[0];if(this.flushBuffer(t.start,t.end,t.type)){this.flushRange.shift();this.flushBufferCounter=0}else{this._needsFlush=true;return}}if(this.flushRange.length===0){this._needsFlush=false;var r=0;var i=this.sourceBuffer;try{for(var n in i){var a=i[n];if(a){r+=a.buffered.length}}}catch(e){o["logger"].error("error while accessing sourceBuffer.buffered")}this.appended=r;this.hls.trigger(s["default"].BUFFER_FLUSHED)}};r.doAppending=function e(){var t=this.config,r=this.hls,i=this.segments,a=this.sourceBuffer;if(!Object.keys(a).length){return}if(!this.media||this.media.error){this.segments=[];o["logger"].error("trying to append although a media error occured, flush segment and abort");return}if(this.appending){return}var u=i.shift();if(!u){return}try{var l=a[u.type];if(!l){this._onSBUpdateEnd();return}if(l.updating){i.unshift(u);return}l.ended=false;this.parent=u.parent;l.appendBuffer(u.data);this.appendError=0;this.appended++;this.appending=true}catch(e){o["logger"].error("error while trying to append buffer:"+e.message);i.unshift(u);var d={type:n["ErrorTypes"].MEDIA_ERROR,parent:u.parent,details:"",fatal:false};if(e.code===22){this.segments=[];d.details=n["ErrorDetails"].BUFFER_FULL_ERROR}else{this.appendError++;d.details=n["ErrorDetails"].BUFFER_APPEND_ERROR;if(this.appendError>t.appendErrorMaxRetry){o["logger"].log("fail "+t.appendErrorMaxRetry+" times to append segment in sourceBuffer");this.segments=[];d.fatal=true}}r.trigger(s["default"].ERROR,d)}};r.flushBuffer=function e(t,r,i){var n=this.sourceBuffer;if(!Object.keys(n).length){return true}var a="null";if(this.media){a=this.media.currentTime.toFixed(3)}o["logger"].log("flushBuffer,pos/start/end: "+a+"/"+t+"/"+r);if(this.flushBufferCounter>=this.appended){o["logger"].warn("abort flushing too many retries");return true}var s=n[i];if(s){s.ended=false;if(!s.updating){if(this.removeBufferRange(i,s,t,r)){this.flushBufferCounter++;return false}}else{o["logger"].warn("cannot flush, sb updating in progress");return false}}o["logger"].log("buffer flushed");return true};r.removeBufferRange=function e(t,r,i,n){try{for(var a=0;a<r.buffered.length;a++){var s=r.buffered.start(a);var u=r.buffered.end(a);var l=Math.max(s,i);var d=Math.min(u,n);if(Math.min(d,u)-l>.5){var f="null";if(this.media){f=this.media.currentTime.toString()}o["logger"].log("sb remove "+t+" ["+l+","+d+"], of ["+s+","+u+"], pos:"+f);r.remove(l,d);return true}}}catch(e){o["logger"].warn("removeBufferRange failed",e)}return false};return t}(d);var Ct=At;function It(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function Dt(e,t,r){if(t)It(e.prototype,t);if(r)It(e,r);return e}function xt(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Lt=function(e){xt(t,e);function t(t){var r;r=e.call(this,t,s["default"].FPS_DROP_LEVEL_CAPPING,s["default"].MEDIA_ATTACHING,s["default"].MANIFEST_PARSED,s["default"].LEVELS_UPDATED,s["default"].BUFFER_CODECS,s["default"].MEDIA_DETACHING)||this;r.autoLevelCapping=Number.POSITIVE_INFINITY;r.firstLevel=null;r.levels=[];r.media=null;r.restrictedLevels=[];r.timer=null;r.clientRect=null;return r}var r=t.prototype;r.destroy=function e(){if(this.hls.config.capLevelToPlayerSize){this.media=null;this.clientRect=null;this.stopCapping()}};r.onFpsDropLevelCapping=function e(r){if(t.isLevelAllowed(r.droppedLevel,this.restrictedLevels)){this.restrictedLevels.push(r.droppedLevel)}};r.onMediaAttaching=function e(t){this.media=t.media instanceof window.HTMLVideoElement?t.media:null};r.onManifestParsed=function e(t){var r=this.hls;this.restrictedLevels=[];this.levels=t.levels;this.firstLevel=t.firstLevel;if(r.config.capLevelToPlayerSize&&t.video){this.startCapping()}};r.onBufferCodecs=function e(t){var r=this.hls;if(r.config.capLevelToPlayerSize&&t.video){this.startCapping()}};r.onLevelsUpdated=function e(t){this.levels=t.levels};r.onMediaDetaching=function e(){this.stopCapping()};r.detectPlayerSize=function e(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var r=this.hls;r.autoLevelCapping=this.getMaxLevel(t-1);if(r.autoLevelCapping>this.autoLevelCapping){r.streamController.nextLevelSwitch()}this.autoLevelCapping=r.autoLevelCapping}}};r.getMaxLevel=function e(r){var i=this;if(!this.levels){return-1}var n=this.levels.filter((function(e,n){return t.isLevelAllowed(n,i.restrictedLevels)&&n<=r}));this.clientRect=null;return t.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)};r.startCapping=function e(){if(this.timer){return}this.autoLevelCapping=Number.POSITIVE_INFINITY;this.hls.firstLevel=this.getMaxLevel(this.firstLevel);clearInterval(this.timer);this.timer=setInterval(this.detectPlayerSize.bind(this),1e3);this.detectPlayerSize()};r.stopCapping=function e(){this.restrictedLevels=[];this.firstLevel=null;this.autoLevelCapping=Number.POSITIVE_INFINITY;if(this.timer){this.timer=clearInterval(this.timer);this.timer=null}};r.getDimensions=function e(){if(this.clientRect){return this.clientRect}var t=this.media;var r={width:0,height:0};if(t){var i=t.getBoundingClientRect();r.width=i.width;r.height=i.height;if(!r.width&&!r.height){r.width=i.right-i.left||t.width||0;r.height=i.bottom-i.top||t.height||0}}this.clientRect=r;return r};t.isLevelAllowed=function e(t,r){if(r===void 0){r=[]}return r.indexOf(t)===-1};t.getMaxLevelByMediaSize=function e(t,r,i){if(!t||t&&!t.length){return-1}var n=function e(t,r){if(!r){return true}return t.width!==r.width||t.height!==r.height};var a=t.length-1;for(var s=0;s<t.length;s+=1){var o=t[s];if((o.width>=r||o.height>=i)&&n(o,t[s+1])){a=s;break}}return a};Dt(t,[{key:"mediaWidth",get:function e(){return this.getDimensions().width*t.contentScaleFactor}},{key:"mediaHeight",get:function e(){return this.getDimensions().height*t.contentScaleFactor}}],[{key:"contentScaleFactor",get:function e(){var t=1;try{t=window.devicePixelRatio}catch(e){}return t}}]);return t}(d);var Ot=Lt;function Pt(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Rt=window,Ut=Rt.performance;var Mt=function(e){Pt(t,e);function t(t){return e.call(this,t,s["default"].MEDIA_ATTACHING)||this}var r=t.prototype;r.destroy=function e(){if(this.timer){clearInterval(this.timer)}this.isVideoPlaybackQualityAvailable=false};r.onMediaAttaching=function e(t){var r=this.hls.config;if(r.capLevelOnFPSDrop){var i=this.video=t.media instanceof window.HTMLVideoElement?t.media:null;if(typeof i.getVideoPlaybackQuality==="function"){this.isVideoPlaybackQualityAvailable=true}clearInterval(this.timer);this.timer=setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}};r.checkFPS=function e(t,r,i){var n=Ut.now();if(r){if(this.lastTime){var a=n-this.lastTime,u=i-this.lastDroppedFrames,l=r-this.lastDecodedFrames,d=1e3*u/a,f=this.hls;f.trigger(s["default"].FPS_DROP,{currentDropped:u,currentDecoded:l,totalDroppedFrames:i});if(d>0){if(u>f.config.fpsDroppedMonitoringThreshold*l){var c=f.currentLevel;o["logger"].warn("drop FPS ratio greater than max allowed value for currentLevel: "+c);if(c>0&&(f.autoLevelCapping===-1||f.autoLevelCapping>=c)){c=c-1;f.trigger(s["default"].FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:f.currentLevel});f.autoLevelCapping=c;f.streamController.nextLevelSwitch()}}}}this.lastTime=n;this.lastDroppedFrames=i;this.lastDecodedFrames=r}};r.checkFPSInterval=function e(){var t=this.video;if(t){if(this.isVideoPlaybackQualityAvailable){var r=t.getVideoPlaybackQuality();this.checkFPS(t,r.totalVideoFrames,r.droppedVideoFrames)}else{this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}}};return t}(d);var Nt=Mt;var Bt=function(){function e(e){if(e&&e.xhrSetup){this.xhrSetup=e.xhrSetup}}var t=e.prototype;t.destroy=function e(){this.abort();this.loader=null};t.abort=function e(){var t=this.loader;if(t&&t.readyState!==4){this.stats.aborted=true;t.abort()}window.clearTimeout(this.requestTimeout);this.requestTimeout=null;window.clearTimeout(this.retryTimeout);this.retryTimeout=null};t.load=function e(t,r,i){this.context=t;this.config=r;this.callbacks=i;this.stats={trequest:window.performance.now(),retry:0};this.retryDelay=r.retryDelay;this.loadInternal()};t.loadInternal=function e(){var t,r=this.context;t=this.loader=new window.XMLHttpRequest;var i=this.stats;i.tfirst=0;i.loaded=0;var n=this.xhrSetup;try{if(n){try{n(t,r.url)}catch(e){t.open("GET",r.url,true);n(t,r.url)}}if(!t.readyState){t.open("GET",r.url,true)}}catch(e){this.callbacks.onError({code:t.status,text:e.message},r,t);return}if(r.rangeEnd){t.setRequestHeader("Range","bytes="+r.rangeStart+"-"+(r.rangeEnd-1))}t.onreadystatechange=this.readystatechange.bind(this);t.onprogress=this.loadprogress.bind(this);t.responseType=r.responseType;this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout);t.send()};t.readystatechange=function e(t){var r=t.currentTarget,i=r.readyState,n=this.stats,a=this.context,s=this.config;if(n.aborted){return}if(i>=2){window.clearTimeout(this.requestTimeout);if(n.tfirst===0){n.tfirst=Math.max(window.performance.now(),n.trequest)}if(i===4){var u=r.status;if(u>=200&&u<300){n.tload=Math.max(n.tfirst,window.performance.now());var l,d;if(a.responseType==="arraybuffer"){l=r.response;d=l.byteLength}else{l=r.responseText;d=l.length}n.loaded=n.total=d;var f={url:r.responseURL,data:l};this.callbacks.onSuccess(f,n,a,r)}else{if(n.retry>=s.maxRetry||u>=400&&u<499){o["logger"].error(u+" while loading "+a.url);this.callbacks.onError({code:u,text:r.statusText},a,r)}else{o["logger"].warn(u+" while loading "+a.url+", retrying in "+this.retryDelay+"...");this.destroy();this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay);this.retryDelay=Math.min(2*this.retryDelay,s.maxRetryDelay);n.retry++}}}else{this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),s.timeout)}}};t.loadtimeout=function e(){o["logger"].warn("timeout while loading "+this.context.url);this.callbacks.onTimeout(this.stats,this.context,null)};t.loadprogress=function e(t){var r=t.currentTarget,i=this.stats;i.loaded=t.loaded;if(t.lengthComputable){i.total=t.total}var n=this.callbacks.onProgress;if(n){n(i,this.context,null,r)}};return e}();var Ft=Bt;var jt=r("./src/empty.js");var qt;(function(e){e["WIDEVINE"]="com.widevine.alpha";e["PLAYREADY"]="com.microsoft.playready"})(qt||(qt={}));var Ht=function(){if(typeof window!=="undefined"&&window.navigator&&window.navigator.requestMediaKeySystemAccess){return window.navigator.requestMediaKeySystemAccess.bind(window.navigator)}else{return null}}();function Gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);if(t)i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}));r.push.apply(r,i)}return r}function Vt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};if(t%2){Gt(Object(r),true).forEach((function(t){Wt(e,t,r[t])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(r))}else{Gt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}}return e}function Wt(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}var zt=Vt(Vt({autoStartLoad:true,startPosition:-1,defaultAudioCodec:void 0,debug:false,capLevelOnFPSDrop:false,capLevelToPlayerSize:false,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:60*1e3*1e3,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:false,liveBackBufferLength:Infinity,maxMaxBufferLength:600,enableWorker:true,enableSoftwareAES:true,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:false,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Ft,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:wt,bufferController:Ct,capLevelController:Ot,fpsController:Nt,stretchShortVideoTrack:false,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:true,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:false,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:false,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:Ht,testBandwidth:true},Kt()),{},{subtitleStreamController:false?undefined:void 0,subtitleTrackController:false?undefined:void 0,timelineController:false?undefined:void 0,audioStreamController:false?undefined:void 0,audioTrackController:false?undefined:void 0,emeController:false?undefined:void 0});function Kt(){return{cueHandler:jt,enableCEA708Captions:false,enableWebVTT:false,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:true}}function Xt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);if(t)i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}));r.push.apply(r,i)}return r}function Yt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};if(t%2){Xt(Object(r),true).forEach((function(t){Qt(e,t,r[t])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(r))}else{Xt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}}return e}function Qt(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function $t(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function Jt(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function Zt(e,t,r){if(t)Jt(e.prototype,t);if(r)Jt(e,r);return e}function er(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var tr=function(e){er(t,e);t.isSupported=function e(){return ft()};Zt(t,null,[{key:"version",get:function e(){return"0.14.16"}},{key:"Events",get:function e(){return s["default"]}},{key:"ErrorTypes",get:function e(){return n["ErrorTypes"]}},{key:"ErrorDetails",get:function e(){return n["ErrorDetails"]}},{key:"DefaultConfig",get:function e(){if(!t.defaultConfig){return zt}return t.defaultConfig},set:function e(r){t.defaultConfig=r}}]);function t(r){var i;if(r===void 0){r={}}i=e.call(this)||this;i.config=void 0;i._autoLevelCapping=void 0;i.abrController=void 0;i.capLevelController=void 0;i.levelController=void 0;i.streamController=void 0;i.networkControllers=void 0;i.audioTrackController=void 0;i.subtitleTrackController=void 0;i.emeController=void 0;i.coreComponents=void 0;i.media=null;i.url=null;var n=t.DefaultConfig;if((r.liveSyncDurationCount||r.liveMaxLatencyDurationCount)&&(r.liveSyncDuration||r.liveMaxLatencyDuration)){throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration")}i.config=Yt(Yt({},n),r);var a=$t(i),s=a.config;if(s.liveMaxLatencyDurationCount!==void 0&&s.liveMaxLatencyDurationCount<=s.liveSyncDurationCount){throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"')}if(s.liveMaxLatencyDuration!==void 0&&(s.liveSyncDuration===void 0||s.liveMaxLatencyDuration<=s.liveSyncDuration)){throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"')}Object(o["enableLogs"])(s.debug);i._autoLevelCapping=-1;var u=i.abrController=new s.abrController($t(i));var l=new s.bufferController($t(i));var d=i.capLevelController=new s.capLevelController($t(i));var f=new s.fpsController($t(i));var c=new G($t(i));var h=new z($t(i));var p=new Y($t(i));var v=new dt($t(i));var m=i.levelController=new rt($t(i));var g=new J($t(i));var y=i.streamController=new $e($t(i),g);var _=[m,y];var b=s.audioStreamController;if(b){_.push(new b($t(i),g))}i.networkControllers=_;var T=[c,h,p,u,l,d,f,v,g];b=s.audioTrackController;if(b){var S=new b($t(i));i.audioTrackController=S;T.push(S)}b=s.subtitleTrackController;if(b){var w=new b($t(i));i.subtitleTrackController=w;_.push(w)}b=s.emeController;if(b){var E=new b($t(i));i.emeController=E;T.push(E)}b=s.subtitleStreamController;if(b){_.push(new b($t(i),g))}b=s.timelineController;if(b){T.push(new b($t(i)))}i.coreComponents=T;return i}var r=t.prototype;r.destroy=function e(){o["logger"].log("destroy");this.trigger(s["default"].DESTROYING);this.detachMedia();this.coreComponents.concat(this.networkControllers).forEach((function(e){e.destroy()}));this.url=null;this.removeAllListeners();this._autoLevelCapping=-1};r.attachMedia=function e(t){o["logger"].log("attachMedia");this.media=t;this.trigger(s["default"].MEDIA_ATTACHING,{media:t})};r.detachMedia=function e(){o["logger"].log("detachMedia");this.trigger(s["default"].MEDIA_DETACHING);this.media=null};r.loadSource=function e(t){t=i["buildAbsoluteURL"](window.location.href,t,{alwaysNormalize:true});o["logger"].log("loadSource:"+t);this.url=t;this.trigger(s["default"].MANIFEST_LOADING,{url:t})};r.startLoad=function e(t){if(t===void 0){t=-1}o["logger"].log("startLoad("+t+")");this.networkControllers.forEach((function(e){e.startLoad(t)}))};r.stopLoad=function e(){o["logger"].log("stopLoad");this.networkControllers.forEach((function(e){e.stopLoad()}))};r.swapAudioCodec=function e(){o["logger"].log("swapAudioCodec");this.streamController.swapAudioCodec()};r.recoverMediaError=function e(){o["logger"].log("recoverMediaError");var t=this.media;this.detachMedia();if(t){this.attachMedia(t)}};r.removeLevel=function e(t,r){if(r===void 0){r=0}this.levelController.removeLevel(t,r)};Zt(t,[{key:"levels",get:function e(){return this.levelController.levels}},{key:"currentLevel",get:function e(){return this.streamController.currentLevel},set:function e(t){o["logger"].log("set currentLevel:"+t);this.loadLevel=t;this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function e(){return this.streamController.nextLevel},set:function e(t){o["logger"].log("set nextLevel:"+t);this.levelController.manualLevel=t;this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function e(){return this.levelController.level},set:function e(t){o["logger"].log("set loadLevel:"+t);this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function e(){return this.levelController.nextLoadLevel},set:function e(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function e(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function e(t){o["logger"].log("set firstLevel:"+t);this.levelController.firstLevel=t}},{key:"startLevel",get:function e(){return this.levelController.startLevel},set:function e(t){o["logger"].log("set startLevel:"+t);if(t!==-1){t=Math.max(t,this.minAutoLevel)}this.levelController.startLevel=t}},{key:"capLevelToPlayerSize",set:function e(t){var r=!!t;if(r!==this.config.capLevelToPlayerSize){if(r){this.capLevelController.startCapping()}else{this.capLevelController.stopCapping();this.autoLevelCapping=-1;this.streamController.nextLevelSwitch()}this.config.capLevelToPlayerSize=r}}},{key:"autoLevelCapping",get:function e(){return this._autoLevelCapping},set:function e(t){o["logger"].log("set autoLevelCapping:"+t);this._autoLevelCapping=t}},{key:"bandwidthEstimate",get:function e(){var t=this.abrController._bwEstimator;return t?t.getEstimate():NaN}},{key:"autoLevelEnabled",get:function e(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function e(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function e(){var t=this.levels,r=this.config.minAutoBitrate;var i=t?t.length:0;for(var n=0;n<i;n++){var a=t[n].realBitrate?Math.max(t[n].realBitrate,t[n].bitrate):t[n].bitrate;if(a>r){return n}}return 0}},{key:"maxAutoLevel",get:function e(){var t=this.levels,r=this.autoLevelCapping;var i;if(r===-1&&t&&t.length){i=t.length-1}else{i=r}return i}},{key:"nextAutoLevel",get:function e(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function e(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}},{key:"audioTracks",get:function e(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function e(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function e(t){var r=this.audioTrackController;if(r){r.audioTrack=t}}},{key:"liveSyncPosition",get:function e(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function e(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function e(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function e(t){var r=this.subtitleTrackController;if(r){r.subtitleTrack=t}}},{key:"subtitleDisplay",get:function e(){var t=this.subtitleTrackController;return t?t.subtitleDisplay:false},set:function e(t){var r=this.subtitleTrackController;if(r){r.subtitleDisplay=t}}}]);return t}(ue);tr.defaultConfig=void 0},"./src/polyfills/number.js":function(e,t,r){"use strict";r.r(t);r.d(t,"isFiniteNumber",(function(){return i}));r.d(t,"MAX_SAFE_INTEGER",(function(){return n}));var i=Number.isFinite||function(e){return typeof e==="number"&&isFinite(e)};var n=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/utils/get-self-scope.js":function(e,t,r){"use strict";r.r(t);r.d(t,"getSelfScope",(function(){return i}));function i(){if(typeof window==="undefined"){return self}else{return window}}},"./src/utils/logger.js":function(e,t,r){"use strict";r.r(t);r.d(t,"enableLogs",(function(){return f}));r.d(t,"logger",(function(){return c}));var i=r("./src/utils/get-self-scope.js");function n(){}var a={trace:n,debug:n,log:n,warn:n,info:n,error:n};var s=a;function o(e,t){t="["+e+"] > "+t;return t}var u=Object(i["getSelfScope"])();function l(e){var t=u.console[e];if(t){return function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++){i[n]=arguments[n]}if(i[0]){i[0]=o(e,i[0])}t.apply(u.console,i)}}return n}function d(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++){r[i-1]=arguments[i]}r.forEach((function(t){s[t]=e[t]?e[t].bind(e):l(t)}))}var f=function e(t){if(u.console&&t===true||typeof t==="object"){d(t,"debug","log","info","warn","error");try{s.log()}catch(e){s=a}}else{s=a}};var c=s}})["default"]}))},"./node_modules/m3u8-parser/dist/m3u8-parser.es.js":function(e,t,r){"use strict";var i=r("./node_modules/@babel/runtime/helpers/inheritsLoose.js");var n=r.n(i);var a=function(){function e(){this.listeners={}}var t=e.prototype;t.on=function e(t,r){if(!this.listeners[t]){this.listeners[t]=[]}this.listeners[t].push(r)};t.off=function e(t,r){if(!this.listeners[t]){return false}var i=this.listeners[t].indexOf(r);this.listeners[t]=this.listeners[t].slice(0);this.listeners[t].splice(i,1);return i>-1};t.trigger=function e(t){var r=this.listeners[t];if(!r){return}if(arguments.length===2){var i=r.length;for(var n=0;n<i;++n){r[n].call(this,arguments[1])}}else{var a=Array.prototype.slice.call(arguments,1);var s=r.length;for(var o=0;o<s;++o){r[o].apply(this,a)}}};t.dispose=function e(){this.listeners={}};t.pipe=function e(t){this.on("data",(function(e){t.push(e)}))};return e}();var s=r("./node_modules/@babel/runtime/helpers/extends.js");var o=r.n(s);var u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js");var l=r.n(u);var d=r("./node_modules/@videojs/vhs-utils/es/decode-b64-to-uint8-array.js");r.d(t,"a",(function(){return b}));var f=function(e){n()(t,e);function t(){var t;t=e.call(this)||this;t.buffer="";return t}var r=t.prototype;r.push=function e(t){var r;this.buffer+=t;r=this.buffer.indexOf("\n");for(;r>-1;r=this.buffer.indexOf("\n")){this.trigger("data",this.buffer.substring(0,r));this.buffer=this.buffer.substring(r+1)}};return t}(a);var c=String.fromCharCode(9);var h=function e(t){var r=/([0-9.]*)?@?([0-9.]*)?/.exec(t||"");var i={};if(r[1]){i.length=parseInt(r[1],10)}if(r[2]){i.offset=parseInt(r[2],10)}return i};var p=function e(){var t="[^=]*";var r='"[^"]*"|[^,]*';var i="(?:"+t+")=(?:"+r+")";return new RegExp("(?:^|,)("+i+")")};var v=function e(t){var r=t.split(p());var i={};var n=r.length;var a;while(n--){if(r[n]===""){continue}a=/([^=]*)=(.*)/.exec(r[n]).slice(1);a[0]=a[0].replace(/^\s+|\s+$/g,"");a[1]=a[1].replace(/^\s+|\s+$/g,"");a[1]=a[1].replace(/^['"](.*)['"]$/g,"$1");i[a[0]]=a[1]}return i};var m=function(e){n()(t,e);function t(){var t;t=e.call(this)||this;t.customParsers=[];t.tagMappers=[];return t}var r=t.prototype;r.push=function e(t){var r=this;var i;var n;t=t.trim();if(t.length===0){return}if(t[0]!=="#"){this.trigger("data",{type:"uri",uri:t});return}var a=this.tagMappers.reduce((function(e,r){var i=r(t);if(i===t){return e}return e.concat([i])}),[t]);a.forEach((function(e){for(var t=0;t<r.customParsers.length;t++){if(r.customParsers[t].call(r,e)){return}}if(e.indexOf("#EXT")!==0){r.trigger("data",{type:"comment",text:e.slice(1)});return}e=e.replace("\r","");i=/^#EXTM3U/.exec(e);if(i){r.trigger("data",{type:"tag",tagType:"m3u"});return}i=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e);if(i){n={type:"tag",tagType:"inf"};if(i[1]){n.duration=parseFloat(i[1])}if(i[2]){n.title=i[2]}r.trigger("data",n);return}i=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e);if(i){n={type:"tag",tagType:"targetduration"};if(i[1]){n.duration=parseInt(i[1],10)}r.trigger("data",n);return}i=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e);if(i){n={type:"tag",tagType:"version"};if(i[1]){n.version=parseInt(i[1],10)}r.trigger("data",n);return}i=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e);if(i){n={type:"tag",tagType:"media-sequence"};if(i[1]){n.number=parseInt(i[1],10)}r.trigger("data",n);return}i=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e);if(i){n={type:"tag",tagType:"discontinuity-sequence"};if(i[1]){n.number=parseInt(i[1],10)}r.trigger("data",n);return}i=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e);if(i){n={type:"tag",tagType:"playlist-type"};if(i[1]){n.playlistType=i[1]}r.trigger("data",n);return}i=/^#EXT-X-BYTERANGE:?(.*)?$/.exec(e);if(i){n=o()(h(i[1]),{type:"tag",tagType:"byterange"});r.trigger("data",n);return}i=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e);if(i){n={type:"tag",tagType:"allow-cache"};if(i[1]){n.allowed=!/NO/.test(i[1])}r.trigger("data",n);return}i=/^#EXT-X-MAP:?(.*)$/.exec(e);if(i){n={type:"tag",tagType:"map"};if(i[1]){var a=v(i[1]);if(a.URI){n.uri=a.URI}if(a.BYTERANGE){n.byterange=h(a.BYTERANGE)}}r.trigger("data",n);return}i=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e);if(i){n={type:"tag",tagType:"stream-inf"};if(i[1]){n.attributes=v(i[1]);if(n.attributes.RESOLUTION){var s=n.attributes.RESOLUTION.split("x");var u={};if(s[0]){u.width=parseInt(s[0],10)}if(s[1]){u.height=parseInt(s[1],10)}n.attributes.RESOLUTION=u}if(n.attributes.BANDWIDTH){n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)}if(n.attributes["PROGRAM-ID"]){n.attributes["PROGRAM-ID"]=parseInt(n.attributes["PROGRAM-ID"],10)}}r.trigger("data",n);return}i=/^#EXT-X-MEDIA:?(.*)$/.exec(e);if(i){n={type:"tag",tagType:"media"};if(i[1]){n.attributes=v(i[1])}r.trigger("data",n);return}i=/^#EXT-X-ENDLIST/.exec(e);if(i){r.trigger("data",{type:"tag",tagType:"endlist"});return}i=/^#EXT-X-DISCONTINUITY/.exec(e);if(i){r.trigger("data",{type:"tag",tagType:"discontinuity"});return}i=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e);if(i){n={type:"tag",tagType:"program-date-time"};if(i[1]){n.dateTimeString=i[1];n.dateTimeObject=new Date(i[1])}r.trigger("data",n);return}i=/^#EXT-X-KEY:?(.*)$/.exec(e);if(i){n={type:"tag",tagType:"key"};if(i[1]){n.attributes=v(i[1]);if(n.attributes.IV){if(n.attributes.IV.substring(0,2).toLowerCase()==="0x"){n.attributes.IV=n.attributes.IV.substring(2)}n.attributes.IV=n.attributes.IV.match(/.{8}/g);n.attributes.IV[0]=parseInt(n.attributes.IV[0],16);n.attributes.IV[1]=parseInt(n.attributes.IV[1],16);n.attributes.IV[2]=parseInt(n.attributes.IV[2],16);n.attributes.IV[3]=parseInt(n.attributes.IV[3],16);n.attributes.IV=new Uint32Array(n.attributes.IV)}}r.trigger("data",n);return}i=/^#EXT-X-START:?(.*)$/.exec(e);if(i){n={type:"tag",tagType:"start"};if(i[1]){n.attributes=v(i[1]);n.attributes["TIME-OFFSET"]=parseFloat(n.attributes["TIME-OFFSET"]);n.attributes.PRECISE=/YES/.test(n.attributes.PRECISE)}r.trigger("data",n);return}i=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e);if(i){n={type:"tag",tagType:"cue-out-cont"};if(i[1]){n.data=i[1]}else{n.data=""}r.trigger("data",n);return}i=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e);if(i){n={type:"tag",tagType:"cue-out"};if(i[1]){n.data=i[1]}else{n.data=""}r.trigger("data",n);return}i=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e);if(i){n={type:"tag",tagType:"cue-in"};if(i[1]){n.data=i[1]}else{n.data=""}r.trigger("data",n);return}i=/^#EXT-X-SKIP:(.*)$/.exec(e);if(i&&i[1]){n={type:"tag",tagType:"skip"};n.attributes=v(i[1]);if(n.attributes.hasOwnProperty("SKIPPED-SEGMENTS")){n.attributes["SKIPPED-SEGMENTS"]=parseInt(n.attributes["SKIPPED-SEGMENTS"],10)}if(n.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")){n.attributes["RECENTLY-REMOVED-DATERANGES"]=n.attributes["RECENTLY-REMOVED-DATERANGES"].split(c)}r.trigger("data",n);return}i=/^#EXT-X-PART:(.*)$/.exec(e);if(i&&i[1]){n={type:"tag",tagType:"part"};n.attributes=v(i[1]);["DURATION"].forEach((function(e){if(n.attributes.hasOwnProperty(e)){n.attributes[e]=parseFloat(n.attributes[e])}}));["INDEPENDENT","GAP"].forEach((function(e){if(n.attributes.hasOwnProperty(e)){n.attributes[e]=/YES/.test(n.attributes[e])}}));if(n.attributes.hasOwnProperty("BYTERANGE")){n.attributes.byterange=h(n.attributes.BYTERANGE)}r.trigger("data",n);return}i=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(e);if(i&&i[1]){n={type:"tag",tagType:"server-control"};n.attributes=v(i[1]);["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach((function(e){if(n.attributes.hasOwnProperty(e)){n.attributes[e]=parseFloat(n.attributes[e])}}));["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach((function(e){if(n.attributes.hasOwnProperty(e)){n.attributes[e]=/YES/.test(n.attributes[e])}}));r.trigger("data",n);return}i=/^#EXT-X-PART-INF:(.*)$/.exec(e);if(i&&i[1]){n={type:"tag",tagType:"part-inf"};n.attributes=v(i[1]);["PART-TARGET"].forEach((function(e){if(n.attributes.hasOwnProperty(e)){n.attributes[e]=parseFloat(n.attributes[e])}}));r.trigger("data",n);return}i=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(e);if(i&&i[1]){n={type:"tag",tagType:"preload-hint"};n.attributes=v(i[1]);["BYTERANGE-START","BYTERANGE-LENGTH"].forEach((function(e){if(n.attributes.hasOwnProperty(e)){n.attributes[e]=parseInt(n.attributes[e],10);var t=e==="BYTERANGE-LENGTH"?"length":"offset";n.attributes.byterange=n.attributes.byterange||{};n.attributes.byterange[t]=n.attributes[e];delete n.attributes[e]}}));r.trigger("data",n);return}i=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(e);if(i&&i[1]){n={type:"tag",tagType:"rendition-report"};n.attributes=v(i[1]);["LAST-MSN","LAST-PART"].forEach((function(e){if(n.attributes.hasOwnProperty(e)){n.attributes[e]=parseInt(n.attributes[e],10)}}));r.trigger("data",n);return}r.trigger("data",{type:"tag",data:e.slice(4)})}))};r.addParser=function e(t){var r=this;var i=t.expression,n=t.customType,a=t.dataParser,s=t.segment;if(typeof a!=="function"){a=function e(t){return t}}this.customParsers.push((function(e){var t=i.exec(e);if(t){r.trigger("data",{type:"custom",data:a(e),customType:n,segment:s});return true}}))};r.addTagMapper=function e(t){var r=t.expression,i=t.map;var n=function e(t){if(r.test(t)){return i(t)}return t};this.tagMappers.push(n)};return t}(a);var g=function e(t){return t.toLowerCase().replace(/-(\w)/g,(function(e){return e[1].toUpperCase()}))};var y=function e(t){var r={};Object.keys(t).forEach((function(e){r[g(e)]=t[e]}));return r};var _=function e(t){var r=t.serverControl,i=t.targetDuration,n=t.partTargetDuration;if(!r){return}var a="#EXT-X-SERVER-CONTROL";var s="holdBack";var o="partHoldBack";var u=i&&i*3;var l=n&&n*2;if(i&&!r.hasOwnProperty(s)){r[s]=u;this.trigger("info",{message:a+" defaulting HOLD-BACK to targetDuration * 3 ("+u+")."})}if(u&&r[s]<u){this.trigger("warn",{message:a+" clamping HOLD-BACK ("+r[s]+") to targetDuration * 3 ("+u+")"});r[s]=u}if(n&&!r.hasOwnProperty(o)){r[o]=n*3;this.trigger("info",{message:a+" defaulting PART-HOLD-BACK to partTargetDuration * 3 ("+r[o]+")."})}if(n&&r[o]<l){this.trigger("warn",{message:a+" clamping PART-HOLD-BACK ("+r[o]+") to partTargetDuration * 2 ("+l+")."});r[o]=l}};var b=function(e){n()(t,e);function t(){var t;t=e.call(this)||this;t.lineStream=new f;t.parseStream=new m;t.lineStream.pipe(t.parseStream);var r=l()(t);var i=[];var n={};var a;var s;var u=false;var c=function e(){};var h={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}};var p="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";var v=0;t.manifest={allowCache:true,discontinuityStarts:[],segments:[]};var g=0;var b=0;t.on("end",(function(){if(n.uri||!n.parts&&!n.preloadHints){return}if(!n.map&&a){n.map=a}if(!n.key&&s){n.key=s}if(!n.timeline&&typeof v==="number"){n.timeline=v}t.manifest.preloadSegment=n}));t.parseStream.on("data",(function(e){var t;var l;({tag:function f(){({version:function t(){if(e.version){this.manifest.version=e.version}},"allow-cache":function t(){this.manifest.allowCache=e.allowed;if(!("allowed"in e)){this.trigger("info",{message:"defaulting allowCache to YES"});this.manifest.allowCache=true}},byterange:function t(){var t={};if("length"in e){n.byterange=t;t.length=e.length;if(!("offset"in e)){e.offset=g}}if("offset"in e){n.byterange=t;t.offset=e.offset}g=t.offset+t.length},endlist:function e(){this.manifest.endList=true},inf:function t(){if(!("mediaSequence"in this.manifest)){this.manifest.mediaSequence=0;this.trigger("info",{message:"defaulting media sequence to zero"})}if(!("discontinuitySequence"in this.manifest)){this.manifest.discontinuitySequence=0;this.trigger("info",{message:"defaulting discontinuity sequence to zero"})}if(e.duration>0){n.duration=e.duration}if(e.duration===0){n.duration=.01;this.trigger("info",{message:"updating zero segment duration to a small value"})}this.manifest.segments=i},key:function t(){if(!e.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(e.attributes.METHOD==="NONE"){s=null;return}if(!e.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(e.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{};this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:e.attributes};return}if(e.attributes.KEYFORMAT===p){var r=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];if(r.indexOf(e.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(e.attributes.METHOD==="SAMPLE-AES-CENC"){this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"})}if(e.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(e.attributes.KEYID&&e.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{};this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:e.attributes.KEYFORMAT,keyId:e.attributes.KEYID.substring(2)},pssh:Object(d["a"])(e.attributes.URI.split(",")[1])};return}if(!e.attributes.METHOD){this.trigger("warn",{message:"defaulting key method to AES-128"})}s={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI};if(typeof e.attributes.IV!=="undefined"){s.iv=e.attributes.IV}},"media-sequence":function t(){if(!isFinite(e.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number});return}this.manifest.mediaSequence=e.number},"discontinuity-sequence":function t(){if(!isFinite(e.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number});return}this.manifest.discontinuitySequence=e.number;v=e.number},"playlist-type":function t(){if(!/VOD|EVENT/.test(e.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist});return}this.manifest.playlistType=e.playlistType},map:function t(){a={};if(e.uri){a.uri=e.uri}if(e.byterange){a.byterange=e.byterange}if(s){a.key=s}},"stream-inf":function t(){this.manifest.playlists=i;this.manifest.mediaGroups=this.manifest.mediaGroups||h;if(!e.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}if(!n.attributes){n.attributes={}}o()(n.attributes,e.attributes)},media:function r(){this.manifest.mediaGroups=this.manifest.mediaGroups||h;if(!(e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}var i=this.manifest.mediaGroups[e.attributes.TYPE];i[e.attributes["GROUP-ID"]]=i[e.attributes["GROUP-ID"]]||{};t=i[e.attributes["GROUP-ID"]];l={default:/yes/i.test(e.attributes.DEFAULT)};if(l.default){l.autoselect=true}else{l.autoselect=/yes/i.test(e.attributes.AUTOSELECT)}if(e.attributes.LANGUAGE){l.language=e.attributes.LANGUAGE}if(e.attributes.URI){l.uri=e.attributes.URI}if(e.attributes["INSTREAM-ID"]){l.instreamId=e.attributes["INSTREAM-ID"]}if(e.attributes.CHARACTERISTICS){l.characteristics=e.attributes.CHARACTERISTICS}if(e.attributes.FORCED){l.forced=/yes/i.test(e.attributes.FORCED)}t[e.attributes.NAME]=l},discontinuity:function e(){v+=1;n.discontinuity=true;this.manifest.discontinuityStarts.push(i.length)},"program-date-time":function t(){if(typeof this.manifest.dateTimeString==="undefined"){this.manifest.dateTimeString=e.dateTimeString;this.manifest.dateTimeObject=e.dateTimeObject}n.dateTimeString=e.dateTimeString;n.dateTimeObject=e.dateTimeObject},targetduration:function t(){if(!isFinite(e.duration)||e.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration});return}this.manifest.targetDuration=e.duration;_.call(this,this.manifest)},start:function t(){if(!e.attributes||isNaN(e.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}},"cue-out":function t(){n.cueOut=e.data},"cue-out-cont":function t(){n.cueOutCont=e.data},"cue-in":function t(){n.cueIn=e.data},skip:function t(){this.manifest.skip=y(e.attributes);this.warnOnMissingAttributes_("#EXT-X-SKIP",e.attributes,["SKIPPED-SEGMENTS"])},part:function t(){var r=this;u=true;var i=this.manifest.segments.length;var t=y(e.attributes);n.parts=n.parts||[];n.parts.push(t);if(t.byterange){if(!t.byterange.hasOwnProperty("offset")){t.byterange.offset=b}b=t.byterange.offset+t.byterange.length}var a=n.parts.length-1;this.warnOnMissingAttributes_("#EXT-X-PART #"+a+" for segment #"+i,e.attributes,["URI","DURATION"]);if(this.manifest.renditionReports){this.manifest.renditionReports.forEach((function(e,t){if(!e.hasOwnProperty("lastPart")){r.trigger("warn",{message:"#EXT-X-RENDITION-REPORT #"+t+" lacks required attribute(s): LAST-PART"})}}))}},"server-control":function t(){var r=this.manifest.serverControl=y(e.attributes);if(!r.hasOwnProperty("canBlockReload")){r.canBlockReload=false;this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})}_.call(this,this.manifest);if(r.canSkipDateranges&&!r.hasOwnProperty("canSkipUntil")){this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})}},"preload-hint":function t(){var r=this.manifest.segments.length;var i=y(e.attributes);var a=i.type&&i.type==="PART";n.preloadHints=n.preloadHints||[];n.preloadHints.push(i);if(i.byterange){if(!i.byterange.hasOwnProperty("offset")){i.byterange.offset=a?b:0;if(a){b=i.byterange.offset+i.byterange.length}}}var s=n.preloadHints.length-1;this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #"+s+" for segment #"+r,e.attributes,["TYPE","URI"]);if(!i.type){return}for(var o=0;o<n.preloadHints.length-1;o++){var u=n.preloadHints[o];if(!u.type){continue}if(u.type===i.type){this.trigger("warn",{message:"#EXT-X-PRELOAD-HINT #"+s+" for segment #"+r+" has the same TYPE "+i.type+" as preload hint #"+o})}}},"rendition-report":function t(){var r=y(e.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[];this.manifest.renditionReports.push(r);var i=this.manifest.renditionReports.length-1;var n=["LAST-MSN","URI"];if(u){n.push("LAST-PART")}this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+i,e.attributes,n)},"part-inf":function t(){this.manifest.partInf=y(e.attributes);this.warnOnMissingAttributes_("#EXT-X-PART-INF",e.attributes,["PART-TARGET"]);if(this.manifest.partInf.partTarget){this.manifest.partTargetDuration=this.manifest.partInf.partTarget}_.call(this,this.manifest)}}[e.tagType]||c).call(r)},uri:function t(){n.uri=e.uri;i.push(n);if(this.manifest.targetDuration&&!("duration"in n)){this.trigger("warn",{message:"defaulting segment duration to the target duration"});n.duration=this.manifest.targetDuration}if(s){n.key=s}n.timeline=v;if(a){n.map=a}b=0;n={}},comment:function e(){},custom:function t(){if(e.segment){n.custom=n.custom||{};n.custom[e.customType]=e.data}else{this.manifest.custom=this.manifest.custom||{};this.manifest.custom[e.customType]=e.data}}})[e.type].call(r)}));return t}var r=t.prototype;r.warnOnMissingAttributes_=function e(t,r,i){var n=[];i.forEach((function(e){if(!r.hasOwnProperty(e)){n.push(e)}}));if(n.length){this.trigger("warn",{message:t+" lacks required attribute(s): "+n.join(", ")})}};r.push=function e(t){this.lineStream.push(t)};r.end=function e(){this.lineStream.push("\n");this.trigger("end")};r.addParser=function e(t){this.parseStream.addParser(t)};r.addTagMapper=function e(t){this.parseStream.addTagMapper(t)};return t}(a)},"./node_modules/mpd-parser/dist/mpd-parser.es.js":function(e,t,r){"use strict";var i=r("./node_modules/@videojs/vhs-utils/es/resolve-url.js");var n=r("./node_modules/global/window.js");var a=r.n(n);var s=function e(t,r,i){r.forEach((function(e){for(var r in t.mediaGroups[e]){for(var n in t.mediaGroups[e][r]){var a=t.mediaGroups[e][r][n];i(a,e,r,n)}}}))};var o=r("./node_modules/@videojs/vhs-utils/es/decode-b64-to-uint8-array.js");var u=r("./node_modules/@xmldom/xmldom/lib/index.js");r.d(t,"a",(function(){return C}));r.d(t,"b",(function(){return M}));r.d(t,"c",(function(){return Ie}));r.d(t,"d",(function(){return De}));var l="0.21.0";var d=function e(t){return!!t&&typeof t==="object"};var f=function e(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++){r[i]=arguments[i]}return r.reduce((function(t,r){if(typeof r!=="object"){return t}Object.keys(r).forEach((function(i){if(Array.isArray(t[i])&&Array.isArray(r[i])){t[i]=t[i].concat(r[i])}else if(d(t[i])&&d(r[i])){t[i]=e(t[i],r[i])}else{t[i]=r[i]}}));return t}),{})};var c=function e(t){return Object.keys(t).map((function(e){return t[e]}))};var h=function e(t,r){var i=[];for(var n=t;n<r;n++){i.push(n)}return i};var p=function e(t){return t.reduce((function(e,t){return e.concat(t)}),[])};var v=function e(t){if(!t.length){return[]}var r=[];for(var i=0;i<t.length;i++){r.push(t[i])}return r};var m=function e(t,r){return t.reduce((function(e,t,i){if(t[r]){e.push(i)}return e}),[])};var g=function e(t,r){for(var i=0;i<t.length;i++){if(r(t[i])){return i}}return-1};var y=function e(t,r){return c(t.reduce((function(e,t){t.forEach((function(t){e[r(t)]=t}));return e}),{}))};var _={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};var b=function e(t){var r=t.baseUrl,n=r===void 0?"":r,s=t.source,o=s===void 0?"":s,u=t.range,l=u===void 0?"":u,d=t.indexRange,f=d===void 0?"":d;var c={uri:o,resolvedUri:Object(i["a"])(n||"",o)};if(l||f){var h=l?l:f;var p=h.split("-");var v=a.a.BigInt?a.a.BigInt(p[0]):parseInt(p[0],10);var m=a.a.BigInt?a.a.BigInt(p[1]):parseInt(p[1],10);if(v<Number.MAX_SAFE_INTEGER&&typeof v==="bigint"){v=Number(v)}if(m<Number.MAX_SAFE_INTEGER&&typeof m==="bigint"){m=Number(m)}var g;if(typeof m==="bigint"||typeof v==="bigint"){g=a.a.BigInt(m)-a.a.BigInt(v)+a.a.BigInt(1)}else{g=m-v+1}if(typeof g==="bigint"&&g<Number.MAX_SAFE_INTEGER){g=Number(g)}c.byterange={length:g,offset:v}}return c};var T=function e(t){var r;if(typeof t.offset==="bigint"||typeof t.length==="bigint"){r=a.a.BigInt(t.offset)+a.a.BigInt(t.length)-a.a.BigInt(1)}else{r=t.offset+t.length-1}return t.offset+"-"+r};var S=function e(t){if(t&&typeof t!=="number"){t=parseInt(t,10)}if(isNaN(t)){return null}return t};var w={static:function e(t){var r=t.duration,i=t.timescale,n=i===void 0?1:i,a=t.sourceDuration,s=t.periodDuration;var o=S(t.endNumber);var u=r/n;if(typeof o==="number"){return{start:0,end:o}}if(typeof s==="number"){return{start:0,end:s/u}}return{start:0,end:a/u}},dynamic:function e(t){var r=t.NOW,i=t.clientOffset,n=t.availabilityStartTime,a=t.timescale,s=a===void 0?1:a,o=t.duration,u=t.periodStart,l=u===void 0?0:u,d=t.minimumUpdatePeriod,f=d===void 0?0:d,c=t.timeShiftBufferDepth,h=c===void 0?Infinity:c;var p=S(t.endNumber);var v=(r+i)/1e3;var m=n+l;var g=v+f;var y=g-m;var _=Math.ceil(y*s/o);var b=Math.floor((v-m-h)*s/o);var T=Math.floor((v-m)*s/o);return{start:Math.max(0,b),end:typeof p==="number"?p:Math.min(_,T)}}};var E=function e(t){return function(e){var r=t.duration,i=t.timescale,n=i===void 0?1:i,a=t.periodStart,s=t.startNumber,o=s===void 0?1:s;return{number:o+e,duration:r/n,timeline:a,time:e*r}}};var k=function e(t){var r=t.type,i=t.duration,n=t.timescale,a=n===void 0?1:n,s=t.periodDuration,o=t.sourceDuration;var u=w[r](t),l=u.start,d=u.end;var f=h(l,d).map(E(t));if(r==="static"){var c=f.length-1;var p=typeof s==="number"?s:o;f[c].duration=p-i/a*c}return f};var A=function e(t){var r=t.baseUrl,i=t.initialization,n=i===void 0?{}:i,a=t.sourceDuration,s=t.indexRange,o=s===void 0?"":s,u=t.periodStart,l=t.presentationTime,d=t.number,f=d===void 0?0:d,c=t.duration;if(!r){throw new Error(_.NO_BASE_URL)}var h=b({baseUrl:r,source:n.sourceURL,range:n.range});var p=b({baseUrl:r,source:r,indexRange:o});p.map=h;if(c){var v=k(t);if(v.length){p.duration=v[0].duration;p.timeline=v[0].timeline}}else if(a){p.duration=a;p.timeline=u}p.presentationTime=l||u;p.number=f;return[p]};var C=function e(t,r,i){var n=t.sidx.map?t.sidx.map:null;var s=t.sidx.duration;var o=t.timeline||0;var u=t.sidx.byterange;var l=u.offset+u.length;var d=r.timescale;var f=r.references.filter((function(e){return e.referenceType!==1}));var c=[];var h=t.endList?"static":"dynamic";var p=t.sidx.timeline;var v=p;var m=t.mediaSequence||0;var g;if(typeof r.firstOffset==="bigint"){g=a.a.BigInt(l)+r.firstOffset}else{g=l+r.firstOffset}for(var y=0;y<f.length;y++){var _=r.references[y];var b=_.referencedSize;var T=_.subsegmentDuration;var S=void 0;if(typeof g==="bigint"){S=g+a.a.BigInt(b)-a.a.BigInt(1)}else{S=g+b-1}var w=g+"-"+S;var E={baseUrl:i,timescale:d,timeline:o,periodStart:p,presentationTime:v,number:m,duration:T,sourceDuration:s,indexRange:w,type:h};var k=A(E)[0];if(n){k.map=n}c.push(k);if(typeof g==="bigint"){g+=a.a.BigInt(b)}else{g+=b}v+=T/d;m++}t.segments=c;return t};var I=["AUDIO","SUBTITLES"];var D=1/60;var x=function e(t){return y(t,(function(e){var t=e.timeline;return t})).sort((function(e,t){return e.timeline>t.timeline?1:-1}))};var L=function e(t,r){for(var i=0;i<t.length;i++){if(t[i].attributes.NAME===r){return t[i]}}return null};var O=function e(t){var r=[];s(t,I,(function(e,t,i,n){r=r.concat(e.playlists||[])}));return r};var P=function e(t){var r=t.playlist,i=t.mediaSequence;r.mediaSequence=i;r.segments.forEach((function(e,t){e.number=r.mediaSequence+t}))};var R=function e(t){var r=t.oldPlaylists,i=t.newPlaylists,n=t.timelineStarts;i.forEach((function(e){e.discontinuitySequence=g(n,(function(t){var r=t.timeline;return r===e.timeline}));var t=L(r,e.attributes.NAME);if(!t){return}if(e.sidx){return}var i=e.segments[0];var a=g(t.segments,(function(e){return Math.abs(e.presentationTime-i.presentationTime)<D}));if(a===-1){P({playlist:e,mediaSequence:t.mediaSequence+t.segments.length});e.segments[0].discontinuity=true;e.discontinuityStarts.unshift(0);if(!t.segments.length&&e.timeline>t.timeline||t.segments.length&&e.timeline>t.segments[t.segments.length-1].timeline){e.discontinuitySequence--}return}var s=t.segments[a];if(s.discontinuity&&!i.discontinuity){i.discontinuity=true;e.discontinuityStarts.unshift(0);e.discontinuitySequence--}P({playlist:e,mediaSequence:t.segments[a].number})}))};var U=function e(t){var r=t.oldManifest,i=t.newManifest;var n=r.playlists.concat(O(r));var a=i.playlists.concat(O(i));i.timelineStarts=x([r.timelineStarts,i.timelineStarts]);R({oldPlaylists:n,newPlaylists:a,timelineStarts:i.timelineStarts});return i};var M=function e(t){return t&&t.uri+"-"+T(t.byterange)};var N=function e(t){var r=c(t.reduce((function(e,t){var r=t.attributes.id+(t.attributes.lang||"");if(!e[r]){e[r]=t;e[r].attributes.timelineStarts=[]}else{if(t.segments){var i;if(t.segments[0]){t.segments[0].discontinuity=true}(i=e[r].segments).push.apply(i,t.segments)}if(t.attributes.contentProtection){e[r].attributes.contentProtection=t.attributes.contentProtection}}e[r].attributes.timelineStarts.push({start:t.attributes.periodStart,timeline:t.attributes.periodStart});return e}),{}));return r.map((function(e){e.discontinuityStarts=m(e.segments||[],"discontinuity");return e}))};var B=function e(t,r){var i=M(t.sidx);var n=i&&r[i]&&r[i].sidx;if(n){C(t,n,t.sidx.resolvedUri)}return t};var F=function e(t,r){if(r===void 0){r={}}if(!Object.keys(r).length){return t}for(var i in t){t[i]=B(t[i],r)}return t};var j=function e(t,r){var i;var n=t.attributes,a=t.segments,s=t.sidx,o=t.mediaSequence,u=t.discontinuitySequence,l=t.discontinuityStarts;var d={attributes:(i={NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs},i["PROGRAM-ID"]=1,i),uri:"",endList:n.type==="static",timeline:n.periodStart,resolvedUri:"",targetDuration:n.duration,discontinuitySequence:u,discontinuityStarts:l,timelineStarts:n.timelineStarts,mediaSequence:o,segments:a};if(n.contentProtection){d.contentProtection=n.contentProtection}if(s){d.sidx=s}if(r){d.attributes.AUDIO="audio";d.attributes.SUBTITLES="subs"}return d};var q=function e(t){var r;var i=t.attributes,n=t.segments,a=t.mediaSequence,s=t.discontinuityStarts,o=t.discontinuitySequence;if(typeof n==="undefined"){n=[{uri:i.baseUrl,timeline:i.periodStart,resolvedUri:i.baseUrl||"",duration:i.sourceDuration,number:0}];i.duration=i.sourceDuration}var u=(r={NAME:i.id,BANDWIDTH:i.bandwidth},r["PROGRAM-ID"]=1,r);if(i.codecs){u.CODECS=i.codecs}return{attributes:u,uri:"",endList:i.type==="static",timeline:i.periodStart,resolvedUri:i.baseUrl||"",targetDuration:i.duration,timelineStarts:i.timelineStarts,discontinuityStarts:s,discontinuitySequence:o,mediaSequence:a,segments:n}};var H=function e(t,r,i){if(r===void 0){r={}}if(i===void 0){i=false}var n;var a=t.reduce((function(e,t){var a=t.attributes.role&&t.attributes.role.value||"";var s=t.attributes.lang||"";var o=t.attributes.label||"main";if(s&&!t.attributes.label){var u=a?" ("+a+")":"";o=""+t.attributes.lang+u}if(!e[o]){e[o]={language:s,autoselect:true,default:a==="main",playlists:[],uri:""}}var l=B(j(t,i),r);e[o].playlists.push(l);if(typeof n==="undefined"&&a==="main"){n=t;n.default=true}return e}),{});if(!n){var s=Object.keys(a)[0];a[s].default=true}return a};var G=function e(t,r){if(r===void 0){r={}}return t.reduce((function(e,t){var i=t.attributes.lang||"text";if(!e[i]){e[i]={language:i,default:false,autoselect:false,playlists:[],uri:""}}e[i].playlists.push(B(q(t),r));return e}),{})};var V=function e(t){return t.reduce((function(e,t){if(!t){return e}t.forEach((function(t){var r=t.channel,i=t.language;e[i]={autoselect:false,default:false,instreamId:r,language:i};if(t.hasOwnProperty("aspectRatio")){e[i].aspectRatio=t.aspectRatio}if(t.hasOwnProperty("easyReader")){e[i].easyReader=t.easyReader}if(t.hasOwnProperty("3D")){e[i]["3D"]=t["3D"]}}));return e}),{})};var W=function e(t){var r;var i=t.attributes,n=t.segments,a=t.sidx,s=t.discontinuityStarts;var o={attributes:(r={NAME:i.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:i.width,height:i.height},CODECS:i.codecs,BANDWIDTH:i.bandwidth},r["PROGRAM-ID"]=1,r),uri:"",endList:i.type==="static",timeline:i.periodStart,resolvedUri:"",targetDuration:i.duration,discontinuityStarts:s,timelineStarts:i.timelineStarts,segments:n};if(i.contentProtection){o.contentProtection=i.contentProtection}if(a){o.sidx=a}return o};var z=function e(t){var r=t.attributes;return r.mimeType==="video/mp4"||r.mimeType==="video/webm"||r.contentType==="video"};var K=function e(t){var r=t.attributes;return r.mimeType==="audio/mp4"||r.mimeType==="audio/webm"||r.contentType==="audio"};var X=function e(t){var r=t.attributes;return r.mimeType==="text/vtt"||r.contentType==="text"};var Y=function e(t,r){t.forEach((function(e){e.mediaSequence=0;e.discontinuitySequence=g(r,(function(t){var r=t.timeline;return r===e.timeline}));if(!e.segments){return}e.segments.forEach((function(e,t){e.number=t}))}))};var Q=function e(t){if(!t){return[]}return Object.keys(t).reduce((function(e,r){var i=t[r];return e.concat(i.playlists)}),[])};var $=function e(t){var r;var i=t.dashPlaylists,n=t.locations,a=t.sidxMapping,s=a===void 0?{}:a,o=t.previousManifest;if(!i.length){return{}}var u=i[0].attributes,l=u.sourceDuration,d=u.type,f=u.suggestedPresentationDelay,c=u.minimumUpdatePeriod;var h=N(i.filter(z)).map(W);var p=N(i.filter(K));var v=N(i.filter(X));var m=i.map((function(e){return e.attributes.captionServices})).filter(Boolean);var g={allowCache:true,discontinuityStarts:[],segments:[],endList:true,mediaGroups:(r={AUDIO:{},VIDEO:{}},r["CLOSED-CAPTIONS"]={},r.SUBTITLES={},r),uri:"",duration:l,playlists:F(h,s)};if(c>=0){g.minimumUpdatePeriod=c*1e3}if(n){g.locations=n}if(d==="dynamic"){g.suggestedPresentationDelay=f}var y=g.playlists.length===0;var _=p.length?H(p,s,y):null;var b=v.length?G(v,s):null;var T=h.concat(Q(_),Q(b));var S=T.map((function(e){var t=e.timelineStarts;return t}));g.timelineStarts=x(S);Y(T,g.timelineStarts);if(_){g.mediaGroups.AUDIO.audio=_}if(b){g.mediaGroups.SUBTITLES.subs=b}if(m.length){g.mediaGroups["CLOSED-CAPTIONS"].cc=V(m)}if(o){return U({oldManifest:o,newManifest:g})}return g};var J=function e(t,r,i){var n=t.NOW,a=t.clientOffset,s=t.availabilityStartTime,o=t.timescale,u=o===void 0?1:o,l=t.periodStart,d=l===void 0?0:l,f=t.minimumUpdatePeriod,c=f===void 0?0:f;var h=(n+a)/1e3;var p=s+d;var v=h+c;var m=v-p;return Math.ceil((m*u-r)/i)};var Z=function e(t,r){var i=t.type,n=t.minimumUpdatePeriod,a=n===void 0?0:n,s=t.media,o=s===void 0?"":s,u=t.sourceDuration,l=t.timescale,d=l===void 0?1:l,f=t.startNumber,c=f===void 0?1:f,h=t.periodStart;var p=[];var v=-1;for(var m=0;m<r.length;m++){var g=r[m];var y=g.d;var _=g.r||0;var b=g.t||0;if(v<0){v=b}if(b&&b>v){v=b}var T=void 0;if(_<0){var S=m+1;if(S===r.length){if(i==="dynamic"&&a>0&&o.indexOf("$Number$")>0){T=J(t,v,y)}else{T=(u*d-v)/y}}else{T=(r[S].t-v)/y}}else{T=_+1}var w=c+p.length+T;var E=c+p.length;while(E<w){p.push({number:E,duration:y/d,time:v,timeline:h});v+=y;E++}}return p};var ee=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g;var te=function e(t){return function(e,r,i,n){if(e==="$$"){return"$"}if(typeof t[r]==="undefined"){return e}var a=""+t[r];if(r==="RepresentationID"){return a}if(!i){n=1}else{n=parseInt(n,10)}if(a.length>=n){return a}return""+new Array(n-a.length+1).join("0")+a}};var re=function e(t,r){return t.replace(ee,te(r))};var ie=function e(t,r){if(!t.duration&&!r){return[{number:t.startNumber||1,duration:t.sourceDuration,time:0,timeline:t.periodStart}]}if(t.duration){return k(t)}return Z(t,r)};var ne=function e(t,r){var n={RepresentationID:t.id,Bandwidth:t.bandwidth||0};var a=t.initialization,s=a===void 0?{sourceURL:"",range:""}:a;var o=b({baseUrl:t.baseUrl,source:re(s.sourceURL,n),range:s.range});var u=ie(t,r);return u.map((function(e){n.Number=e.number;n.Time=e.time;var r=re(t.media||"",n);var a=t.timescale||1;var s=t.presentationTimeOffset||0;var u=t.periodStart+(e.time-s)/a;var l={uri:r,timeline:e.timeline,duration:e.duration,resolvedUri:Object(i["a"])(t.baseUrl||"",r),map:o,number:e.number,presentationTime:u};return l}))};var ae=function e(t,r){var i=t.baseUrl,n=t.initialization,a=n===void 0?{}:n;var s=b({baseUrl:i,source:a.sourceURL,range:a.range});var o=b({baseUrl:i,source:r.media,range:r.mediaRange});o.map=s;return o};var se=function e(t,r){var i=t.duration,n=t.segmentUrls,a=n===void 0?[]:n,s=t.periodStart;if(!i&&!r||i&&r){throw new Error(_.SEGMENT_TIME_UNSPECIFIED)}var o=a.map((function(e){return ae(t,e)}));var u;if(i){u=k(t)}if(r){u=Z(t,r)}var l=u.map((function(e,r){if(o[r]){var i=o[r];var n=t.timescale||1;var a=t.presentationTimeOffset||0;i.timeline=e.timeline;i.duration=e.duration;i.number=e.number;i.presentationTime=s+(e.time-a)/n;return i}})).filter((function(e){return e}));return l};var oe=function e(t){var r=t.attributes,i=t.segmentInfo;var n;var a;if(i.template){a=ne;n=f(r,i.template)}else if(i.base){a=A;n=f(r,i.base)}else if(i.list){a=se;n=f(r,i.list)}var s={attributes:r};if(!a){return s}var o=a(n,i.segmentTimeline);if(n.duration){var u=n,l=u.duration,d=u.timescale,c=d===void 0?1:d;n.duration=l/c}else if(o.length){n.duration=o.reduce((function(e,t){return Math.max(e,Math.ceil(t.duration))}),0)}else{n.duration=0}s.attributes=n;s.segments=o;if(i.base&&n.indexRange){s.sidx=o[0];s.segments=[]}return s};var ue=function e(t){return t.map(oe)};var le=function e(t,r){return v(t.childNodes).filter((function(e){var t=e.tagName;return t===r}))};var de=function e(t){return t.textContent.trim()};var fe=function e(t){var r=365*24*60*60;var i=30*24*60*60;var n=24*60*60;var a=60*60;var s=60;var o=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/;var u=o.exec(t);if(!u){return 0}var l=u.slice(1),d=l[0],f=l[1],c=l[2],h=l[3],p=l[4],v=l[5];return parseFloat(d||0)*r+parseFloat(f||0)*i+parseFloat(c||0)*n+parseFloat(h||0)*a+parseFloat(p||0)*s+parseFloat(v||0)};var ce=function e(t){var r=/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/;if(r.test(t)){t+="Z"}return Date.parse(t)};var he={mediaPresentationDuration:function e(t){return fe(t)},availabilityStartTime:function e(t){return ce(t)/1e3},minimumUpdatePeriod:function e(t){return fe(t)},suggestedPresentationDelay:function e(t){return fe(t)},type:function e(t){return t},timeShiftBufferDepth:function e(t){return fe(t)},start:function e(t){return fe(t)},width:function e(t){return parseInt(t,10)},height:function e(t){return parseInt(t,10)},bandwidth:function e(t){return parseInt(t,10)},startNumber:function e(t){return parseInt(t,10)},timescale:function e(t){return parseInt(t,10)},presentationTimeOffset:function e(t){return parseInt(t,10)},duration:function e(t){var r=parseInt(t,10);if(isNaN(r)){return fe(t)}return r},d:function e(t){return parseInt(t,10)},t:function e(t){return parseInt(t,10)},r:function e(t){return parseInt(t,10)},DEFAULT:function e(t){return t}};var pe=function e(t){if(!(t&&t.attributes)){return{}}return v(t.attributes).reduce((function(e,t){var r=he[t.name]||he.DEFAULT;e[t.name]=r(t.value);return e}),{})};var ve={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"};var me=function e(t,r){if(!r.length){return t}return p(t.map((function(e){return r.map((function(t){return Object(i["a"])(e,de(t))}))})))};var ge=function e(t){var r=le(t,"SegmentTemplate")[0];var i=le(t,"SegmentList")[0];var n=i&&le(i,"SegmentURL").map((function(e){return f({tag:"SegmentURL"},pe(e))}));var a=le(t,"SegmentBase")[0];var s=i||r;var o=s&&le(s,"SegmentTimeline")[0];var u=i||a||r;var l=u&&le(u,"Initialization")[0];var d=r&&pe(r);if(d&&l){d.initialization=l&&pe(l)}else if(d&&d.initialization){d.initialization={sourceURL:d.initialization}}var c={template:d,segmentTimeline:o&&le(o,"S").map((function(e){return pe(e)})),list:i&&f(pe(i),{segmentUrls:n,initialization:pe(l)}),base:a&&f(pe(a),{initialization:pe(l)})};Object.keys(c).forEach((function(e){if(!c[e]){delete c[e]}}));return c};var ye=function e(t,r,i){return function(e){var n=le(e,"BaseURL");var a=me(r,n);var s=f(t,pe(e));var o=ge(e);return a.map((function(e){return{segmentInfo:f(i,o),attributes:f(s,{baseUrl:e})}}))}};var _e=function e(t){return t.reduce((function(e,t){var r=pe(t);var i=ve[r.schemeIdUri];if(i){e[i]={attributes:r};var n=le(t,"cenc:pssh")[0];if(n){var a=de(n);var s=a&&Object(o["a"])(a);e[i].pssh=s}}return e}),{})};var be=function e(t){if(t.schemeIdUri==="urn:scte:dash:cc:cea-608:2015"){var r=typeof t.value!=="string"?[]:t.value.split(";");return r.map((function(e){var t;var r;r=e;if(/^CC\d=/.test(e)){var i=e.split("=");t=i[0];r=i[1]}else if(/^CC\d$/.test(e)){t=e}return{channel:t,language:r}}))}else if(t.schemeIdUri==="urn:scte:dash:cc:cea-708:2015"){var i=typeof t.value!=="string"?[]:t.value.split(";");return i.map((function(e){var t={channel:undefined,language:undefined,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(e)){var r=e.split("="),i=r[0],n=r[1],a=n===void 0?"":n;t.channel=i;t.language=e;a.split(",").forEach((function(e){var r=e.split(":"),i=r[0],n=r[1];if(i==="lang"){t.language=n}else if(i==="er"){t.easyReader=Number(n)}else if(i==="war"){t.aspectRatio=Number(n)}else if(i==="3D"){t["3D"]=Number(n)}}))}else{t.language=e}if(t.channel){t.channel="SERVICE"+t.channel}return t}))}};var Te=function e(t,r,i){return function(e){var n=pe(e);var a=me(r,le(e,"BaseURL"));var s=le(e,"Role")[0];var o={role:pe(s)};var u=f(t,n,o);var l=le(e,"Accessibility")[0];var d=be(pe(l));if(d){u=f(u,{captionServices:d})}var c=le(e,"Label")[0];if(c&&c.childNodes.length){var h=c.childNodes[0].nodeValue.trim();u=f(u,{label:h})}var v=_e(le(e,"ContentProtection"));if(Object.keys(v).length){u=f(u,{contentProtection:v})}var m=ge(e);var g=le(e,"Representation");var y=f(i,m);return p(g.map(ye(u,a,y)))}};var Se=function e(t,r){return function(e,i){var n=me(r,le(e.node,"BaseURL"));var a=f(t,{periodStart:e.attributes.start});if(typeof e.attributes.duration==="number"){a.periodDuration=e.attributes.duration}var s=le(e.node,"AdaptationSet");var o=ge(e.node);return p(s.map(Te(a,n,o)))}};var we=function e(t){var r=t.attributes,i=t.priorPeriodAttributes,n=t.mpdType;if(typeof r.start==="number"){return r.start}if(i&&typeof i.start==="number"&&typeof i.duration==="number"){return i.start+i.duration}if(!i&&n==="static"){return 0}return null};var Ee=function e(t,r){if(r===void 0){r={}}var i=r,n=i.manifestUri,a=n===void 0?"":n,s=i.NOW,o=s===void 0?Date.now():s,u=i.clientOffset,l=u===void 0?0:u;var d=le(t,"Period");if(!d.length){throw new Error(_.INVALID_NUMBER_OF_PERIOD)}var f=le(t,"Location");var c=pe(t);var h=me([a],le(t,"BaseURL"));c.type=c.type||"static";c.sourceDuration=c.mediaPresentationDuration||0;c.NOW=o;c.clientOffset=l;if(f.length){c.locations=f.map(de)}var v=[];d.forEach((function(e,t){var r=pe(e);var i=v[t-1];r.start=we({attributes:r,priorPeriodAttributes:i?i.attributes:null,mpdType:c.type});v.push({node:e,attributes:r})}));return{locations:c.locations,representationInfo:p(v.map(Se(c,h)))}};var ke=function e(t){if(t===""){throw new Error(_.DASH_EMPTY_MANIFEST)}var r=new u["DOMParser"];var i;var n;try{i=r.parseFromString(t,"application/xml");n=i&&i.documentElement.tagName==="MPD"?i.documentElement:null}catch(e){}if(!n||n&&n.getElementsByTagName("parsererror").length>0){throw new Error(_.DASH_INVALID_XML)}return n};var Ae=function e(t){var r=le(t,"UTCTiming")[0];if(!r){return null}var i=pe(r);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT";i.value=Date.parse(i.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(_.UNSUPPORTED_UTC_TIMING_SCHEME)}return i};var Ce=l;var Ie=function e(t,r){if(r===void 0){r={}}var i=Ee(ke(t),r);var n=ue(i.representationInfo);return $({dashPlaylists:n,locations:i.locations,sidxMapping:r.sidxMapping,previousManifest:r.previousManifest})};var De=function e(t){return Ae(ke(t))}},"./node_modules/mux.js/dist/mux.js":function(e,t,r){(function(t,i){true?e.exports=i(r("./node_modules/global/window.js")):undefined})(this,(function(e){"use strict";function t(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var r=t(e);var i=function e(){this.init=function(){var e={};this.on=function(t,r){if(!e[t]){e[t]=[]}e[t]=e[t].concat(r)};this.off=function(t,r){var i;if(!e[t]){return false}i=e[t].indexOf(r);e[t]=e[t].slice();e[t].splice(i,1);return i>-1};this.trigger=function(t){var r,i,n,a;r=e[t];if(!r){return}if(arguments.length===2){n=r.length;for(i=0;i<n;++i){r[i].call(this,arguments[1])}}else{a=[];i=arguments.length;for(i=1;i<arguments.length;++i){a.push(arguments[i])}n=r.length;for(i=0;i<n;++i){r[i].apply(this,a)}}};this.dispose=function(){e={}}}};i.prototype.pipe=function(e){this.on("data",(function(t){e.push(t)}));this.on("done",(function(t){e.flush(t)}));this.on("partialdone",(function(t){e.partialFlush(t)}));this.on("endedtimeline",(function(t){e.endTimeline(t)}));this.on("reset",(function(t){e.reset(t)}));return e};i.prototype.push=function(e){this.trigger("data",e)};i.prototype.flush=function(e){this.trigger("done",e)};i.prototype.partialFlush=function(e){this.trigger("partialdone",e)};i.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)};i.prototype.reset=function(e){this.trigger("reset",e)};var n=i;var a=9e4,s,o,u,l,d,f,c;s=function e(t){return t*a};o=function e(t,r){return t*r};u=function e(t){return t/a};l=function e(t,r){return t/r};d=function e(t,r){return s(l(t,r))};f=function e(t,r){return o(u(t),r)};c=function e(t,r,i){return u(i?t:t-r)};var h={ONE_SECOND_IN_TS:a,secondsToVideoTs:s,secondsToAudioTs:o,videoTsToSeconds:u,audioTsToSeconds:l,audioTsToVideoTs:d,videoTsToAudioTs:f,metadataTsToSeconds:c};var p=h.ONE_SECOND_IN_TS;var v;var m=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];v=function e(t){var r,i=0;v.prototype.init.call(this);this.skipWarn_=function(e,t){this.trigger("log",{level:"warn",message:"adts skiping bytes "+e+" to "+t+" in frame "+i+" outside syncword"})};this.push=function(e){var n=0,a,s,o,u,l;if(!t){i=0}if(e.type!=="audio"){return}if(r&&r.length){o=r;r=new Uint8Array(o.byteLength+e.data.byteLength);r.set(o);r.set(e.data,o.byteLength)}else{r=e.data}var d;while(n+7<r.length){if(r[n]!==255||(r[n+1]&246)!==240){if(typeof d!=="number"){d=n}n++;continue}if(typeof d==="number"){this.skipWarn_(d,n);d=null}s=(~r[n+1]&1)*2;a=(r[n+3]&3)<<11|r[n+4]<<3|(r[n+5]&224)>>5;u=((r[n+6]&3)+1)*1024;l=u*p/m[(r[n+2]&60)>>>2];if(r.byteLength-n<a){break}this.trigger("data",{pts:e.pts+i*l,dts:e.dts+i*l,sampleCount:u,audioobjecttype:(r[n+2]>>>6&3)+1,channelcount:(r[n+2]&1)<<2|(r[n+3]&192)>>>6,samplerate:m[(r[n+2]&60)>>>2],samplingfrequencyindex:(r[n+2]&60)>>>2,samplesize:16,data:r.subarray(n+7+s,n+a)});i++;n+=a}if(typeof d==="number"){this.skipWarn_(d,n);d=null}r=r.subarray(n)};this.flush=function(){i=0;this.trigger("done")};this.reset=function(){r=void 0;this.trigger("reset")};this.endTimeline=function(){r=void 0;this.trigger("endedtimeline")}};v.prototype=new n;var g=v;var y;y=function e(t){var r=t.byteLength,i=0,n=0;this.length=function(){return 8*r};this.bitsAvailable=function(){return 8*r+n};this.loadWord=function(){var e=t.byteLength-r,a=new Uint8Array(4),s=Math.min(4,r);if(s===0){throw new Error("no bytes available")}a.set(t.subarray(e,e+s));i=new DataView(a.buffer).getUint32(0);n=s*8;r-=s};this.skipBits=function(e){var t;if(n>e){i<<=e;n-=e}else{e-=n;t=Math.floor(e/8);e-=t*8;r-=t;this.loadWord();i<<=e;n-=e}};this.readBits=function(e){var t=Math.min(n,e),a=i>>>32-t;n-=t;if(n>0){i<<=t}else if(r>0){this.loadWord()}t=e-t;if(t>0){return a<<t|this.readBits(t)}return a};this.skipLeadingZeros=function(){var e;for(e=0;e<n;++e){if((i&2147483648>>>e)!==0){i<<=e;n-=e;return e}}this.loadWord();return e+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1};this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();if(1&e){return 1+e>>>1}return-1*(e>>>1)};this.readBoolean=function(){return this.readBits(1)===1};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};var _=y;var b,T;var S;T=function e(){var t=0,r,i;T.prototype.init.call(this);this.push=function(e){var n;if(!i){i=e.data}else{n=new Uint8Array(i.byteLength+e.data.byteLength);n.set(i);n.set(e.data,i.byteLength);i=n}var a=i.byteLength;for(;t<a-3;t++){if(i[t+2]===1){r=t+5;break}}while(r<a){switch(i[r]){case 0:if(i[r-1]!==0){r+=2;break}else if(i[r-2]!==0){r++;break}if(t+3!==r-2){this.trigger("data",i.subarray(t+3,r-2))}do{r++}while(i[r]!==1&&r<a);t=r-2;r+=3;break;case 1:if(i[r-1]!==0||i[r-2]!==0){r+=3;break}this.trigger("data",i.subarray(t+3,r-2));t=r-2;r+=3;break;default:r+=3;break}}i=i.subarray(t);r-=t;t=0};this.reset=function(){i=null;t=0;this.trigger("reset")};this.flush=function(){if(i&&i.byteLength>3){this.trigger("data",i.subarray(t+3))}i=null;t=0;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")}};T.prototype=new n;S={100:true,110:true,122:true,244:true,44:true,83:true,86:true,118:true,128:true,138:true,139:true,134:true};b=function e(){var t=new T,r,i,n,a,s,o,u;b.prototype.init.call(this);r=this;this.push=function(e){if(e.type!=="video"){return}i=e.trackId;n=e.pts;a=e.dts;t.push(e)};t.on("data",(function(e){var t={trackId:i,pts:n,dts:a,data:e,nalUnitTypeCode:e[0]&31};switch(t.nalUnitTypeCode){case 5:t.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:t.nalUnitType="sei_rbsp";t.escapedRBSP=s(e.subarray(1));break;case 7:t.nalUnitType="seq_parameter_set_rbsp";t.escapedRBSP=s(e.subarray(1));t.config=o(t.escapedRBSP);break;case 8:t.nalUnitType="pic_parameter_set_rbsp";break;case 9:t.nalUnitType="access_unit_delimiter_rbsp";break}r.trigger("data",t)}));t.on("done",(function(){r.trigger("done")}));t.on("partialdone",(function(){r.trigger("partialdone")}));t.on("reset",(function(){r.trigger("reset")}));t.on("endedtimeline",(function(){r.trigger("endedtimeline")}));this.flush=function(){t.flush()};this.partialFlush=function(){t.partialFlush()};this.reset=function(){t.reset()};this.endTimeline=function(){t.endTimeline()};u=function e(t,r){var i=8,n=8,a,s;for(a=0;a<t;a++){if(n!==0){s=r.readExpGolomb();n=(i+s+256)%256}i=n===0?i:n}};s=function e(t){var r=t.byteLength,i=[],n=1,a,s;while(n<r-2){if(t[n]===0&&t[n+1]===0&&t[n+2]===3){i.push(n+2);n+=2}else{n++}}if(i.length===0){return t}a=r-i.length;s=new Uint8Array(a);var o=0;for(n=0;n<a;o++,n++){if(o===i[0]){o++;i.shift()}s[n]=t[o]}return s};o=function e(t){var r=0,i=0,n=0,a=0,s,o,l,d,f,c,h,p,v,m,g,y=[1,1],b,T;s=new _(t);o=s.readUnsignedByte();d=s.readUnsignedByte();l=s.readUnsignedByte();s.skipUnsignedExpGolomb();if(S[o]){f=s.readUnsignedExpGolomb();if(f===3){s.skipBits(1)}s.skipUnsignedExpGolomb();s.skipUnsignedExpGolomb();s.skipBits(1);if(s.readBoolean()){g=f!==3?8:12;for(T=0;T<g;T++){if(s.readBoolean()){if(T<6){u(16,s)}else{u(64,s)}}}}}s.skipUnsignedExpGolomb();c=s.readUnsignedExpGolomb();if(c===0){s.readUnsignedExpGolomb()}else if(c===1){s.skipBits(1);s.skipExpGolomb();s.skipExpGolomb();h=s.readUnsignedExpGolomb();for(T=0;T<h;T++){s.skipExpGolomb()}}s.skipUnsignedExpGolomb();s.skipBits(1);p=s.readUnsignedExpGolomb();v=s.readUnsignedExpGolomb();m=s.readBits(1);if(m===0){s.skipBits(1)}s.skipBits(1);if(s.readBoolean()){r=s.readUnsignedExpGolomb();i=s.readUnsignedExpGolomb();n=s.readUnsignedExpGolomb();a=s.readUnsignedExpGolomb()}if(s.readBoolean()){if(s.readBoolean()){b=s.readUnsignedByte();switch(b){case 1:y=[1,1];break;case 2:y=[12,11];break;case 3:y=[10,11];break;case 4:y=[16,11];break;case 5:y=[40,33];break;case 6:y=[24,11];break;case 7:y=[20,11];break;case 8:y=[32,11];break;case 9:y=[80,33];break;case 10:y=[18,11];break;case 11:y=[15,11];break;case 12:y=[64,33];break;case 13:y=[160,99];break;case 14:y=[4,3];break;case 15:y=[3,2];break;case 16:y=[2,1];break;case 255:{y=[s.readUnsignedByte()<<8|s.readUnsignedByte(),s.readUnsignedByte()<<8|s.readUnsignedByte()];break}}if(y){y[0]/y[1]}}}return{profileIdc:o,levelIdc:l,profileCompatibility:d,width:(p+1)*16-r*2-i*2,height:(2-m)*(v+1)*16-n*2-a*2,sarRatio:y}}};b.prototype=new n;var w={H264Stream:b,NalByteStream:T};var E={Adts:g,h264:w};var k=Math.pow(2,32);var A=function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);var i;if(r.getBigUint64){i=r.getBigUint64(0);if(i<Number.MAX_SAFE_INTEGER){return Number(i)}return i}return r.getUint32(0)*k+r.getUint32(4)};var C={getUint64:A,MAX_UINT32:k};var I=C.MAX_UINT32;var D,x,L,O,P,R,U,M,N,B,F,j,q,H,G,V,W,z,K,X,Y,Q,$,J,Z,ee,te,re,ie,ne,ae,se,oe,ue,le,de;(function(){var e;$={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]};if(typeof Uint8Array==="undefined"){return}for(e in $){if($.hasOwnProperty(e)){$[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]}}J=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]);ee=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]);Z=new Uint8Array([0,0,0,1]);te=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);re=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);ie={video:te,audio:re};se=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);ae=new Uint8Array([0,0,0,0,0,0,0,0]);oe=new Uint8Array([0,0,0,0,0,0,0,0]);ue=oe;le=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);de=oe;ne=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])})();D=function e(t){var r=[],i=0,n,a,s;for(n=1;n<arguments.length;n++){r.push(arguments[n])}n=r.length;while(n--){i+=r[n].byteLength}a=new Uint8Array(i+8);s=new DataView(a.buffer,a.byteOffset,a.byteLength);s.setUint32(0,a.byteLength);a.set(t,4);for(n=0,i=8;n<r.length;n++){a.set(r[n],i);i+=r[n].byteLength}return a};x=function e(){return D($.dinf,D($.dref,se))};L=function e(t){return D($.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))};O=function e(){return D($.ftyp,J,Z,J,ee)};V=function e(t){return D($.hdlr,ie[t])};P=function e(t){return D($.mdat,t)};G=function e(t){var r=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,t.duration&255,85,196,0,0]);if(t.samplerate){r[12]=t.samplerate>>>24&255;r[13]=t.samplerate>>>16&255;r[14]=t.samplerate>>>8&255;r[15]=t.samplerate&255}return D($.mdhd,r)};H=function e(t){return D($.mdia,G(t),V(t.type),U(t))};R=function e(t){return D($.mfhd,new Uint8Array([0,0,0,0,(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255]))};U=function e(t){return D($.minf,t.type==="video"?D($.vmhd,ne):D($.smhd,ae),x(),z(t))};M=function e(t,r){var i=[],n=r.length;while(n--){i[n]=X(r[n])}return D.apply(null,[$.moof,R(t)].concat(i))};N=function e(t){var r=t.length,i=[];while(r--){i[r]=j(t[r])}return D.apply(null,[$.moov,F(4294967295)].concat(i).concat(B(t)))};B=function e(t){var r=t.length,i=[];while(r--){i[r]=Y(t[r])}return D.apply(null,[$.mvex].concat(i))};F=function e(t){var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return D($.mvhd,r)};W=function e(t){var r=t.samples||[],i=new Uint8Array(4+r.length),n,a;for(a=0;a<r.length;a++){n=r[a].flags;i[a+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy}return D($.sdtp,i)};z=function e(t){return D($.stbl,K(t),D($.stts,de),D($.stsc,ue),D($.stsz,le),D($.stco,oe))};(function(){var e,t;K=function r(i){return D($.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),i.type==="video"?e(i):t(i))};e=function e(t){var r=t.sps||[],i=t.pps||[],n=[],a=[],s,o;for(s=0;s<r.length;s++){n.push((r[s].byteLength&65280)>>>8);n.push(r[s].byteLength&255);n=n.concat(Array.prototype.slice.call(r[s]))}for(s=0;s<i.length;s++){a.push((i[s].byteLength&65280)>>>8);a.push(i[s].byteLength&255);a=a.concat(Array.prototype.slice.call(i[s]))}o=[$.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(t.width&65280)>>8,t.width&255,(t.height&65280)>>8,t.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),D($.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([r.length],n,[i.length],a))),D($.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))];if(t.sarRatio){var u=t.sarRatio[0],l=t.sarRatio[1];o.push(D($.pasp,new Uint8Array([(u&4278190080)>>24,(u&16711680)>>16,(u&65280)>>8,u&255,(l&4278190080)>>24,(l&16711680)>>16,(l&65280)>>8,l&255])))}return D.apply(null,o)};t=function e(t){return D($.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(t.channelcount&65280)>>8,t.channelcount&255,(t.samplesize&65280)>>8,t.samplesize&255,0,0,0,0,(t.samplerate&65280)>>8,t.samplerate&255,0,0]),L(t))}})();q=function e(t){var r=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(t.id&4278190080)>>24,(t.id&16711680)>>16,(t.id&65280)>>8,t.id&255,0,0,0,0,(t.duration&4278190080)>>24,(t.duration&16711680)>>16,(t.duration&65280)>>8,t.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(t.width&65280)>>8,t.width&255,0,0,(t.height&65280)>>8,t.height&255,0,0]);return D($.tkhd,r)};X=function e(t){var r,i,n,a,s,o,u;r=D($.tfhd,new Uint8Array([0,0,0,58,(t.id&4278190080)>>24,(t.id&16711680)>>16,(t.id&65280)>>8,t.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]));o=Math.floor(t.baseMediaDecodeTime/I);u=Math.floor(t.baseMediaDecodeTime%I);i=D($.tfdt,new Uint8Array([1,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,o&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255]));s=32+20+8+16+8+8;if(t.type==="audio"){n=Q(t,s);return D($.traf,r,i,n)}a=W(t);n=Q(t,a.length+s);return D($.traf,r,i,n,a)};j=function e(t){t.duration=t.duration||4294967295;return D($.trak,q(t),H(t))};Y=function e(t){var r=new Uint8Array([0,0,0,0,(t.id&4278190080)>>24,(t.id&16711680)>>16,(t.id&65280)>>8,t.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);if(t.type!=="video"){r[r.length-1]=0}return D($.trex,r)};(function(){var e,t,r;r=function e(t,r){var i=0,n=0,a=0,s=0;if(t.length){if(t[0].duration!==undefined){i=1}if(t[0].size!==undefined){n=2}if(t[0].flags!==undefined){a=4}if(t[0].compositionTimeOffset!==undefined){s=8}}return[0,0,i|n|a|s,1,(t.length&4278190080)>>>24,(t.length&16711680)>>>16,(t.length&65280)>>>8,t.length&255,(r&4278190080)>>>24,(r&16711680)>>>16,(r&65280)>>>8,r&255]};t=function e(t,i){var n,a,s,o,u,l;o=t.samples||[];i+=8+12+16*o.length;s=r(o,i);a=new Uint8Array(s.length+o.length*16);a.set(s);n=s.length;for(l=0;l<o.length;l++){u=o[l];a[n++]=(u.duration&4278190080)>>>24;a[n++]=(u.duration&16711680)>>>16;a[n++]=(u.duration&65280)>>>8;a[n++]=u.duration&255;a[n++]=(u.size&4278190080)>>>24;a[n++]=(u.size&16711680)>>>16;a[n++]=(u.size&65280)>>>8;a[n++]=u.size&255;a[n++]=u.flags.isLeading<<2|u.flags.dependsOn;a[n++]=u.flags.isDependedOn<<6|u.flags.hasRedundancy<<4|u.flags.paddingValue<<1|u.flags.isNonSyncSample;a[n++]=u.flags.degradationPriority&240<<8;a[n++]=u.flags.degradationPriority&15;a[n++]=(u.compositionTimeOffset&4278190080)>>>24;a[n++]=(u.compositionTimeOffset&16711680)>>>16;a[n++]=(u.compositionTimeOffset&65280)>>>8;a[n++]=u.compositionTimeOffset&255}return D($.trun,a)};e=function e(t,i){var n,a,s,o,u,l;o=t.samples||[];i+=8+12+8*o.length;s=r(o,i);n=new Uint8Array(s.length+o.length*8);n.set(s);a=s.length;for(l=0;l<o.length;l++){u=o[l];n[a++]=(u.duration&4278190080)>>>24;n[a++]=(u.duration&16711680)>>>16;n[a++]=(u.duration&65280)>>>8;n[a++]=u.duration&255;n[a++]=(u.size&4278190080)>>>24;n[a++]=(u.size&16711680)>>>16;n[a++]=(u.size&65280)>>>8;n[a++]=u.size&255}return D($.trun,n)};Q=function r(i,n){if(i.type==="audio"){return e(i,n)}return t(i,n)}})();var fe={ftyp:O,mdat:P,moof:M,moov:N,initSegment:function e(t){var r=O(),i=N(t),n;n=new Uint8Array(r.byteLength+i.byteLength);n.set(r);n.set(i,r.byteLength);return n}};var ce=function e(t){return t>>>0};var he=function e(t){return("00"+t.toString(16)).slice(-2)};var pe={toUnsigned:ce,toHexString:he};var ve=function e(t){var r="";r+=String.fromCharCode(t[0]);r+=String.fromCharCode(t[1]);r+=String.fromCharCode(t[2]);r+=String.fromCharCode(t[3]);return r};var me=ve;var ge=pe.toUnsigned;var ye=function e(t,r){var i=[],n,a,s,o,u;if(!r.length){return null}for(n=0;n<t.byteLength;){a=ge(t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]);s=me(t.subarray(n+4,n+8));o=a>1?n+a:t.byteLength;if(s===r[0]){if(r.length===1){i.push(t.subarray(n+8,o))}else{u=e(t.subarray(n+8,o),r.slice(1));if(u.length){i=i.concat(u)}}}n=o}return i};var _e=ye;var be=function e(t){var r=0;var i=String.fromCharCode(t[r]);var n="";while(i!=="\0"){n+=i;r++;i=String.fromCharCode(t[r])}n+=i;return n};var Te={uint8ToCString:be};var Se=Te.uint8ToCString;var we=C.getUint64;var Ee=function e(t){var r=4;var i=t[0];var n,a,s,o,u,l,d,f;if(i===0){n=Se(t.subarray(r));r+=n.length;a=Se(t.subarray(r));r+=a.length;var c=new DataView(t.buffer);s=c.getUint32(r);r+=4;u=c.getUint32(r);r+=4;l=c.getUint32(r);r+=4;d=c.getUint32(r);r+=4}else if(i===1){var c=new DataView(t.buffer);s=c.getUint32(r);r+=4;o=we(t.subarray(r));r+=8;l=c.getUint32(r);r+=4;d=c.getUint32(r);r+=4;n=Se(t.subarray(r));r+=n.length;a=Se(t.subarray(r));r+=a.length}f=new Uint8Array(t.subarray(r,t.byteLength));var h={scheme_id_uri:n,value:a,timescale:s?s:1,presentation_time:o,presentation_time_delta:u,event_duration:l,id:d,message_data:f};return Ae(i,h)?h:undefined};var ke=function e(t,r,i,n){return t||t===0?t/r:n+i/r};var Ae=function e(t,r){var i=r.scheme_id_uri!=="\0";var n=t===0&&Ce(r.presentation_time_delta)&&i;var a=t===1&&Ce(r.presentation_time)&&i;return!(t>1)&&n||a};var Ce=function e(t){return t!==undefined||t!==null};var Ie={parseEmsgBox:Ee,scaleTime:ke};var De=function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:r.getUint32(4)},n=i.flags[2]&1,a=i.flags[2]&2,s=i.flags[2]&8,o=i.flags[2]&16,u=i.flags[2]&32,l=i.flags[0]&65536,d=i.flags[0]&131072,f;f=8;if(n){f+=4;i.baseDataOffset=r.getUint32(12);f+=4}if(a){i.sampleDescriptionIndex=r.getUint32(f);f+=4}if(s){i.defaultSampleDuration=r.getUint32(f);f+=4}if(o){i.defaultSampleSize=r.getUint32(f);f+=4}if(u){i.defaultSampleFlags=r.getUint32(f)}if(l){i.durationIsEmpty=true}if(!n&&d){i.baseDataOffsetIsMoof=true}return i};var xe=De;var Le=function e(t){return{isLeading:(t[0]&12)>>>2,dependsOn:t[0]&3,isDependedOn:(t[1]&192)>>>6,hasRedundancy:(t[1]&48)>>>4,paddingValue:(t[1]&14)>>>1,isNonSyncSample:t[1]&1,degradationPriority:t[2]<<8|t[3]}};var Oe=Le;var Pe=function e(t){var r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},i=new DataView(t.buffer,t.byteOffset,t.byteLength),n=r.flags[2]&1,a=r.flags[2]&4,s=r.flags[1]&1,o=r.flags[1]&2,u=r.flags[1]&4,l=r.flags[1]&8,d=i.getUint32(4),f=8,c;if(n){r.dataOffset=i.getInt32(f);f+=4}if(a&&d){c={flags:Oe(t.subarray(f,f+4))};f+=4;if(s){c.duration=i.getUint32(f);f+=4}if(o){c.size=i.getUint32(f);f+=4}if(l){if(r.version===1){c.compositionTimeOffset=i.getInt32(f)}else{c.compositionTimeOffset=i.getUint32(f)}f+=4}r.samples.push(c);d--}while(d--){c={};if(s){c.duration=i.getUint32(f);f+=4}if(o){c.size=i.getUint32(f);f+=4}if(u){c.flags=Oe(t.subarray(f,f+4));f+=4}if(l){if(r.version===1){c.compositionTimeOffset=i.getInt32(f)}else{c.compositionTimeOffset=i.getUint32(f)}f+=4}r.samples.push(c)}return r};var Re=Pe;var Ue=pe.toUnsigned;var Me=C.getUint64;var Ne=function e(t){var r={version:t[0],flags:new Uint8Array(t.subarray(1,4))};if(r.version===1){r.baseMediaDecodeTime=Me(t.subarray(4))}else{r.baseMediaDecodeTime=Ue(t[4]<<24|t[5]<<16|t[6]<<8|t[7])}return r};var Be=Ne;var Fe=function e(t,r,i){if(!t){return-1}var n=i;for(;n<t.length;n++){if(t[n]===r){return n}}return-1};var je={typedArrayIndexOf:Fe};var qe=je.typedArrayIndexOf,He={Iso88591:0,Utf16:1,Utf16be:2,Utf8:3},Ge=function e(t,r,i){var n,a="";for(n=r;n<i;n++){a+="%"+("00"+t[n].toString(16)).slice(-2)}return a},Ve=function e(t,r,i){return decodeURIComponent(Ge(t,r,i))},We=function e(t,r,i){return unescape(Ge(t,r,i))},ze=function e(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},Ke={APIC:function e(t){var r=1,i,n,a="--\x3e";if(t.data[0]!==He.Utf8){return}i=qe(t.data,0,r);if(i<0){return}t.mimeType=We(t.data,r,i);r=i+1;t.pictureType=t.data[r];r++;n=qe(t.data,0,r);if(n<0){return}t.description=Ve(t.data,r,n);r=n+1;if(t.mimeType===a){t.url=We(t.data,r,t.data.length)}else{t.pictureData=t.data.subarray(r,t.data.length)}},"T*":function e(t){if(t.data[0]!==He.Utf8){return}t.value=Ve(t.data,1,t.data.length).replace(/\0*$/,"");t.values=t.value.split("\0")},TXXX:function e(t){var r;if(t.data[0]!==He.Utf8){return}r=qe(t.data,0,1);if(r===-1){return}t.description=Ve(t.data,1,r);t.value=Ve(t.data,r+1,t.data.length).replace(/\0*$/,"");t.data=t.value},"W*":function e(t){t.url=We(t.data,0,t.data.length).replace(/\0.*$/,"")},WXXX:function e(t){var r;if(t.data[0]!==He.Utf8){return}r=qe(t.data,0,1);if(r===-1){return}t.description=Ve(t.data,1,r);t.url=We(t.data,r+1,t.data.length).replace(/\0.*$/,"")},PRIV:function e(t){var r;for(r=0;r<t.data.length;r++){if(t.data[r]===0){t.owner=We(t.data,0,r);break}}t.privateData=t.data.subarray(r+1);t.data=t.privateData}};var Xe=function e(t){var r,i,n=10,a=0,s=[];if(t.length<10||t[0]!=="I".charCodeAt(0)||t[1]!=="D".charCodeAt(0)||t[2]!=="3".charCodeAt(0)){return}a=ze(t.subarray(6,10));a+=10;var o=t[5]&64;if(o){n+=4;n+=ze(t.subarray(10,14));a-=ze(t.subarray(16,20))}do{r=ze(t.subarray(n+4,n+8));if(r<1){break}i=String.fromCharCode(t[n],t[n+1],t[n+2],t[n+3]);var u={id:i,data:t.subarray(n+10,n+r+10)};u.key=u.id;if(Ke[u.id]){Ke[u.id](u)}else if(u.id[0]==="T"){Ke["T*"](u)}else if(u.id[0]==="W"){Ke["W*"](u)}s.push(u);n+=10;n+=r}while(n<a);return s};var Ye={parseId3Frames:Xe,parseSyncSafeInteger:ze,frameParsers:Ke};var Qe=pe.toUnsigned;var $e=pe.toHexString;var Je=C.getUint64;var Ze,et,tt,rt,it,nt,at;var st=Ye.parseId3Frames;Ze=function e(t){var r={},i=_e(t,["moov","trak"]);return i.reduce((function(e,t){var r,i,n,a,s;r=_e(t,["tkhd"])[0];if(!r){return null}i=r[0];n=i===0?12:20;a=Qe(r[n]<<24|r[n+1]<<16|r[n+2]<<8|r[n+3]);s=_e(t,["mdia","mdhd"])[0];if(!s){return null}i=s[0];n=i===0?12:20;e[a]=Qe(s[n]<<24|s[n+1]<<16|s[n+2]<<8|s[n+3]);return e}),r)};et=function e(t,i){var n;n=_e(i,["moof","traf"]);var a=n.reduce((function(e,i){var n=_e(i,["tfhd"])[0];var a=Qe(n[4]<<24|n[5]<<16|n[6]<<8|n[7]);var s=t[a]||9e4;var o=_e(i,["tfdt"])[0];var u=new DataView(o.buffer,o.byteOffset,o.byteLength);var l;if(o[0]===1){l=Je(o.subarray(4,12))}else{l=u.getUint32(4)}var d;if(typeof l==="bigint"){d=l/r["default"].BigInt(s)}else if(typeof l==="number"&&!isNaN(l)){d=l/s}if(d<Number.MAX_SAFE_INTEGER){d=Number(d)}if(d<e){e=d}return e}),Infinity);return typeof a==="bigint"||isFinite(a)?a:0};tt=function e(t,i){var n=_e(i,["moof","traf"]);var a=0;var s=0;var o;if(n&&n.length){var u=_e(n[0],["tfhd"])[0];var l=_e(n[0],["trun"])[0];var d=_e(n[0],["tfdt"])[0];if(u){var f=xe(u);o=f.trackId}if(d){var c=Be(d);a=c.baseMediaDecodeTime}if(l){var h=Re(l);if(h.samples&&h.samples.length){s=h.samples[0].compositionTimeOffset||0}}}var p=t[o]||9e4;if(typeof a==="bigint"){s=r["default"].BigInt(s);p=r["default"].BigInt(p)}var v=(a+s)/p;if(typeof v==="bigint"&&v<Number.MAX_SAFE_INTEGER){v=Number(v)}return v};rt=function e(t){var r=_e(t,["moov","trak"]);var i=[];r.forEach((function(e){var t=_e(e,["mdia","hdlr"]);var r=_e(e,["tkhd"]);t.forEach((function(e,t){var n=me(e.subarray(8,12));var a=r[t];var s;var o;var u;if(n==="vide"){s=new DataView(a.buffer,a.byteOffset,a.byteLength);o=s.getUint8(0);u=o===0?s.getUint32(12):s.getUint32(20);i.push(u)}}))}));return i};nt=function e(t){var r=t[0];var i=r===0?12:20;return Qe(t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3])};it=function e(t){var r=_e(t,["moov","trak"]);var i=[];r.forEach((function(e){var t={};var r=_e(e,["tkhd"])[0];var n,a;if(r){n=new DataView(r.buffer,r.byteOffset,r.byteLength);a=n.getUint8(0);t.id=a===0?n.getUint32(12):n.getUint32(20)}var s=_e(e,["mdia","hdlr"])[0];if(s){var o=me(s.subarray(8,12));if(o==="vide"){t.type="video"}else if(o==="soun"){t.type="audio"}else{t.type=o}}var u=_e(e,["mdia","minf","stbl","stsd"])[0];if(u){var l=u.subarray(8);t.codec=me(l.subarray(4,8));var d=_e(l,[t.codec])[0];var f,c;if(d){if(/^[asm]vc[1-9]$/i.test(t.codec)){f=d.subarray(78);c=me(f.subarray(4,8));if(c==="avcC"&&f.length>11){t.codec+=".";t.codec+=$e(f[9]);t.codec+=$e(f[10]);t.codec+=$e(f[11])}else{t.codec="avc1.4d400d"}}else if(/^mp4[a,v]$/i.test(t.codec)){f=d.subarray(28);c=me(f.subarray(4,8));if(c==="esds"&&f.length>20&&f[19]!==0){t.codec+="."+$e(f[19]);t.codec+="."+$e(f[20]>>>2&63).replace(/^0/,"")}else{t.codec="mp4a.40.2"}}else{t.codec=t.codec.toLowerCase()}}}var h=_e(e,["mdia","mdhd"])[0];if(h){t.timescale=nt(h)}i.push(t)}));return i};at=function e(t,r){if(r===void 0){r=0}var i=_e(t,["emsg"]);return i.map((function(e){var t=Ie.parseEmsgBox(new Uint8Array(e));var i=st(t.message_data);return{cueTime:Ie.scaleTime(t.presentation_time,t.timescale,t.presentation_time_delta,r),duration:Ie.scaleTime(t.event_duration,t.timescale),frames:i}}))};var ot={findBox:_e,parseType:me,timescale:Ze,startTime:et,compositionStartTime:tt,videoTrackIds:rt,tracks:it,getTimescaleFromMediaHeader:nt,getEmsgID3:at};var ut=function e(t){var r,i,n=[],a=[];a.byteLength=0;a.nalCount=0;a.duration=0;n.byteLength=0;for(r=0;r<t.length;r++){i=t[r];if(i.nalUnitType==="access_unit_delimiter_rbsp"){if(n.length){n.duration=i.dts-n.dts;a.byteLength+=n.byteLength;a.nalCount+=n.length;a.duration+=n.duration;a.push(n)}n=[i];n.byteLength=i.data.byteLength;n.pts=i.pts;n.dts=i.dts}else{if(i.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"){n.keyFrame=true}n.duration=i.dts-n.dts;n.byteLength+=i.data.byteLength;n.push(i)}}if(a.length&&(!n.duration||n.duration<=0)){n.duration=a[a.length-1].duration}a.byteLength+=n.byteLength;a.nalCount+=n.length;a.duration+=n.duration;a.push(n);return a};var lt=function e(t){var r,i,n=[],a=[];n.byteLength=0;n.nalCount=0;n.duration=0;n.pts=t[0].pts;n.dts=t[0].dts;a.byteLength=0;a.nalCount=0;a.duration=0;a.pts=t[0].pts;a.dts=t[0].dts;for(r=0;r<t.length;r++){i=t[r];if(i.keyFrame){if(n.length){a.push(n);a.byteLength+=n.byteLength;a.nalCount+=n.nalCount;a.duration+=n.duration}n=[i];n.nalCount=i.length;n.byteLength=i.byteLength;n.pts=i.pts;n.dts=i.dts;n.duration=i.duration}else{n.duration+=i.duration;n.nalCount+=i.length;n.byteLength+=i.byteLength;n.push(i)}}if(a.length&&n.duration<=0){n.duration=a[a.length-1].duration}a.byteLength+=n.byteLength;a.nalCount+=n.nalCount;a.duration+=n.duration;a.push(n);return a};var dt=function e(t){var r;if(!t[0][0].keyFrame&&t.length>1){r=t.shift();t.byteLength-=r.byteLength;t.nalCount-=r.nalCount;t[0][0].dts=r.dts;t[0][0].pts=r.pts;t[0][0].duration+=r.duration}return t};var ft=function e(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}};var ct=function e(t,r){var i=ft();i.dataOffset=r;i.compositionTimeOffset=t.pts-t.dts;i.duration=t.duration;i.size=4*t.length;i.size+=t.byteLength;if(t.keyFrame){i.flags.dependsOn=2;i.flags.isNonSyncSample=0}return i};var ht=function e(t,r){var i,n,a,s,o,u=r||0,l=[];for(i=0;i<t.length;i++){s=t[i];for(n=0;n<s.length;n++){o=s[n];a=ct(o,u);u+=a.size;l.push(a)}}return l};var pt=function e(t){var r,i,n,a,s,o,u=0,l=t.byteLength,d=t.nalCount,f=l+4*d,c=new Uint8Array(f),h=new DataView(c.buffer);for(r=0;r<t.length;r++){a=t[r];for(i=0;i<a.length;i++){s=a[i];for(n=0;n<s.length;n++){o=s[n];h.setUint32(u,o.data.byteLength);u+=4;c.set(o.data,u);u+=o.data.byteLength}}}return c};var vt=function e(t,r){var i,n=r||0,a=[];i=ct(t,n);a.push(i);return a};var mt=function e(t){var r,i,n=0,a=t.byteLength,s=t.length,o=a+4*s,u=new Uint8Array(o),l=new DataView(u.buffer);for(r=0;r<t.length;r++){i=t[r];l.setUint32(n,i.data.byteLength);n+=4;u.set(i.data,n);n+=i.data.byteLength}return u};var gt={groupNalsIntoFrames:ut,groupFramesIntoGops:lt,extendFirstKeyFrame:dt,generateSampleTable:ht,concatenateNalData:pt,generateSampleTableForFrame:vt,concatenateNalDataForFrame:mt};var yt=[33,16,5,32,164,27];var _t=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252];var bt=function e(t){var r=[];while(t--){r.push(0)}return r};var Tt=function e(t){return Object.keys(t).reduce((function(e,r){e[r]=new Uint8Array(t[r].reduce((function(e,t){return e.concat(t)}),[]));return e}),{})};var St;var wt=function e(){if(!St){var t={96e3:[yt,[227,64],bt(154),[56]],88200:[yt,[231],bt(170),[56]],64e3:[yt,[248,192],bt(240),[56]],48e3:[yt,[255,192],bt(268),[55,148,128],bt(54),[112]],44100:[yt,[255,192],bt(268),[55,163,128],bt(84),[112]],32e3:[yt,[255,192],bt(268),[55,234],bt(226),[112]],24e3:[yt,[255,192],bt(268),[55,255,128],bt(268),[111,112],bt(126),[224]],16e3:[yt,[255,192],bt(268),[55,255,128],bt(268),[111,255],bt(269),[223,108],bt(195),[1,192]],12e3:[_t,bt(268),[3,127,248],bt(268),[6,255,240],bt(268),[13,255,224],bt(268),[27,253,128],bt(259),[56]],11025:[_t,bt(268),[3,127,248],bt(268),[6,255,240],bt(268),[13,255,224],bt(268),[27,255,192],bt(268),[55,175,128],bt(108),[112]],8e3:[_t,bt(268),[3,121,16],bt(47),[7]]};St=Tt(t)}return St};var Et=function e(t){var r,i,n=0;for(r=0;r<t.length;r++){i=t[r];n+=i.data.byteLength}return n};var kt=function e(t,r,i,n){var a,s=0,o=0,u=0,l=0,d,f,c;if(!r.length){return}a=h.audioTsToVideoTs(t.baseMediaDecodeTime,t.samplerate);s=Math.ceil(h.ONE_SECOND_IN_TS/(t.samplerate/1024));if(i&&n){o=a-Math.max(i,n);u=Math.floor(o/s);l=u*s}if(u<1||l>h.ONE_SECOND_IN_TS/2){return}d=wt()[t.samplerate];if(!d){d=r[0].data}for(f=0;f<u;f++){c=r[0];r.splice(0,0,{data:d,dts:c.dts-s,pts:c.pts-s})}t.baseMediaDecodeTime-=Math.floor(h.videoTsToAudioTs(l,t.samplerate));return l};var At=function e(t,r,i){if(r.minSegmentDts>=i){return t}r.minSegmentDts=Infinity;return t.filter((function(e){if(e.dts>=i){r.minSegmentDts=Math.min(r.minSegmentDts,e.dts);r.minSegmentPts=r.minSegmentDts;return true}return false}))};var Ct=function e(t){var r,i,n=[];for(r=0;r<t.length;r++){i=t[r];n.push({size:i.data.byteLength,duration:1024})}return n};var It=function e(t){var r,i,n=0,a=new Uint8Array(Et(t));for(r=0;r<t.length;r++){i=t[r];a.set(i.data,n);n+=i.data.byteLength}return a};var Dt={prefixWithSilence:kt,trimAdtsFramesByEarliestDts:At,generateSampleTable:Ct,concatenateFrameData:It};var xt=h.ONE_SECOND_IN_TS;var Lt=function e(t,r){if(typeof r.pts==="number"){if(t.timelineStartInfo.pts===undefined){t.timelineStartInfo.pts=r.pts}if(t.minSegmentPts===undefined){t.minSegmentPts=r.pts}else{t.minSegmentPts=Math.min(t.minSegmentPts,r.pts)}if(t.maxSegmentPts===undefined){t.maxSegmentPts=r.pts}else{t.maxSegmentPts=Math.max(t.maxSegmentPts,r.pts)}}if(typeof r.dts==="number"){if(t.timelineStartInfo.dts===undefined){t.timelineStartInfo.dts=r.dts}if(t.minSegmentDts===undefined){t.minSegmentDts=r.dts}else{t.minSegmentDts=Math.min(t.minSegmentDts,r.dts)}if(t.maxSegmentDts===undefined){t.maxSegmentDts=r.dts}else{t.maxSegmentDts=Math.max(t.maxSegmentDts,r.dts)}}};var Ot=function e(t){delete t.minSegmentDts;delete t.maxSegmentDts;delete t.minSegmentPts;delete t.maxSegmentPts};var Pt=function e(t,r){var i,n,a=t.minSegmentDts;if(!r){a-=t.timelineStartInfo.dts}i=t.timelineStartInfo.baseMediaDecodeTime;i+=a;i=Math.max(0,i);if(t.type==="audio"){n=t.samplerate/xt;i*=n;i=Math.floor(i)}return i};var Rt={clearDtsInfo:Ot,calculateTrackBaseMediaDecodeTime:Pt,collectDtsInfo:Lt};var Ut=4,Mt=128;var Nt=function e(t){var r=0,i={payloadType:-1,payloadSize:0},n=0,a=0;while(r<t.byteLength){if(t[r]===Mt){break}while(t[r]===255){n+=255;r++}n+=t[r++];while(t[r]===255){a+=255;r++}a+=t[r++];if(!i.payload&&n===Ut){var s=String.fromCharCode(t[r+3],t[r+4],t[r+5],t[r+6]);if(s==="GA94"){i.payloadType=n;i.payloadSize=a;i.payload=t.subarray(r,r+a);break}else{i.payload=void 0}}r+=a;n=0;a=0}return i};var Bt=function e(t){if(t.payload[0]!==181){return null}if((t.payload[1]<<8|t.payload[2])!==49){return null}if(String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6])!=="GA94"){return null}if(t.payload[7]!==3){return null}return t.payload.subarray(8,t.payload.length-1)};var Ft=function e(t,r){var i=[],n,a,s,o;if(!(r[0]&64)){return i}a=r[0]&31;for(n=0;n<a;n++){s=n*3;o={type:r[s+2]&3,pts:t};if(r[s+2]&4){o.ccData=r[s+3]<<8|r[s+4];i.push(o)}}return i};var jt=function e(t){var r=t.byteLength,i=[],n=1,a,s;while(n<r-2){if(t[n]===0&&t[n+1]===0&&t[n+2]===3){i.push(n+2);n+=2}else{n++}}if(i.length===0){return t}a=r-i.length;s=new Uint8Array(a);var o=0;for(n=0;n<a;o++,n++){if(o===i[0]){o++;i.shift()}s[n]=t[o]}return s};var qt={parseSei:Nt,parseUserData:Bt,parseCaptionPackets:Ft,discardEmulationPreventionBytes:jt,USER_DATA_REGISTERED_ITU_T_T35:Ut};var Ht=function e(t){t=t||{};e.prototype.init.call(this);this.parse708captions_=typeof t.parse708captions==="boolean"?t.parse708captions:true;this.captionPackets_=[];this.ccStreams_=[new er(0,0),new er(0,1),new er(1,0),new er(1,1)];if(this.parse708captions_){this.cc708Stream_=new Xt({captionServices:t.captionServices})}this.reset();this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data"));e.on("partialdone",this.trigger.bind(this,"partialdone"));e.on("done",this.trigger.bind(this,"done"))}),this);if(this.parse708captions_){this.cc708Stream_.on("data",this.trigger.bind(this,"data"));this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone"));this.cc708Stream_.on("done",this.trigger.bind(this,"done"))}};Ht.prototype=new n;Ht.prototype.push=function(e){var t,r,i;if(e.nalUnitType!=="sei_rbsp"){return}t=qt.parseSei(e.escapedRBSP);if(!t.payload){return}if(t.payloadType!==qt.USER_DATA_REGISTERED_ITU_T_T35){return}r=qt.parseUserData(t);if(!r){return}if(e.dts<this.latestDts_){this.ignoreNextEqualDts_=true;return}else if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;if(!this.numSameDts_){this.ignoreNextEqualDts_=false}return}i=qt.parseCaptionPackets(e.pts,r);this.captionPackets_=this.captionPackets_.concat(i);if(this.latestDts_!==e.dts){this.numSameDts_=0}this.numSameDts_++;this.latestDts_=e.dts};Ht.prototype.flushCCStreams=function(e){this.ccStreams_.forEach((function(t){return e==="flush"?t.flush():t.partialFlush()}),this)};Ht.prototype.flushStream=function(e){if(!this.captionPackets_.length){this.flushCCStreams(e);return}this.captionPackets_.forEach((function(e,t){e.presortIndex=t}));this.captionPackets_.sort((function(e,t){if(e.pts===t.pts){return e.presortIndex-t.presortIndex}return e.pts-t.pts}));this.captionPackets_.forEach((function(e){if(e.type<2){this.dispatchCea608Packet(e)}else{this.dispatchCea708Packet(e)}}),this);this.captionPackets_.length=0;this.flushCCStreams(e)};Ht.prototype.flush=function(){return this.flushStream("flush")};Ht.prototype.partialFlush=function(){return this.flushStream("partialFlush")};Ht.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=false;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach((function(e){e.reset()}))};Ht.prototype.dispatchCea608Packet=function(e){if(this.setsTextOrXDSActive(e)){this.activeCea608Channel_[e.type]=null}else if(this.setsChannel1Active(e)){this.activeCea608Channel_[e.type]=0}else if(this.setsChannel2Active(e)){this.activeCea608Channel_[e.type]=1}if(this.activeCea608Channel_[e.type]===null){return}this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)};Ht.prototype.setsChannel1Active=function(e){return(e.ccData&30720)===4096};Ht.prototype.setsChannel2Active=function(e){return(e.ccData&30720)===6144};Ht.prototype.setsTextOrXDSActive=function(e){return(e.ccData&28928)===256||(e.ccData&30974)===4138||(e.ccData&30974)===6186};Ht.prototype.dispatchCea708Packet=function(e){if(this.parse708captions_){this.cc708Stream_.push(e)}};var Gt={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600};var Vt=function e(t){var r=Gt[t]||t;if(t&4096&&t===r){return""}return String.fromCharCode(r)};var Wt=function e(t){return 32<=t&&t<=127||160<=t&&t<=255};var zt=function e(t){this.windowNum=t;this.reset()};zt.prototype.reset=function(){this.clearText();this.pendingNewLine=false;this.winAttr={};this.penAttr={};this.penLoc={};this.penColor={};this.visible=0;this.rowLock=0;this.columnLock=0;this.priority=0;this.relativePositioning=0;this.anchorVertical=0;this.anchorHorizontal=0;this.anchorPoint=0;this.rowCount=1;this.virtualRowCount=this.rowCount+1;this.columnCount=41;this.windowStyle=0;this.penStyle=0};zt.prototype.getText=function(){return this.rows.join("\n")};zt.prototype.clearText=function(){this.rows=[""];this.rowIdx=0};zt.prototype.newLine=function(e){if(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow==="function"){this.beforeRowOverflow(e)}if(this.rows.length>0){this.rows.push("");this.rowIdx++}while(this.rows.length>this.virtualRowCount){this.rows.shift();this.rowIdx--}};zt.prototype.isEmpty=function(){if(this.rows.length===0){return true}else if(this.rows.length===1){return this.rows[0]===""}return false};zt.prototype.addText=function(e){this.rows[this.rowIdx]+=e};zt.prototype.backspace=function(){if(!this.isEmpty()){var e=this.rows[this.rowIdx];this.rows[this.rowIdx]=e.substr(0,e.length-1)}};var Kt=function e(t,r,i){this.serviceNum=t;this.text="";this.currentWindow=new zt(-1);this.windows=[];this.stream=i;if(typeof r==="string"){this.createTextDecoder(r)}};Kt.prototype.init=function(e,t){this.startPts=e;for(var r=0;r<8;r++){this.windows[r]=new zt(r);if(typeof t==="function"){this.windows[r].beforeRowOverflow=t}}};Kt.prototype.setCurrentWindow=function(e){this.currentWindow=this.windows[e]};Kt.prototype.createTextDecoder=function(e){if(typeof TextDecoder==="undefined"){this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"})}else{try{this.textDecoder_=new TextDecoder(e)}catch(t){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+e+" encoding. "+t})}}};var Xt=function e(t){t=t||{};e.prototype.init.call(this);var r=this;var i=t.captionServices||{};var n={};var a;Object.keys(i).forEach((function(e){a=i[e];if(/^SERVICE/.test(e)){n[e]=a.encoding}}));this.serviceEncodings=n;this.current708Packet=null;this.services={};this.push=function(e){if(e.type===3){r.new708Packet();r.add708Bytes(e)}else{if(r.current708Packet===null){r.new708Packet()}r.add708Bytes(e)}}};Xt.prototype=new n;Xt.prototype.new708Packet=function(){if(this.current708Packet!==null){this.push708Packet()}this.current708Packet={data:[],ptsVals:[]}};Xt.prototype.add708Bytes=function(e){var t=e.ccData;var r=t>>>8;var i=t&255;this.current708Packet.ptsVals.push(e.pts);this.current708Packet.data.push(r);this.current708Packet.data.push(i)};Xt.prototype.push708Packet=function(){var e=this.current708Packet;var t=e.data;var r=null;var i=null;var n=0;var a=t[n++];e.seq=a>>6;e.sizeCode=a&63;for(;n<t.length;n++){a=t[n++];r=a>>5;i=a&31;if(r===7&&i>0){a=t[n++];r=a}this.pushServiceBlock(r,n,i);if(i>0){n+=i-1}}};Xt.prototype.pushServiceBlock=function(e,t,r){var i;var n=t;var a=this.current708Packet.data;var s=this.services[e];if(!s){s=this.initService(e,n)}for(;n<t+r&&n<a.length;n++){i=a[n];if(Wt(i)){n=this.handleText(n,s)}else if(i===24){n=this.multiByteCharacter(n,s)}else if(i===16){n=this.extendedCommands(n,s)}else if(128<=i&&i<=135){n=this.setCurrentWindow(n,s)}else if(152<=i&&i<=159){n=this.defineWindow(n,s)}else if(i===136){n=this.clearWindows(n,s)}else if(i===140){n=this.deleteWindows(n,s)}else if(i===137){n=this.displayWindows(n,s)}else if(i===138){n=this.hideWindows(n,s)}else if(i===139){n=this.toggleWindows(n,s)}else if(i===151){n=this.setWindowAttributes(n,s)}else if(i===144){n=this.setPenAttributes(n,s)}else if(i===145){n=this.setPenColor(n,s)}else if(i===146){n=this.setPenLocation(n,s)}else if(i===143){s=this.reset(n,s)}else if(i===8){s.currentWindow.backspace()}else if(i===12){s.currentWindow.clearText()}else if(i===13){s.currentWindow.pendingNewLine=true}else if(i===14){s.currentWindow.clearText()}else if(i===141){n++}else;}};Xt.prototype.extendedCommands=function(e,t){var r=this.current708Packet.data;var i=r[++e];if(Wt(i)){e=this.handleText(e,t,{isExtended:true})}return e};Xt.prototype.getPts=function(e){return this.current708Packet.ptsVals[Math.floor(e/2)]};Xt.prototype.initService=function(e,t){var r="SERVICE"+e;var i=this;var r;var n;if(r in this.serviceEncodings){n=this.serviceEncodings[r]}this.services[e]=new Kt(e,n,i);this.services[e].init(this.getPts(t),(function(t){i.flushDisplayed(t,i.services[e])}));return this.services[e]};Xt.prototype.handleText=function(e,t,r){var i=r&&r.isExtended;var n=r&&r.isMultiByte;var a=this.current708Packet.data;var s=i?4096:0;var o=a[e];var u=a[e+1];var l=t.currentWindow;var d;var f;if(t.textDecoder_&&!i){if(n){f=[o,u];e++}else{f=[o]}d=t.textDecoder_.decode(new Uint8Array(f))}else{d=Vt(s|o)}if(l.pendingNewLine&&!l.isEmpty()){l.newLine(this.getPts(e))}l.pendingNewLine=false;l.addText(d);return e};Xt.prototype.multiByteCharacter=function(e,t){var r=this.current708Packet.data;var i=r[e+1];var n=r[e+2];if(Wt(i)&&Wt(n)){e=this.handleText(++e,t,{isMultiByte:true})}return e};Xt.prototype.setCurrentWindow=function(e,t){var r=this.current708Packet.data;var i=r[e];var n=i&7;t.setCurrentWindow(n);return e};Xt.prototype.defineWindow=function(e,t){var r=this.current708Packet.data;var i=r[e];var n=i&7;t.setCurrentWindow(n);var a=t.currentWindow;i=r[++e];a.visible=(i&32)>>5;a.rowLock=(i&16)>>4;a.columnLock=(i&8)>>3;a.priority=i&7;i=r[++e];a.relativePositioning=(i&128)>>7;a.anchorVertical=i&127;i=r[++e];a.anchorHorizontal=i;i=r[++e];a.anchorPoint=(i&240)>>4;a.rowCount=i&15;i=r[++e];a.columnCount=i&63;i=r[++e];a.windowStyle=(i&56)>>3;a.penStyle=i&7;a.virtualRowCount=a.rowCount+1;return e};Xt.prototype.setWindowAttributes=function(e,t){var r=this.current708Packet.data;var i=r[e];var n=t.currentWindow.winAttr;i=r[++e];n.fillOpacity=(i&192)>>6;n.fillRed=(i&48)>>4;n.fillGreen=(i&12)>>2;n.fillBlue=i&3;i=r[++e];n.borderType=(i&192)>>6;n.borderRed=(i&48)>>4;n.borderGreen=(i&12)>>2;n.borderBlue=i&3;i=r[++e];n.borderType+=(i&128)>>5;n.wordWrap=(i&64)>>6;n.printDirection=(i&48)>>4;n.scrollDirection=(i&12)>>2;n.justify=i&3;i=r[++e];n.effectSpeed=(i&240)>>4;n.effectDirection=(i&12)>>2;n.displayEffect=i&3;return e};Xt.prototype.flushDisplayed=function(e,t){var r=[];for(var i=0;i<8;i++){if(t.windows[i].visible&&!t.windows[i].isEmpty()){r.push(t.windows[i].getText())}}t.endPts=e;t.text=r.join("\n\n");this.pushCaption(t);t.startPts=e};Xt.prototype.pushCaption=function(e){if(e.text!==""){this.trigger("data",{startPts:e.startPts,endPts:e.endPts,text:e.text,stream:"cc708_"+e.serviceNum});e.text="";e.startPts=e.endPts}};Xt.prototype.displayWindows=function(e,t){var r=this.current708Packet.data;var i=r[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++){if(i&1<<a){t.windows[a].visible=1}}return e};Xt.prototype.hideWindows=function(e,t){var r=this.current708Packet.data;var i=r[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++){if(i&1<<a){t.windows[a].visible=0}}return e};Xt.prototype.toggleWindows=function(e,t){var r=this.current708Packet.data;var i=r[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++){if(i&1<<a){t.windows[a].visible^=1}}return e};Xt.prototype.clearWindows=function(e,t){var r=this.current708Packet.data;var i=r[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++){if(i&1<<a){t.windows[a].clearText()}}return e};Xt.prototype.deleteWindows=function(e,t){var r=this.current708Packet.data;var i=r[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++){if(i&1<<a){t.windows[a].reset()}}return e};Xt.prototype.setPenAttributes=function(e,t){var r=this.current708Packet.data;var i=r[e];var n=t.currentWindow.penAttr;i=r[++e];n.textTag=(i&240)>>4;n.offset=(i&12)>>2;n.penSize=i&3;i=r[++e];n.italics=(i&128)>>7;n.underline=(i&64)>>6;n.edgeType=(i&56)>>3;n.fontStyle=i&7;return e};Xt.prototype.setPenColor=function(e,t){var r=this.current708Packet.data;var i=r[e];var n=t.currentWindow.penColor;i=r[++e];n.fgOpacity=(i&192)>>6;n.fgRed=(i&48)>>4;n.fgGreen=(i&12)>>2;n.fgBlue=i&3;i=r[++e];n.bgOpacity=(i&192)>>6;n.bgRed=(i&48)>>4;n.bgGreen=(i&12)>>2;n.bgBlue=i&3;i=r[++e];n.edgeRed=(i&48)>>4;n.edgeGreen=(i&12)>>2;n.edgeBlue=i&3;return e};Xt.prototype.setPenLocation=function(e,t){var r=this.current708Packet.data;var i=r[e];var n=t.currentWindow.penLoc;t.currentWindow.pendingNewLine=true;i=r[++e];n.row=i&15;i=r[++e];n.column=i&63;return e};Xt.prototype.reset=function(e,t){var r=this.getPts(e);this.flushDisplayed(r,t);return this.initService(t.serviceNum,e)};var Yt={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496};var Qt=function e(t){if(t===null){return""}t=Yt[t]||t;return String.fromCharCode(t)};var $t=14;var Jt=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152];var Zt=function e(){var t=[],r=$t+1;while(r--){t.push({text:"",indent:0,offset:0})}return t};var er=function e(t,r){e.prototype.init.call(this);this.field_=t||0;this.dataChannel_=r||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(e){var t,r,i,n,a;t=e.ccData&32639;if(t===this.lastControlCode_){this.lastControlCode_=null;return}if((t&61440)===4096){this.lastControlCode_=t}else if(t!==this.PADDING_){this.lastControlCode_=null}i=t>>>8;n=t&255;if(t===this.PADDING_){return}else if(t===this.RESUME_CAPTION_LOADING_){this.mode_="popOn"}else if(t===this.END_OF_CAPTION_){this.mode_="popOn";this.clearFormatting(e.pts);this.flushDisplayed(e.pts);r=this.displayed_;this.displayed_=this.nonDisplayed_;this.nonDisplayed_=r;this.startPts_=e.pts}else if(t===this.ROLL_UP_2_ROWS_){this.rollUpRows_=2;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_3_ROWS_){this.rollUpRows_=3;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_4_ROWS_){this.rollUpRows_=4;this.setRollUp(e.pts)}else if(t===this.CARRIAGE_RETURN_){this.clearFormatting(e.pts);this.flushDisplayed(e.pts);this.shiftRowsUp_();this.startPts_=e.pts}else if(t===this.BACKSPACE_){if(this.mode_==="popOn"){this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1)}else{this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1)}}else if(t===this.ERASE_DISPLAYED_MEMORY_){this.flushDisplayed(e.pts);this.displayed_=Zt()}else if(t===this.ERASE_NON_DISPLAYED_MEMORY_){this.nonDisplayed_=Zt()}else if(t===this.RESUME_DIRECT_CAPTIONING_){if(this.mode_!=="paintOn"){this.flushDisplayed(e.pts);this.displayed_=Zt()}this.mode_="paintOn";this.startPts_=e.pts}else if(this.isSpecialCharacter(i,n)){i=(i&3)<<8;a=Qt(i|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isExtCharacter(i,n)){if(this.mode_==="popOn"){this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1)}else{this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1)}i=(i&3)<<8;a=Qt(i|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isMidRowCode(i,n)){this.clearFormatting(e.pts);this[this.mode_](e.pts," ");this.column_++;if((n&14)===14){this.addFormatting(e.pts,["i"])}if((n&1)===1){this.addFormatting(e.pts,["u"])}}else if(this.isOffsetControlCode(i,n)){var s=n&3;this.nonDisplayed_[this.row_].offset=s;this.column_+=s}else if(this.isPAC(i,n)){var o=Jt.indexOf(t&7968);if(this.mode_==="rollUp"){if(o-this.rollUpRows_+1<0){o=this.rollUpRows_-1}this.setRollUp(e.pts,o)}if(o!==this.row_){this.clearFormatting(e.pts);this.row_=o}if(n&1&&this.formatting_.indexOf("u")===-1){this.addFormatting(e.pts,["u"])}if((t&16)===16){var u=(t&14)>>1;this.column_=u*4;this.nonDisplayed_[this.row_].indent+=u}if(this.isColorPAC(n)){if((n&14)===14){this.addFormatting(e.pts,["i"])}}}else if(this.isNormalChar(i)){if(n===0){n=null}a=Qt(i);a+=Qt(n);this[this.mode_](e.pts,a);this.column_+=a.length}}};er.prototype=new n;er.prototype.flushDisplayed=function(e){var t=this;var r=function e(r){t.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+r+"."})};var i=[];this.displayed_.forEach((function(e,t){if(e&&e.text&&e.text.length){try{e.text=e.text.trim()}catch(e){r(t)}if(e.text.length){i.push({text:e.text,line:t+1,position:10+Math.min(70,e.indent*10)+e.offset*2.5})}}else if(e===undefined||e===null){r(t)}}));if(i.length){this.trigger("data",{startPts:this.startPts_,endPts:e,content:i,stream:this.name_})}};er.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=Zt();this.nonDisplayed_=Zt();this.lastControlCode_=null;this.column_=0;this.row_=$t;this.rollUpRows_=2;this.formatting_=[]};er.prototype.setConstants=function(){if(this.dataChannel_===0){this.BASE_=16;this.EXT_=17;this.CONTROL_=(20|this.field_)<<8;this.OFFSET_=23}else if(this.dataChannel_===1){this.BASE_=24;this.EXT_=25;this.CONTROL_=(28|this.field_)<<8;this.OFFSET_=31}this.PADDING_=0;this.RESUME_CAPTION_LOADING_=this.CONTROL_|32;this.END_OF_CAPTION_=this.CONTROL_|47;this.ROLL_UP_2_ROWS_=this.CONTROL_|37;this.ROLL_UP_3_ROWS_=this.CONTROL_|38;this.ROLL_UP_4_ROWS_=this.CONTROL_|39;this.CARRIAGE_RETURN_=this.CONTROL_|45;this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41;this.BACKSPACE_=this.CONTROL_|33;this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44;this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46};er.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63};er.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63};er.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47};er.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35};er.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127};er.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127};er.prototype.isNormalChar=function(e){return e>=32&&e<=127};er.prototype.setRollUp=function(e,t){if(this.mode_!=="rollUp"){this.row_=$t;this.mode_="rollUp";this.flushDisplayed(e);this.nonDisplayed_=Zt();this.displayed_=Zt()}if(t!==undefined&&t!==this.row_){for(var r=0;r<this.rollUpRows_;r++){this.displayed_[t-r]=this.displayed_[this.row_-r];this.displayed_[this.row_-r]={text:"",indent:0,offset:0}}}if(t===undefined){t=this.row_}this.topRow_=t-this.rollUpRows_+1};er.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var r=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,r)};er.prototype.clearFormatting=function(e){if(!this.formatting_.length){return}var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[];this[this.mode_](e,t)};er.prototype.popOn=function(e,t){var r=this.nonDisplayed_[this.row_].text;r+=t;this.nonDisplayed_[this.row_].text=r};er.prototype.rollUp=function(e,t){var r=this.displayed_[this.row_].text;r+=t;this.displayed_[this.row_].text=r};er.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++){this.displayed_[e]={text:"",indent:0,offset:0}}for(e=this.row_+1;e<$t+1;e++){this.displayed_[e]={text:"",indent:0,offset:0}}for(e=this.topRow_;e<this.row_;e++){this.displayed_[e]=this.displayed_[e+1]}this.displayed_[this.row_]={text:"",indent:0,offset:0}};er.prototype.paintOn=function(e,t){var r=this.displayed_[this.row_].text;r+=t;this.displayed_[this.row_].text=r};var tr={CaptionStream:Ht,Cea608Stream:er,Cea708Stream:Xt};var rr={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21};var ir=8589934592;var nr=4294967296;var ar="shared";var sr=function e(t,r){var i=1;if(t>r){i=-1}while(Math.abs(r-t)>nr){t+=i*ir}return t};var or=function e(t){var r,i;e.prototype.init.call(this);this.type_=t||ar;this.push=function(e){if(this.type_!==ar&&e.type!==this.type_){return}if(i===undefined){i=e.dts}e.dts=sr(e.dts,i);e.pts=sr(e.pts,i);r=e.dts;this.trigger("data",e)};this.flush=function(){i=r;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};this.discontinuity=function(){i=void 0;r=void 0};this.reset=function(){this.discontinuity();this.trigger("reset")}};or.prototype=new n;var ur={TimestampRolloverStream:or,handleRollover:sr};var lr;lr=function e(t){var r={descriptor:t&&t.descriptor},i=0,n=[],a=0,s;lr.prototype.init.call(this);this.dispatchType=rr.METADATA_STREAM_TYPE.toString(16);if(r.descriptor){for(s=0;s<r.descriptor.length;s++){this.dispatchType+=("00"+r.descriptor[s].toString(16)).slice(-2)}}this.push=function(e){var t,r,s,o,u,l;if(e.type!=="timed-metadata"){return}if(e.dataAlignmentIndicator){a=0;n.length=0}if(n.length===0&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0))){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}n.push(e);a+=e.data.byteLength;if(n.length===1){i=Ye.parseSyncSafeInteger(e.data.subarray(6,10));i+=10}if(a<i){return}t={data:new Uint8Array(i),frames:[],pts:n[0].pts,dts:n[0].dts};for(u=0;u<i;){t.data.set(n[0].data.subarray(0,i-u),u);u+=n[0].data.byteLength;a-=n[0].data.byteLength;n.shift()}r=10;if(t.data[5]&64){r+=4;r+=Ye.parseSyncSafeInteger(t.data.subarray(10,14));i-=Ye.parseSyncSafeInteger(t.data.subarray(16,20))}do{s=Ye.parseSyncSafeInteger(t.data.subarray(r+4,r+8));if(s<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}l=String.fromCharCode(t.data[r],t.data[r+1],t.data[r+2],t.data[r+3]);o={id:l,data:t.data.subarray(r+10,r+s+10)};o.key=o.id;if(Ye.frameParsers[o.id]){Ye.frameParsers[o.id](o)}else if(o.id[0]==="T"){Ye.frameParsers["T*"](o)}else if(o.id[0]==="W"){Ye.frameParsers["W*"](o)}if(o.owner==="com.apple.streaming.transportStreamTimestamp"){var d=o.data,f=(d[3]&1)<<30|d[4]<<22|d[5]<<14|d[6]<<6|d[7]>>>2;f*=4;f+=d[7]&3;o.timeStamp=f;if(t.pts===undefined&&t.dts===undefined){t.pts=o.timeStamp;t.dts=o.timeStamp}this.trigger("timestamp",o)}t.frames.push(o);r+=10;r+=s}while(r<i);this.trigger("data",t)}};lr.prototype=new n;var dr=lr;var fr=ur.TimestampRolloverStream;var cr,hr,pr;var vr=188,mr=71;cr=function e(){var t=new Uint8Array(vr),r=0;cr.prototype.init.call(this);this.push=function(e){var i=0,n=vr,a;if(r){a=new Uint8Array(e.byteLength+r);a.set(t.subarray(0,r));a.set(e,r);r=0}else{a=e}while(n<a.byteLength){if(a[i]===mr&&a[n]===mr){this.trigger("data",a.subarray(i,n));i+=vr;n+=vr;continue}i++;n++}if(i<a.byteLength){t.set(a.subarray(i),0);r=a.byteLength-i}};this.flush=function(){if(r===vr&&t[0]===mr){this.trigger("data",t);r=0}this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};this.reset=function(){r=0;this.trigger("reset")}};cr.prototype=new n;hr=function e(){var t,r,i,n;hr.prototype.init.call(this);n=this;this.packetsWaitingForPmt=[];this.programMapTable=undefined;t=function e(t,n){var a=0;if(n.payloadUnitStartIndicator){a+=t[a]+1}if(n.type==="pat"){r(t.subarray(a),n)}else{i(t.subarray(a),n)}};r=function e(t,r){r.section_number=t[7];r.last_section_number=t[8];n.pmtPid=(t[10]&31)<<8|t[11];r.pmtPid=n.pmtPid};i=function e(t,r){var i,a,s,o;if(!(t[5]&1)){return}n.programMapTable={video:null,audio:null,"timed-metadata":{}};i=(t[1]&15)<<8|t[2];a=3+i-4;s=(t[10]&15)<<8|t[11];o=12+s;while(o<a){var u=t[o];var l=(t[o+1]&31)<<8|t[o+2];if(u===rr.H264_STREAM_TYPE&&n.programMapTable.video===null){n.programMapTable.video=l}else if(u===rr.ADTS_STREAM_TYPE&&n.programMapTable.audio===null){n.programMapTable.audio=l}else if(u===rr.METADATA_STREAM_TYPE){n.programMapTable["timed-metadata"][l]=u}o+=((t[o+3]&15)<<8|t[o+4])+5}r.programMapTable=n.programMapTable};this.push=function(e){var r={},i=4;r.payloadUnitStartIndicator=!!(e[1]&64);r.pid=e[1]&31;r.pid<<=8;r.pid|=e[2];if((e[3]&48)>>>4>1){i+=e[i]+1}if(r.pid===0){r.type="pat";t(e.subarray(i),r);this.trigger("data",r)}else if(r.pid===this.pmtPid){r.type="pmt";t(e.subarray(i),r);this.trigger("data",r);while(this.packetsWaitingForPmt.length){this.processPes_.apply(this,this.packetsWaitingForPmt.shift())}}else if(this.programMapTable===undefined){this.packetsWaitingForPmt.push([e,i,r])}else{this.processPes_(e,i,r)}};this.processPes_=function(e,t,r){if(r.pid===this.programMapTable.video){r.streamType=rr.H264_STREAM_TYPE}else if(r.pid===this.programMapTable.audio){r.streamType=rr.ADTS_STREAM_TYPE}else{r.streamType=this.programMapTable["timed-metadata"][r.pid]}r.type="pes";r.data=e.subarray(t);this.trigger("data",r)}};hr.prototype=new n;hr.STREAM_TYPES={h264:27,adts:15};pr=function e(){var t=this,r=false,i={data:[],size:0},n={data:[],size:0},a={data:[],size:0},s,o=function e(t,r){var i;var n=t[0]<<16|t[1]<<8|t[2];r.data=new Uint8Array;if(n!==1){return}r.packetLength=6+(t[4]<<8|t[5]);r.dataAlignmentIndicator=(t[6]&4)!==0;i=t[7];if(i&192){r.pts=(t[9]&14)<<27|(t[10]&255)<<20|(t[11]&254)<<12|(t[12]&255)<<5|(t[13]&254)>>>3;r.pts*=4;r.pts+=(t[13]&6)>>>1;r.dts=r.pts;if(i&64){r.dts=(t[14]&14)<<27|(t[15]&255)<<20|(t[16]&254)<<12|(t[17]&255)<<5|(t[18]&254)>>>3;r.dts*=4;r.dts+=(t[18]&6)>>>1}}r.data=t.subarray(9+t[8])},u=function e(r,i,n){var a=new Uint8Array(r.size),s={type:i},u=0,l=0,d=false,f;if(!r.data.length||r.size<9){return}s.trackId=r.data[0].pid;for(u=0;u<r.data.length;u++){f=r.data[u];a.set(f.data,l);l+=f.data.byteLength}o(a,s);d=i==="video"||s.packetLength<=r.size;if(n||d){r.size=0;r.data.length=0}if(d){t.trigger("data",s)}};pr.prototype.init.call(this);this.push=function(e){({pat:function e(){},pes:function t(){var r,s;switch(e.streamType){case rr.H264_STREAM_TYPE:r=i;s="video";break;case rr.ADTS_STREAM_TYPE:r=n;s="audio";break;case rr.METADATA_STREAM_TYPE:r=a;s="timed-metadata";break;default:return}if(e.payloadUnitStartIndicator){u(r,s,true)}r.data.push(e);r.size+=e.data.byteLength},pmt:function i(){var n={type:"metadata",tracks:[]};s=e.programMapTable;if(s.video!==null){n.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+s.video,codec:"avc",type:"video"})}if(s.audio!==null){n.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+s.audio,codec:"adts",type:"audio"})}r=true;t.trigger("data",n)}})[e.type]()};this.reset=function(){i.size=0;i.data.length=0;n.size=0;n.data.length=0;this.trigger("reset")};this.flushStreams_=function(){u(i,"video");u(n,"audio");u(a,"timed-metadata")};this.flush=function(){if(!r&&s){var e={type:"metadata",tracks:[]};if(s.video!==null){e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+s.video,codec:"avc",type:"video"})}if(s.audio!==null){e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+s.audio,codec:"adts",type:"audio"})}t.trigger("data",e)}r=false;this.flushStreams_();this.trigger("done")}};pr.prototype=new n;var gr={PAT_PID:0,MP2T_PACKET_LENGTH:vr,TransportPacketStream:cr,TransportParseStream:hr,ElementaryStream:pr,TimestampRolloverStream:fr,CaptionStream:tr.CaptionStream,Cea608Stream:tr.Cea608Stream,Cea708Stream:tr.Cea708Stream,MetadataStream:dr};for(var yr in rr){if(rr.hasOwnProperty(yr)){gr[yr]=rr[yr]}}var _r=gr;var br=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];var Tr=function e(t,r){var i=t[r+6]<<21|t[r+7]<<14|t[r+8]<<7|t[r+9],n=t[r+5],a=(n&16)>>4;i=i>=0?i:0;if(a){return i+20}return i+10};var Sr=function e(t,r){if(t.length-r<10||t[r]!=="I".charCodeAt(0)||t[r+1]!=="D".charCodeAt(0)||t[r+2]!=="3".charCodeAt(0)){return r}r+=Tr(t,r);return e(t,r)};var wr=function e(t){var r=Sr(t,0);return t.length>=r+2&&(t[r]&255)===255&&(t[r+1]&240)===240&&(t[r+1]&22)===16};var Er=function e(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]};var kr=function e(t,r,i){var n,a="";for(n=r;n<i;n++){a+="%"+("00"+t[n].toString(16)).slice(-2)}return a};var Ar=function e(t,r,i){return unescape(kr(t,r,i))};var Cr=function e(t,r){var i=(t[r+5]&224)>>5,n=t[r+4]<<3,a=t[r+3]&3<<11;return a|n|i};var Ir=function e(t,r){if(t[r]==="I".charCodeAt(0)&&t[r+1]==="D".charCodeAt(0)&&t[r+2]==="3".charCodeAt(0)){return"timed-metadata"}else if(t[r]&255===255&&(t[r+1]&240)===240){return"audio"}return null};var Dr=function e(t){var r=0;while(r+5<t.length){if(t[r]!==255||(t[r+1]&246)!==240){r++;continue}return br[(t[r+2]&60)>>>2]}return null};var xr=function e(t){var r,i,n,a;r=10;if(t[5]&64){r+=4;r+=Er(t.subarray(10,14))}do{i=Er(t.subarray(r+4,r+8));if(i<1){return null}a=String.fromCharCode(t[r],t[r+1],t[r+2],t[r+3]);if(a==="PRIV"){n=t.subarray(r+10,r+i+10);for(var s=0;s<n.byteLength;s++){if(n[s]===0){var o=Ar(n,0,s);if(o==="com.apple.streaming.transportStreamTimestamp"){var u=n.subarray(s+1);var l=(u[3]&1)<<30|u[4]<<22|u[5]<<14|u[6]<<6|u[7]>>>2;l*=4;l+=u[7]&3;return l}break}}}r+=10;r+=i}while(r<t.byteLength);return null};var Lr={isLikelyAacData:wr,parseId3TagSize:Tr,parseAdtsSize:Cr,parseType:Ir,parseSampleRate:Dr,parseAacTimestamp:xr};var Or;Or=function e(){var t=new Uint8Array,r=0;Or.prototype.init.call(this);this.setTimestamp=function(e){r=e};this.push=function(e){var i=0,n=0,a,s,o,u;if(t.length){u=t.length;t=new Uint8Array(e.byteLength+u);t.set(t.subarray(0,u));t.set(e,u)}else{t=e}while(t.length-n>=3){if(t[n]==="I".charCodeAt(0)&&t[n+1]==="D".charCodeAt(0)&&t[n+2]==="3".charCodeAt(0)){if(t.length-n<10){break}i=Lr.parseId3TagSize(t,n);if(n+i>t.length){break}s={type:"timed-metadata",data:t.subarray(n,n+i)};this.trigger("data",s);n+=i;continue}else if((t[n]&255)===255&&(t[n+1]&240)===240){if(t.length-n<7){break}i=Lr.parseAdtsSize(t,n);if(n+i>t.length){break}o={type:"audio",data:t.subarray(n,n+i),pts:r,dts:r};this.trigger("data",o);n+=i;continue}n++}a=t.length-n;if(a>0){t=t.subarray(n)}else{t=new Uint8Array}};this.reset=function(){t=new Uint8Array;this.trigger("reset")};this.endTimeline=function(){t=new Uint8Array;this.trigger("endedtimeline")}};Or.prototype=new n;var Pr=Or;var Rr=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"];var Ur=Rr;var Mr=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"];var Nr=Mr;var Br=w.H264Stream;var Fr=Lr.isLikelyAacData;var jr=h.ONE_SECOND_IN_TS;var qr,Hr,Gr,Vr;var Wr=function e(t,r){r.stream=t;this.trigger("log",r)};var zr=function e(t,r){var i=Object.keys(r);for(var n=0;n<i.length;n++){var a=i[n];if(a==="headOfPipeline"||!r[a].on){continue}r[a].on("log",Wr.bind(t,a))}};var Kr=function e(t,r){var i;if(t.length!==r.length){return false}for(i=0;i<t.length;i++){if(t[i]!==r[i]){return false}}return true};var Xr=function e(t,r,i,n,a,s){var o=i-r,u=n-r,l=a-i;return{start:{dts:t,pts:t+o},end:{dts:t+u,pts:t+l},prependedContentDuration:s,baseMediaDecodeTime:t}};Hr=function e(t,r){var i=[],n,a=0,s=0,o=Infinity;r=r||{};n=r.firstSequenceNumber||0;Hr.prototype.init.call(this);this.push=function(e){Rt.collectDtsInfo(t,e);if(t){Ur.forEach((function(r){t[r]=e[r]}))}i.push(e)};this.setEarliestDts=function(e){a=e};this.setVideoBaseMediaDecodeTime=function(e){o=e};this.setAudioAppendStart=function(e){s=e};this.flush=function(){var e,u,l,d,f,c,p;if(i.length===0){this.trigger("done","AudioSegmentStream");return}e=Dt.trimAdtsFramesByEarliestDts(i,t,a);t.baseMediaDecodeTime=Rt.calculateTrackBaseMediaDecodeTime(t,r.keepOriginalTimestamps);p=Dt.prefixWithSilence(t,e,s,o);t.samples=Dt.generateSampleTable(e);l=fe.mdat(Dt.concatenateFrameData(e));i=[];u=fe.moof(n,[t]);d=new Uint8Array(u.byteLength+l.byteLength);n++;d.set(u);d.set(l,u.byteLength);Rt.clearDtsInfo(t);f=Math.ceil(jr*1024/t.samplerate);if(e.length){c=e.length*f;this.trigger("segmentTimingInfo",Xr(h.audioTsToVideoTs(t.baseMediaDecodeTime,t.samplerate),e[0].dts,e[0].pts,e[0].dts+c,e[0].pts+c,p||0));this.trigger("timingInfo",{start:e[0].pts,end:e[0].pts+c})}this.trigger("data",{track:t,boxes:d});this.trigger("done","AudioSegmentStream")};this.reset=function(){Rt.clearDtsInfo(t);i=[];this.trigger("reset")}};Hr.prototype=new n;qr=function e(t,r){var i,n=[],a=[],s,o;r=r||{};i=r.firstSequenceNumber||0;qr.prototype.init.call(this);delete t.minPTS;this.gopCache_=[];this.push=function(e){Rt.collectDtsInfo(t,e);if(e.nalUnitType==="seq_parameter_set_rbsp"&&!s){s=e.config;t.sps=[e.data];Nr.forEach((function(e){t[e]=s[e]}),this)}if(e.nalUnitType==="pic_parameter_set_rbsp"&&!o){o=e.data;t.pps=[e.data]}n.push(e)};this.flush=function(){var e,s,o,u,l,d,f=0,c,h;while(n.length){if(n[0].nalUnitType==="access_unit_delimiter_rbsp"){break}n.shift()}if(n.length===0){this.resetStream_();this.trigger("done","VideoSegmentStream");return}e=gt.groupNalsIntoFrames(n);o=gt.groupFramesIntoGops(e);if(!o[0][0].keyFrame){s=this.getGopForFusion_(n[0],t);if(s){f=s.duration;o.unshift(s);o.byteLength+=s.byteLength;o.nalCount+=s.nalCount;o.pts=s.pts;o.dts=s.dts;o.duration+=s.duration}else{o=gt.extendFirstKeyFrame(o)}}if(a.length){var p;if(r.alignGopsAtEnd){p=this.alignGopsAtEnd_(o)}else{p=this.alignGopsAtStart_(o)}if(!p){this.gopCache_.unshift({gop:o.pop(),pps:t.pps,sps:t.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);n=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}Rt.clearDtsInfo(t);o=p}Rt.collectDtsInfo(t,o);t.samples=gt.generateSampleTable(o);l=fe.mdat(gt.concatenateNalData(o));t.baseMediaDecodeTime=Rt.calculateTrackBaseMediaDecodeTime(t,r.keepOriginalTimestamps);this.trigger("processedGopsInfo",o.map((function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})));c=o[0];h=o[o.length-1];this.trigger("segmentTimingInfo",Xr(t.baseMediaDecodeTime,c.dts,c.pts,h.dts+h.duration,h.pts+h.duration,f));this.trigger("timingInfo",{start:o[0].pts,end:o[o.length-1].pts+o[o.length-1].duration});this.gopCache_.unshift({gop:o.pop(),pps:t.pps,sps:t.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);n=[];this.trigger("baseMediaDecodeTime",t.baseMediaDecodeTime);this.trigger("timelineStartInfo",t.timelineStartInfo);u=fe.moof(i,[t]);d=new Uint8Array(u.byteLength+l.byteLength);i++;d.set(u);d.set(l,u.byteLength);this.trigger("data",{track:t,boxes:d});this.resetStream_();this.trigger("done","VideoSegmentStream")};this.reset=function(){this.resetStream_();n=[];this.gopCache_.length=0;a.length=0;this.trigger("reset")};this.resetStream_=function(){Rt.clearDtsInfo(t);s=undefined;o=undefined};this.getGopForFusion_=function(e){var r=45e3,i=1e4,n=Infinity,a,s,o,u,l;for(l=0;l<this.gopCache_.length;l++){u=this.gopCache_[l];o=u.gop;if(!(t.pps&&Kr(t.pps[0],u.pps[0]))||!(t.sps&&Kr(t.sps[0],u.sps[0]))){continue}if(o.dts<t.timelineStartInfo.dts){continue}a=e.dts-o.dts-o.duration;if(a>=-i&&a<=r){if(!s||n>a){s=u;n=a}}}if(s){return s.gop}return null};this.alignGopsAtStart_=function(e){var t,r,i,n,s,o,u,l;s=e.byteLength;o=e.nalCount;u=e.duration;t=r=0;while(t<a.length&&r<e.length){i=a[t];n=e[r];if(i.pts===n.pts){break}if(n.pts>i.pts){t++;continue}r++;s-=n.byteLength;o-=n.nalCount;u-=n.duration}if(r===0){return e}if(r===e.length){return null}l=e.slice(r);l.byteLength=s;l.duration=u;l.nalCount=o;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsAtEnd_=function(e){var t,r,i,n,s,o;t=a.length-1;r=e.length-1;s=null;o=false;while(t>=0&&r>=0){i=a[t];n=e[r];if(i.pts===n.pts){o=true;break}if(i.pts>n.pts){t--;continue}if(t===a.length-1){s=r}r--}if(!o&&s===null){return null}var u;if(o){u=r}else{u=s}if(u===0){return e}var l=e.slice(u);var d=l.reduce((function(e,t){e.byteLength+=t.byteLength;e.duration+=t.duration;e.nalCount+=t.nalCount;return e}),{byteLength:0,duration:0,nalCount:0});l.byteLength=d.byteLength;l.duration=d.duration;l.nalCount=d.nalCount;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsWith=function(e){a=e}};qr.prototype=new n;Vr=function e(t,r){this.numberOfTracks=0;this.metadataStream=r;t=t||{};if(typeof t.remux!=="undefined"){this.remuxTracks=!!t.remux}else{this.remuxTracks=true}if(typeof t.keepOriginalTimestamps==="boolean"){this.keepOriginalTimestamps=t.keepOriginalTimestamps}else{this.keepOriginalTimestamps=false}this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.pendingBytes=0;this.emittedTracks=0;Vr.prototype.init.call(this);this.push=function(e){if(e.content||e.text){return this.pendingCaptions.push(e)}if(e.frames){return this.pendingMetadata.push(e)}this.pendingTracks.push(e.track);this.pendingBytes+=e.boxes.byteLength;if(e.track.type==="video"){this.videoTrack=e.track;this.pendingBoxes.push(e.boxes)}if(e.track.type==="audio"){this.audioTrack=e.track;this.pendingBoxes.unshift(e.boxes)}}};Vr.prototype=new n;Vr.prototype.flush=function(e){var t=0,r={captions:[],captionStreams:{},metadata:[],info:{}},i,n,a,s=0,o;if(this.pendingTracks.length<this.numberOfTracks){if(e!=="VideoSegmentStream"&&e!=="AudioSegmentStream"){return}else if(this.remuxTracks){return}else if(this.pendingTracks.length===0){this.emittedTracks++;if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}return}}if(this.videoTrack){s=this.videoTrack.timelineStartInfo.pts;Nr.forEach((function(e){r.info[e]=this.videoTrack[e]}),this)}else if(this.audioTrack){s=this.audioTrack.timelineStartInfo.pts;Ur.forEach((function(e){r.info[e]=this.audioTrack[e]}),this)}if(this.videoTrack||this.audioTrack){if(this.pendingTracks.length===1){r.type=this.pendingTracks[0].type}else{r.type="combined"}this.emittedTracks+=this.pendingTracks.length;a=fe.initSegment(this.pendingTracks);r.initSegment=new Uint8Array(a.byteLength);r.initSegment.set(a);r.data=new Uint8Array(this.pendingBytes);for(o=0;o<this.pendingBoxes.length;o++){r.data.set(this.pendingBoxes[o],t);t+=this.pendingBoxes[o].byteLength}for(o=0;o<this.pendingCaptions.length;o++){i=this.pendingCaptions[o];i.startTime=h.metadataTsToSeconds(i.startPts,s,this.keepOriginalTimestamps);i.endTime=h.metadataTsToSeconds(i.endPts,s,this.keepOriginalTimestamps);r.captionStreams[i.stream]=true;r.captions.push(i)}for(o=0;o<this.pendingMetadata.length;o++){n=this.pendingMetadata[o];n.cueTime=h.metadataTsToSeconds(n.pts,s,this.keepOriginalTimestamps);r.metadata.push(n)}r.metadata.dispatchType=this.metadataStream.dispatchType;this.pendingTracks.length=0;this.videoTrack=null;this.pendingBoxes.length=0;this.pendingCaptions.length=0;this.pendingBytes=0;this.pendingMetadata.length=0;this.trigger("data",r);for(o=0;o<r.captions.length;o++){i=r.captions[o];this.trigger("caption",i)}for(o=0;o<r.metadata.length;o++){n=r.metadata[o];this.trigger("id3Frame",n)}}if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}};Vr.prototype.setRemux=function(e){this.remuxTracks=e};Gr=function e(t){var r=this,i=true,n,a;Gr.prototype.init.call(this);t=t||{};this.baseMediaDecodeTime=t.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var e={};this.transmuxPipeline_=e;e.type="aac";e.metadataStream=new _r.MetadataStream;e.aacStream=new Pr;e.audioTimestampRolloverStream=new _r.TimestampRolloverStream("audio");e.timedMetadataTimestampRolloverStream=new _r.TimestampRolloverStream("timed-metadata");e.adtsStream=new g;e.coalesceStream=new Vr(t,e.metadataStream);e.headOfPipeline=e.aacStream;e.aacStream.pipe(e.audioTimestampRolloverStream).pipe(e.adtsStream);e.aacStream.pipe(e.timedMetadataTimestampRolloverStream).pipe(e.metadataStream).pipe(e.coalesceStream);e.metadataStream.on("timestamp",(function(t){e.aacStream.setTimestamp(t.timeStamp)}));e.aacStream.on("data",(function(i){if(i.type!=="timed-metadata"&&i.type!=="audio"||e.audioSegmentStream){return}a=a||{timelineStartInfo:{baseMediaDecodeTime:r.baseMediaDecodeTime},codec:"adts",type:"audio"};e.coalesceStream.numberOfTracks++;e.audioSegmentStream=new Hr(a,t);e.audioSegmentStream.on("log",r.getLogTrigger_("audioSegmentStream"));e.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo"));e.adtsStream.pipe(e.audioSegmentStream).pipe(e.coalesceStream);r.trigger("trackinfo",{hasAudio:!!a,hasVideo:!!n})}));e.coalesceStream.on("data",this.trigger.bind(this,"data"));e.coalesceStream.on("done",this.trigger.bind(this,"done"));zr(this,e)};this.setupTsPipeline=function(){var e={};this.transmuxPipeline_=e;e.type="ts";e.metadataStream=new _r.MetadataStream;e.packetStream=new _r.TransportPacketStream;e.parseStream=new _r.TransportParseStream;e.elementaryStream=new _r.ElementaryStream;e.timestampRolloverStream=new _r.TimestampRolloverStream;e.adtsStream=new g;e.h264Stream=new Br;e.captionStream=new _r.CaptionStream(t);e.coalesceStream=new Vr(t,e.metadataStream);e.headOfPipeline=e.packetStream;e.packetStream.pipe(e.parseStream).pipe(e.elementaryStream).pipe(e.timestampRolloverStream);e.timestampRolloverStream.pipe(e.h264Stream);e.timestampRolloverStream.pipe(e.adtsStream);e.timestampRolloverStream.pipe(e.metadataStream).pipe(e.coalesceStream);e.h264Stream.pipe(e.captionStream).pipe(e.coalesceStream);e.elementaryStream.on("data",(function(i){var s;if(i.type==="metadata"){s=i.tracks.length;while(s--){if(!n&&i.tracks[s].type==="video"){n=i.tracks[s];n.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime}else if(!a&&i.tracks[s].type==="audio"){a=i.tracks[s];a.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime}}if(n&&!e.videoSegmentStream){e.coalesceStream.numberOfTracks++;e.videoSegmentStream=new qr(n,t);e.videoSegmentStream.on("log",r.getLogTrigger_("videoSegmentStream"));e.videoSegmentStream.on("timelineStartInfo",(function(i){if(a&&!t.keepOriginalTimestamps){a.timelineStartInfo=i;e.audioSegmentStream.setEarliestDts(i.dts-r.baseMediaDecodeTime)}}));e.videoSegmentStream.on("processedGopsInfo",r.trigger.bind(r,"gopInfo"));e.videoSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"videoSegmentTimingInfo"));e.videoSegmentStream.on("baseMediaDecodeTime",(function(t){if(a){e.audioSegmentStream.setVideoBaseMediaDecodeTime(t)}}));e.videoSegmentStream.on("timingInfo",r.trigger.bind(r,"videoTimingInfo"));e.h264Stream.pipe(e.videoSegmentStream).pipe(e.coalesceStream)}if(a&&!e.audioSegmentStream){e.coalesceStream.numberOfTracks++;e.audioSegmentStream=new Hr(a,t);e.audioSegmentStream.on("log",r.getLogTrigger_("audioSegmentStream"));e.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo"));e.audioSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"audioSegmentTimingInfo"));e.adtsStream.pipe(e.audioSegmentStream).pipe(e.coalesceStream)}r.trigger("trackinfo",{hasAudio:!!a,hasVideo:!!n})}}));e.coalesceStream.on("data",this.trigger.bind(this,"data"));e.coalesceStream.on("id3Frame",(function(t){t.dispatchType=e.metadataStream.dispatchType;r.trigger("id3Frame",t)}));e.coalesceStream.on("caption",this.trigger.bind(this,"caption"));e.coalesceStream.on("done",this.trigger.bind(this,"done"));zr(this,e)};this.setBaseMediaDecodeTime=function(e){var r=this.transmuxPipeline_;if(!t.keepOriginalTimestamps){this.baseMediaDecodeTime=e}if(a){a.timelineStartInfo.dts=undefined;a.timelineStartInfo.pts=undefined;Rt.clearDtsInfo(a);if(r.audioTimestampRolloverStream){r.audioTimestampRolloverStream.discontinuity()}}if(n){if(r.videoSegmentStream){r.videoSegmentStream.gopCache_=[]}n.timelineStartInfo.dts=undefined;n.timelineStartInfo.pts=undefined;Rt.clearDtsInfo(n);r.captionStream.reset()}if(r.timestampRolloverStream){r.timestampRolloverStream.discontinuity()}};this.setAudioAppendStart=function(e){if(a){this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)}};this.setRemux=function(e){var r=this.transmuxPipeline_;t.remux=e;if(r&&r.coalesceStream){r.coalesceStream.setRemux(e)}};this.alignGopsWith=function(e){if(n&&this.transmuxPipeline_.videoSegmentStream){this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)}};this.getLogTrigger_=function(e){var t=this;return function(r){r.stream=e;t.trigger("log",r)}};this.push=function(e){if(i){var t=Fr(e);if(t&&this.transmuxPipeline_.type!=="aac"){this.setupAacPipeline()}else if(!t&&this.transmuxPipeline_.type!=="ts"){this.setupTsPipeline()}i=false}this.transmuxPipeline_.headOfPipeline.push(e)};this.flush=function(){i=true;this.transmuxPipeline_.headOfPipeline.flush()};this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()};this.reset=function(){if(this.transmuxPipeline_.headOfPipeline){this.transmuxPipeline_.headOfPipeline.reset()}};this.resetCaptions=function(){if(this.transmuxPipeline_.captionStream){this.transmuxPipeline_.captionStream.reset()}}};Gr.prototype=new n;var Yr={Transmuxer:Gr,VideoSegmentStream:qr,AudioSegmentStream:Hr,AUDIO_PROPERTIES:Ur,VIDEO_PROPERTIES:Nr,generateSegmentTimingInfo:Xr};var Qr=qt.discardEmulationPreventionBytes;var $r=tr.CaptionStream;var Jr=function e(t,r){var i=t;for(var n=0;n<r.length;n++){var a=r[n];if(i<a.size){return a}i-=a.size}return null};var Zr=function e(t,r,i){var n=new DataView(t.buffer,t.byteOffset,t.byteLength),a={logs:[],seiNals:[]},s,o,u,l;for(o=0;o+4<t.length;o+=u){u=n.getUint32(o);o+=4;if(u<=0){continue}switch(t[o]&31){case 6:var d=t.subarray(o+1,o+1+u);var f=Jr(o,r);s={nalUnitType:"sei_rbsp",size:u,data:d,escapedRBSP:Qr(d),trackId:i};if(f){s.pts=f.pts;s.dts=f.dts;l=f}else if(l){s.pts=l.pts;s.dts=l.dts}else{a.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+o+" for trackId "+i+". See mux.js#223."});break}a.seiNals.push(s);break}}return a};var ei=function e(t,i,n){var a=i;var s=n.defaultSampleDuration||0;var o=n.defaultSampleSize||0;var u=n.trackId;var l=[];t.forEach((function(e){var t=Re(e);var i=t.samples;i.forEach((function(e){if(e.duration===undefined){e.duration=s}if(e.size===undefined){e.size=o}e.trackId=u;e.dts=a;if(e.compositionTimeOffset===undefined){e.compositionTimeOffset=0}if(typeof a==="bigint"){e.pts=a+r["default"].BigInt(e.compositionTimeOffset);a+=r["default"].BigInt(e.duration)}else{e.pts=a+e.compositionTimeOffset;a+=e.duration}}));l=l.concat(i)}));return l};var ti=function e(t,r){var i=_e(t,["moof","traf"]);var n=_e(t,["mdat"]);var a={};var s=[];n.forEach((function(e,t){var r=i[t];s.push({mdat:e,traf:r})}));s.forEach((function(e){var t=e.mdat;var i=e.traf;var n=_e(i,["tfhd"]);var s=xe(n[0]);var o=s.trackId;var u=_e(i,["tfdt"]);var l=u.length>0?Be(u[0]).baseMediaDecodeTime:0;var d=_e(i,["trun"]);var f;var c;if(r===o&&d.length>0){f=ei(d,l,s);c=Zr(t,f,o);if(!a[o]){a[o]={seiNals:[],logs:[]}}a[o].seiNals=a[o].seiNals.concat(c.seiNals);a[o].logs=a[o].logs.concat(c.logs)}}));return a};var ri=function e(t,r,i){var n;if(r===null){return null}n=ti(t,r);var a=n[r]||{};return{seiNals:a.seiNals,logs:a.logs,timescale:i}};var ii=function e(){var t=false;var r;var i;var n;var a;var s;var o;this.isInitialized=function(){return t};this.init=function(e){r=new $r;t=true;o=e?e.isPartial:false;r.on("data",(function(e){e.startTime=e.startPts/a;e.endTime=e.endPts/a;s.captions.push(e);s.captionStreams[e.stream]=true}));r.on("log",(function(e){s.logs.push(e)}))};this.isNewInit=function(e,t){if(e&&e.length===0||t&&typeof t==="object"&&Object.keys(t).length===0){return false}return n!==e[0]||a!==t[n]};this.parse=function(e,t,r){var o;if(!this.isInitialized()){return null}else if(!t||!r){return null}else if(this.isNewInit(t,r)){n=t[0];a=r[n]}else if(n===null||!a){i.push(e);return null}while(i.length>0){var u=i.shift();this.parse(u,t,r)}o=ri(e,n,a);if(o&&o.logs){s.logs=s.logs.concat(o.logs)}if(o===null||!o.seiNals){if(s.logs.length){return{logs:s.logs,captions:[],captionStreams:[]}}return null}this.pushNals(o.seiNals);this.flushStream();return s};this.pushNals=function(e){if(!this.isInitialized()||!e||e.length===0){return null}e.forEach((function(e){r.push(e)}))};this.flushStream=function(){if(!this.isInitialized()){return null}if(!o){r.flush()}else{r.partialFlush()}};this.clearParsedCaptions=function(){s.captions=[];s.captionStreams={};s.logs=[]};this.resetCaptionStream=function(){if(!this.isInitialized()){return null}r.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){i=[];n=null;a=null;if(!s){s={captions:[],captionStreams:{},logs:[]}}else{this.clearParsedCaptions()}this.resetCaptionStream()};this.reset()};var ni=ii;var ai={generator:fe,probe:ot,Transmuxer:Yr.Transmuxer,AudioSegmentStream:Yr.AudioSegmentStream,VideoSegmentStream:Yr.VideoSegmentStream,CaptionParser:ni};var si;si=function e(t,r){var i=0,n=16384,a=function e(t,r){var i,n=t.position+r;if(n<t.bytes.byteLength){return}i=new Uint8Array(n*2);i.set(t.bytes.subarray(0,t.position),0);t.bytes=i;t.view=new DataView(t.bytes.buffer)},s=si.widthBytes||new Uint8Array("width".length),o=si.heightBytes||new Uint8Array("height".length),u=si.videocodecidBytes||new Uint8Array("videocodecid".length),l;if(!si.widthBytes){for(l=0;l<"width".length;l++){s[l]="width".charCodeAt(l)}for(l=0;l<"height".length;l++){o[l]="height".charCodeAt(l)}for(l=0;l<"videocodecid".length;l++){u[l]="videocodecid".charCodeAt(l)}si.widthBytes=s;si.heightBytes=o;si.videocodecidBytes=u}this.keyFrame=false;switch(t){case si.VIDEO_TAG:this.length=16;n*=6;break;case si.AUDIO_TAG:this.length=13;this.keyFrame=true;break;case si.METADATA_TAG:this.length=29;this.keyFrame=true;break;default:throw new Error("Unknown FLV tag type")}this.bytes=new Uint8Array(n);this.view=new DataView(this.bytes.buffer);this.bytes[0]=t;this.position=this.length;this.keyFrame=r;this.pts=0;this.dts=0;this.writeBytes=function(e,t,r){var i=t||0,n;r=r||e.byteLength;n=i+r;a(this,r);this.bytes.set(e.subarray(i,n),this.position);this.position+=r;this.length=Math.max(this.length,this.position)};this.writeByte=function(e){a(this,1);this.bytes[this.position]=e;this.position++;this.length=Math.max(this.length,this.position)};this.writeShort=function(e){a(this,2);this.view.setUint16(this.position,e);this.position+=2;this.length=Math.max(this.length,this.position)};this.negIndex=function(e){return this.bytes[this.length-e]};this.nalUnitSize=function(){if(i===0){return 0}return this.length-(i+4)};this.startNalUnit=function(){if(i>0){throw new Error("Attempted to create new NAL wihout closing the old one")}i=this.length;this.length+=4;this.position=this.length};this.endNalUnit=function(e){var t,r;if(this.length===i+4){this.length-=4}else if(i>0){t=i+4;r=this.length-t;this.position=i;this.view.setUint32(this.position,r);this.position=this.length;if(e){e.push(this.bytes.subarray(t,t+r))}}i=0};this.writeMetaDataDouble=function(e,t){var r;a(this,2+e.length+9);this.view.setUint16(this.position,e.length);this.position+=2;if(e==="width"){this.bytes.set(s,this.position);this.position+=5}else if(e==="height"){this.bytes.set(o,this.position);this.position+=6}else if(e==="videocodecid"){this.bytes.set(u,this.position);this.position+=12}else{for(r=0;r<e.length;r++){this.bytes[this.position]=e.charCodeAt(r);this.position++}}this.position++;this.view.setFloat64(this.position,t);this.position+=8;this.length=Math.max(this.length,this.position);++i};this.writeMetaDataBoolean=function(e,t){var r;a(this,2);this.view.setUint16(this.position,e.length);this.position+=2;for(r=0;r<e.length;r++){a(this,1);this.bytes[this.position]=e.charCodeAt(r);this.position++}a(this,2);this.view.setUint8(this.position,1);this.position++;this.view.setUint8(this.position,t?1:0);this.position++;this.length=Math.max(this.length,this.position);++i};this.finalize=function(){var e,t;switch(this.bytes[0]){case si.VIDEO_TAG:this.bytes[11]=(this.keyFrame||r?16:32)|7;this.bytes[12]=r?0:1;e=this.pts-this.dts;this.bytes[13]=(e&16711680)>>>16;this.bytes[14]=(e&65280)>>>8;this.bytes[15]=(e&255)>>>0;break;case si.AUDIO_TAG:this.bytes[11]=175;this.bytes[12]=r?0:1;break;case si.METADATA_TAG:this.position=11;this.view.setUint8(this.position,2);this.position++;this.view.setUint16(this.position,10);this.position+=2;this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position);this.position+=10;this.bytes[this.position]=8;this.position++;this.view.setUint32(this.position,i);this.position=this.length;this.bytes.set([0,0,9],this.position);this.position+=3;this.length=this.position;break}t=this.length-11;this.bytes[1]=(t&16711680)>>>16;this.bytes[2]=(t&65280)>>>8;this.bytes[3]=(t&255)>>>0;this.bytes[4]=(this.dts&16711680)>>>16;this.bytes[5]=(this.dts&65280)>>>8;this.bytes[6]=(this.dts&255)>>>0;this.bytes[7]=(this.dts&4278190080)>>>24;this.bytes[8]=0;this.bytes[9]=0;this.bytes[10]=0;a(this,4);this.view.setUint32(this.length,this.length);this.length+=4;this.position+=4;this.bytes=this.bytes.subarray(0,this.length);this.frameTime=si.frameTime(this.bytes);return this}};si.AUDIO_TAG=8;si.VIDEO_TAG=9;si.METADATA_TAG=18;si.isAudioFrame=function(e){return si.AUDIO_TAG===e[0]};si.isVideoFrame=function(e){return si.VIDEO_TAG===e[0]};si.isMetaData=function(e){return si.METADATA_TAG===e[0]};si.isKeyFrame=function(e){if(si.isVideoFrame(e)){return e[11]===23}if(si.isAudioFrame(e)){return true}if(si.isMetaData(e)){return true}return false};si.frameTime=function(e){var t=e[4]<<16;t|=e[5]<<8;t|=e[6]<<0;t|=e[7]<<24;return t};var oi=si;var ui=function e(t){this.numberOfTracks=0;this.metadataStream=t.metadataStream;this.videoTags=[];this.audioTags=[];this.videoTrack=null;this.audioTrack=null;this.pendingCaptions=[];this.pendingMetadata=[];this.pendingTracks=0;this.processedTracks=0;e.prototype.init.call(this);this.push=function(e){if(e.content||e.text){return this.pendingCaptions.push(e)}if(e.frames){return this.pendingMetadata.push(e)}if(e.track.type==="video"){this.videoTrack=e.track;this.videoTags=e.tags;this.pendingTracks++}if(e.track.type==="audio"){this.audioTrack=e.track;this.audioTags=e.tags;this.pendingTracks++}}};ui.prototype=new n;ui.prototype.flush=function(e){var t,r,i,n,a={tags:{},captions:[],captionStreams:{},metadata:[]};if(this.pendingTracks<this.numberOfTracks){if(e!=="VideoSegmentStream"&&e!=="AudioSegmentStream"){return}else if(this.pendingTracks===0){this.processedTracks++;if(this.processedTracks<this.numberOfTracks){return}}}this.processedTracks+=this.pendingTracks;this.pendingTracks=0;if(this.processedTracks<this.numberOfTracks){return}if(this.videoTrack){n=this.videoTrack.timelineStartInfo.pts}else if(this.audioTrack){n=this.audioTrack.timelineStartInfo.pts}a.tags.videoTags=this.videoTags;a.tags.audioTags=this.audioTags;for(i=0;i<this.pendingCaptions.length;i++){r=this.pendingCaptions[i];r.startTime=r.startPts-n;r.startTime/=9e4;r.endTime=r.endPts-n;r.endTime/=9e4;a.captionStreams[r.stream]=true;a.captions.push(r)}for(i=0;i<this.pendingMetadata.length;i++){t=this.pendingMetadata[i];t.cueTime=t.pts-n;t.cueTime/=9e4;a.metadata.push(t)}a.metadata.dispatchType=this.metadataStream.dispatchType;this.videoTrack=null;this.audioTrack=null;this.videoTags=[];this.audioTags=[];this.pendingCaptions.length=0;this.pendingMetadata.length=0;this.pendingTracks=0;this.processedTracks=0;this.trigger("data",a);this.trigger("done")};var li=ui;var di=function e(){var t=this;this.list=[];this.push=function(e){this.list.push({bytes:e.bytes,dts:e.dts,pts:e.pts,keyFrame:e.keyFrame,metaDataTag:e.metaDataTag})};Object.defineProperty(this,"length",{get:function e(){return t.list.length}})};var fi=di;var ci=w.H264Stream;var hi,pi,vi,mi,gi,yi;mi=function e(t,r){if(typeof r.pts==="number"){if(t.timelineStartInfo.pts===undefined){t.timelineStartInfo.pts=r.pts}else{t.timelineStartInfo.pts=Math.min(t.timelineStartInfo.pts,r.pts)}}if(typeof r.dts==="number"){if(t.timelineStartInfo.dts===undefined){t.timelineStartInfo.dts=r.dts}else{t.timelineStartInfo.dts=Math.min(t.timelineStartInfo.dts,r.dts)}}};gi=function e(t,r){var i=new oi(oi.METADATA_TAG);i.dts=r;i.pts=r;i.writeMetaDataDouble("videocodecid",7);i.writeMetaDataDouble("width",t.width);i.writeMetaDataDouble("height",t.height);return i};yi=function e(t,r){var i,n=new oi(oi.VIDEO_TAG,true);n.dts=r;n.pts=r;n.writeByte(1);n.writeByte(t.profileIdc);n.writeByte(t.profileCompatibility);n.writeByte(t.levelIdc);n.writeByte(252|3);n.writeByte(224|1);n.writeShort(t.sps[0].length);n.writeBytes(t.sps[0]);n.writeByte(t.pps.length);for(i=0;i<t.pps.length;++i){n.writeShort(t.pps[i].length);n.writeBytes(t.pps[i])}return n};vi=function e(t){var r=[],i=[],n;vi.prototype.init.call(this);this.push=function(e){mi(t,e);if(t){t.audioobjecttype=e.audioobjecttype;t.channelcount=e.channelcount;t.samplerate=e.samplerate;t.samplingfrequencyindex=e.samplingfrequencyindex;t.samplesize=e.samplesize;t.extraData=t.audioobjecttype<<11|t.samplingfrequencyindex<<7|t.channelcount<<3}e.pts=Math.round(e.pts/90);e.dts=Math.round(e.dts/90);r.push(e)};this.flush=function(){var e,a,s,o=new fi;if(r.length===0){this.trigger("done","AudioSegmentStream");return}s=-Infinity;while(r.length){e=r.shift();if(i.length&&e.pts>=i[0]){s=i.shift();this.writeMetaDataTags(o,s)}if(t.extraData!==n||e.pts-s>=1e3){this.writeMetaDataTags(o,e.pts);n=t.extraData;s=e.pts}a=new oi(oi.AUDIO_TAG);a.pts=e.pts;a.dts=e.dts;a.writeBytes(e.data);o.push(a.finalize())}i.length=0;n=null;this.trigger("data",{track:t,tags:o.list});this.trigger("done","AudioSegmentStream")};this.writeMetaDataTags=function(e,r){var i;i=new oi(oi.METADATA_TAG);i.pts=r;i.dts=r;i.writeMetaDataDouble("audiocodecid",10);i.writeMetaDataBoolean("stereo",t.channelcount===2);i.writeMetaDataDouble("audiosamplerate",t.samplerate);i.writeMetaDataDouble("audiosamplesize",16);e.push(i.finalize());i=new oi(oi.AUDIO_TAG,true);i.pts=r;i.dts=r;i.view.setUint16(i.position,t.extraData);i.position+=2;i.length=Math.max(i.length,i.position);e.push(i.finalize())};this.onVideoKeyFrame=function(e){i.push(e)}};vi.prototype=new n;pi=function e(t){var r=[],i,n;pi.prototype.init.call(this);this.finishFrame=function(e,r){if(!r){return}if(i&&t&&t.newMetadata&&(r.keyFrame||e.length===0)){var a=gi(i,r.dts).finalize();var s=yi(t,r.dts).finalize();a.metaDataTag=s.metaDataTag=true;e.push(a);e.push(s);t.newMetadata=false;this.trigger("keyframe",r.dts)}r.endNalUnit();e.push(r.finalize());n=null};this.push=function(e){mi(t,e);e.pts=Math.round(e.pts/90);e.dts=Math.round(e.dts/90);r.push(e)};this.flush=function(){var e,a=new fi;while(r.length){if(r[0].nalUnitType==="access_unit_delimiter_rbsp"){break}r.shift()}if(r.length===0){this.trigger("done","VideoSegmentStream");return}while(r.length){e=r.shift();if(e.nalUnitType==="seq_parameter_set_rbsp"){t.newMetadata=true;i=e.config;t.width=i.width;t.height=i.height;t.sps=[e.data];t.profileIdc=i.profileIdc;t.levelIdc=i.levelIdc;t.profileCompatibility=i.profileCompatibility;n.endNalUnit()}else if(e.nalUnitType==="pic_parameter_set_rbsp"){t.newMetadata=true;t.pps=[e.data];n.endNalUnit()}else if(e.nalUnitType==="access_unit_delimiter_rbsp"){if(n){this.finishFrame(a,n)}n=new oi(oi.VIDEO_TAG);n.pts=e.pts;n.dts=e.dts}else{if(e.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"){n.keyFrame=true}n.endNalUnit()}n.startNalUnit();n.writeBytes(e.data)}if(n){this.finishFrame(a,n)}this.trigger("data",{track:t,tags:a.list});this.trigger("done","VideoSegmentStream")}};pi.prototype=new n;hi=function e(t){var r=this,i,n,a,s,o,u,l,d,f,c,h,p;hi.prototype.init.call(this);t=t||{};this.metadataStream=new _r.MetadataStream;t.metadataStream=this.metadataStream;i=new _r.TransportPacketStream;n=new _r.TransportParseStream;a=new _r.ElementaryStream;s=new _r.TimestampRolloverStream("video");o=new _r.TimestampRolloverStream("audio");u=new _r.TimestampRolloverStream("timed-metadata");l=new g;d=new ci;p=new li(t);i.pipe(n).pipe(a);a.pipe(s).pipe(d);a.pipe(o).pipe(l);a.pipe(u).pipe(this.metadataStream).pipe(p);h=new _r.CaptionStream(t);d.pipe(h).pipe(p);a.on("data",(function(e){var t,r,i;if(e.type==="metadata"){t=e.tracks.length;while(t--){if(e.tracks[t].type==="video"){r=e.tracks[t]}else if(e.tracks[t].type==="audio"){i=e.tracks[t]}}if(r&&!f){p.numberOfTracks++;f=new pi(r);d.pipe(f).pipe(p)}if(i&&!c){p.numberOfTracks++;c=new vi(i);l.pipe(c).pipe(p);if(f){f.on("keyframe",c.onVideoKeyFrame)}}}}));this.push=function(e){i.push(e)};this.flush=function(){i.flush()};this.resetCaptions=function(){h.reset()};p.on("data",(function(e){r.trigger("data",e)}));p.on("done",(function(){r.trigger("done")}))};hi.prototype=new n;var _i=hi;var bi=function e(t,r,i){var n=new Uint8Array(3+1+1+4),a=new DataView(n.buffer),s,o,u;t=t||0;r=r===undefined?true:r;i=i===undefined?true:i;a.setUint8(0,70);a.setUint8(1,76);a.setUint8(2,86);a.setUint8(3,1);a.setUint8(4,(r?4:0)|(i?1:0));a.setUint32(5,n.byteLength);if(t<=0){o=new Uint8Array(n.byteLength+4);o.set(n);o.set([0,0,0,0],n.byteLength);return o}s=new oi(oi.METADATA_TAG);s.pts=s.dts=0;s.writeMetaDataDouble("duration",t);u=s.finalize().length;o=new Uint8Array(n.byteLength+u);o.set(n);o.set(a.byteLength,u);return o};var Ti=bi;var Si={tag:oi,Transmuxer:_i,getFlvHeader:Ti};var wi=_r;var Ei=h.ONE_SECOND_IN_TS;var ki=function e(t,r){var i=[],n=0,a=0,s=0,o=Infinity,u=null,l=null;r=r||{};e.prototype.init.call(this);this.push=function(e){Rt.collectDtsInfo(t,e);if(t){Ur.forEach((function(r){t[r]=e[r]}))}i.push(e)};this.setEarliestDts=function(e){a=e};this.setVideoBaseMediaDecodeTime=function(e){o=e};this.setAudioAppendStart=function(e){s=e};this.processFrames_=function(){var e,d,f,c,h;if(i.length===0){return}e=Dt.trimAdtsFramesByEarliestDts(i,t,a);if(e.length===0){return}t.baseMediaDecodeTime=Rt.calculateTrackBaseMediaDecodeTime(t,r.keepOriginalTimestamps);Dt.prefixWithSilence(t,e,s,o);t.samples=Dt.generateSampleTable(e);f=fe.mdat(Dt.concatenateFrameData(e));i=[];d=fe.moof(n,[t]);n++;t.initSegment=fe.initSegment([t]);c=new Uint8Array(d.byteLength+f.byteLength);c.set(d);c.set(f,d.byteLength);Rt.clearDtsInfo(t);if(u===null){l=u=e[0].pts}l+=e.length*(Ei*1024/t.samplerate);h={start:u};this.trigger("timingInfo",h);this.trigger("data",{track:t,boxes:c})};this.flush=function(){this.processFrames_();this.trigger("timingInfo",{start:u,end:l});this.resetTiming_();this.trigger("done","AudioSegmentStream")};this.partialFlush=function(){this.processFrames_();this.trigger("partialdone","AudioSegmentStream")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline","AudioSegmentStream")};this.resetTiming_=function(){Rt.clearDtsInfo(t);u=null;l=null};this.reset=function(){this.resetTiming_();i=[];this.trigger("reset")}};ki.prototype=new n;var Ai=ki;var Ci=function e(t,r){var i=0,n=[],a=[],s,o,u=null,l=null,d,f=true;r=r||{};e.prototype.init.call(this);this.push=function(e){Rt.collectDtsInfo(t,e);if(typeof t.timelineStartInfo.dts==="undefined"){t.timelineStartInfo.dts=e.dts}if(e.nalUnitType==="seq_parameter_set_rbsp"&&!s){s=e.config;t.sps=[e.data];Nr.forEach((function(e){t[e]=s[e]}),this)}if(e.nalUnitType==="pic_parameter_set_rbsp"&&!o){o=e.data;t.pps=[e.data]}n.push(e)};this.processNals_=function(e){var s;n=a.concat(n);while(n.length){if(n[0].nalUnitType==="access_unit_delimiter_rbsp"){break}n.shift()}if(n.length===0){return}var o=gt.groupNalsIntoFrames(n);if(!o.length){return}a=o[o.length-1];if(e){o.pop();o.duration-=a.duration;o.nalCount-=a.length;o.byteLength-=a.byteLength}if(!o.length){n=[];return}this.trigger("timelineStartInfo",t.timelineStartInfo);if(f){d=gt.groupFramesIntoGops(o);if(!d[0][0].keyFrame){d=gt.extendFirstKeyFrame(d);if(!d[0][0].keyFrame){n=[].concat.apply([],o).concat(a);a=[];return}o=[].concat.apply([],d);o.duration=d.duration}f=false}if(u===null){u=o[0].pts;l=u}l+=o.duration;this.trigger("timingInfo",{start:u,end:l});for(s=0;s<o.length;s++){var c=o[s];t.samples=gt.generateSampleTableForFrame(c);var h=fe.mdat(gt.concatenateNalDataForFrame(c));Rt.clearDtsInfo(t);Rt.collectDtsInfo(t,c);t.baseMediaDecodeTime=Rt.calculateTrackBaseMediaDecodeTime(t,r.keepOriginalTimestamps);var p=fe.moof(i,[t]);i++;t.initSegment=fe.initSegment([t]);var v=new Uint8Array(p.byteLength+h.byteLength);v.set(p);v.set(h,p.byteLength);this.trigger("data",{track:t,boxes:v,sequence:i,videoFrameDts:c.dts,videoFramePts:c.pts})}n=[]};this.resetTimingAndConfig_=function(){s=undefined;o=undefined;u=null;l=null};this.partialFlush=function(){this.processNals_(true);this.trigger("partialdone","VideoSegmentStream")};this.flush=function(){this.processNals_(false);this.resetTimingAndConfig_();this.trigger("done","VideoSegmentStream")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline","VideoSegmentStream")};this.reset=function(){this.resetTimingAndConfig_();a=[];n=[];f=true;this.trigger("reset")}};Ci.prototype=new n;var Ii=Ci;var Di=Lr.isLikelyAacData;var xi=function e(t){t.prototype=new n;t.prototype.init.call(t);return t};var Li=function e(t){var r={type:"ts",tracks:{audio:null,video:null},packet:new _r.TransportPacketStream,parse:new _r.TransportParseStream,elementary:new _r.ElementaryStream,timestampRollover:new _r.TimestampRolloverStream,adts:new E.Adts,h264:new E.h264.H264Stream,captionStream:new _r.CaptionStream(t),metadataStream:new _r.MetadataStream};r.headOfPipeline=r.packet;r.packet.pipe(r.parse).pipe(r.elementary).pipe(r.timestampRollover);r.timestampRollover.pipe(r.h264);r.h264.pipe(r.captionStream);r.timestampRollover.pipe(r.metadataStream);r.timestampRollover.pipe(r.adts);r.elementary.on("data",(function(e){if(e.type!=="metadata"){return}for(var i=0;i<e.tracks.length;i++){if(!r.tracks[e.tracks[i].type]){r.tracks[e.tracks[i].type]=e.tracks[i];r.tracks[e.tracks[i].type].timelineStartInfo.baseMediaDecodeTime=t.baseMediaDecodeTime}}if(r.tracks.video&&!r.videoSegmentStream){r.videoSegmentStream=new Ii(r.tracks.video,t);r.videoSegmentStream.on("timelineStartInfo",(function(e){if(r.tracks.audio&&!t.keepOriginalTimestamps){r.audioSegmentStream.setEarliestDts(e.dts-t.baseMediaDecodeTime)}}));r.videoSegmentStream.on("timingInfo",r.trigger.bind(r,"videoTimingInfo"));r.videoSegmentStream.on("data",(function(e){r.trigger("data",{type:"video",data:e})}));r.videoSegmentStream.on("done",r.trigger.bind(r,"done"));r.videoSegmentStream.on("partialdone",r.trigger.bind(r,"partialdone"));r.videoSegmentStream.on("endedtimeline",r.trigger.bind(r,"endedtimeline"));r.h264.pipe(r.videoSegmentStream)}if(r.tracks.audio&&!r.audioSegmentStream){r.audioSegmentStream=new Ai(r.tracks.audio,t);r.audioSegmentStream.on("data",(function(e){r.trigger("data",{type:"audio",data:e})}));r.audioSegmentStream.on("done",r.trigger.bind(r,"done"));r.audioSegmentStream.on("partialdone",r.trigger.bind(r,"partialdone"));r.audioSegmentStream.on("endedtimeline",r.trigger.bind(r,"endedtimeline"));r.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo"));r.adts.pipe(r.audioSegmentStream)}r.trigger("trackinfo",{hasAudio:!!r.tracks.audio,hasVideo:!!r.tracks.video})}));r.captionStream.on("data",(function(e){var i;if(r.tracks.video){i=r.tracks.video.timelineStartInfo.pts||0}else{i=0}e.startTime=h.metadataTsToSeconds(e.startPts,i,t.keepOriginalTimestamps);e.endTime=h.metadataTsToSeconds(e.endPts,i,t.keepOriginalTimestamps);r.trigger("caption",e)}));r=xi(r);r.metadataStream.on("data",r.trigger.bind(r,"id3Frame"));return r};var Oi=function e(t){var r={type:"aac",tracks:{audio:null},metadataStream:new _r.MetadataStream,aacStream:new Pr,audioRollover:new _r.TimestampRolloverStream("audio"),timedMetadataRollover:new _r.TimestampRolloverStream("timed-metadata"),adtsStream:new g(true)};r.headOfPipeline=r.aacStream;r.aacStream.pipe(r.audioRollover).pipe(r.adtsStream);r.aacStream.pipe(r.timedMetadataRollover).pipe(r.metadataStream);r.metadataStream.on("timestamp",(function(e){r.aacStream.setTimestamp(e.timeStamp)}));r.aacStream.on("data",(function(e){if(e.type!=="timed-metadata"&&e.type!=="audio"||r.audioSegmentStream){return}r.tracks.audio=r.tracks.audio||{timelineStartInfo:{baseMediaDecodeTime:t.baseMediaDecodeTime},codec:"adts",type:"audio"};r.audioSegmentStream=new Ai(r.tracks.audio,t);r.audioSegmentStream.on("data",(function(e){r.trigger("data",{type:"audio",data:e})}));r.audioSegmentStream.on("partialdone",r.trigger.bind(r,"partialdone"));r.audioSegmentStream.on("done",r.trigger.bind(r,"done"));r.audioSegmentStream.on("endedtimeline",r.trigger.bind(r,"endedtimeline"));r.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo"));r.adtsStream.pipe(r.audioSegmentStream);r.trigger("trackinfo",{hasAudio:!!r.tracks.audio,hasVideo:!!r.tracks.video})}));r=xi(r);r.metadataStream.on("data",r.trigger.bind(r,"id3Frame"));return r};var Pi=function e(t,r){t.on("data",r.trigger.bind(r,"data"));t.on("done",r.trigger.bind(r,"done"));t.on("partialdone",r.trigger.bind(r,"partialdone"));t.on("endedtimeline",r.trigger.bind(r,"endedtimeline"));t.on("audioTimingInfo",r.trigger.bind(r,"audioTimingInfo"));t.on("videoTimingInfo",r.trigger.bind(r,"videoTimingInfo"));t.on("trackinfo",r.trigger.bind(r,"trackinfo"));t.on("id3Frame",(function(e){e.dispatchType=t.metadataStream.dispatchType;e.cueTime=h.videoTsToSeconds(e.pts);r.trigger("id3Frame",e)}));t.on("caption",(function(e){r.trigger("caption",e)}))};var Ri=function e(t){var r=null,i=true;t=t||{};e.prototype.init.call(this);t.baseMediaDecodeTime=t.baseMediaDecodeTime||0;this.push=function(e){if(i){var n=Di(e);if(n&&(!r||r.type!=="aac")){r=Oi(t);Pi(r,this)}else if(!n&&(!r||r.type!=="ts")){r=Li(t);Pi(r,this)}i=false}r.headOfPipeline.push(e)};this.flush=function(){if(!r){return}i=true;r.headOfPipeline.flush()};this.partialFlush=function(){if(!r){return}r.headOfPipeline.partialFlush()};this.endTimeline=function(){if(!r){return}r.headOfPipeline.endTimeline()};this.reset=function(){if(!r){return}r.headOfPipeline.reset()};this.setBaseMediaDecodeTime=function(e){if(!t.keepOriginalTimestamps){t.baseMediaDecodeTime=e}if(!r){return}if(r.tracks.audio){r.tracks.audio.timelineStartInfo.dts=undefined;r.tracks.audio.timelineStartInfo.pts=undefined;Rt.clearDtsInfo(r.tracks.audio);if(r.audioRollover){r.audioRollover.discontinuity()}}if(r.tracks.video){if(r.videoSegmentStream){r.videoSegmentStream.gopCache_=[]}r.tracks.video.timelineStartInfo.dts=undefined;r.tracks.video.timelineStartInfo.pts=undefined;Rt.clearDtsInfo(r.tracks.video)}if(r.timestampRollover){r.timestampRollover.discontinuity()}};this.setRemux=function(e){t.remux=e;if(r&&r.coalesceStream){r.coalesceStream.setRemux(e)}};this.setAudioAppendStart=function(e){if(!r||!r.tracks.audio||!r.audioSegmentStream){return}r.audioSegmentStream.setAudioAppendStart(e)};this.alignGopsWith=function(e){return}};Ri.prototype=new n;var Ui=Ri;var Mi={Transmuxer:Ui};var Ni=C.getUint64;var Bi=function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:r.getUint32(4),timescale:r.getUint32(8)},n=12;if(i.version===0){i.earliestPresentationTime=r.getUint32(n);i.firstOffset=r.getUint32(n+4);n+=8}else{i.earliestPresentationTime=Ni(t.subarray(n));i.firstOffset=Ni(t.subarray(n+8));n+=16}n+=2;var a=r.getUint16(n);n+=2;for(;a>0;n+=12,a--){i.references.push({referenceType:(t[n]&128)>>>7,referencedSize:r.getUint32(n)&2147483647,subsegmentDuration:r.getUint32(n+4),startsWithSap:!!(t[n+8]&128),sapType:(t[n+8]&112)>>>4,sapDeltaTime:r.getUint32(n+8)&268435455})}return i};var Fi=Bi;var ji=C.getUint64;var qi,Hi,Gi=function e(t){return new Date(t*1e3-20828448e5)},Vi=function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i=[],n,a;for(n=0;n+4<t.length;n+=a){a=r.getUint32(n);n+=4;if(a<=0){i.push("<span style='color:red;'>MALFORMED DATA</span>");continue}switch(t[n]&31){case 1:i.push("slice_layer_without_partitioning_rbsp");break;case 5:i.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:i.push("sei_rbsp");break;case 7:i.push("seq_parameter_set_rbsp");break;case 8:i.push("pic_parameter_set_rbsp");break;case 9:i.push("access_unit_delimiter_rbsp");break;default:i.push("UNKNOWN NAL - "+t[n]&31);break}}return i},Wi={avc1:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return{dataReferenceIndex:r.getUint16(6),width:r.getUint16(24),height:r.getUint16(26),horizresolution:r.getUint16(28)+r.getUint16(30)/16,vertresolution:r.getUint16(32)+r.getUint16(34)/16,frameCount:r.getUint16(40),depth:r.getUint16(74),config:qi(t.subarray(78,t.byteLength))}},avcC:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={configurationVersion:t[0],avcProfileIndication:t[1],profileCompatibility:t[2],avcLevelIndication:t[3],lengthSizeMinusOne:t[4]&3,sps:[],pps:[]},n=t[5]&31,a,s,o,u;o=6;for(u=0;u<n;u++){s=r.getUint16(o);o+=2;i.sps.push(new Uint8Array(t.subarray(o,o+s)));o+=s}a=t[o];o++;for(u=0;u<a;u++){s=r.getUint16(o);o+=2;i.pps.push(new Uint8Array(t.subarray(o,o+s)));o+=s}return i},btrt:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return{bufferSizeDB:r.getUint32(0),maxBitrate:r.getUint32(4),avgBitrate:r.getUint32(8)}},edts:function e(t){return{boxes:qi(t)}},elst:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),edits:[]},n=r.getUint32(4),a;for(a=8;n;n--){if(i.version===0){i.edits.push({segmentDuration:r.getUint32(a),mediaTime:r.getInt32(a+4),mediaRate:r.getUint16(a+8)+r.getUint16(a+10)/(256*256)});a+=12}else{i.edits.push({segmentDuration:ji(t.subarray(a)),mediaTime:ji(t.subarray(a+8)),mediaRate:r.getUint16(a+16)+r.getUint16(a+18)/(256*256)});a+=20}}return i},esds:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),esId:t[6]<<8|t[7],streamPriority:t[8]&31,decoderConfig:{objectProfileIndication:t[11],streamType:t[12]>>>2&63,bufferSize:t[13]<<16|t[14]<<8|t[15],maxBitrate:t[16]<<24|t[17]<<16|t[18]<<8|t[19],avgBitrate:t[20]<<24|t[21]<<16|t[22]<<8|t[23],decoderConfigDescriptor:{tag:t[24],length:t[25],audioObjectType:t[26]>>>3&31,samplingFrequencyIndex:(t[26]&7)<<1|t[27]>>>7&1,channelConfiguration:t[27]>>>3&15}}}},ftyp:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={majorBrand:me(t.subarray(0,4)),minorVersion:r.getUint32(4),compatibleBrands:[]},n=8;while(n<t.byteLength){i.compatibleBrands.push(me(t.subarray(n,n+4)));n+=4}return i},dinf:function e(t){return{boxes:qi(t)}},dref:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),dataReferences:qi(t.subarray(8))}},hdlr:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),handlerType:me(t.subarray(8,12)),name:""},n=8;for(n=24;n<t.byteLength;n++){if(t[n]===0){n++;break}i.name+=String.fromCharCode(t[n])}i.name=decodeURIComponent(escape(i.name));return i},mdat:function e(t){return{byteLength:t.byteLength,nals:Vi(t)}},mdhd:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i=4,n,a={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),language:""};if(a.version===1){i+=4;a.creationTime=Gi(r.getUint32(i));i+=8;a.modificationTime=Gi(r.getUint32(i));i+=4;a.timescale=r.getUint32(i);i+=8;a.duration=r.getUint32(i)}else{a.creationTime=Gi(r.getUint32(i));i+=4;a.modificationTime=Gi(r.getUint32(i));i+=4;a.timescale=r.getUint32(i);i+=4;a.duration=r.getUint32(i)}i+=4;n=r.getUint16(i);a.language+=String.fromCharCode((n>>10)+96);a.language+=String.fromCharCode(((n&992)>>5)+96);a.language+=String.fromCharCode((n&31)+96);return a},mdia:function e(t){return{boxes:qi(t)}},mfhd:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sequenceNumber:t[4]<<24|t[5]<<16|t[6]<<8|t[7]}},minf:function e(t){return{boxes:qi(t)}},mp4a:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={dataReferenceIndex:r.getUint16(6),channelcount:r.getUint16(16),samplesize:r.getUint16(18),samplerate:r.getUint16(24)+r.getUint16(26)/65536};if(t.byteLength>28){i.streamDescriptor=qi(t.subarray(28))[0]}return i},moof:function e(t){return{boxes:qi(t)}},moov:function e(t){return{boxes:qi(t)}},mvex:function e(t){return{boxes:qi(t)}},mvhd:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i=4,n={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};if(n.version===1){i+=4;n.creationTime=Gi(r.getUint32(i));i+=8;n.modificationTime=Gi(r.getUint32(i));i+=4;n.timescale=r.getUint32(i);i+=8;n.duration=r.getUint32(i)}else{n.creationTime=Gi(r.getUint32(i));i+=4;n.modificationTime=Gi(r.getUint32(i));i+=4;n.timescale=r.getUint32(i);i+=4;n.duration=r.getUint32(i)}i+=4;n.rate=r.getUint16(i)+r.getUint16(i+2)/16;i+=4;n.volume=r.getUint8(i)+r.getUint8(i+1)/8;i+=2;i+=2;i+=2*4;n.matrix=new Uint32Array(t.subarray(i,i+9*4));i+=9*4;i+=6*4;n.nextTrackId=r.getUint32(i);return n},pdin:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),rate:r.getUint32(4),initialDelay:r.getUint32(8)}},sdtp:function e(t){var r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},i;for(i=4;i<t.byteLength;i++){r.samples.push({dependsOn:(t[i]&48)>>4,isDependedOn:(t[i]&12)>>2,hasRedundancy:t[i]&3})}return r},sidx:Fi,smhd:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),balance:t[4]+t[5]/256}},stbl:function e(t){return{boxes:qi(t)}},ctts:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),compositionOffsets:[]},n=r.getUint32(4),a;for(a=8;n;a+=8,n--){i.compositionOffsets.push({sampleCount:r.getUint32(a),sampleOffset:r[i.version===0?"getUint32":"getInt32"](a+4)})}return i},stss:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),syncSamples:[]},n=r.getUint32(4),a;for(a=8;n;a+=4,n--){i.syncSamples.push(r.getUint32(a))}return i},stco:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),chunkOffsets:[]},n=r.getUint32(4),a;for(a=8;n;a+=4,n--){i.chunkOffsets.push(r.getUint32(a))}return i},stsc:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i=r.getUint32(4),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleToChunks:[]},a;for(a=8;i;a+=12,i--){n.sampleToChunks.push({firstChunk:r.getUint32(a),samplesPerChunk:r.getUint32(a+4),sampleDescriptionIndex:r.getUint32(a+8)})}return n},stsd:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleDescriptions:qi(t.subarray(8))}},stsz:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleSize:r.getUint32(4),entries:[]},n;for(n=12;n<t.byteLength;n+=4){i.entries.push(r.getUint32(n))}return i},stts:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),timeToSamples:[]},n=r.getUint32(4),a;for(a=8;n;a+=8,n--){i.timeToSamples.push({sampleCount:r.getUint32(a),sampleDelta:r.getUint32(a+4)})}return i},styp:function e(t){return Wi.ftyp(t)},tfdt:Be,tfhd:xe,tkhd:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i=4,n={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};if(n.version===1){i+=4;n.creationTime=Gi(r.getUint32(i));i+=8;n.modificationTime=Gi(r.getUint32(i));i+=4;n.trackId=r.getUint32(i);i+=4;i+=8;n.duration=r.getUint32(i)}else{n.creationTime=Gi(r.getUint32(i));i+=4;n.modificationTime=Gi(r.getUint32(i));i+=4;n.trackId=r.getUint32(i);i+=4;i+=4;n.duration=r.getUint32(i)}i+=4;i+=2*4;n.layer=r.getUint16(i);i+=2;n.alternateGroup=r.getUint16(i);i+=2;n.volume=r.getUint8(i)+r.getUint8(i+1)/8;i+=2;i+=2;n.matrix=new Uint32Array(t.subarray(i,i+9*4));i+=9*4;n.width=r.getUint16(i)+r.getUint16(i+2)/65536;i+=4;n.height=r.getUint16(i)+r.getUint16(i+2)/65536;return n},traf:function e(t){return{boxes:qi(t)}},trak:function e(t){return{boxes:qi(t)}},trex:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:r.getUint32(4),defaultSampleDescriptionIndex:r.getUint32(8),defaultSampleDuration:r.getUint32(12),defaultSampleSize:r.getUint32(16),sampleDependsOn:t[20]&3,sampleIsDependedOn:(t[21]&192)>>6,sampleHasRedundancy:(t[21]&48)>>4,samplePaddingValue:(t[21]&14)>>1,sampleIsDifferenceSample:!!(t[21]&1),sampleDegradationPriority:r.getUint16(22)}},trun:Re,"url ":function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4))}},vmhd:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),graphicsmode:r.getUint16(4),opcolor:new Uint16Array([r.getUint16(6),r.getUint16(8),r.getUint16(10)])}}};qi=function e(t){var r=0,i=[],n,a,s,o,u;var l=new ArrayBuffer(t.length);var d=new Uint8Array(l);for(var f=0;f<t.length;++f){d[f]=t[f]}n=new DataView(l);while(r<t.byteLength){a=n.getUint32(r);s=me(t.subarray(r+4,r+8));o=a>1?r+a:t.byteLength;u=(Wi[s]||function(e){return{data:e}})(t.subarray(r+8,o));u.size=a;u.type=s;i.push(u);r=o}return i};Hi=function e(t,r){var i;r=r||0;i=new Array(r*2+1).join(" ");return t.map((function(e,t){return i+e.type+"\n"+Object.keys(e).filter((function(e){return e!=="type"&&e!=="boxes"})).map((function(t){var r=i+"  "+t+": ",n=e[t];if(n instanceof Uint8Array||n instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(n.buffer,n.byteOffset,n.byteLength)).map((function(e){return" "+("00"+e.toString(16)).slice(-2)})).join("").match(/.{1,24}/g);if(!a){return r+"<>"}if(a.length===1){return r+"<"+a.join("").slice(1)+">"}return r+"<\n"+a.map((function(e){return i+"  "+e})).join("\n")+"\n"+i+"  >"}return r+JSON.stringify(n,null,2).split("\n").map((function(e,t){if(t===0){return e}return i+"  "+e})).join("\n")})).join("\n")+(e.boxes?"\n"+Hi(e.boxes,r+1):"")})).join("\n")};var zi={inspect:qi,textify:Hi,parseType:me,findBox:_e,parseTraf:Wi.traf,parseTfdt:Wi.tfdt,parseHdlr:Wi.hdlr,parseTfhd:Wi.tfhd,parseTrun:Wi.trun,parseSidx:Wi.sidx};var Ki={8:"audio",9:"video",18:"metadata"},Xi=function e(t){return"0x"+("00"+t.toString(16)).slice(-2).toUpperCase()},Yi=function e(t){var r=[],i;while(t.byteLength>0){i=0;r.push(Xi(t[i++]));t=t.subarray(i)}return r.join(" ")},Qi=function e(t,r){var i=["AVC Sequence Header","AVC NALU","AVC End-of-Sequence"],n=t[1]&parseInt("01111111",2)<<16|t[2]<<8|t[3];r=r||{};r.avcPacketType=i[t[0]];r.CompositionTime=t[1]&parseInt("10000000",2)?-n:n;if(t[0]===1){r.nalUnitTypeRaw=Yi(t.subarray(4,100))}else{r.data=Yi(t.subarray(4))}return r},$i=function e(t,r){var i=["Unknown","Keyframe (for AVC, a seekable frame)","Inter frame (for AVC, a nonseekable frame)","Disposable inter frame (H.263 only)","Generated keyframe (reserved for server use only)","Video info/command frame"],n=t[0]&parseInt("00001111",2);r=r||{};r.frameType=i[(t[0]&parseInt("11110000",2))>>>4];r.codecID=n;if(n===7){return Qi(t.subarray(1),r)}return r},Ji=function e(t,r){var i=["AAC Sequence Header","AAC Raw"];r=r||{};r.aacPacketType=i[t[0]];r.data=Yi(t.subarray(1));return r},Zi=function e(t,r){var i=["Linear PCM, platform endian","ADPCM","MP3","Linear PCM, little endian","Nellymoser 16-kHz mono","Nellymoser 8-kHz mono","Nellymoser","G.711 A-law logarithmic PCM","G.711 mu-law logarithmic PCM","reserved","AAC","Speex","MP3 8-Khz","Device-specific sound"],n=["5.5-kHz","11-kHz","22-kHz","44-kHz"],a=(t[0]&parseInt("11110000",2))>>>4;r=r||{};r.soundFormat=i[a];r.soundRate=n[(t[0]&parseInt("00001100",2))>>>2];r.soundSize=(t[0]&parseInt("00000010",2))>>>1?"16-bit":"8-bit";r.soundType=t[0]&parseInt("00000001",2)?"Stereo":"Mono";if(a===10){return Ji(t.subarray(1),r)}return r},en=function e(t){return{tagType:Ki[t[0]],dataSize:t[1]<<16|t[2]<<8|t[3],timestamp:t[7]<<24|t[4]<<16|t[5]<<8|t[6],streamID:t[8]<<16|t[9]<<8|t[10]}},tn=function e(t){var r=en(t);switch(t[0]){case 8:Zi(t.subarray(11),r);break;case 9:$i(t.subarray(11),r);break}return r},rn=function e(t){var r=9,i,n=[],a;r+=4;while(r<t.byteLength){i=t[r+1]<<16;i|=t[r+2]<<8;i|=t[r+3];i+=11;a=t.subarray(r,r+i);n.push(tn(a));r+=i+4}return n},nn=function e(t){return JSON.stringify(t,null,2)};var an={inspectTag:tn,inspect:rn,textify:nn};var sn=function e(t){var r=t[1]&31;r<<=8;r|=t[2];return r};var on=function e(t){return!!(t[1]&64)};var un=function e(t){var r=0;if((t[3]&48)>>>4>1){r+=t[4]+1}return r};var ln=function e(t,r){var i=sn(t);if(i===0){return"pat"}else if(i===r){return"pmt"}else if(r){return"pes"}return null};var dn=function e(t){var r=on(t);var i=4+un(t);if(r){i+=t[i]+1}return(t[i+10]&31)<<8|t[i+11]};var fn=function e(t){var r={};var i=on(t);var n=4+un(t);if(i){n+=t[n]+1}if(!(t[n+5]&1)){return}var a,s,o;a=(t[n+1]&15)<<8|t[n+2];s=3+a-4;o=(t[n+10]&15)<<8|t[n+11];var u=12+o;while(u<s){var l=n+u;r[(t[l+1]&31)<<8|t[l+2]]=t[l];u+=((t[l+3]&15)<<8|t[l+4])+5}return r};var cn=function e(t,r){var i=sn(t);var n=r[i];switch(n){case rr.H264_STREAM_TYPE:return"video";case rr.ADTS_STREAM_TYPE:return"audio";case rr.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}};var hn=function e(t){var r=on(t);if(!r){return null}var i=4+un(t);if(i>=t.byteLength){return null}var n=null;var a;a=t[i+7];if(a&192){n={};n.pts=(t[i+9]&14)<<27|(t[i+10]&255)<<20|(t[i+11]&254)<<12|(t[i+12]&255)<<5|(t[i+13]&254)>>>3;n.pts*=4;n.pts+=(t[i+13]&6)>>>1;n.dts=n.pts;if(a&64){n.dts=(t[i+14]&14)<<27|(t[i+15]&255)<<20|(t[i+16]&254)<<12|(t[i+17]&255)<<5|(t[i+18]&254)>>>3;n.dts*=4;n.dts+=(t[i+18]&6)>>>1}}return n};var pn=function e(t){switch(t){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}};var vn=function e(t){var r=4+un(t);var i=t.subarray(r);var n=0;var a=0;var s=false;var o;for(;a<i.byteLength-3;a++){if(i[a+2]===1){n=a+5;break}}while(n<i.byteLength){switch(i[n]){case 0:if(i[n-1]!==0){n+=2;break}else if(i[n-2]!==0){n++;break}if(a+3!==n-2){o=pn(i[a+3]&31);if(o==="slice_layer_without_partitioning_rbsp_idr"){s=true}}do{n++}while(i[n]!==1&&n<i.length);a=n-2;n+=3;break;case 1:if(i[n-1]!==0||i[n-2]!==0){n+=3;break}o=pn(i[a+3]&31);if(o==="slice_layer_without_partitioning_rbsp_idr"){s=true}a=n-2;n+=3;break;default:n+=3;break}}i=i.subarray(a);n-=a;a=0;if(i&&i.byteLength>3){o=pn(i[a+3]&31);if(o==="slice_layer_without_partitioning_rbsp_idr"){s=true}}return s};var mn={parseType:ln,parsePat:dn,parsePmt:fn,parsePayloadUnitStartIndicator:on,parsePesType:cn,parsePesTime:hn,videoPacketContainsKeyFrame:vn};var gn=ur.handleRollover;var yn={};yn.ts=mn;yn.aac=Lr;var _n=h.ONE_SECOND_IN_TS;var bn=188,Tn=71;var Sn=function e(t,r){var i=0,n=bn,a,s;while(n<t.byteLength){if(t[i]===Tn&&t[n]===Tn){a=t.subarray(i,n);s=yn.ts.parseType(a,r.pid);switch(s){case"pat":r.pid=yn.ts.parsePat(a);break;case"pmt":var o=yn.ts.parsePmt(a);r.table=r.table||{};Object.keys(o).forEach((function(e){r.table[e]=o[e]}));break}i+=bn;n+=bn;continue}i++;n++}};var wn=function e(t,r,i){var n=0,a=bn,s,o,u,l,d;var f=false;while(a<=t.byteLength){if(t[n]===Tn&&(t[a]===Tn||a===t.byteLength)){s=t.subarray(n,a);o=yn.ts.parseType(s,r.pid);switch(o){case"pes":u=yn.ts.parsePesType(s,r.table);l=yn.ts.parsePayloadUnitStartIndicator(s);if(u==="audio"&&l){d=yn.ts.parsePesTime(s);if(d){d.type="audio";i.audio.push(d);f=true}}break}if(f){break}n+=bn;a+=bn;continue}n++;a++}a=t.byteLength;n=a-bn;f=false;while(n>=0){if(t[n]===Tn&&(t[a]===Tn||a===t.byteLength)){s=t.subarray(n,a);o=yn.ts.parseType(s,r.pid);switch(o){case"pes":u=yn.ts.parsePesType(s,r.table);l=yn.ts.parsePayloadUnitStartIndicator(s);if(u==="audio"&&l){d=yn.ts.parsePesTime(s);if(d){d.type="audio";i.audio.push(d);f=true}}break}if(f){break}n-=bn;a-=bn;continue}n--;a--}};var En=function e(t,r,i){var n=0,a=bn,s,o,u,l,d,f,c,h;var p=false;var v={data:[],size:0};while(a<t.byteLength){if(t[n]===Tn&&t[a]===Tn){s=t.subarray(n,a);o=yn.ts.parseType(s,r.pid);switch(o){case"pes":u=yn.ts.parsePesType(s,r.table);l=yn.ts.parsePayloadUnitStartIndicator(s);if(u==="video"){if(l&&!p){d=yn.ts.parsePesTime(s);if(d){d.type="video";i.video.push(d);p=true}}if(!i.firstKeyFrame){if(l){if(v.size!==0){f=new Uint8Array(v.size);c=0;while(v.data.length){h=v.data.shift();f.set(h,c);c+=h.byteLength}if(yn.ts.videoPacketContainsKeyFrame(f)){var m=yn.ts.parsePesTime(f);if(m){i.firstKeyFrame=m;i.firstKeyFrame.type="video"}else{console.warn("Failed to extract PTS/DTS from PES at first keyframe. "+"This could be an unusual TS segment, or else mux.js did not "+"parse your TS segment correctly. If you know your TS "+"segments do contain PTS/DTS on keyframes please file a bug "+"report! You can try ffprobe to double check for yourself.")}}v.size=0}}v.data.push(s);v.size+=s.byteLength}}break}if(p&&i.firstKeyFrame){break}n+=bn;a+=bn;continue}n++;a++}a=t.byteLength;n=a-bn;p=false;while(n>=0){if(t[n]===Tn&&t[a]===Tn){s=t.subarray(n,a);o=yn.ts.parseType(s,r.pid);switch(o){case"pes":u=yn.ts.parsePesType(s,r.table);l=yn.ts.parsePayloadUnitStartIndicator(s);if(u==="video"&&l){d=yn.ts.parsePesTime(s);if(d){d.type="video";i.video.push(d);p=true}}break}if(p){break}n-=bn;a-=bn;continue}n--;a--}};var kn=function e(t,r){if(t.audio&&t.audio.length){var i=r;if(typeof i==="undefined"||isNaN(i)){i=t.audio[0].dts}t.audio.forEach((function(e){e.dts=gn(e.dts,i);e.pts=gn(e.pts,i);e.dtsTime=e.dts/_n;e.ptsTime=e.pts/_n}))}if(t.video&&t.video.length){var n=r;if(typeof n==="undefined"||isNaN(n)){n=t.video[0].dts}t.video.forEach((function(e){e.dts=gn(e.dts,n);e.pts=gn(e.pts,n);e.dtsTime=e.dts/_n;e.ptsTime=e.pts/_n}));if(t.firstKeyFrame){var a=t.firstKeyFrame;a.dts=gn(a.dts,n);a.pts=gn(a.pts,n);a.dtsTime=a.dts/_n;a.ptsTime=a.pts/_n}}};var An=function e(t){var r=false,i=0,n=null,a=null,s=0,o=0,u;while(t.length-o>=3){var l=yn.aac.parseType(t,o);switch(l){case"timed-metadata":if(t.length-o<10){r=true;break}s=yn.aac.parseId3TagSize(t,o);if(s>t.length){r=true;break}if(a===null){u=t.subarray(o,o+s);a=yn.aac.parseAacTimestamp(u)}o+=s;break;case"audio":if(t.length-o<7){r=true;break}s=yn.aac.parseAdtsSize(t,o);if(s>t.length){r=true;break}if(n===null){u=t.subarray(o,o+s);n=yn.aac.parseSampleRate(u)}i++;o+=s;break;default:o++;break}if(r){return null}}if(n===null||a===null){return null}var d=_n/n;var f={audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+i*1024*d,pts:a+i*1024*d}]};return f};var Cn=function e(t){var r={pid:null,table:null};var i={};Sn(t,r);for(var n in r.table){if(r.table.hasOwnProperty(n)){var a=r.table[n];switch(a){case rr.H264_STREAM_TYPE:i.video=[];En(t,r,i);if(i.video.length===0){delete i.video}break;case rr.ADTS_STREAM_TYPE:i.audio=[];wn(t,r,i);if(i.audio.length===0){delete i.audio}break}}}return i};var In=function e(t,r){var i=yn.aac.isLikelyAacData(t);var n;if(i){n=An(t)}else{n=Cn(t)}if(!n||!n.audio&&!n.video){return null}kn(n,r);return n};var Dn={inspect:In,parseAudioPes_:wn};var xn={codecs:E,mp4:ai,flv:Si,mp2t:wi,partial:Mi};xn.mp4.tools=zi;xn.flv.tools=an;xn.mp2t.tools=Dn;var Ln=xn;return Ln}))},"./node_modules/video.js/dist/video.es.js":function(e,t,r){"use strict";r.r(t);(function(e){var i=r("./node_modules/global/window.js");var n=r.n(i);var a=r("./node_modules/global/document.js");var s=r.n(a);var o=r("./node_modules/@babel/runtime/helpers/extends.js");var u=r.n(o);var l=r("./node_modules/keycode/index.js");var d=r.n(l);var f=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js");var c=r.n(f);var h=r("./node_modules/@babel/runtime/helpers/inheritsLoose.js");var p=r.n(h);var v=r("./node_modules/safe-json-parse/tuple.js");var m=r.n(v);var g=r("./node_modules/@videojs/xhr/lib/index.js");var y=r.n(g);var _=r("./node_modules/videojs-vtt.js/lib/browser-index.js");var b=r.n(_);var T=r("./node_modules/@babel/runtime/helpers/construct.js");var S=r.n(T);var w=r("./node_modules/@babel/runtime/helpers/inherits.js");var E=r.n(w);var k=r("./node_modules/@videojs/vhs-utils/es/resolve-url.js");var A=r("./node_modules/m3u8-parser/dist/m3u8-parser.es.js");var C=r("./node_modules/@videojs/vhs-utils/es/codecs.js");var I=r("./node_modules/@videojs/vhs-utils/es/media-types.js");var D=r("./node_modules/mpd-parser/dist/mpd-parser.es.js");var x=r("./node_modules/video.js/node_modules/mux.js/lib/tools/parse-sidx.js");var L=r.n(x);var O=r("./node_modules/@videojs/vhs-utils/es/id3-helpers.js");var P=r("./node_modules/@videojs/vhs-utils/es/containers.js");var R=r("./node_modules/@videojs/vhs-utils/es/byte-helpers.js");var U=r("./node_modules/video.js/node_modules/mux.js/lib/utils/clock.js");var M=r.n(U);var N="7.18.1";var B={};var F=function e(t,r){B[t]=B[t]||[];if(r){B[t]=B[t].concat(r)}return B[t]};var j=function e(t,r){F(t,r)};var q=function e(t,r){var i=F(t).indexOf(r);if(i<=-1){return false}B[t]=B[t].slice();B[t].splice(i,1);return true};var H=function e(t,r){F(t,[].concat(r).map((function(e){var r=function r(){q(t,r);return e.apply(void 0,arguments)};return r})))};var G={prefixed:true};var V=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]];var W=V[0];var z;for(var K=0;K<V.length;K++){if(V[K][1]in s.a){z=V[K];break}}if(z){for(var X=0;X<z.length;X++){G[W[X]]=z[X]}G.prefixed=z[0]!==W[0]}var Y=[];var Q=function e(t,r){return function(e,i,a){var s=r.levels[i];var o=new RegExp("^("+s+")$");if(e!=="log"){a.unshift(e.toUpperCase()+":")}a.unshift(t+":");if(Y){Y.push([].concat(a));var u=Y.length-1e3;Y.splice(0,u>0?u:0)}if(!n.a.console){return}var l=n.a.console[e];if(!l&&e==="debug"){l=n.a.console.info||n.a.console.log}if(!l||!s||!o.test(e)){return}l[Array.isArray(a)?"apply":"call"](n.a.console,a)}};function $(e){var t="info";var r;var i=function e(){for(var i=arguments.length,n=new Array(i),a=0;a<i;a++){n[a]=arguments[a]}r("log",t,n)};r=Q(e,i);i.createLogger=function(t){return $(e+": "+t)};i.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:t};i.level=function(e){if(typeof e==="string"){if(!i.levels.hasOwnProperty(e)){throw new Error('"'+e+'" in not a valid log level')}t=e}return t};i.history=function(){return Y?[].concat(Y):[]};i.history.filter=function(e){return(Y||[]).filter((function(t){return new RegExp(".*"+e+".*").test(t[0])}))};i.history.clear=function(){if(Y){Y.length=0}};i.history.disable=function(){if(Y!==null){Y.length=0;Y=null}};i.history.enable=function(){if(Y===null){Y=[]}};i.error=function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++){i[n]=arguments[n]}return r("error",t,i)};i.warn=function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++){i[n]=arguments[n]}return r("warn",t,i)};i.debug=function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++){i[n]=arguments[n]}return r("debug",t,i)};return i}var J=$("VIDEOJS");var Z=J.createLogger;var ee=Object.prototype.toString;var te=function e(t){return ae(t)?Object.keys(t):[]};function re(e,t){te(e).forEach((function(r){return t(e[r],r)}))}function ie(e,t,r){if(r===void 0){r=0}return te(e).reduce((function(r,i){return t(r,e[i],i)}),r)}function ne(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++){r[i-1]=arguments[i]}if(Object.assign){return u.a.apply(void 0,[e].concat(r))}r.forEach((function(t){if(!t){return}re(t,(function(t,r){e[r]=t}))}));return e}function ae(e){return!!e&&typeof e==="object"}function se(e){return ae(e)&&ee.call(e)==="[object Object]"&&e.constructor===Object}function oe(e,t){if(!e||!t){return""}if(typeof n.a.getComputedStyle==="function"){var r;try{r=n.a.getComputedStyle(e)}catch(e){return""}return r?r.getPropertyValue(t)||r[t]:""}return""}var ue=n.a.navigator&&n.a.navigator.userAgent||"";var le=/AppleWebKit\/([\d.]+)/i.exec(ue);var de=le?parseFloat(le.pop()):null;var fe=/iPod/i.test(ue);var ce=function(){var e=ue.match(/OS (\d+)_/i);if(e&&e[1]){return e[1]}return null}();var he=/Android/i.test(ue);var pe=function(){var e=ue.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e){return null}var t=e[1]&&parseFloat(e[1]);var r=e[2]&&parseFloat(e[2]);if(t&&r){return parseFloat(e[1]+"."+e[2])}else if(t){return t}return null}();var ve=he&&pe<5&&de<537;var me=/Firefox/i.test(ue);var ge=/Edg/i.test(ue);var ye=!ge&&(/Chrome/i.test(ue)||/CriOS/i.test(ue));var _e=function(){var e=ue.match(/(Chrome|CriOS)\/(\d+)/);if(e&&e[2]){return parseFloat(e[2])}return null}();var be=function(){var e=/MSIE\s(\d+)\.\d/.exec(ue);var t=e&&parseFloat(e[1]);if(!t&&/Trident\/7.0/i.test(ue)&&/rv:11.0/.test(ue)){t=11}return t}();var Te=/Safari/i.test(ue)&&!ye&&!he&&!ge;var Se=/Windows/i.test(ue);var we=Boolean(Oe()&&("ontouchstart"in n.a||n.a.navigator.maxTouchPoints||n.a.DocumentTouch&&n.a.document instanceof n.a.DocumentTouch));var Ee=/iPad/i.test(ue)||Te&&we&&!/iPhone/i.test(ue);var ke=/iPhone/i.test(ue)&&!Ee;var Ae=ke||Ee||fe;var Ce=(Te||Ae)&&!ye;var Ie=Object.freeze({__proto__:null,IS_IPOD:fe,IOS_VERSION:ce,IS_ANDROID:he,ANDROID_VERSION:pe,IS_NATIVE_ANDROID:ve,IS_FIREFOX:me,IS_EDGE:ge,IS_CHROME:ye,CHROME_VERSION:_e,IE_VERSION:be,IS_SAFARI:Te,IS_WINDOWS:Se,TOUCH_ENABLED:we,IS_IPAD:Ee,IS_IPHONE:ke,IS_IOS:Ae,IS_ANY_SAFARI:Ce});function De(e){return typeof e==="string"&&Boolean(e.trim())}function xe(e){if(e.indexOf(" ")>=0){throw new Error("class has illegal whitespace characters")}}function Le(e){return new RegExp("(^|\\s)"+e+"($|\\s)")}function Oe(){return s.a===n.a.document}function Pe(e){return ae(e)&&e.nodeType===1}function Re(){try{return n.a.parent!==n.a.self}catch(e){return true}}function Ue(e){return function(t,r){if(!De(t)){return s.a[e](null)}if(De(r)){r=s.a.querySelector(r)}var i=Pe(r)?r:s.a;return i[e]&&i[e](t)}}function Me(e,t,r,i){if(e===void 0){e="div"}if(t===void 0){t={}}if(r===void 0){r={}}var n=s.a.createElement(e);Object.getOwnPropertyNames(t).forEach((function(e){var r=t[e];if(e.indexOf("aria-")!==-1||e==="role"||e==="type"){J.warn("Setting attributes in the second argument of createEl()\n"+"has been deprecated. Use the third argument instead.\n"+("createEl(type, properties, attributes). Attempting to set "+e+" to "+r+"."));n.setAttribute(e,r)}else if(e==="textContent"){Ne(n,r)}else if(n[e]!==r||e==="tabIndex"){n[e]=r}}));Object.getOwnPropertyNames(r).forEach((function(e){n.setAttribute(e,r[e])}));if(i){rt(n,i)}return n}function Ne(e,t){if(typeof e.textContent==="undefined"){e.innerText=t}else{e.textContent=t}return e}function Be(e,t){if(t.firstChild){t.insertBefore(e,t.firstChild)}else{t.appendChild(e)}}function Fe(e,t){xe(t);if(e.classList){return e.classList.contains(t)}return Le(t).test(e.className)}function je(e,t){if(e.classList){e.classList.add(t)}else if(!Fe(e,t)){e.className=(e.className+" "+t).trim()}return e}function qe(e,t){if(!e){J.warn("removeClass was called with an element that doesn't exist");return null}if(e.classList){e.classList.remove(t)}else{xe(t);e.className=e.className.split(/\s+/).filter((function(e){return e!==t})).join(" ")}return e}function He(e,t,r){var i=Fe(e,t);if(typeof r==="function"){r=r(e,t)}if(typeof r!=="boolean"){r=!i}if(r===i){return}if(r){je(e,t)}else{qe(e,t)}return e}function Ge(e,t){Object.getOwnPropertyNames(t).forEach((function(r){var i=t[r];if(i===null||typeof i==="undefined"||i===false){e.removeAttribute(r)}else{e.setAttribute(r,i===true?"":i)}}))}function Ve(e){var t={};var r=","+"autoplay,controls,playsinline,loop,muted,default,defaultMuted"+",";if(e&&e.attributes&&e.attributes.length>0){var i=e.attributes;for(var n=i.length-1;n>=0;n--){var a=i[n].name;var s=i[n].value;if(typeof e[a]==="boolean"||r.indexOf(","+a+",")!==-1){s=s!==null?true:false}t[a]=s}}return t}function We(e,t){return e.getAttribute(t)}function ze(e,t,r){e.setAttribute(t,r)}function Ke(e,t){e.removeAttribute(t)}function Xe(){s.a.body.focus();s.a.onselectstart=function(){return false}}function Ye(){s.a.onselectstart=function(){return true}}function Qe(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect();var r={};["bottom","height","left","right","top","width"].forEach((function(e){if(t[e]!==undefined){r[e]=t[e]}}));if(!r.height){r.height=parseFloat(oe(e,"height"))}if(!r.width){r.width=parseFloat(oe(e,"width"))}return r}}function $e(e){if(!e||e&&!e.offsetParent){return{left:0,top:0,width:0,height:0}}var t=e.offsetWidth;var r=e.offsetHeight;var i=0;var n=0;while(e.offsetParent&&e!==s.a[G.fullscreenElement]){i+=e.offsetLeft;n+=e.offsetTop;e=e.offsetParent}return{left:i,top:n,width:t,height:r}}function Je(e,t){var r={x:0,y:0};if(Ae){var i=e;while(i&&i.nodeName.toLowerCase()!=="html"){var n=oe(i,"transform");if(/^matrix/.test(n)){var a=n.slice(7,-1).split(/,\s/).map(Number);r.x+=a[4];r.y+=a[5]}else if(/^matrix3d/.test(n)){var s=n.slice(9,-1).split(/,\s/).map(Number);r.x+=s[12];r.y+=s[13]}i=i.parentNode}}var o={};var u=$e(t.target);var l=$e(e);var d=l.width;var f=l.height;var c=t.offsetY-(l.top-u.top);var h=t.offsetX-(l.left-u.left);if(t.changedTouches){h=t.changedTouches[0].pageX-l.left;c=t.changedTouches[0].pageY+l.top;if(Ae){h-=r.x;c-=r.y}}o.y=1-Math.max(0,Math.min(1,c/f));o.x=Math.max(0,Math.min(1,h/d));return o}function Ze(e){return ae(e)&&e.nodeType===3}function et(e){while(e.firstChild){e.removeChild(e.firstChild)}return e}function tt(e){if(typeof e==="function"){e=e()}return(Array.isArray(e)?e:[e]).map((function(e){if(typeof e==="function"){e=e()}if(Pe(e)||Ze(e)){return e}if(typeof e==="string"&&/\S/.test(e)){return s.a.createTextNode(e)}})).filter((function(e){return e}))}function rt(e,t){tt(t).forEach((function(t){return e.appendChild(t)}));return e}function it(e,t){return rt(et(e),t)}function nt(e){if(e.button===undefined&&e.buttons===undefined){return true}if(e.button===0&&e.buttons===undefined){return true}if(e.type==="mouseup"&&e.button===0&&e.buttons===0){return true}if(e.button!==0||e.buttons!==1){return false}return true}var at=Ue("querySelector");var st=Ue("querySelectorAll");var ot=Object.freeze({__proto__:null,isReal:Oe,isEl:Pe,isInFrame:Re,createEl:Me,textContent:Ne,prependTo:Be,hasClass:Fe,addClass:je,removeClass:qe,toggleClass:He,setAttributes:Ge,getAttributes:Ve,getAttribute:We,setAttribute:ze,removeAttribute:Ke,blockTextSelection:Xe,unblockTextSelection:Ye,getBoundingClientRect:Qe,findPosition:$e,getPointerPosition:Je,isTextNode:Ze,emptyEl:et,normalizeContent:tt,appendContent:rt,insertContent:it,isSingleLeftClick:nt,$:at,$$:st});var ut=false;var lt;var dt=function e(){if(lt.options.autoSetup===false){return}var t=Array.prototype.slice.call(s.a.getElementsByTagName("video"));var r=Array.prototype.slice.call(s.a.getElementsByTagName("audio"));var i=Array.prototype.slice.call(s.a.getElementsByTagName("video-js"));var n=t.concat(r,i);if(n&&n.length>0){for(var a=0,o=n.length;a<o;a++){var u=n[a];if(u&&u.getAttribute){if(u.player===undefined){var l=u.getAttribute("data-setup");if(l!==null){lt(u)}}}else{ft(1);break}}}else if(!ut){ft(1)}};function ft(e,t){if(!Oe()){return}if(t){lt=t}n.a.setTimeout(dt,e)}function ct(){ut=true;n.a.removeEventListener("load",ct)}if(Oe()){if(s.a.readyState==="complete"){ct()}else{n.a.addEventListener("load",ct)}}var ht=function e(t){var r=s.a.createElement("style");r.className=t;return r};var pt=function e(t,r){if(t.styleSheet){t.styleSheet.cssText=r}else{t.textContent=r}};var vt=3;var mt=vt;function gt(){return mt++}var yt;if(!n.a.WeakMap){yt=function(){function e(){this.vdata="vdata"+Math.floor(n.a.performance&&n.a.performance.now()||Date.now());this.data={}}var t=e.prototype;t.set=function e(t,r){var i=t[this.vdata]||gt();if(!t[this.vdata]){t[this.vdata]=i}this.data[i]=r;return this};t.get=function e(t){var r=t[this.vdata];if(r){return this.data[r]}J("We have no data for this element",t);return undefined};t.has=function e(t){var r=t[this.vdata];return r in this.data};t["delete"]=function e(t){var r=t[this.vdata];if(r){delete this.data[r];delete t[this.vdata]}};return e}()}var _t=n.a.WeakMap?new WeakMap:new yt;function bt(e,t){if(!_t.has(e)){return}var r=_t.get(e);if(r.handlers[t].length===0){delete r.handlers[t];if(e.removeEventListener){e.removeEventListener(t,r.dispatcher,false)}else if(e.detachEvent){e.detachEvent("on"+t,r.dispatcher)}}if(Object.getOwnPropertyNames(r.handlers).length<=0){delete r.handlers;delete r.dispatcher;delete r.disabled}if(Object.getOwnPropertyNames(r).length===0){_t["delete"](e)}}function Tt(e,t,r,i){r.forEach((function(r){e(t,r,i)}))}function St(e){if(e.fixed_){return e}function t(){return true}function r(){return false}if(!e||!e.isPropagationStopped||!e.isImmediatePropagationStopped){var i=e||n.a.event;e={};for(var a in i){if(a!=="layerX"&&a!=="layerY"&&a!=="keyLocation"&&a!=="webkitMovementX"&&a!=="webkitMovementY"){if(!(a==="returnValue"&&i.preventDefault)){e[a]=i[a]}}}if(!e.target){e.target=e.srcElement||s.a}if(!e.relatedTarget){e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement}e.preventDefault=function(){if(i.preventDefault){i.preventDefault()}e.returnValue=false;i.returnValue=false;e.defaultPrevented=true};e.defaultPrevented=false;e.stopPropagation=function(){if(i.stopPropagation){i.stopPropagation()}e.cancelBubble=true;i.cancelBubble=true;e.isPropagationStopped=t};e.isPropagationStopped=r;e.stopImmediatePropagation=function(){if(i.stopImmediatePropagation){i.stopImmediatePropagation()}e.isImmediatePropagationStopped=t;e.stopPropagation()};e.isImmediatePropagationStopped=r;if(e.clientX!==null&&e.clientX!==undefined){var o=s.a.documentElement;var u=s.a.body;e.pageX=e.clientX+(o&&o.scrollLeft||u&&u.scrollLeft||0)-(o&&o.clientLeft||u&&u.clientLeft||0);e.pageY=e.clientY+(o&&o.scrollTop||u&&u.scrollTop||0)-(o&&o.clientTop||u&&u.clientTop||0)}e.which=e.charCode||e.keyCode;if(e.button!==null&&e.button!==undefined){e.button=e.button&1?0:e.button&4?1:e.button&2?2:0}}e.fixed_=true;return e}var wt;var Et=function e(){if(typeof wt!=="boolean"){wt=false;try{var t=Object.defineProperty({},"passive",{get:function e(){wt=true}});n.a.addEventListener("test",null,t);n.a.removeEventListener("test",null,t)}catch(e){}}return wt};var kt=["touchstart","touchmove"];function At(e,t,r){if(Array.isArray(t)){return Tt(At,e,t,r)}if(!_t.has(e)){_t.set(e,{})}var i=_t.get(e);if(!i.handlers){i.handlers={}}if(!i.handlers[t]){i.handlers[t]=[]}if(!r.guid){r.guid=gt()}i.handlers[t].push(r);if(!i.dispatcher){i.disabled=false;i.dispatcher=function(t,r){if(i.disabled){return}t=St(t);var n=i.handlers[t.type];if(n){var a=n.slice(0);for(var s=0,o=a.length;s<o;s++){if(t.isImmediatePropagationStopped()){break}else{try{a[s].call(e,t,r)}catch(e){J.error(e)}}}}}}if(i.handlers[t].length===1){if(e.addEventListener){var n=false;if(Et()&&kt.indexOf(t)>-1){n={passive:true}}e.addEventListener(t,i.dispatcher,n)}else if(e.attachEvent){e.attachEvent("on"+t,i.dispatcher)}}}function Ct(e,t,r){if(!_t.has(e)){return}var i=_t.get(e);if(!i.handlers){return}if(Array.isArray(t)){return Tt(Ct,e,t,r)}var n=function e(t,r){i.handlers[r]=[];bt(t,r)};if(t===undefined){for(var a in i.handlers){if(Object.prototype.hasOwnProperty.call(i.handlers||{},a)){n(e,a)}}return}var s=i.handlers[t];if(!s){return}if(!r){n(e,t);return}if(r.guid){for(var o=0;o<s.length;o++){if(s[o].guid===r.guid){s.splice(o--,1)}}}bt(e,t)}function It(e,t,r){var i=_t.has(e)?_t.get(e):{};var n=e.parentNode||e.ownerDocument;if(typeof t==="string"){t={type:t,target:e}}else if(!t.target){t.target=e}t=St(t);if(i.dispatcher){i.dispatcher.call(e,t,r)}if(n&&!t.isPropagationStopped()&&t.bubbles===true){It.call(null,n,t,r)}else if(!n&&!t.defaultPrevented&&t.target&&t.target[t.type]){if(!_t.has(t.target)){_t.set(t.target,{})}var a=_t.get(t.target);if(t.target[t.type]){a.disabled=true;if(typeof t.target[t.type]==="function"){t.target[t.type]()}a.disabled=false}}return!t.defaultPrevented}function Dt(e,t,r){if(Array.isArray(t)){return Tt(Dt,e,t,r)}var i=function i(){Ct(e,t,i);r.apply(this,arguments)};i.guid=r.guid=r.guid||gt();At(e,t,i)}function xt(e,t,r){var i=function i(){Ct(e,t,i);r.apply(this,arguments)};i.guid=r.guid=r.guid||gt();At(e,t,i)}var Lt=Object.freeze({__proto__:null,fixEvent:St,on:At,off:Ct,trigger:It,one:Dt,any:xt});var Ot=30;var Pt=function e(t,r,i){if(!r.guid){r.guid=gt()}var n=r.bind(t);n.guid=i?i+"_"+r.guid:r.guid;return n};var Rt=function e(t,r){var i=n.a.performance.now();var a=function e(){var a=n.a.performance.now();if(a-i>=r){t.apply(void 0,arguments);i=a}};return a};var Ut=function e(t,r,i,a){if(a===void 0){a=n.a}var s;var o=function e(){a.clearTimeout(s);s=null};var u=function e(){var n=this;var o=arguments;var u=function e(){s=null;u=null;if(!i){t.apply(n,o)}};if(!s&&i){t.apply(n,o)}a.clearTimeout(s);s=a.setTimeout(u,r)};u.cancel=o;return u};var Mt=function e(){};Mt.prototype.allowedEvents_={};Mt.prototype.on=function(e,t){var r=this.addEventListener;this.addEventListener=function(){};At(this,e,t);this.addEventListener=r};Mt.prototype.addEventListener=Mt.prototype.on;Mt.prototype.off=function(e,t){Ct(this,e,t)};Mt.prototype.removeEventListener=Mt.prototype.off;Mt.prototype.one=function(e,t){var r=this.addEventListener;this.addEventListener=function(){};Dt(this,e,t);this.addEventListener=r};Mt.prototype.any=function(e,t){var r=this.addEventListener;this.addEventListener=function(){};xt(this,e,t);this.addEventListener=r};Mt.prototype.trigger=function(e){var t=e.type||e;if(typeof e==="string"){e={type:t}}e=St(e);if(this.allowedEvents_[t]&&this["on"+t]){this["on"+t](e)}It(this,e)};Mt.prototype.dispatchEvent=Mt.prototype.trigger;var Nt;Mt.prototype.queueTrigger=function(e){var t=this;if(!Nt){Nt=new Map}var r=e.type||e;var i=Nt.get(this);if(!i){i=new Map;Nt.set(this,i)}var a=i.get(r);i["delete"](r);n.a.clearTimeout(a);var s=n.a.setTimeout((function(){if(i.size===0){i=null;Nt["delete"](t)}t.trigger(e)}),0);i.set(r,s)};var Bt=function e(t){if(typeof t.name==="function"){return t.name()}if(typeof t.name==="string"){return t.name}if(t.name_){return t.name_}if(t.constructor&&t.constructor.name){return t.constructor.name}return typeof t};var Ft=function e(t){return t instanceof Mt||!!t.eventBusEl_&&["on","one","off","trigger"].every((function(e){return typeof t[e]==="function"}))};var jt=function e(t,r){if(Ft(t)){r()}else{if(!t.eventedCallbacks){t.eventedCallbacks=[]}t.eventedCallbacks.push(r)}};var qt=function e(t){return typeof t==="string"&&/\S/.test(t)||Array.isArray(t)&&!!t.length};var Ht=function e(t,r,i){if(!t||!t.nodeName&&!Ft(t)){throw new Error("Invalid target for "+Bt(r)+"#"+i+"; must be a DOM node or evented object.")}};var Gt=function e(t,r,i){if(!qt(t)){throw new Error("Invalid event type for "+Bt(r)+"#"+i+"; must be a non-empty string or array.")}};var Vt=function e(t,r,i){if(typeof t!=="function"){throw new Error("Invalid listener for "+Bt(r)+"#"+i+"; must be a function.")}};var Wt=function e(t,r,i){var n=r.length<3||r[0]===t||r[0]===t.eventBusEl_;var a;var s;var o;if(n){a=t.eventBusEl_;if(r.length>=3){r.shift()}s=r[0];o=r[1]}else{a=r[0];s=r[1];o=r[2]}Ht(a,t,i);Gt(s,t,i);Vt(o,t,i);o=Pt(t,o);return{isTargetingSelf:n,target:a,type:s,listener:o}};var zt=function e(t,r,i,n){Ht(t,t,r);if(t.nodeName){Lt[r](t,i,n)}else{t[r](i,n)}};var Kt={on:function e(){var t=this;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++){i[n]=arguments[n]}var a=Wt(this,i,"on"),s=a.isTargetingSelf,o=a.target,u=a.type,l=a.listener;zt(o,"on",u,l);if(!s){var d=function e(){return t.off(o,u,l)};d.guid=l.guid;var f=function e(){return t.off("dispose",d)};f.guid=l.guid;zt(this,"on","dispose",d);zt(o,"on","dispose",f)}},one:function e(){var t=this;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++){i[n]=arguments[n]}var a=Wt(this,i,"one"),s=a.isTargetingSelf,o=a.target,u=a.type,l=a.listener;if(s){zt(o,"one",u,l)}else{var d=function e(){t.off(o,u,e);for(var r=arguments.length,i=new Array(r),n=0;n<r;n++){i[n]=arguments[n]}l.apply(null,i)};d.guid=l.guid;zt(o,"one",u,d)}},any:function e(){var t=this;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++){i[n]=arguments[n]}var a=Wt(this,i,"any"),s=a.isTargetingSelf,o=a.target,u=a.type,l=a.listener;if(s){zt(o,"any",u,l)}else{var d=function e(){t.off(o,u,e);for(var r=arguments.length,i=new Array(r),n=0;n<r;n++){i[n]=arguments[n]}l.apply(null,i)};d.guid=l.guid;zt(o,"any",u,d)}},off:function e(t,r,i){if(!t||qt(t)){Ct(this.eventBusEl_,t,r)}else{var n=t;var a=r;Ht(n,this,"off");Gt(a,this,"off");Vt(i,this,"off");i=Pt(this,i);this.off("dispose",i);if(n.nodeName){Ct(n,a,i);Ct(n,"dispose",i)}else if(Ft(n)){n.off(a,i);n.off("dispose",i)}}},trigger:function e(t,r){Ht(this.eventBusEl_,this,"trigger");var i=t&&typeof t!=="string"?t.type:t;if(!qt(i)){var n="Invalid event type for "+Bt(this)+"#trigger; "+"must be a non-empty string or object with a type key that has a non-empty value.";if(t){(this.log||J).error(n)}else{throw new Error(n)}}return It(this.eventBusEl_,t,r)}};function Xt(e,t){if(t===void 0){t={}}var r=t,i=r.eventBusKey;if(i){if(!e[i].nodeName){throw new Error('The eventBusKey "'+i+'" does not refer to an element.')}e.eventBusEl_=e[i]}else{e.eventBusEl_=Me("span",{className:"vjs-event-bus"})}ne(e,Kt);if(e.eventedCallbacks){e.eventedCallbacks.forEach((function(e){e()}))}e.on("dispose",(function(){e.off();[e,e.el_,e.eventBusEl_].forEach((function(e){if(e&&_t.has(e)){_t["delete"](e)}}));n.a.setTimeout((function(){e.eventBusEl_=null}),0)}));return e}var Yt={state:{},setState:function e(t){var r=this;if(typeof t==="function"){t=t()}var i;re(t,(function(e,t){if(r.state[t]!==e){i=i||{};i[t]={from:r.state[t],to:e}}r.state[t]=e}));if(i&&Ft(this)){this.trigger({changes:i,type:"statechanged"})}return i}};function Qt(e,t){ne(e,Yt);e.state=ne({},e.state,t);if(typeof e.handleStateChanged==="function"&&Ft(e)){e.on("statechanged",e.handleStateChanged)}return e}var $t=function e(t){if(typeof t!=="string"){return t}return t.replace(/./,(function(e){return e.toLowerCase()}))};var Jt=function e(t){if(typeof t!=="string"){return t}return t.replace(/./,(function(e){return e.toUpperCase()}))};var Zt=function e(t,r){return Jt(t)===Jt(r)};function er(){var e={};for(var t=arguments.length,r=new Array(t),i=0;i<t;i++){r[i]=arguments[i]}r.forEach((function(t){if(!t){return}re(t,(function(t,r){if(!se(t)){e[r]=t;return}if(!se(e[r])){e[r]={}}e[r]=er(e[r],t)}))}));return e}var tr=function(){function e(){this.map_={}}var t=e.prototype;t.has=function e(t){return t in this.map_};t["delete"]=function e(t){var r=this.has(t);delete this.map_[t];return r};t.set=function e(t,r){this.map_[t]=r;return this};t.forEach=function e(t,r){for(var i in this.map_){t.call(r,this.map_[i],i,this)}};return e}();var rr=n.a.Map?n.a.Map:tr;var ir=function(){function e(){this.set_={}}var t=e.prototype;t.has=function e(t){return t in this.set_};t["delete"]=function e(t){var r=this.has(t);delete this.set_[t];return r};t.add=function e(t){this.set_[t]=1;return this};t.forEach=function e(t,r){for(var i in this.set_){t.call(r,i,i,this)}};return e}();var nr=n.a.Set?n.a.Set:ir;var ar=function(){function e(e,t,r){if(!e&&this.play){this.player_=e=this}else{this.player_=e}this.isDisposed_=false;this.parentComponent_=null;this.options_=er({},this.options_);t=this.options_=er(this.options_,t);this.id_=t.id||t.el&&t.el.id;if(!this.id_){var i=e&&e.id&&e.id()||"no_player";this.id_=i+"_component_"+gt()}this.name_=t.name||null;if(t.el){this.el_=t.el}else if(t.createEl!==false){this.el_=this.createEl()}if(t.evented!==false){Xt(this,{eventBusKey:this.el_?"el_":null});this.handleLanguagechange=this.handleLanguagechange.bind(this);this.on(this.player_,"languagechange",this.handleLanguagechange)}Qt(this,this.constructor.defaultState);this.children_=[];this.childIndex_={};this.childNameIndex_={};this.setTimeoutIds_=new nr;this.setIntervalIds_=new nr;this.rafIds_=new nr;this.namedRafs_=new rr;this.clearingTimersOnDispose_=false;if(t.initChildren!==false){this.initChildren()}this.ready(r);if(t.reportTouchActivity!==false){this.enableTouchActivity()}}var t=e.prototype;t.dispose=function e(){if(this.isDisposed_){return}if(this.readyQueue_){this.readyQueue_.length=0}this.trigger({type:"dispose",bubbles:false});this.isDisposed_=true;if(this.children_){for(var t=this.children_.length-1;t>=0;t--){if(this.children_[t].dispose){this.children_[t].dispose()}}}this.children_=null;this.childIndex_=null;this.childNameIndex_=null;this.parentComponent_=null;if(this.el_){if(this.el_.parentNode){this.el_.parentNode.removeChild(this.el_)}this.el_=null}this.player_=null};t.isDisposed=function e(){return Boolean(this.isDisposed_)};t.player=function e(){return this.player_};t.options=function e(t){if(!t){return this.options_}this.options_=er(this.options_,t);return this.options_};t.el=function e(){return this.el_};t.createEl=function e(t,r,i){return Me(t,r,i)};t.localize=function e(t,r,i){if(i===void 0){i=t}var n=this.player_.language&&this.player_.language();var a=this.player_.languages&&this.player_.languages();var s=a&&a[n];var o=n&&n.split("-")[0];var u=a&&a[o];var l=i;if(s&&s[t]){l=s[t]}else if(u&&u[t]){l=u[t]}if(r){l=l.replace(/\{(\d+)\}/g,(function(e,t){var i=r[t-1];var n=i;if(typeof i==="undefined"){n=e}return n}))}return l};t.handleLanguagechange=function e(){};t.contentEl=function e(){return this.contentEl_||this.el_};t.id=function e(){return this.id_};t.name=function e(){return this.name_};t.children=function e(){return this.children_};t.getChildById=function e(t){return this.childIndex_[t]};t.getChild=function e(t){if(!t){return}return this.childNameIndex_[t]};t.getDescendant=function e(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++){r[i]=arguments[i]}r=r.reduce((function(e,t){return e.concat(t)}),[]);var n=this;for(var a=0;a<r.length;a++){n=n.getChild(r[a]);if(!n||!n.getChild){return}}return n};t.addChild=function t(r,i,n){if(i===void 0){i={}}if(n===void 0){n=this.children_.length}var a;var s;if(typeof r==="string"){s=Jt(r);var o=i.componentClass||s;i.name=s;var u=e.getComponent(o);if(!u){throw new Error("Component "+o+" does not exist")}if(typeof u!=="function"){return null}a=new u(this.player_||this,i)}else{a=r}if(a.parentComponent_){a.parentComponent_.removeChild(a)}this.children_.splice(n,0,a);a.parentComponent_=this;if(typeof a.id==="function"){this.childIndex_[a.id()]=a}s=s||a.name&&Jt(a.name());if(s){this.childNameIndex_[s]=a;this.childNameIndex_[$t(s)]=a}if(typeof a.el==="function"&&a.el()){var l=null;if(this.children_[n+1]){if(this.children_[n+1].el_){l=this.children_[n+1].el_}else if(Pe(this.children_[n+1])){l=this.children_[n+1]}}this.contentEl().insertBefore(a.el(),l)}return a};t.removeChild=function e(t){if(typeof t==="string"){t=this.getChild(t)}if(!t||!this.children_){return}var r=false;for(var i=this.children_.length-1;i>=0;i--){if(this.children_[i]===t){r=true;this.children_.splice(i,1);break}}if(!r){return}t.parentComponent_=null;this.childIndex_[t.id()]=null;this.childNameIndex_[Jt(t.name())]=null;this.childNameIndex_[$t(t.name())]=null;var n=t.el();if(n&&n.parentNode===this.contentEl()){this.contentEl().removeChild(t.el())}};t.initChildren=function t(){var r=this;var i=this.options_.children;if(i){var n=this.options_;var a=function e(t){var i=t.name;var a=t.opts;if(n[i]!==undefined){a=n[i]}if(a===false){return}if(a===true){a={}}a.playerOptions=r.options_.playerOptions;var s=r.addChild(i,a);if(s){r[i]=s}};var s;var o=e.getComponent("Tech");if(Array.isArray(i)){s=i}else{s=Object.keys(i)}s.concat(Object.keys(this.options_).filter((function(e){return!s.some((function(t){if(typeof t==="string"){return e===t}return e===t.name}))}))).map((function(e){var t;var n;if(typeof e==="string"){t=e;n=i[t]||r.options_[t]||{}}else{t=e.name;n=e}return{name:t,opts:n}})).filter((function(t){var r=e.getComponent(t.opts.componentClass||Jt(t.name));return r&&!o.isTech(r)})).forEach(a)}};t.buildCSSClass=function e(){return""};t.ready=function e(t,r){if(r===void 0){r=false}if(!t){return}if(!this.isReady_){this.readyQueue_=this.readyQueue_||[];this.readyQueue_.push(t);return}if(r){t.call(this)}else{this.setTimeout(t,1)}};t.triggerReady=function e(){this.isReady_=true;this.setTimeout((function(){var e=this.readyQueue_;this.readyQueue_=[];if(e&&e.length>0){e.forEach((function(e){e.call(this)}),this)}this.trigger("ready")}),1)};t.$=function e(t,r){return at(t,r||this.contentEl())};t.$$=function e(t,r){return st(t,r||this.contentEl())};t.hasClass=function e(t){return Fe(this.el_,t)};t.addClass=function e(t){je(this.el_,t)};t.removeClass=function e(t){qe(this.el_,t)};t.toggleClass=function e(t,r){He(this.el_,t,r)};t.show=function e(){this.removeClass("vjs-hidden")};t.hide=function e(){this.addClass("vjs-hidden")};t.lockShowing=function e(){this.addClass("vjs-lock-showing")};t.unlockShowing=function e(){this.removeClass("vjs-lock-showing")};t.getAttribute=function e(t){return We(this.el_,t)};t.setAttribute=function e(t,r){ze(this.el_,t,r)};t.removeAttribute=function e(t){Ke(this.el_,t)};t.width=function e(t,r){return this.dimension("width",t,r)};t.height=function e(t,r){return this.dimension("height",t,r)};t.dimensions=function e(t,r){this.width(t,true);this.height(r)};t.dimension=function e(t,r,i){if(r!==undefined){if(r===null||r!==r){r=0}if((""+r).indexOf("%")!==-1||(""+r).indexOf("px")!==-1){this.el_.style[t]=r}else if(r==="auto"){this.el_.style[t]=""}else{this.el_.style[t]=r+"px"}if(!i){this.trigger("componentresize")}return}if(!this.el_){return 0}var n=this.el_.style[t];var a=n.indexOf("px");if(a!==-1){return parseInt(n.slice(0,a),10)}return parseInt(this.el_["offset"+Jt(t)],10)};t.currentDimension=function e(t){var r=0;if(t!=="width"&&t!=="height"){throw new Error("currentDimension only accepts width or height value")}r=oe(this.el_,t);r=parseFloat(r);if(r===0||isNaN(r)){var i="offset"+Jt(t);r=this.el_[i]}return r};t.currentDimensions=function e(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}};t.currentWidth=function e(){return this.currentDimension("width")};t.currentHeight=function e(){return this.currentDimension("height")};t.focus=function e(){this.el_.focus()};t.blur=function e(){this.el_.blur()};t.handleKeyDown=function e(t){if(this.player_){if(!d.a.isEventKey(t,"Tab")){t.stopPropagation()}this.player_.handleKeyDown(t)}};t.handleKeyPress=function e(t){this.handleKeyDown(t)};t.emitTapEvents=function e(){var t=0;var r=null;var i=10;var a=200;var s;this.on("touchstart",(function(e){if(e.touches.length===1){r={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY};t=n.a.performance.now();s=true}}));this.on("touchmove",(function(e){if(e.touches.length>1){s=false}else if(r){var t=e.touches[0].pageX-r.pageX;var n=e.touches[0].pageY-r.pageY;var a=Math.sqrt(t*t+n*n);if(a>i){s=false}}}));var o=function e(){s=false};this.on("touchleave",o);this.on("touchcancel",o);this.on("touchend",(function(e){r=null;if(s===true){var i=n.a.performance.now()-t;if(i<a){e.preventDefault();this.trigger("tap")}}}))};t.enableTouchActivity=function e(){if(!this.player()||!this.player().reportUserActivity){return}var t=Pt(this.player(),this.player().reportUserActivity);var r;this.on("touchstart",(function(){t();this.clearInterval(r);r=this.setInterval(t,250)}));var i=function e(i){t();this.clearInterval(r)};this.on("touchmove",t);this.on("touchend",i);this.on("touchcancel",i)};t.setTimeout=function e(t,r){var i=this;var a;t=Pt(this,t);this.clearTimersOnDispose_();a=n.a.setTimeout((function(){if(i.setTimeoutIds_.has(a)){i.setTimeoutIds_["delete"](a)}t()}),r);this.setTimeoutIds_.add(a);return a};t.clearTimeout=function e(t){if(this.setTimeoutIds_.has(t)){this.setTimeoutIds_["delete"](t);n.a.clearTimeout(t)}return t};t.setInterval=function e(t,r){t=Pt(this,t);this.clearTimersOnDispose_();var i=n.a.setInterval(t,r);this.setIntervalIds_.add(i);return i};t.clearInterval=function e(t){if(this.setIntervalIds_.has(t)){this.setIntervalIds_["delete"](t);n.a.clearInterval(t)}return t};t.requestAnimationFrame=function e(t){var r=this;if(!this.supportsRaf_){return this.setTimeout(t,1e3/60)}this.clearTimersOnDispose_();var i;t=Pt(this,t);i=n.a.requestAnimationFrame((function(){if(r.rafIds_.has(i)){r.rafIds_["delete"](i)}t()}));this.rafIds_.add(i);return i};t.requestNamedAnimationFrame=function e(t,r){var i=this;if(this.namedRafs_.has(t)){return}this.clearTimersOnDispose_();r=Pt(this,r);var n=this.requestAnimationFrame((function(){r();if(i.namedRafs_.has(t)){i.namedRafs_["delete"](t)}}));this.namedRafs_.set(t,n);return t};t.cancelNamedAnimationFrame=function e(t){if(!this.namedRafs_.has(t)){return}this.cancelAnimationFrame(this.namedRafs_.get(t));this.namedRafs_["delete"](t)};t.cancelAnimationFrame=function e(t){if(!this.supportsRaf_){return this.clearTimeout(t)}if(this.rafIds_.has(t)){this.rafIds_["delete"](t);n.a.cancelAnimationFrame(t)}return t};t.clearTimersOnDispose_=function e(){var t=this;if(this.clearingTimersOnDispose_){return}this.clearingTimersOnDispose_=true;this.one("dispose",(function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach((function(e){var r=e[0],i=e[1];t[r].forEach((function(e,r){return t[i](r)}))}));t.clearingTimersOnDispose_=false}))};e.registerComponent=function t(r,i){if(typeof r!=="string"||!r){throw new Error('Illegal component name, "'+r+'"; must be a non-empty string.')}var n=e.getComponent("Tech");var a=n&&n.isTech(i);var s=e===i||e.prototype.isPrototypeOf(i.prototype);if(a||!s){var o;if(a){o="techs must be registered using Tech.registerTech()"}else{o="must be a Component subclass"}throw new Error('Illegal component, "'+r+'"; '+o+".")}r=Jt(r);if(!e.components_){e.components_={}}var u=e.getComponent("Player");if(r==="Player"&&u&&u.players){var l=u.players;var d=Object.keys(l);if(l&&d.length>0&&d.map((function(e){return l[e]})).every(Boolean)){throw new Error("Can not register Player component after player has been created.")}}e.components_[r]=i;e.components_[$t(r)]=i;return i};e.getComponent=function t(r){if(!r||!e.components_){return}return e.components_[r]};return e}();ar.prototype.supportsRaf_=typeof n.a.requestAnimationFrame==="function"&&typeof n.a.cancelAnimationFrame==="function";ar.registerComponent("Component",ar);function sr(e,t,r){if(typeof t!=="number"||t<0||t>r){throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+r+").")}}function or(e,t,r,i){sr(e,i,r.length-1);return r[i][t]}function ur(e){var t;if(e===undefined||e.length===0){t={length:0,start:function e(){throw new Error("This TimeRanges object is empty")},end:function e(){throw new Error("This TimeRanges object is empty")}}}else{t={length:e.length,start:or.bind(null,"start",0,e),end:or.bind(null,"end",1,e)}}if(n.a.Symbol&&n.a.Symbol.iterator){t[n.a.Symbol.iterator]=function(){return(e||[]).values()}}return t}function lr(e,t){if(Array.isArray(e)){return ur(e)}else if(e===undefined||t===undefined){return ur()}return ur([[e,t]])}function dr(e,t){var r=0;var i;var n;if(!t){return 0}if(!e||!e.length){e=lr(0,0)}for(var a=0;a<e.length;a++){i=e.start(a);n=e.end(a);if(n>t){n=t}r+=n-i}return r/t}function fr(e){if(e instanceof fr){return e}if(typeof e==="number"){this.code=e}else if(typeof e==="string"){this.message=e}else if(ae(e)){if(typeof e.code==="number"){this.code=e.code}ne(this,e)}if(!this.message){this.message=fr.defaultMessages[this.code]||""}}fr.prototype.code=0;fr.prototype.message="";fr.prototype.status=null;fr.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];fr.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var cr=0;cr<fr.errorTypes.length;cr++){fr[fr.errorTypes[cr]]=cr;fr.prototype[fr.errorTypes[cr]]=cr}function hr(e){return e!==undefined&&e!==null&&typeof e.then==="function"}function pr(e){if(hr(e)){e.then(null,(function(e){}))}}var vr=function e(t){var r=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((function(e,r,i){if(t[r]){e[r]=t[r]}return e}),{cues:t.cues&&Array.prototype.map.call(t.cues,(function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}}))});return r};var mr=function e(t){var r=t.$$("track");var i=Array.prototype.map.call(r,(function(e){return e.track}));var n=Array.prototype.map.call(r,(function(e){var t=vr(e.track);if(e.src){t.src=e.src}return t}));return n.concat(Array.prototype.filter.call(t.textTracks(),(function(e){return i.indexOf(e)===-1})).map(vr))};var gr=function e(t,r){t.forEach((function(e){var t=r.addRemoteTextTrack(e).track;if(!e.src&&e.cues){e.cues.forEach((function(e){return t.addCue(e)}))}}));return r.textTracks()};var yr={textTracksToJson:mr,jsonToTextTracks:gr,trackToJson_:vr};var _r="vjs-modal-dialog";var br=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.handleKeyDown_=function(e){return i.handleKeyDown(e)};i.close_=function(e){return i.close(e)};i.opened_=i.hasBeenOpened_=i.hasBeenFilled_=false;i.closeable(!i.options_.uncloseable);i.content(i.options_.content);i.contentEl_=Me("div",{className:_r+"-content"},{role:"document"});i.descEl_=Me("p",{className:_r+"-description vjs-control-text",id:i.el().getAttribute("aria-describedby")});Ne(i.descEl_,i.description());i.el_.appendChild(i.descEl_);i.el_.appendChild(i.contentEl_);return i}var r=t.prototype;r.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})};r.dispose=function t(){this.contentEl_=null;this.descEl_=null;this.previouslyActiveEl_=null;e.prototype.dispose.call(this)};r.buildCSSClass=function t(){return _r+" vjs-hidden "+e.prototype.buildCSSClass.call(this)};r.label=function e(){return this.localize(this.options_.label||"Modal Window")};r.description=function e(){var t=this.options_.description||this.localize("This is a modal window.");if(this.closeable()){t+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")}return t};r.open=function e(){if(!this.opened_){var t=this.player();this.trigger("beforemodalopen");this.opened_=true;if(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_){this.fill()}this.wasPlaying_=!t.paused();if(this.options_.pauseOnOpen&&this.wasPlaying_){t.pause()}this.on("keydown",this.handleKeyDown_);this.hadControls_=t.controls();t.controls(false);this.show();this.conditionalFocus_();this.el().setAttribute("aria-hidden","false");this.trigger("modalopen");this.hasBeenOpened_=true}};r.opened=function e(t){if(typeof t==="boolean"){this[t?"open":"close"]()}return this.opened_};r.close=function e(){if(!this.opened_){return}var t=this.player();this.trigger("beforemodalclose");this.opened_=false;if(this.wasPlaying_&&this.options_.pauseOnOpen){t.play()}this.off("keydown",this.handleKeyDown_);if(this.hadControls_){t.controls(true)}this.hide();this.el().setAttribute("aria-hidden","true");this.trigger("modalclose");this.conditionalBlur_();if(this.options_.temporary){this.dispose()}};r.closeable=function e(t){if(typeof t==="boolean"){var e=this.closeable_=!!t;var r=this.getChild("closeButton");if(e&&!r){var i=this.contentEl_;this.contentEl_=this.el_;r=this.addChild("closeButton",{controlText:"Close Modal Dialog"});this.contentEl_=i;this.on(r,"close",this.close_)}if(!e&&r){this.off(r,"close",this.close_);this.removeChild(r);r.dispose()}}return this.closeable_};r.fill=function e(){this.fillWith(this.content())};r.fillWith=function e(t){var r=this.contentEl();var i=r.parentNode;var n=r.nextSibling;this.trigger("beforemodalfill");this.hasBeenFilled_=true;i.removeChild(r);this.empty();it(r,t);this.trigger("modalfill");if(n){i.insertBefore(r,n)}else{i.appendChild(r)}var a=this.getChild("closeButton");if(a){i.appendChild(a.el_)}};r.empty=function e(){this.trigger("beforemodalempty");et(this.contentEl());this.trigger("modalempty")};r.content=function e(t){if(typeof t!=="undefined"){this.content_=t}return this.content_};r.conditionalFocus_=function e(){var t=s.a.activeElement;var r=this.player_.el_;this.previouslyActiveEl_=null;if(r.contains(t)||r===t){this.previouslyActiveEl_=t;this.focus()}};r.conditionalBlur_=function e(){if(this.previouslyActiveEl_){this.previouslyActiveEl_.focus();this.previouslyActiveEl_=null}};r.handleKeyDown=function e(t){t.stopPropagation();if(d.a.isEventKey(t,"Escape")&&this.closeable()){t.preventDefault();this.close();return}if(!d.a.isEventKey(t,"Tab")){return}var r=this.focusableEls_();var i=this.el_.querySelector(":focus");var n;for(var a=0;a<r.length;a++){if(i===r[a]){n=a;break}}if(s.a.activeElement===this.el_){n=0}if(t.shiftKey&&n===0){r[r.length-1].focus();t.preventDefault()}else if(!t.shiftKey&&n===r.length-1){r[0].focus();t.preventDefault()}};r.focusableEls_=function e(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,(function(e){return(e instanceof n.a.HTMLAnchorElement||e instanceof n.a.HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof n.a.HTMLInputElement||e instanceof n.a.HTMLSelectElement||e instanceof n.a.HTMLTextAreaElement||e instanceof n.a.HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof n.a.HTMLIFrameElement||e instanceof n.a.HTMLObjectElement||e instanceof n.a.HTMLEmbedElement||e.hasAttribute("tabindex")&&e.getAttribute("tabindex")!==-1||e.hasAttribute("contenteditable")}))};return t}(ar);br.prototype.options_={pauseOnOpen:true,temporary:true};ar.registerComponent("ModalDialog",br);var Tr=function(e){p()(t,e);function t(t){var r;if(t===void 0){t=[]}r=e.call(this)||this;r.tracks_=[];Object.defineProperty(c()(r),"length",{get:function e(){return this.tracks_.length}});for(var i=0;i<t.length;i++){r.addTrack(t[i])}return r}var r=t.prototype;r.addTrack=function e(t){var r=this;var i=this.tracks_.length;if(!(""+i in this)){Object.defineProperty(this,i,{get:function e(){return this.tracks_[i]}})}if(this.tracks_.indexOf(t)===-1){this.tracks_.push(t);this.trigger({track:t,type:"addtrack",target:this})}t.labelchange_=function(){r.trigger({track:t,type:"labelchange",target:r})};if(Ft(t)){t.addEventListener("labelchange",t.labelchange_)}};r.removeTrack=function e(t){var r;for(var i=0,n=this.length;i<n;i++){if(this[i]===t){r=this[i];if(r.off){r.off()}this.tracks_.splice(i,1);break}}if(!r){return}this.trigger({track:r,type:"removetrack",target:this})};r.getTrackById=function e(t){var r=null;for(var i=0,n=this.length;i<n;i++){var a=this[i];if(a.id===t){r=a;break}}return r};return t}(Mt);Tr.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(var Sr in Tr.prototype.allowedEvents_){Tr.prototype["on"+Sr]=null}var wr=function e(t,r){for(var i=0;i<t.length;i++){if(!Object.keys(t[i]).length||r.id===t[i].id){continue}t[i].enabled=false}};var Er=function(e){p()(t,e);function t(t){var r;if(t===void 0){t=[]}for(var i=t.length-1;i>=0;i--){if(t[i].enabled){wr(t,t[i]);break}}r=e.call(this,t)||this;r.changing_=false;return r}var r=t.prototype;r.addTrack=function t(r){var i=this;if(r.enabled){wr(this,r)}e.prototype.addTrack.call(this,r);if(!r.addEventListener){return}r.enabledChange_=function(){if(i.changing_){return}i.changing_=true;wr(i,r);i.changing_=false;i.trigger("change")};r.addEventListener("enabledchange",r.enabledChange_)};r.removeTrack=function t(r){e.prototype.removeTrack.call(this,r);if(r.removeEventListener&&r.enabledChange_){r.removeEventListener("enabledchange",r.enabledChange_);r.enabledChange_=null}};return t}(Tr);var kr=function e(t,r){for(var i=0;i<t.length;i++){if(!Object.keys(t[i]).length||r.id===t[i].id){continue}t[i].selected=false}};var Ar=function(e){p()(t,e);function t(t){var r;if(t===void 0){t=[]}for(var i=t.length-1;i>=0;i--){if(t[i].selected){kr(t,t[i]);break}}r=e.call(this,t)||this;r.changing_=false;Object.defineProperty(c()(r),"selectedIndex",{get:function e(){for(var t=0;t<this.length;t++){if(this[t].selected){return t}}return-1},set:function e(){}});return r}var r=t.prototype;r.addTrack=function t(r){var i=this;if(r.selected){kr(this,r)}e.prototype.addTrack.call(this,r);if(!r.addEventListener){return}r.selectedChange_=function(){if(i.changing_){return}i.changing_=true;kr(i,r);i.changing_=false;i.trigger("change")};r.addEventListener("selectedchange",r.selectedChange_)};r.removeTrack=function t(r){e.prototype.removeTrack.call(this,r);if(r.removeEventListener&&r.selectedChange_){r.removeEventListener("selectedchange",r.selectedChange_);r.selectedChange_=null}};return t}(Tr);var Cr=function(e){p()(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.addTrack=function t(r){var i=this;e.prototype.addTrack.call(this,r);if(!this.queueChange_){this.queueChange_=function(){return i.queueTrigger("change")}}if(!this.triggerSelectedlanguagechange){this.triggerSelectedlanguagechange_=function(){return i.trigger("selectedlanguagechange")}}r.addEventListener("modechange",this.queueChange_);var n=["metadata","chapters"];if(n.indexOf(r.kind)===-1){r.addEventListener("modechange",this.triggerSelectedlanguagechange_)}};r.removeTrack=function t(r){e.prototype.removeTrack.call(this,r);if(r.removeEventListener){if(this.queueChange_){r.removeEventListener("modechange",this.queueChange_)}if(this.selectedlanguagechange_){r.removeEventListener("modechange",this.triggerSelectedlanguagechange_)}}};return t}(Tr);var Ir=function(){function e(e){if(e===void 0){e=[]}this.trackElements_=[];Object.defineProperty(this,"length",{get:function e(){return this.trackElements_.length}});for(var t=0,r=e.length;t<r;t++){this.addTrackElement_(e[t])}}var t=e.prototype;t.addTrackElement_=function e(t){var r=this.trackElements_.length;if(!(""+r in this)){Object.defineProperty(this,r,{get:function e(){return this.trackElements_[r]}})}if(this.trackElements_.indexOf(t)===-1){this.trackElements_.push(t)}};t.getTrackElementByTrack_=function e(t){var r;for(var i=0,n=this.trackElements_.length;i<n;i++){if(t===this.trackElements_[i].track){r=this.trackElements_[i];break}}return r};t.removeTrackElement_=function e(t){for(var r=0,i=this.trackElements_.length;r<i;r++){if(t===this.trackElements_[r]){if(this.trackElements_[r].track&&typeof this.trackElements_[r].track.off==="function"){this.trackElements_[r].track.off()}if(typeof this.trackElements_[r].off==="function"){this.trackElements_[r].off()}this.trackElements_.splice(r,1);break}}};return e}();var Dr=function(){function e(t){e.prototype.setCues_.call(this,t);Object.defineProperty(this,"length",{get:function e(){return this.length_}})}var t=e.prototype;t.setCues_=function e(t){var r=this.length||0;var i=0;var n=t.length;this.cues_=t;this.length_=t.length;var a=function e(t){if(!(""+t in this)){Object.defineProperty(this,""+t,{get:function e(){return this.cues_[t]}})}};if(r<n){i=r;for(;i<n;i++){a.call(this,i)}}};t.getCueById=function e(t){var r=null;for(var i=0,n=this.length;i<n;i++){var a=this[i];if(a.id===t){r=a;break}}return r};return e}();var xr={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"};var Lr={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"};var Or={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"};var Pr={disabled:"disabled",hidden:"hidden",showing:"showing"};var Rr=function(e){p()(t,e);function t(t){var r;if(t===void 0){t={}}r=e.call(this)||this;var i={id:t.id||"vjs_track_"+gt(),kind:t.kind||"",language:t.language||""};var n=t.label||"";var a=function e(t){Object.defineProperty(c()(r),t,{get:function e(){return i[t]},set:function e(){}})};for(var s in i){a(s)}Object.defineProperty(c()(r),"label",{get:function e(){return n},set:function e(t){if(t!==n){n=t;this.trigger("labelchange")}}});return r}return t}(Mt);var Ur=function e(t){var r=["protocol","hostname","port","pathname","search","hash","host"];var i=s.a.createElement("a");i.href=t;var a={};for(var o=0;o<r.length;o++){a[r[o]]=i[r[o]]}if(a.protocol==="http:"){a.host=a.host.replace(/:80$/,"")}if(a.protocol==="https:"){a.host=a.host.replace(/:443$/,"")}if(!a.protocol){a.protocol=n.a.location.protocol}if(!a.host){a.host=n.a.location.host}return a};var Mr=function e(t){if(!t.match(/^https?:\/\//)){var r=s.a.createElement("a");r.href=t;t=r.href}return t};var Nr=function e(t){if(typeof t==="string"){var r=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/;var i=r.exec(t);if(i){return i.pop().toLowerCase()}}return""};var Br=function e(t,r){if(r===void 0){r=n.a.location}var i=Ur(t);var a=i.protocol===":"?r.protocol:i.protocol;var s=a+i.host!==r.protocol+r.host;return s};var Fr=Object.freeze({__proto__:null,parseUrl:Ur,getAbsoluteURL:Mr,getFileExtension:Nr,isCrossOrigin:Br});var jr=function e(t,r){var i=new n.a.WebVTT.Parser(n.a,n.a.vttjs,n.a.WebVTT.StringDecoder());var a=[];i.oncue=function(e){r.addCue(e)};i.onparsingerror=function(e){a.push(e)};i.onflush=function(){r.trigger({type:"loadeddata",target:r})};i.parse(t);if(a.length>0){if(n.a.console&&n.a.console.groupCollapsed){n.a.console.groupCollapsed("Text Track parsing errors for "+r.src)}a.forEach((function(e){return J.error(e)}));if(n.a.console&&n.a.console.groupEnd){n.a.console.groupEnd()}}i.flush()};var qr=function e(t,r){var i={uri:t};var a=Br(t);if(a){i.cors=a}var s=r.tech_.crossOrigin()==="use-credentials";if(s){i.withCredentials=s}y()(i,Pt(this,(function(e,t,i){if(e){return J.error(e,t)}r.loaded_=true;if(typeof n.a.WebVTT!=="function"){if(r.tech_){r.tech_.any(["vttjsloaded","vttjserror"],(function(e){if(e.type==="vttjserror"){J.error("vttjs failed to load, stopping trying to process "+r.src);return}return jr(i,r)}))}}else{jr(i,r)}})))};var Hr=function(e){p()(t,e);function t(t){var r;if(t===void 0){t={}}if(!t.tech){throw new Error("A tech was not provided.")}var i=er(t,{kind:Or[t.kind]||"subtitles",language:t.language||t.srclang||""});var n=Pr[i.mode]||"disabled";var a=i["default"];if(i.kind==="metadata"||i.kind==="chapters"){n="hidden"}r=e.call(this,i)||this;r.tech_=i.tech;r.cues_=[];r.activeCues_=[];r.preload_=r.tech_.preloadTextTracks!==false;var s=new Dr(r.cues_);var o=new Dr(r.activeCues_);var u=false;var l=Pt(c()(r),(function(){if(!this.tech_.isReady_||this.tech_.isDisposed()){return}this.activeCues=this.activeCues;if(u){this.trigger("cuechange");u=false}}));var d=function e(){r.tech_.off("timeupdate",l)};r.tech_.one("dispose",d);if(n!=="disabled"){r.tech_.on("timeupdate",l)}Object.defineProperties(c()(r),{default:{get:function e(){return a},set:function e(){}},mode:{get:function e(){return n},set:function e(t){if(!Pr[t]){return}if(n===t){return}n=t;if(!this.preload_&&n!=="disabled"&&this.cues.length===0){qr(this.src,this)}this.tech_.off("timeupdate",l);if(n!=="disabled"){this.tech_.on("timeupdate",l)}this.trigger("modechange")}},cues:{get:function e(){if(!this.loaded_){return null}return s},set:function e(){}},activeCues:{get:function e(){if(!this.loaded_){return null}if(this.cues.length===0){return o}var t=this.tech_.currentTime();var r=[];for(var i=0,n=this.cues.length;i<n;i++){var a=this.cues[i];if(a.startTime<=t&&a.endTime>=t){r.push(a)}else if(a.startTime===a.endTime&&a.startTime<=t&&a.startTime+.5>=t){r.push(a)}}u=false;if(r.length!==this.activeCues_.length){u=true}else{for(var s=0;s<r.length;s++){if(this.activeCues_.indexOf(r[s])===-1){u=true}}}this.activeCues_=r;o.setCues_(this.activeCues_);return o},set:function e(){}}});if(i.src){r.src=i.src;if(!r.preload_){r.loaded_=true}if(r.preload_||i.kind!=="subtitles"&&i.kind!=="captions"){qr(r.src,c()(r))}}else{r.loaded_=true}return r}var r=t.prototype;r.addCue=function e(t){var r=t;if(n.a.vttjs&&!(t instanceof n.a.vttjs.VTTCue)){r=new n.a.vttjs.VTTCue(t.startTime,t.endTime,t.text);for(var i in t){if(!(i in r)){r[i]=t[i]}}r.id=t.id;r.originalCue_=t}var a=this.tech_.textTracks();for(var s=0;s<a.length;s++){if(a[s]!==this){a[s].removeCue(r)}}this.cues_.push(r);this.cues.setCues_(this.cues_)};r.removeCue=function e(t){var r=this.cues_.length;while(r--){var i=this.cues_[r];if(i===t||i.originalCue_&&i.originalCue_===t){this.cues_.splice(r,1);this.cues.setCues_(this.cues_);break}}};return t}(Rr);Hr.prototype.allowedEvents_={cuechange:"cuechange"};var Gr=function(e){p()(t,e);function t(t){var r;if(t===void 0){t={}}var i=er(t,{kind:Lr[t.kind]||""});r=e.call(this,i)||this;var n=false;Object.defineProperty(c()(r),"enabled",{get:function e(){return n},set:function e(t){if(typeof t!=="boolean"||t===n){return}n=t;this.trigger("enabledchange")}});if(i.enabled){r.enabled=i.enabled}r.loaded_=true;return r}return t}(Rr);var Vr=function(e){p()(t,e);function t(t){var r;if(t===void 0){t={}}var i=er(t,{kind:xr[t.kind]||""});r=e.call(this,i)||this;var n=false;Object.defineProperty(c()(r),"selected",{get:function e(){return n},set:function e(t){if(typeof t!=="boolean"||t===n){return}n=t;this.trigger("selectedchange")}});if(i.selected){r.selected=i.selected}return r}return t}(Rr);var Wr=0;var zr=1;var Kr=2;var Xr=3;var Yr=function(e){p()(t,e);function t(t){var r;if(t===void 0){t={}}r=e.call(this)||this;var i;var n=new Hr(t);r.kind=n.kind;r.src=n.src;r.srclang=n.language;r.label=n.label;r["default"]=n["default"];Object.defineProperties(c()(r),{readyState:{get:function e(){return i}},track:{get:function e(){return n}}});i=Wr;n.addEventListener("loadeddata",(function(){i=Kr;r.trigger({type:"load",target:c()(r)})}));return r}return t}(Mt);Yr.prototype.allowedEvents_={load:"load"};Yr.NONE=Wr;Yr.LOADING=zr;Yr.LOADED=Kr;Yr.ERROR=Xr;var Qr={audio:{ListClass:Er,TrackClass:Gr,capitalName:"Audio"},video:{ListClass:Ar,TrackClass:Vr,capitalName:"Video"},text:{ListClass:Cr,TrackClass:Hr,capitalName:"Text"}};Object.keys(Qr).forEach((function(e){Qr[e].getterName=e+"Tracks";Qr[e].privateName=e+"Tracks_"}));var $r={remoteText:{ListClass:Cr,TrackClass:Hr,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Ir,TrackClass:Yr,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}};var Jr=u()({},Qr,$r);$r.names=Object.keys($r);Qr.names=Object.keys(Qr);Jr.names=[].concat($r.names).concat(Qr.names);function Zr(e,t,r,i,n){if(n===void 0){n={}}var a=e.textTracks();n.kind=t;if(r){n.label=r}if(i){n.language=i}n.tech=e;var s=new Jr.text.TrackClass(n);a.addTrack(s);return s}var ei=function(e){p()(t,e);function t(t,r){var i;if(t===void 0){t={}}if(r===void 0){r=function e(){}}t.reportTouchActivity=false;i=e.call(this,null,t,r)||this;i.onDurationChange_=function(e){return i.onDurationChange(e)};i.trackProgress_=function(e){return i.trackProgress(e)};i.trackCurrentTime_=function(e){return i.trackCurrentTime(e)};i.stopTrackingCurrentTime_=function(e){return i.stopTrackingCurrentTime(e)};i.disposeSourceHandler_=function(e){return i.disposeSourceHandler(e)};i.hasStarted_=false;i.on("playing",(function(){this.hasStarted_=true}));i.on("loadstart",(function(){this.hasStarted_=false}));Jr.names.forEach((function(e){var r=Jr[e];if(t&&t[r.getterName]){i[r.privateName]=t[r.getterName]}}));if(!i.featuresProgressEvents){i.manualProgressOn()}if(!i.featuresTimeupdateEvents){i.manualTimeUpdatesOn()}["Text","Audio","Video"].forEach((function(e){if(t["native"+e+"Tracks"]===false){i["featuresNative"+e+"Tracks"]=false}}));if(t.nativeCaptions===false||t.nativeTextTracks===false){i.featuresNativeTextTracks=false}else if(t.nativeCaptions===true||t.nativeTextTracks===true){i.featuresNativeTextTracks=true}if(!i.featuresNativeTextTracks){i.emulateTextTracks()}i.preloadTextTracks=t.preloadTextTracks!==false;i.autoRemoteTextTracks_=new Jr.text.ListClass;i.initTrackListeners();if(!t.nativeControlsForTouch){i.emitTapEvents()}if(i.constructor){i.name_=i.constructor.name||"Unknown Tech"}return i}var r=t.prototype;r.triggerSourceset=function e(t){var r=this;if(!this.isReady_){this.one("ready",(function(){return r.setTimeout((function(){return r.triggerSourceset(t)}),1)}))}this.trigger({src:t,type:"sourceset"})};r.manualProgressOn=function e(){this.on("durationchange",this.onDurationChange_);this.manualProgress=true;this.one("ready",this.trackProgress_)};r.manualProgressOff=function e(){this.manualProgress=false;this.stopTrackingProgress();this.off("durationchange",this.onDurationChange_)};r.trackProgress=function e(t){this.stopTrackingProgress();this.progressInterval=this.setInterval(Pt(this,(function(){var e=this.bufferedPercent();if(this.bufferedPercent_!==e){this.trigger("progress")}this.bufferedPercent_=e;if(e===1){this.stopTrackingProgress()}})),500)};r.onDurationChange=function e(t){this.duration_=this.duration()};r.buffered=function e(){return lr(0,0)};r.bufferedPercent=function e(){return dr(this.buffered(),this.duration_)};r.stopTrackingProgress=function e(){this.clearInterval(this.progressInterval)};r.manualTimeUpdatesOn=function e(){this.manualTimeUpdates=true;this.on("play",this.trackCurrentTime_);this.on("pause",this.stopTrackingCurrentTime_)};r.manualTimeUpdatesOff=function e(){this.manualTimeUpdates=false;this.stopTrackingCurrentTime();this.off("play",this.trackCurrentTime_);this.off("pause",this.stopTrackingCurrentTime_)};r.trackCurrentTime=function e(){if(this.currentTimeInterval){this.stopTrackingCurrentTime()}this.currentTimeInterval=this.setInterval((function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})}),250)};r.stopTrackingCurrentTime=function e(){this.clearInterval(this.currentTimeInterval);this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})};r.dispose=function t(){this.clearTracks(Qr.names);if(this.manualProgress){this.manualProgressOff()}if(this.manualTimeUpdates){this.manualTimeUpdatesOff()}e.prototype.dispose.call(this)};r.clearTracks=function e(t){var r=this;t=[].concat(t);t.forEach((function(e){var t=r[e+"Tracks"]()||[];var i=t.length;while(i--){var n=t[i];if(e==="text"){r.removeRemoteTextTrack(n)}t.removeTrack(n)}}))};r.cleanupAutoTextTracks=function e(){var t=this.autoRemoteTextTracks_||[];var r=t.length;while(r--){var i=t[r];this.removeRemoteTextTrack(i)}};r.reset=function e(){};r.crossOrigin=function e(){};r.setCrossOrigin=function e(){};r.error=function e(t){if(t!==undefined){this.error_=new fr(t);this.trigger("error")}return this.error_};r.played=function e(){if(this.hasStarted_){return lr(0,0)}return lr()};r.play=function e(){};r.setScrubbing=function e(){};r.scrubbing=function e(){};r.setCurrentTime=function e(){if(this.manualTimeUpdates){this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})}};r.initTrackListeners=function e(){var t=this;Qr.names.forEach((function(e){var r=Qr[e];var i=function r(){t.trigger(e+"trackchange")};var n=t[r.getterName]();n.addEventListener("removetrack",i);n.addEventListener("addtrack",i);t.on("dispose",(function(){n.removeEventListener("removetrack",i);n.removeEventListener("addtrack",i)}))}))};r.addWebVttScript_=function e(){var t=this;if(n.a.WebVTT){return}if(s.a.body.contains(this.el())){if(!this.options_["vtt.js"]&&se(b.a)&&Object.keys(b.a).length>0){this.trigger("vttjsloaded");return}var r=s.a.createElement("script");r.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js";r.onload=function(){t.trigger("vttjsloaded")};r.onerror=function(){t.trigger("vttjserror")};this.on("dispose",(function(){r.onload=null;r.onerror=null}));n.a.WebVTT=true;this.el().parentNode.appendChild(r)}else{this.ready(this.addWebVttScript_)}};r.emulateTextTracks=function e(){var t=this;var r=this.textTracks();var i=this.remoteTextTracks();var n=function e(t){return r.addTrack(t.track)};var a=function e(t){return r.removeTrack(t.track)};i.on("addtrack",n);i.on("removetrack",a);this.addWebVttScript_();var s=function e(){return t.trigger("texttrackchange")};var o=function e(){s();for(var t=0;t<r.length;t++){var i=r[t];i.removeEventListener("cuechange",s);if(i.mode==="showing"){i.addEventListener("cuechange",s)}}};o();r.addEventListener("change",o);r.addEventListener("addtrack",o);r.addEventListener("removetrack",o);this.on("dispose",(function(){i.off("addtrack",n);i.off("removetrack",a);r.removeEventListener("change",o);r.removeEventListener("addtrack",o);r.removeEventListener("removetrack",o);for(var e=0;e<r.length;e++){var t=r[e];t.removeEventListener("cuechange",s)}}))};r.addTextTrack=function e(t,r,i){if(!t){throw new Error("TextTrack kind is required but was not provided")}return Zr(this,t,r,i)};r.createRemoteTextTrack=function e(t){var r=er(t,{tech:this});return new $r.remoteTextEl.TrackClass(r)};r.addRemoteTextTrack=function e(t,r){var i=this;if(t===void 0){t={}}var n=this.createRemoteTextTrack(t);if(r!==true&&r!==false){J.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js');r=true}this.remoteTextTrackEls().addTrackElement_(n);this.remoteTextTracks().addTrack(n.track);if(r!==true){this.ready((function(){return i.autoRemoteTextTracks_.addTrack(n.track)}))}return n};r.removeRemoteTextTrack=function e(t){var r=this.remoteTextTrackEls().getTrackElementByTrack_(t);this.remoteTextTrackEls().removeTrackElement_(r);this.remoteTextTracks().removeTrack(t);this.autoRemoteTextTracks_.removeTrack(t)};r.getVideoPlaybackQuality=function e(){return{}};r.requestPictureInPicture=function e(){var t=this.options_.Promise||n.a.Promise;if(t){return t.reject()}};r.disablePictureInPicture=function e(){return true};r.setDisablePictureInPicture=function e(){};r.setPoster=function e(){};r.playsinline=function e(){};r.setPlaysinline=function e(){};r.overrideNativeAudioTracks=function e(){};r.overrideNativeVideoTracks=function e(){};r.canPlayType=function e(){return""};t.canPlayType=function e(){return""};t.canPlaySource=function e(r,i){return t.canPlayType(r.type)};t.isTech=function e(r){return r.prototype instanceof t||r instanceof t||r===t};t.registerTech=function e(r,i){if(!t.techs_){t.techs_={}}if(!t.isTech(i)){throw new Error("Tech "+r+" must be a Tech")}if(!t.canPlayType){throw new Error("Techs must have a static canPlayType method on them")}if(!t.canPlaySource){throw new Error("Techs must have a static canPlaySource method on them")}r=Jt(r);t.techs_[r]=i;t.techs_[$t(r)]=i;if(r!=="Tech"){t.defaultTechOrder_.push(r)}return i};t.getTech=function e(r){if(!r){return}if(t.techs_&&t.techs_[r]){return t.techs_[r]}r=Jt(r);if(n.a&&n.a.videojs&&n.a.videojs[r]){J.warn("The "+r+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)");return n.a.videojs[r]}};return t}(ar);Jr.names.forEach((function(e){var t=Jr[e];ei.prototype[t.getterName]=function(){this[t.privateName]=this[t.privateName]||new t.ListClass;return this[t.privateName]}}));ei.prototype.featuresVolumeControl=true;ei.prototype.featuresMuteControl=true;ei.prototype.featuresFullscreenResize=false;ei.prototype.featuresPlaybackRate=false;ei.prototype.featuresProgressEvents=false;ei.prototype.featuresSourceset=false;ei.prototype.featuresTimeupdateEvents=false;ei.prototype.featuresNativeTextTracks=false;ei.withSourceHandlers=function(e){e.registerSourceHandler=function(t,r){var i=e.sourceHandlers;if(!i){i=e.sourceHandlers=[]}if(r===undefined){r=i.length}i.splice(r,0,t)};e.canPlayType=function(t){var r=e.sourceHandlers||[];var i;for(var n=0;n<r.length;n++){i=r[n].canPlayType(t);if(i){return i}}return""};e.selectSourceHandler=function(t,r){var i=e.sourceHandlers||[];var n;for(var a=0;a<i.length;a++){n=i[a].canHandleSource(t,r);if(n){return i[a]}}return null};e.canPlaySource=function(t,r){var i=e.selectSourceHandler(t,r);if(i){return i.canHandleSource(t,r)}return""};var t=["seekable","seeking","duration"];t.forEach((function(e){var t=this[e];if(typeof t!=="function"){return}this[e]=function(){if(this.sourceHandler_&&this.sourceHandler_[e]){return this.sourceHandler_[e].apply(this.sourceHandler_,arguments)}return t.apply(this,arguments)}}),e.prototype);e.prototype.setSource=function(t){var r=e.selectSourceHandler(t,this.options_);if(!r){if(e.nativeSourceHandler){r=e.nativeSourceHandler}else{J.error("No source handler found for the current source.")}}this.disposeSourceHandler();this.off("dispose",this.disposeSourceHandler_);if(r!==e.nativeSourceHandler){this.currentSource_=t}this.sourceHandler_=r.handleSource(t,this,this.options_);this.one("dispose",this.disposeSourceHandler_)};e.prototype.disposeSourceHandler=function(){if(this.currentSource_){this.clearTracks(["audio","video"]);this.currentSource_=null}this.cleanupAutoTextTracks();if(this.sourceHandler_){if(this.sourceHandler_.dispose){this.sourceHandler_.dispose()}this.sourceHandler_=null}}};ar.registerComponent("Tech",ei);ei.registerTech("Tech",ei);ei.defaultTechOrder_=[];var ti={};var ri={};var ii={};function ni(e,t){ti[e]=ti[e]||[];ti[e].push(t)}function ai(e,t,r){e.setTimeout((function(){return gi(t,ti[t.type],r,e)}),1)}function si(e,t){e.forEach((function(e){return e.setTech&&e.setTech(t)}))}function oi(e,t,r){return e.reduceRight(hi(r),t[r]())}function ui(e,t,r,i){return t[r](e.reduce(hi(r),i))}function li(e,t,r,i){if(i===void 0){i=null}var n="call"+Jt(r);var a=e.reduce(hi(n),i);var s=a===ii;var o=s?null:t[r](a);pi(e,r,o,s);return o}var di={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1};var fi={setCurrentTime:1,setMuted:1,setVolume:1};var ci={play:1,pause:1};function hi(e){return function(t,r){if(t===ii){return ii}if(r[e]){return r[e](t)}return t}}function pi(e,t,r,i){for(var n=e.length-1;n>=0;n--){var a=e[n];if(a[t]){a[t](i,r)}}}function vi(e){ri[e.id()]=null}function mi(e,t){var r=ri[e.id()];var i=null;if(r===undefined||r===null){i=t(e);ri[e.id()]=[[t,i]];return i}for(var n=0;n<r.length;n++){var a=r[n],s=a[0],o=a[1];if(s!==t){continue}i=o}if(i===null){i=t(e);r.push([t,i])}return i}function gi(e,t,r,i,n,a){if(e===void 0){e={}}if(t===void 0){t=[]}if(n===void 0){n=[]}if(a===void 0){a=false}var s=t,o=s[0],u=s.slice(1);if(typeof o==="string"){gi(e,ti[o],r,i,n,a)}else if(o){var l=mi(i,o);if(!l.setSource){n.push(l);return gi(e,u,r,i,n,a)}l.setSource(ne({},e),(function(t,s){if(t){return gi(e,u,r,i,n,a)}n.push(l);gi(s,e.type===s.type?u:ti[s.type],r,i,n,a)}))}else if(u.length){gi(e,u,r,i,n,a)}else if(a){r(e,n)}else{gi(e,ti["*"],r,i,n,true)}}var yi={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"};var _i=function e(t){if(t===void 0){t=""}var r=Nr(t);var i=yi[r.toLowerCase()];return i||""};var bi=function e(t,r){if(!r){return""}if(t.cache_.source.src===r&&t.cache_.source.type){return t.cache_.source.type}var i=t.cache_.sources.filter((function(e){return e.src===r}));if(i.length){return i[0].type}var n=t.$$("source");for(var a=0;a<n.length;a++){var s=n[a];if(s.type&&s.src&&s.src===r){return s.type}}return _i(r)};var Ti=function e(t){if(Array.isArray(t)){var r=[];t.forEach((function(t){t=e(t);if(Array.isArray(t)){r=r.concat(t)}else if(ae(t)){r.push(t)}}));t=r}else if(typeof t==="string"&&t.trim()){t=[Si({src:t})]}else if(ae(t)&&typeof t.src==="string"&&t.src&&t.src.trim()){t=[Si(t)]}else{t=[]}return t};function Si(e){if(!e.type){var t=_i(e.src);if(t){e.type=t}}return e}var wi=function(e){p()(t,e);function t(t,r,i){var n;var a=er({createEl:false},r);n=e.call(this,t,a,i)||this;if(!r.playerOptions.sources||r.playerOptions.sources.length===0){for(var s=0,o=r.playerOptions.techOrder;s<o.length;s++){var u=Jt(o[s]);var l=ei.getTech(u);if(!u){l=ar.getComponent(u)}if(l&&l.isSupported()){t.loadTech_(u);break}}}else{t.src(r.playerOptions.sources)}return n}return t}(ar);ar.registerComponent("MediaLoader",wi);var Ei=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.handleMouseOver_=function(e){return i.handleMouseOver(e)};i.handleMouseOut_=function(e){return i.handleMouseOut(e)};i.handleClick_=function(e){return i.handleClick(e)};i.handleKeyDown_=function(e){return i.handleKeyDown(e)};i.emitTapEvents();i.enable();return i}var r=t.prototype;r.createEl=function e(t,r,i){if(t===void 0){t="div"}if(r===void 0){r={}}if(i===void 0){i={}}r=ne({className:this.buildCSSClass(),tabIndex:0},r);if(t==="button"){J.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead.")}i=ne({role:"button"},i);this.tabIndex_=r.tabIndex;var n=Me(t,r,i);n.appendChild(Me("span",{className:"vjs-icon-placeholder"},{"aria-hidden":true}));this.createControlTextEl(n);return n};r.dispose=function t(){this.controlTextEl_=null;e.prototype.dispose.call(this)};r.createControlTextEl=function e(t){this.controlTextEl_=Me("span",{className:"vjs-control-text"},{"aria-live":"polite"});if(t){t.appendChild(this.controlTextEl_)}this.controlText(this.controlText_,t);return this.controlTextEl_};r.controlText=function e(t,r){if(r===void 0){r=this.el()}if(t===undefined){return this.controlText_||"Need Text"}var i=this.localize(t);this.controlText_=t;Ne(this.controlTextEl_,i);if(!this.nonIconControl&&!this.player_.options_.noUITitleAttributes){r.setAttribute("title",i)}};r.buildCSSClass=function t(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)};r.enable=function e(){if(!this.enabled_){this.enabled_=true;this.removeClass("vjs-disabled");this.el_.setAttribute("aria-disabled","false");if(typeof this.tabIndex_!=="undefined"){this.el_.setAttribute("tabIndex",this.tabIndex_)}this.on(["tap","click"],this.handleClick_);this.on("keydown",this.handleKeyDown_)}};r.disable=function e(){this.enabled_=false;this.addClass("vjs-disabled");this.el_.setAttribute("aria-disabled","true");if(typeof this.tabIndex_!=="undefined"){this.el_.removeAttribute("tabIndex")}this.off("mouseover",this.handleMouseOver_);this.off("mouseout",this.handleMouseOut_);this.off(["tap","click"],this.handleClick_);this.off("keydown",this.handleKeyDown_)};r.handleLanguagechange=function e(){this.controlText(this.controlText_)};r.handleClick=function e(t){if(this.options_.clickHandler){this.options_.clickHandler.call(this,arguments)}};r.handleKeyDown=function t(r){if(d.a.isEventKey(r,"Space")||d.a.isEventKey(r,"Enter")){r.preventDefault();r.stopPropagation();this.trigger("click")}else{e.prototype.handleKeyDown.call(this,r)}};return t}(ar);ar.registerComponent("ClickableComponent",Ei);var ki=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.update();i.update_=function(e){return i.update(e)};t.on("posterchange",i.update_);return i}var r=t.prototype;r.dispose=function t(){this.player().off("posterchange",this.update_);e.prototype.dispose.call(this)};r.createEl=function e(){var t=Me("div",{className:"vjs-poster",tabIndex:-1});return t};r.update=function e(t){var r=this.player().poster();this.setSrc(r);if(r){this.show()}else{this.hide()}};r.setSrc=function e(t){var r="";if(t){r='url("'+t+'")'}this.el_.style.backgroundImage=r};r.handleClick=function e(t){if(!this.player_.controls()){return}var r=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;if(this.player_.tech(true)&&!((be||ge)&&r)){this.player_.tech(true).focus()}if(this.player_.paused()){pr(this.player_.play())}else{this.player_.pause()}};return t}(Ei);ar.registerComponent("PosterImage",ki);var Ai="#222";var Ci="#ccc";var Ii={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Di(e,t){var r;if(e.length===4){r=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]}else if(e.length===7){r=e.slice(1)}else{throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.")}return"rgba("+parseInt(r.slice(0,2),16)+","+parseInt(r.slice(2,4),16)+","+parseInt(r.slice(4,6),16)+","+t+")"}function xi(e,t,r){try{e.style[t]=r}catch(e){return}}var Li=function(e){p()(t,e);function t(t,r,i){var a;a=e.call(this,t,r,i)||this;var s=function e(t){return a.updateDisplay(t)};t.on("loadstart",(function(e){return a.toggleDisplay(e)}));t.on("texttrackchange",s);t.on("loadedmetadata",(function(e){return a.preselectTrack(e)}));t.ready(Pt(c()(a),(function(){if(t.tech_&&t.tech_.featuresNativeTextTracks){this.hide();return}t.on("fullscreenchange",s);t.on("playerresize",s);n.a.addEventListener("orientationchange",s);t.on("dispose",(function(){return n.a.removeEventListener("orientationchange",s)}));var e=this.options_.playerOptions.tracks||[];for(var r=0;r<e.length;r++){this.player_.addRemoteTextTrack(e[r],true)}this.preselectTrack()})));return a}var r=t.prototype;r.preselectTrack=function e(){var t={captions:1,subtitles:1};var r=this.player_.textTracks();var i=this.player_.cache_.selectedLanguage;var n;var a;var s;for(var o=0;o<r.length;o++){var u=r[o];if(i&&i.enabled&&i.language&&i.language===u.language&&u.kind in t){if(u.kind===i.kind){s=u}else if(!s){s=u}}else if(i&&!i.enabled){s=null;n=null;a=null}else if(u["default"]){if(u.kind==="descriptions"&&!n){n=u}else if(u.kind in t&&!a){a=u}}}if(s){s.mode="showing"}else if(a){a.mode="showing"}else if(n){n.mode="showing"}};r.toggleDisplay=function e(){if(this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks){this.hide()}else{this.show()}};r.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})};r.clearDisplay=function e(){if(typeof n.a.WebVTT==="function"){n.a.WebVTT.processCues(n.a,[],this.el_)}};r.updateDisplay=function e(){var t=this.player_.textTracks();var r=this.options_.allowMultipleShowingTracks;this.clearDisplay();if(r){var i=[];for(var n=0;n<t.length;++n){var a=t[n];if(a.mode!=="showing"){continue}i.push(a)}this.updateForTrack(i);return}var s=null;var o=null;var u=t.length;while(u--){var l=t[u];if(l.mode==="showing"){if(l.kind==="descriptions"){s=l}else{o=l}}}if(o){if(this.getAttribute("aria-live")!=="off"){this.setAttribute("aria-live","off")}this.updateForTrack(o)}else if(s){if(this.getAttribute("aria-live")!=="assertive"){this.setAttribute("aria-live","assertive")}this.updateForTrack(s)}};r.updateDisplayState=function e(t){var r=this.player_.textTrackSettings.getValues();var i=t.activeCues;var a=i.length;while(a--){var s=i[a];if(!s){continue}var o=s.displayState;if(r.color){o.firstChild.style.color=r.color}if(r.textOpacity){xi(o.firstChild,"color",Di(r.color||"#fff",r.textOpacity))}if(r.backgroundColor){o.firstChild.style.backgroundColor=r.backgroundColor}if(r.backgroundOpacity){xi(o.firstChild,"backgroundColor",Di(r.backgroundColor||"#000",r.backgroundOpacity))}if(r.windowColor){if(r.windowOpacity){xi(o,"backgroundColor",Di(r.windowColor,r.windowOpacity))}else{o.style.backgroundColor=r.windowColor}}if(r.edgeStyle){if(r.edgeStyle==="dropshadow"){o.firstChild.style.textShadow="2px 2px 3px "+Ai+", 2px 2px 4px "+Ai+", 2px 2px 5px "+Ai}else if(r.edgeStyle==="raised"){o.firstChild.style.textShadow="1px 1px "+Ai+", 2px 2px "+Ai+", 3px 3px "+Ai}else if(r.edgeStyle==="depressed"){o.firstChild.style.textShadow="1px 1px "+Ci+", 0 1px "+Ci+", -1px -1px "+Ai+", 0 -1px "+Ai}else if(r.edgeStyle==="uniform"){o.firstChild.style.textShadow="0 0 4px "+Ai+", 0 0 4px "+Ai+", 0 0 4px "+Ai+", 0 0 4px "+Ai}}if(r.fontPercent&&r.fontPercent!==1){var u=n.a.parseFloat(o.style.fontSize);o.style.fontSize=u*r.fontPercent+"px";o.style.height="auto";o.style.top="auto"}if(r.fontFamily&&r.fontFamily!=="default"){if(r.fontFamily==="small-caps"){o.firstChild.style.fontVariant="small-caps"}else{o.firstChild.style.fontFamily=Ii[r.fontFamily]}}}};r.updateForTrack=function e(t){if(!Array.isArray(t)){t=[t]}if(typeof n.a.WebVTT!=="function"||t.every((function(e){return!e.activeCues}))){return}var r=[];for(var i=0;i<t.length;++i){var a=t[i];for(var s=0;s<a.activeCues.length;++s){r.push(a.activeCues[s])}}n.a.WebVTT.processCues(n.a,r,this.el_);for(var o=0;o<t.length;++o){var u=t[o];for(var l=0;l<u.activeCues.length;++l){var d=u.activeCues[l].displayState;je(d,"vjs-text-track-cue");je(d,"vjs-text-track-cue-"+(u.language?u.language:o));if(u.language){ze(d,"lang",u.language)}}if(this.player_.textTrackSettings){this.updateDisplayState(u)}}};return t}(ar);ar.registerComponent("TextTrackDisplay",Li);var Oi=function(e){p()(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.createEl=function t(){var r=this.player_.isAudio();var i=this.localize(r?"Audio Player":"Video Player");var n=Me("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[i])});var a=e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});a.appendChild(n);return a};return t}(ar);ar.registerComponent("LoadingSpinner",Oi);var Pi=function(e){p()(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.createEl=function e(t,r,i){if(r===void 0){r={}}if(i===void 0){i={}}t="button";r=ne({className:this.buildCSSClass()},r);i=ne({type:"button"},i);var n=Me(t,r,i);n.appendChild(Me("span",{className:"vjs-icon-placeholder"},{"aria-hidden":true}));this.createControlTextEl(n);return n};r.addChild=function e(t,r){if(r===void 0){r={}}var i=this.constructor.name;J.warn("Adding an actionable (user controllable) child to a Button ("+i+") is not supported; use a ClickableComponent instead.");return ar.prototype.addChild.call(this,t,r)};r.enable=function t(){e.prototype.enable.call(this);this.el_.removeAttribute("disabled")};r.disable=function t(){e.prototype.disable.call(this);this.el_.setAttribute("disabled","disabled")};r.handleKeyDown=function t(r){if(d.a.isEventKey(r,"Space")||d.a.isEventKey(r,"Enter")){r.stopPropagation();return}e.prototype.handleKeyDown.call(this,r)};return t}(Ei);ar.registerComponent("Button",Pi);var Ri=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.mouseused_=false;i.on("mousedown",(function(e){return i.handleMouseDown(e)}));return i}var r=t.prototype;r.buildCSSClass=function e(){return"vjs-big-play-button"};r.handleClick=function e(t){var r=this.player_.play();if(this.mouseused_&&t.clientX&&t.clientY){var i=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;pr(r);if(this.player_.tech(true)&&!((be||ge)&&i)){this.player_.tech(true).focus()}return}var n=this.player_.getChild("controlBar");var a=n&&n.getChild("playToggle");if(!a){this.player_.tech(true).focus();return}var s=function e(){return a.focus()};if(hr(r)){r.then(s,(function(){}))}else{this.setTimeout(s,1)}};r.handleKeyDown=function t(r){this.mouseused_=false;e.prototype.handleKeyDown.call(this,r)};r.handleMouseDown=function e(t){this.mouseused_=true};return t}(Pi);Ri.prototype.controlText_="Play Video";ar.registerComponent("BigPlayButton",Ri);var Ui=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.controlText(r&&r.controlText||i.localize("Close"));return i}var r=t.prototype;r.buildCSSClass=function t(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)};r.handleClick=function e(t){this.trigger({type:"close",bubbles:false})};r.handleKeyDown=function t(r){if(d.a.isEventKey(r,"Esc")){r.preventDefault();r.stopPropagation();this.trigger("click")}else{e.prototype.handleKeyDown.call(this,r)}};return t}(Pi);ar.registerComponent("CloseButton",Ui);var Mi=function(e){p()(t,e);function t(t,r){var i;if(r===void 0){r={}}i=e.call(this,t,r)||this;r.replay=r.replay===undefined||r.replay;i.on(t,"play",(function(e){return i.handlePlay(e)}));i.on(t,"pause",(function(e){return i.handlePause(e)}));if(r.replay){i.on(t,"ended",(function(e){return i.handleEnded(e)}))}return i}var r=t.prototype;r.buildCSSClass=function t(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)};r.handleClick=function e(t){if(this.player_.paused()){pr(this.player_.play())}else{this.player_.pause()}};r.handleSeeked=function e(t){this.removeClass("vjs-ended");if(this.player_.paused()){this.handlePause(t)}else{this.handlePlay(t)}};r.handlePlay=function e(t){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.controlText("Pause")};r.handlePause=function e(t){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.controlText("Play")};r.handleEnded=function e(t){var r=this;this.removeClass("vjs-playing");this.addClass("vjs-ended");this.controlText("Replay");this.one(this.player_,"seeked",(function(e){return r.handleSeeked(e)}))};return t}(Pi);Mi.prototype.controlText_="Play";ar.registerComponent("PlayToggle",Mi);var Ni=function e(t,r){t=t<0?0:t;var i=Math.floor(t%60);var n=Math.floor(t/60%60);var a=Math.floor(t/3600);var s=Math.floor(r/60%60);var o=Math.floor(r/3600);if(isNaN(t)||t===Infinity){a=n=i="-"}a=a>0||o>0?a+":":"";n=((a||s>=10)&&n<10?"0"+n:n)+":";i=i<10?"0"+i:i;return a+n+i};var Bi=Ni;function Fi(e){Bi=e}function ji(){Bi=Ni}function qi(e,t){if(t===void 0){t=e}return Bi(e,t)}var Hi=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.on(t,["timeupdate","ended"],(function(e){return i.updateContent(e)}));i.updateTextNode_();return i}var r=t.prototype;r.createEl=function t(){var r=this.buildCSSClass();var i=e.prototype.createEl.call(this,"div",{className:r+" vjs-time-control vjs-control"});var n=Me("span",{className:"vjs-control-text",textContent:this.localize(this.labelText_)+""},{role:"presentation"});i.appendChild(n);this.contentEl_=Me("span",{className:r+"-display"},{"aria-live":"off",role:"presentation"});i.appendChild(this.contentEl_);return i};r.dispose=function t(){this.contentEl_=null;this.textNode_=null;e.prototype.dispose.call(this)};r.updateTextNode_=function e(t){var r=this;if(t===void 0){t=0}t=qi(t);if(this.formattedTime_===t){return}this.formattedTime_=t;this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",(function(){if(!r.contentEl_){return}var e=r.textNode_;if(e&&r.contentEl_.firstChild!==e){e=null;J.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")}r.textNode_=s.a.createTextNode(r.formattedTime_);if(!r.textNode_){return}if(e){r.contentEl_.replaceChild(r.textNode_,e)}else{r.contentEl_.appendChild(r.textNode_)}}))};r.updateContent=function e(t){};return t}(ar);Hi.prototype.labelText_="Time";Hi.prototype.controlText_="Time";ar.registerComponent("TimeDisplay",Hi);var Gi=function(e){p()(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.buildCSSClass=function e(){return"vjs-current-time"};r.updateContent=function e(t){var r;if(this.player_.ended()){r=this.player_.duration()}else{r=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}this.updateTextNode_(r)};return t}(Hi);Gi.prototype.labelText_="Current Time";Gi.prototype.controlText_="Current Time";ar.registerComponent("CurrentTimeDisplay",Gi);var Vi=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;var n=function e(t){return i.updateContent(t)};i.on(t,"durationchange",n);i.on(t,"loadstart",n);i.on(t,"loadedmetadata",n);return i}var r=t.prototype;r.buildCSSClass=function e(){return"vjs-duration"};r.updateContent=function e(t){var r=this.player_.duration();this.updateTextNode_(r)};return t}(Hi);Vi.prototype.labelText_="Duration";Vi.prototype.controlText_="Duration";ar.registerComponent("DurationDisplay",Vi);var Wi=function(e){p()(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.createEl=function t(){var r=e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":true});var i=e.prototype.createEl.call(this,"div");var n=e.prototype.createEl.call(this,"span",{textContent:"/"});i.appendChild(n);r.appendChild(i);return r};return t}(ar);ar.registerComponent("TimeDivider",Wi);var zi=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.on(t,"durationchange",(function(e){return i.updateContent(e)}));return i}var r=t.prototype;r.buildCSSClass=function e(){return"vjs-remaining-time"};r.createEl=function t(){var r=e.prototype.createEl.call(this);if(this.options_.displayNegative!==false){r.insertBefore(Me("span",{},{"aria-hidden":true},"-"),this.contentEl_)}return r};r.updateContent=function e(t){if(typeof this.player_.duration()!=="number"){return}var r;if(this.player_.ended()){r=0}else if(this.player_.remainingTimeDisplay){r=this.player_.remainingTimeDisplay()}else{r=this.player_.remainingTime()}this.updateTextNode_(r)};return t}(Hi);zi.prototype.labelText_="Remaining Time";zi.prototype.controlText_="Remaining Time";ar.registerComponent("RemainingTimeDisplay",zi);var Ki=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.updateShowing();i.on(i.player(),"durationchange",(function(e){return i.updateShowing(e)}));return i}var r=t.prototype;r.createEl=function t(){var r=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});this.contentEl_=Me("div",{className:"vjs-live-display"},{"aria-live":"off"});this.contentEl_.appendChild(Me("span",{className:"vjs-control-text",textContent:this.localize("Stream Type")+""}));this.contentEl_.appendChild(s.a.createTextNode(this.localize("LIVE")));r.appendChild(this.contentEl_);return r};r.dispose=function t(){this.contentEl_=null;e.prototype.dispose.call(this)};r.updateShowing=function e(t){if(this.player().duration()===Infinity){this.show()}else{this.hide()}};return t}(ar);ar.registerComponent("LiveDisplay",Ki);var Xi=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.updateLiveEdgeStatus();if(i.player_.liveTracker){i.updateLiveEdgeStatusHandler_=function(e){return i.updateLiveEdgeStatus(e)};i.on(i.player_.liveTracker,"liveedgechange",i.updateLiveEdgeStatusHandler_)}return i}var r=t.prototype;r.createEl=function t(){var r=e.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});this.textEl_=Me("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"});r.appendChild(this.textEl_);return r};r.updateLiveEdgeStatus=function e(){if(!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()){this.setAttribute("aria-disabled",true);this.addClass("vjs-at-live-edge");this.controlText("Seek to live, currently playing live")}else{this.setAttribute("aria-disabled",false);this.removeClass("vjs-at-live-edge");this.controlText("Seek to live, currently behind live")}};r.handleClick=function e(){this.player_.liveTracker.seekToLiveEdge()};r.dispose=function t(){if(this.player_.liveTracker){this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_)}this.textEl_=null;e.prototype.dispose.call(this)};return t}(Pi);Xi.prototype.controlText_="Seek to live, currently playing live";ar.registerComponent("SeekToLive",Xi);var Yi=function e(t,r,i){t=Number(t);return Math.min(i,Math.max(r,isNaN(t)?r:t))};var Qi=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.handleMouseDown_=function(e){return i.handleMouseDown(e)};i.handleMouseUp_=function(e){return i.handleMouseUp(e)};i.handleKeyDown_=function(e){return i.handleKeyDown(e)};i.handleClick_=function(e){return i.handleClick(e)};i.handleMouseMove_=function(e){return i.handleMouseMove(e)};i.update_=function(e){return i.update(e)};i.bar=i.getChild(i.options_.barName);i.vertical(!!i.options_.vertical);i.enable();return i}var r=t.prototype;r.enabled=function e(){return this.enabled_};r.enable=function e(){if(this.enabled()){return}this.on("mousedown",this.handleMouseDown_);this.on("touchstart",this.handleMouseDown_);this.on("keydown",this.handleKeyDown_);this.on("click",this.handleClick_);this.on(this.player_,"controlsvisible",this.update);if(this.playerEvent){this.on(this.player_,this.playerEvent,this.update)}this.removeClass("disabled");this.setAttribute("tabindex",0);this.enabled_=true};r.disable=function e(){if(!this.enabled()){return}var t=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_);this.off("touchstart",this.handleMouseDown_);this.off("keydown",this.handleKeyDown_);this.off("click",this.handleClick_);this.off(this.player_,"controlsvisible",this.update_);this.off(t,"mousemove",this.handleMouseMove_);this.off(t,"mouseup",this.handleMouseUp_);this.off(t,"touchmove",this.handleMouseMove_);this.off(t,"touchend",this.handleMouseUp_);this.removeAttribute("tabindex");this.addClass("disabled");if(this.playerEvent){this.off(this.player_,this.playerEvent,this.update)}this.enabled_=false};r.createEl=function t(r,i,n){if(i===void 0){i={}}if(n===void 0){n={}}i.className=i.className+" vjs-slider";i=ne({tabIndex:0},i);n=ne({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},n);return e.prototype.createEl.call(this,r,i,n)};r.handleMouseDown=function e(t){var r=this.bar.el_.ownerDocument;if(t.type==="mousedown"){t.preventDefault()}if(t.type==="touchstart"&&!ye){t.preventDefault()}Xe();this.addClass("vjs-sliding");this.trigger("slideractive");this.on(r,"mousemove",this.handleMouseMove_);this.on(r,"mouseup",this.handleMouseUp_);this.on(r,"touchmove",this.handleMouseMove_);this.on(r,"touchend",this.handleMouseUp_);this.handleMouseMove(t,true)};r.handleMouseMove=function e(t){};r.handleMouseUp=function e(){var t=this.bar.el_.ownerDocument;Ye();this.removeClass("vjs-sliding");this.trigger("sliderinactive");this.off(t,"mousemove",this.handleMouseMove_);this.off(t,"mouseup",this.handleMouseUp_);this.off(t,"touchmove",this.handleMouseMove_);this.off(t,"touchend",this.handleMouseUp_);this.update()};r.update=function e(){var t=this;if(!this.el_||!this.bar){return}var r=this.getProgress();if(r===this.progress_){return r}this.progress_=r;this.requestNamedAnimationFrame("Slider#update",(function(){var e=t.vertical()?"height":"width";t.bar.el().style[e]=(r*100).toFixed(2)+"%"}));return r};r.getProgress=function e(){return Number(Yi(this.getPercent(),0,1).toFixed(4))};r.calculateDistance=function e(t){var r=Je(this.el_,t);if(this.vertical()){return r.y}return r.x};r.handleKeyDown=function t(r){if(d.a.isEventKey(r,"Left")||d.a.isEventKey(r,"Down")){r.preventDefault();r.stopPropagation();this.stepBack()}else if(d.a.isEventKey(r,"Right")||d.a.isEventKey(r,"Up")){r.preventDefault();r.stopPropagation();this.stepForward()}else{e.prototype.handleKeyDown.call(this,r)}};r.handleClick=function e(t){t.stopPropagation();t.preventDefault()};r.vertical=function e(t){if(t===undefined){return this.vertical_||false}this.vertical_=!!t;if(this.vertical_){this.addClass("vjs-slider-vertical")}else{this.addClass("vjs-slider-horizontal")}};return t}(ar);ar.registerComponent("Slider",Qi);var $i=function e(t,r){return Yi(t/r*100,0,100).toFixed(2)+"%"};var Ji=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.partEls_=[];i.on(t,"progress",(function(e){return i.update(e)}));return i}var r=t.prototype;r.createEl=function t(){var r=e.prototype.createEl.call(this,"div",{className:"vjs-load-progress"});var i=Me("span",{className:"vjs-control-text"});var n=Me("span",{textContent:this.localize("Loaded")});var a=s.a.createTextNode(": ");this.percentageEl_=Me("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"});r.appendChild(i);i.appendChild(n);i.appendChild(a);i.appendChild(this.percentageEl_);return r};r.dispose=function t(){this.partEls_=null;this.percentageEl_=null;e.prototype.dispose.call(this)};r.update=function e(t){var r=this;this.requestNamedAnimationFrame("LoadProgressBar#update",(function(){var e=r.player_.liveTracker;var t=r.player_.buffered();var i=e&&e.isLive()?e.seekableEnd():r.player_.duration();var n=r.player_.bufferedEnd();var a=r.partEls_;var s=$i(n,i);if(r.percent_!==s){r.el_.style.width=s;Ne(r.percentageEl_,s);r.percent_=s}for(var o=0;o<t.length;o++){var u=t.start(o);var l=t.end(o);var d=a[o];if(!d){d=r.el_.appendChild(Me());a[o]=d}if(d.dataset.start===u&&d.dataset.end===l){continue}d.dataset.start=u;d.dataset.end=l;d.style.left=$i(u,n);d.style.width=$i(l-u,n)}for(var f=a.length;f>t.length;f--){r.el_.removeChild(a[f-1])}a.length=t.length}))};return t}(ar);ar.registerComponent("LoadProgressBar",Ji);var Zi=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.update=Rt(Pt(c()(i),i.update),Ot);return i}var r=t.prototype;r.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})};r.update=function e(t,r,i){var n=$e(this.el_);var a=Qe(this.player_.el());var s=t.width*r;if(!a||!n){return}var o=t.left-a.left+s;var u=t.width-s+(a.right-t.right);var l=n.width/2;if(o<l){l+=l-o}else if(u<l){l=u}if(l<0){l=0}else if(l>n.width){l=n.width}l=Math.round(l);this.el_.style.right="-"+l+"px";this.write(i)};r.write=function e(t){Ne(this.el_,t)};r.updateTime=function e(t,r,i,n){var a=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",(function(){var e;var s=a.player_.duration();if(a.player_.liveTracker&&a.player_.liveTracker.isLive()){var o=a.player_.liveTracker.liveWindow();var u=o-r*o;e=(u<1?"":"-")+qi(u,o)}else{e=qi(i,s)}a.update(t,r,e);if(n){n()}}))};return t}(ar);ar.registerComponent("TimeTooltip",Zi);var en=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.update=Rt(Pt(c()(i),i.update),Ot);return i}var r=t.prototype;r.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})};r.update=function e(t,r){var i=this.getChild("timeTooltip");if(!i){return}var n=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();i.updateTime(t,r,n)};return t}(ar);en.prototype.options_={children:[]};if(!Ae&&!he){en.prototype.options_.children.push("timeTooltip")}ar.registerComponent("PlayProgressBar",en);var tn=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.update=Rt(Pt(c()(i),i.update),Ot);return i}var r=t.prototype;r.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})};r.update=function e(t,r){var i=this;var n=r*this.player_.duration();this.getChild("timeTooltip").updateTime(t,r,n,(function(){i.el_.style.left=t.width*r+"px"}))};return t}(ar);tn.prototype.options_={children:["timeTooltip"]};ar.registerComponent("MouseTimeDisplay",tn);var rn=5;var nn=12;var an=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.setEventHandlers_();return i}var r=t.prototype;r.setEventHandlers_=function e(){var t=this;this.update_=Pt(this,this.update);this.update=Rt(this.update_,Ot);this.on(this.player_,["ended","durationchange","timeupdate"],this.update);if(this.player_.liveTracker){this.on(this.player_.liveTracker,"liveedgechange",this.update)}this.updateInterval=null;this.enableIntervalHandler_=function(e){return t.enableInterval_(e)};this.disableIntervalHandler_=function(e){return t.disableInterval_(e)};this.on(this.player_,["playing"],this.enableIntervalHandler_);this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_);if("hidden"in s.a&&"visibilityState"in s.a){this.on(s.a,"visibilitychange",this.toggleVisibility_)}};r.toggleVisibility_=function e(t){if(s.a.visibilityState==="hidden"){this.cancelNamedAnimationFrame("SeekBar#update");this.cancelNamedAnimationFrame("Slider#update");this.disableInterval_(t)}else{if(!this.player_.ended()&&!this.player_.paused()){this.enableInterval_()}this.update()}};r.enableInterval_=function e(){if(this.updateInterval){return}this.updateInterval=this.setInterval(this.update,Ot)};r.disableInterval_=function e(t){if(this.player_.liveTracker&&this.player_.liveTracker.isLive()&&t&&t.type!=="ended"){return}if(!this.updateInterval){return}this.clearInterval(this.updateInterval);this.updateInterval=null};r.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})};r.update=function t(r){var i=this;if(s.a.visibilityState==="hidden"){return}var n=e.prototype.update.call(this);this.requestNamedAnimationFrame("SeekBar#update",(function(){var e=i.player_.ended()?i.player_.duration():i.getCurrentTime_();var t=i.player_.liveTracker;var r=i.player_.duration();if(t&&t.isLive()){r=i.player_.liveTracker.liveCurrentTime()}if(i.percent_!==n){i.el_.setAttribute("aria-valuenow",(n*100).toFixed(2));i.percent_=n}if(i.currentTime_!==e||i.duration_!==r){i.el_.setAttribute("aria-valuetext",i.localize("progress bar timing: currentTime={1} duration={2}",[qi(e,r),qi(r,r)],"{1} of {2}"));i.currentTime_=e;i.duration_=r}if(i.bar){i.bar.update(Qe(i.el()),i.getProgress())}}));return n};r.userSeek_=function e(t){if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){this.player_.liveTracker.nextSeekedFromUser()}this.player_.currentTime(t)};r.getCurrentTime_=function e(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()};r.getPercent=function e(){var t=this.getCurrentTime_();var r;var i=this.player_.liveTracker;if(i&&i.isLive()){r=(t-i.seekableStart())/i.liveWindow();if(i.atLiveEdge()){r=1}}else{r=t/this.player_.duration()}return r};r.handleMouseDown=function t(r){if(!nt(r)){return}r.stopPropagation();this.videoWasPlaying=!this.player_.paused();this.player_.pause();e.prototype.handleMouseDown.call(this,r)};r.handleMouseMove=function e(t,r){if(r===void 0){r=false}if(!nt(t)){return}if(!r&&!this.player_.scrubbing()){this.player_.scrubbing(true)}var i;var n=this.calculateDistance(t);var a=this.player_.liveTracker;if(!a||!a.isLive()){i=n*this.player_.duration();if(i===this.player_.duration()){i=i-.1}}else{if(n>=.99){a.seekToLiveEdge();return}var s=a.seekableStart();var o=a.liveCurrentTime();i=s+n*a.liveWindow();if(i>=o){i=o}if(i<=s){i=s+.1}if(i===Infinity){return}}this.userSeek_(i)};r.enable=function t(){e.prototype.enable.call(this);var r=this.getChild("mouseTimeDisplay");if(!r){return}r.show()};r.disable=function t(){e.prototype.disable.call(this);var r=this.getChild("mouseTimeDisplay");if(!r){return}r.hide()};r.handleMouseUp=function t(r){e.prototype.handleMouseUp.call(this,r);if(r){r.stopPropagation()}this.player_.scrubbing(false);this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:true});if(this.videoWasPlaying){pr(this.player_.play())}else{this.update_()}};r.stepForward=function e(){this.userSeek_(this.player_.currentTime()+rn)};r.stepBack=function e(){this.userSeek_(this.player_.currentTime()-rn)};r.handleAction=function e(t){if(this.player_.paused()){this.player_.play()}else{this.player_.pause()}};r.handleKeyDown=function t(r){var i=this.player_.liveTracker;if(d.a.isEventKey(r,"Space")||d.a.isEventKey(r,"Enter")){r.preventDefault();r.stopPropagation();this.handleAction(r)}else if(d.a.isEventKey(r,"Home")){r.preventDefault();r.stopPropagation();this.userSeek_(0)}else if(d.a.isEventKey(r,"End")){r.preventDefault();r.stopPropagation();if(i&&i.isLive()){this.userSeek_(i.liveCurrentTime())}else{this.userSeek_(this.player_.duration())}}else if(/^[0-9]$/.test(d()(r))){r.preventDefault();r.stopPropagation();var n=(d.a.codes[d()(r)]-d.a.codes["0"])*10/100;if(i&&i.isLive()){this.userSeek_(i.seekableStart()+i.liveWindow()*n)}else{this.userSeek_(this.player_.duration()*n)}}else if(d.a.isEventKey(r,"PgDn")){r.preventDefault();r.stopPropagation();this.userSeek_(this.player_.currentTime()-rn*nn)}else if(d.a.isEventKey(r,"PgUp")){r.preventDefault();r.stopPropagation();this.userSeek_(this.player_.currentTime()+rn*nn)}else{e.prototype.handleKeyDown.call(this,r)}};r.dispose=function t(){this.disableInterval_();this.off(this.player_,["ended","durationchange","timeupdate"],this.update);if(this.player_.liveTracker){this.off(this.player_.liveTracker,"liveedgechange",this.update)}this.off(this.player_,["playing"],this.enableIntervalHandler_);this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_);if("hidden"in s.a&&"visibilityState"in s.a){this.off(s.a,"visibilitychange",this.toggleVisibility_)}e.prototype.dispose.call(this)};return t}(Qi);an.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};if(!Ae&&!he){an.prototype.options_.children.splice(1,0,"mouseTimeDisplay")}ar.registerComponent("SeekBar",an);var sn=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.handleMouseMove=Rt(Pt(c()(i),i.handleMouseMove),Ot);i.throttledHandleMouseSeek=Rt(Pt(c()(i),i.handleMouseSeek),Ot);i.handleMouseUpHandler_=function(e){return i.handleMouseUp(e)};i.handleMouseDownHandler_=function(e){return i.handleMouseDown(e)};i.enable();return i}var r=t.prototype;r.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})};r.handleMouseMove=function e(t){var r=this.getChild("seekBar");if(!r){return}var i=r.getChild("playProgressBar");var n=r.getChild("mouseTimeDisplay");if(!i&&!n){return}var a=r.el();var s=$e(a);var o=Je(a,t).x;o=Yi(o,0,1);if(n){n.update(s,o)}if(i){i.update(s,r.getProgress())}};r.handleMouseSeek=function e(t){var r=this.getChild("seekBar");if(r){r.handleMouseMove(t)}};r.enabled=function e(){return this.enabled_};r.disable=function e(){this.children().forEach((function(e){return e.disable&&e.disable()}));if(!this.enabled()){return}this.off(["mousedown","touchstart"],this.handleMouseDownHandler_);this.off(this.el_,"mousemove",this.handleMouseMove);this.removeListenersAddedOnMousedownAndTouchstart();this.addClass("disabled");this.enabled_=false;if(this.player_.scrubbing()){var t=this.getChild("seekBar");this.player_.scrubbing(false);if(t.videoWasPlaying){pr(this.player_.play())}}};r.enable=function e(){this.children().forEach((function(e){return e.enable&&e.enable()}));if(this.enabled()){return}this.on(["mousedown","touchstart"],this.handleMouseDownHandler_);this.on(this.el_,"mousemove",this.handleMouseMove);this.removeClass("disabled");this.enabled_=true};r.removeListenersAddedOnMousedownAndTouchstart=function e(){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseSeek);this.off(t,"touchmove",this.throttledHandleMouseSeek);this.off(t,"mouseup",this.handleMouseUpHandler_);this.off(t,"touchend",this.handleMouseUpHandler_)};r.handleMouseDown=function e(t){var r=this.el_.ownerDocument;var i=this.getChild("seekBar");if(i){i.handleMouseDown(t)}this.on(r,"mousemove",this.throttledHandleMouseSeek);this.on(r,"touchmove",this.throttledHandleMouseSeek);this.on(r,"mouseup",this.handleMouseUpHandler_);this.on(r,"touchend",this.handleMouseUpHandler_)};r.handleMouseUp=function e(t){var r=this.getChild("seekBar");if(r){r.handleMouseUp(t)}this.removeListenersAddedOnMousedownAndTouchstart()};return t}(ar);sn.prototype.options_={children:["seekBar"]};ar.registerComponent("ProgressControl",sn);var on=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.on(t,["enterpictureinpicture","leavepictureinpicture"],(function(e){return i.handlePictureInPictureChange(e)}));i.on(t,["disablepictureinpicturechanged","loadedmetadata"],(function(e){return i.handlePictureInPictureEnabledChange(e)}));i.disable();return i}var r=t.prototype;r.buildCSSClass=function t(){return"vjs-picture-in-picture-control "+e.prototype.buildCSSClass.call(this)};r.handlePictureInPictureEnabledChange=function e(){if(s.a.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===false){this.enable()}else{this.disable()}};r.handlePictureInPictureChange=function e(t){if(this.player_.isInPictureInPicture()){this.controlText("Exit Picture-in-Picture")}else{this.controlText("Picture-in-Picture")}this.handlePictureInPictureEnabledChange()};r.handleClick=function e(t){if(!this.player_.isInPictureInPicture()){this.player_.requestPictureInPicture()}else{this.player_.exitPictureInPicture()}};return t}(Pi);on.prototype.controlText_="Picture-in-Picture";ar.registerComponent("PictureInPictureToggle",on);var un=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.on(t,"fullscreenchange",(function(e){return i.handleFullscreenChange(e)}));if(s.a[t.fsApi_.fullscreenEnabled]===false){i.disable()}return i}var r=t.prototype;r.buildCSSClass=function t(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)};r.handleFullscreenChange=function e(t){if(this.player_.isFullscreen()){this.controlText("Non-Fullscreen")}else{this.controlText("Fullscreen")}};r.handleClick=function e(t){if(!this.player_.isFullscreen()){this.player_.requestFullscreen()}else{this.player_.exitFullscreen()}};return t}(Pi);un.prototype.controlText_="Fullscreen";ar.registerComponent("FullscreenToggle",un);var ln=function e(t,r){if(r.tech_&&!r.tech_.featuresVolumeControl){t.addClass("vjs-hidden")}t.on(r,"loadstart",(function(){if(!r.tech_.featuresVolumeControl){t.addClass("vjs-hidden")}else{t.removeClass("vjs-hidden")}}))};var dn=function(e){p()(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.createEl=function t(){var r=e.prototype.createEl.call(this,"div",{className:"vjs-volume-level"});r.appendChild(e.prototype.createEl.call(this,"span",{className:"vjs-control-text"}));return r};return t}(ar);ar.registerComponent("VolumeLevel",dn);var fn=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.update=Rt(Pt(c()(i),i.update),Ot);return i}var r=t.prototype;r.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})};r.update=function e(t,r,i,n){if(!i){var a=Qe(this.el_);var s=Qe(this.player_.el());var o=t.width*r;if(!s||!a){return}var u=t.left-s.left+o;var l=t.width-o+(s.right-t.right);var d=a.width/2;if(u<d){d+=d-u}else if(l<d){d=l}if(d<0){d=0}else if(d>a.width){d=a.width}this.el_.style.right="-"+d+"px"}this.write(n+"%")};r.write=function e(t){Ne(this.el_,t)};r.updateVolume=function e(t,r,i,n,a){var s=this;this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",(function(){s.update(t,r,i,n.toFixed(0));if(a){a()}}))};return t}(ar);ar.registerComponent("VolumeLevelTooltip",fn);var cn=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.update=Rt(Pt(c()(i),i.update),Ot);return i}var r=t.prototype;r.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})};r.update=function e(t,r,i){var n=this;var a=100*r;this.getChild("volumeLevelTooltip").updateVolume(t,r,i,a,(function(){if(i){n.el_.style.bottom=t.height*r+"px"}else{n.el_.style.left=t.width*r+"px"}}))};return t}(ar);cn.prototype.options_={children:["volumeLevelTooltip"]};ar.registerComponent("MouseVolumeLevelDisplay",cn);var hn=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.on("slideractive",(function(e){return i.updateLastVolume_(e)}));i.on(t,"volumechange",(function(e){return i.updateARIAAttributes(e)}));t.ready((function(){return i.updateARIAAttributes()}));return i}var r=t.prototype;r.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})};r.handleMouseDown=function t(r){if(!nt(r)){return}e.prototype.handleMouseDown.call(this,r)};r.handleMouseMove=function e(t){var r=this.getChild("mouseVolumeLevelDisplay");if(r){var i=this.el();var n=Qe(i);var a=this.vertical();var s=Je(i,t);s=a?s.y:s.x;s=Yi(s,0,1);r.update(n,s,a)}if(!nt(t)){return}this.checkMuted();this.player_.volume(this.calculateDistance(t))};r.checkMuted=function e(){if(this.player_.muted()){this.player_.muted(false)}};r.getPercent=function e(){if(this.player_.muted()){return 0}return this.player_.volume()};r.stepForward=function e(){this.checkMuted();this.player_.volume(this.player_.volume()+.1)};r.stepBack=function e(){this.checkMuted();this.player_.volume(this.player_.volume()-.1)};r.updateARIAAttributes=function e(t){var r=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",r);this.el_.setAttribute("aria-valuetext",r+"%")};r.volumeAsPercentage_=function e(){return Math.round(this.player_.volume()*100)};r.updateLastVolume_=function e(){var t=this;var r=this.player_.volume();this.one("sliderinactive",(function(){if(t.player_.volume()===0){t.player_.lastVolume_(r)}}))};return t}(Qi);hn.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};if(!Ae&&!he){hn.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay")}hn.prototype.playerEvent="volumechange";ar.registerComponent("VolumeBar",hn);var pn=function(e){p()(t,e);function t(t,r){var i;if(r===void 0){r={}}r.vertical=r.vertical||false;if(typeof r.volumeBar==="undefined"||se(r.volumeBar)){r.volumeBar=r.volumeBar||{};r.volumeBar.vertical=r.vertical}i=e.call(this,t,r)||this;ln(c()(i),t);i.throttledHandleMouseMove=Rt(Pt(c()(i),i.handleMouseMove),Ot);i.handleMouseUpHandler_=function(e){return i.handleMouseUp(e)};i.on("mousedown",(function(e){return i.handleMouseDown(e)}));i.on("touchstart",(function(e){return i.handleMouseDown(e)}));i.on("mousemove",(function(e){return i.handleMouseMove(e)}));i.on(i.volumeBar,["focus","slideractive"],(function(){i.volumeBar.addClass("vjs-slider-active");i.addClass("vjs-slider-active");i.trigger("slideractive")}));i.on(i.volumeBar,["blur","sliderinactive"],(function(){i.volumeBar.removeClass("vjs-slider-active");i.removeClass("vjs-slider-active");i.trigger("sliderinactive")}));return i}var r=t.prototype;r.createEl=function t(){var r="vjs-volume-horizontal";if(this.options_.vertical){r="vjs-volume-vertical"}return e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+r})};r.handleMouseDown=function e(t){var r=this.el_.ownerDocument;this.on(r,"mousemove",this.throttledHandleMouseMove);this.on(r,"touchmove",this.throttledHandleMouseMove);this.on(r,"mouseup",this.handleMouseUpHandler_);this.on(r,"touchend",this.handleMouseUpHandler_)};r.handleMouseUp=function e(t){var r=this.el_.ownerDocument;this.off(r,"mousemove",this.throttledHandleMouseMove);this.off(r,"touchmove",this.throttledHandleMouseMove);this.off(r,"mouseup",this.handleMouseUpHandler_);this.off(r,"touchend",this.handleMouseUpHandler_)};r.handleMouseMove=function e(t){this.volumeBar.handleMouseMove(t)};return t}(ar);pn.prototype.options_={children:["volumeBar"]};ar.registerComponent("VolumeControl",pn);var vn=function e(t,r){if(r.tech_&&!r.tech_.featuresMuteControl){t.addClass("vjs-hidden")}t.on(r,"loadstart",(function(){if(!r.tech_.featuresMuteControl){t.addClass("vjs-hidden")}else{t.removeClass("vjs-hidden")}}))};var mn=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;vn(c()(i),t);i.on(t,["loadstart","volumechange"],(function(e){return i.update(e)}));return i}var r=t.prototype;r.buildCSSClass=function t(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)};r.handleClick=function e(t){var r=this.player_.volume();var i=this.player_.lastVolume_();if(r===0){var n=i<.1?.1:i;this.player_.volume(n);this.player_.muted(false)}else{this.player_.muted(this.player_.muted()?false:true)}};r.update=function e(t){this.updateIcon_();this.updateControlText_()};r.updateIcon_=function e(){var t=this.player_.volume();var r=3;if(Ae&&this.player_.tech_&&this.player_.tech_.el_){this.player_.muted(this.player_.tech_.el_.muted)}if(t===0||this.player_.muted()){r=0}else if(t<.33){r=1}else if(t<.67){r=2}for(var i=0;i<4;i++){qe(this.el_,"vjs-vol-"+i)}je(this.el_,"vjs-vol-"+r)};r.updateControlText_=function e(){var t=this.player_.muted()||this.player_.volume()===0;var r=t?"Unmute":"Mute";if(this.controlText()!==r){this.controlText(r)}};return t}(Pi);mn.prototype.controlText_="Mute";ar.registerComponent("MuteToggle",mn);var gn=function(e){p()(t,e);function t(t,r){var i;if(r===void 0){r={}}if(typeof r.inline!=="undefined"){r.inline=r.inline}else{r.inline=true}if(typeof r.volumeControl==="undefined"||se(r.volumeControl)){r.volumeControl=r.volumeControl||{};r.volumeControl.vertical=!r.inline}i=e.call(this,t,r)||this;i.handleKeyPressHandler_=function(e){return i.handleKeyPress(e)};i.on(t,["loadstart"],(function(e){return i.volumePanelState_(e)}));i.on(i.muteToggle,"keyup",(function(e){return i.handleKeyPress(e)}));i.on(i.volumeControl,"keyup",(function(e){return i.handleVolumeControlKeyUp(e)}));i.on("keydown",(function(e){return i.handleKeyPress(e)}));i.on("mouseover",(function(e){return i.handleMouseOver(e)}));i.on("mouseout",(function(e){return i.handleMouseOut(e)}));i.on(i.volumeControl,["slideractive"],i.sliderActive_);i.on(i.volumeControl,["sliderinactive"],i.sliderInactive_);return i}var r=t.prototype;r.sliderActive_=function e(){this.addClass("vjs-slider-active")};r.sliderInactive_=function e(){this.removeClass("vjs-slider-active")};r.volumePanelState_=function e(){if(this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")){this.addClass("vjs-hidden")}if(this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")){this.addClass("vjs-mute-toggle-only")}};r.createEl=function t(){var r="vjs-volume-panel-horizontal";if(!this.options_.inline){r="vjs-volume-panel-vertical"}return e.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+r})};r.dispose=function t(){this.handleMouseOut();e.prototype.dispose.call(this)};r.handleVolumeControlKeyUp=function e(t){if(d.a.isEventKey(t,"Esc")){this.muteToggle.focus()}};r.handleMouseOver=function e(t){this.addClass("vjs-hover");At(s.a,"keyup",this.handleKeyPressHandler_)};r.handleMouseOut=function e(t){this.removeClass("vjs-hover");Ct(s.a,"keyup",this.handleKeyPressHandler_)};r.handleKeyPress=function e(t){if(d.a.isEventKey(t,"Esc")){this.handleMouseOut()}};return t}(ar);gn.prototype.options_={children:["muteToggle","volumeControl"]};ar.registerComponent("VolumePanel",gn);var yn=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;if(r){i.menuButton_=r.menuButton}i.focusedChild_=-1;i.on("keydown",(function(e){return i.handleKeyDown(e)}));i.boundHandleBlur_=function(e){return i.handleBlur(e)};i.boundHandleTapClick_=function(e){return i.handleTapClick(e)};return i}var r=t.prototype;r.addEventListenerForItem=function e(t){if(!(t instanceof ar)){return}this.on(t,"blur",this.boundHandleBlur_);this.on(t,["tap","click"],this.boundHandleTapClick_)};r.removeEventListenerForItem=function e(t){if(!(t instanceof ar)){return}this.off(t,"blur",this.boundHandleBlur_);this.off(t,["tap","click"],this.boundHandleTapClick_)};r.removeChild=function t(r){if(typeof r==="string"){r=this.getChild(r)}this.removeEventListenerForItem(r);e.prototype.removeChild.call(this,r)};r.addItem=function e(t){var r=this.addChild(t);if(r){this.addEventListenerForItem(r)}};r.createEl=function t(){var r=this.options_.contentElType||"ul";this.contentEl_=Me(r,{className:"vjs-menu-content"});this.contentEl_.setAttribute("role","menu");var i=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});i.appendChild(this.contentEl_);At(i,"click",(function(e){e.preventDefault();e.stopImmediatePropagation()}));return i};r.dispose=function t(){this.contentEl_=null;this.boundHandleBlur_=null;this.boundHandleTapClick_=null;e.prototype.dispose.call(this)};r.handleBlur=function e(t){var r=t.relatedTarget||s.a.activeElement;if(!this.children().some((function(e){return e.el()===r}))){var i=this.menuButton_;if(i&&i.buttonPressed_&&r!==i.el().firstChild){i.unpressButton()}}};r.handleTapClick=function e(t){if(this.menuButton_){this.menuButton_.unpressButton();var r=this.children();if(!Array.isArray(r)){return}var i=r.filter((function(e){return e.el()===t.target}))[0];if(!i){return}if(i.name()!=="CaptionSettingsMenuItem"){this.menuButton_.focus()}}};r.handleKeyDown=function e(t){if(d.a.isEventKey(t,"Left")||d.a.isEventKey(t,"Down")){t.preventDefault();t.stopPropagation();this.stepForward()}else if(d.a.isEventKey(t,"Right")||d.a.isEventKey(t,"Up")){t.preventDefault();t.stopPropagation();this.stepBack()}};r.stepForward=function e(){var t=0;if(this.focusedChild_!==undefined){t=this.focusedChild_+1}this.focus(t)};r.stepBack=function e(){var t=0;if(this.focusedChild_!==undefined){t=this.focusedChild_-1}this.focus(t)};r.focus=function e(t){if(t===void 0){t=0}var r=this.children().slice();var i=r.length&&r[0].hasClass("vjs-menu-title");if(i){r.shift()}if(r.length>0){if(t<0){t=0}else if(t>=r.length){t=r.length-1}this.focusedChild_=t;r[t].el_.focus()}};return t}(ar);ar.registerComponent("Menu",yn);var _n=function(e){p()(t,e);function t(t,r){var i;if(r===void 0){r={}}i=e.call(this,t,r)||this;i.menuButton_=new Pi(t,r);i.menuButton_.controlText(i.controlText_);i.menuButton_.el_.setAttribute("aria-haspopup","true");var n=Pi.prototype.buildCSSClass();i.menuButton_.el_.className=i.buildCSSClass()+" "+n;i.menuButton_.removeClass("vjs-control");i.addChild(i.menuButton_);i.update();i.enabled_=true;var a=function e(t){return i.handleClick(t)};i.handleMenuKeyUp_=function(e){return i.handleMenuKeyUp(e)};i.on(i.menuButton_,"tap",a);i.on(i.menuButton_,"click",a);i.on(i.menuButton_,"keydown",(function(e){return i.handleKeyDown(e)}));i.on(i.menuButton_,"mouseenter",(function(){i.addClass("vjs-hover");i.menu.show();At(s.a,"keyup",i.handleMenuKeyUp_)}));i.on("mouseleave",(function(e){return i.handleMouseLeave(e)}));i.on("keydown",(function(e){return i.handleSubmenuKeyDown(e)}));return i}var r=t.prototype;r.update=function e(){var t=this.createMenu();if(this.menu){this.menu.dispose();this.removeChild(this.menu)}this.menu=t;this.addChild(t);this.buttonPressed_=false;this.menuButton_.el_.setAttribute("aria-expanded","false");if(this.items&&this.items.length<=this.hideThreshold_){this.hide()}else{this.show()}};r.createMenu=function e(){var t=new yn(this.player_,{menuButton:this});this.hideThreshold_=0;if(this.options_.title){var r=Me("li",{className:"vjs-menu-title",textContent:Jt(this.options_.title),tabIndex:-1});var i=new ar(this.player_,{el:r});t.addItem(i)}this.items=this.createItems();if(this.items){for(var n=0;n<this.items.length;n++){t.addItem(this.items[n])}}return t};r.createItems=function e(){};r.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})};r.buildWrapperCSSClass=function t(){var r="vjs-menu-button";if(this.options_.inline===true){r+="-inline"}else{r+="-popup"}var i=Pi.prototype.buildCSSClass();return"vjs-menu-button "+r+" "+i+" "+e.prototype.buildCSSClass.call(this)};r.buildCSSClass=function t(){var r="vjs-menu-button";if(this.options_.inline===true){r+="-inline"}else{r+="-popup"}return"vjs-menu-button "+r+" "+e.prototype.buildCSSClass.call(this)};r.controlText=function e(t,r){if(r===void 0){r=this.menuButton_.el()}return this.menuButton_.controlText(t,r)};r.dispose=function t(){this.handleMouseLeave();e.prototype.dispose.call(this)};r.handleClick=function e(t){if(this.buttonPressed_){this.unpressButton()}else{this.pressButton()}};r.handleMouseLeave=function e(t){this.removeClass("vjs-hover");Ct(s.a,"keyup",this.handleMenuKeyUp_)};r.focus=function e(){this.menuButton_.focus()};r.blur=function e(){this.menuButton_.blur()};r.handleKeyDown=function e(t){if(d.a.isEventKey(t,"Esc")||d.a.isEventKey(t,"Tab")){if(this.buttonPressed_){this.unpressButton()}if(!d.a.isEventKey(t,"Tab")){t.preventDefault();this.menuButton_.focus()}}else if(d.a.isEventKey(t,"Up")||d.a.isEventKey(t,"Down")){if(!this.buttonPressed_){t.preventDefault();this.pressButton()}}};r.handleMenuKeyUp=function e(t){if(d.a.isEventKey(t,"Esc")||d.a.isEventKey(t,"Tab")){this.removeClass("vjs-hover")}};r.handleSubmenuKeyPress=function e(t){this.handleSubmenuKeyDown(t)};r.handleSubmenuKeyDown=function e(t){if(d.a.isEventKey(t,"Esc")||d.a.isEventKey(t,"Tab")){if(this.buttonPressed_){this.unpressButton()}if(!d.a.isEventKey(t,"Tab")){t.preventDefault();this.menuButton_.focus()}}};r.pressButton=function e(){if(this.enabled_){this.buttonPressed_=true;this.menu.show();this.menu.lockShowing();this.menuButton_.el_.setAttribute("aria-expanded","true");if(Ae&&Re()){return}this.menu.focus()}};r.unpressButton=function e(){if(this.enabled_){this.buttonPressed_=false;this.menu.unlockShowing();this.menu.hide();this.menuButton_.el_.setAttribute("aria-expanded","false")}};r.disable=function e(){this.unpressButton();this.enabled_=false;this.addClass("vjs-disabled");this.menuButton_.disable()};r.enable=function e(){this.enabled_=true;this.removeClass("vjs-disabled");this.menuButton_.enable()};return t}(ar);ar.registerComponent("MenuButton",_n);var bn=function(e){p()(t,e);function t(t,r){var i;var n=r.tracks;i=e.call(this,t,r)||this;if(i.items.length<=1){i.hide()}if(!n){return c()(i)}var a=Pt(c()(i),i.update);n.addEventListener("removetrack",a);n.addEventListener("addtrack",a);n.addEventListener("labelchange",a);i.player_.on("ready",a);i.player_.on("dispose",(function(){n.removeEventListener("removetrack",a);n.removeEventListener("addtrack",a);n.removeEventListener("labelchange",a)}));return i}return t}(_n);ar.registerComponent("TrackButton",bn);var Tn=["Tab","Esc","Up","Down","Right","Left"];var Sn=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.selectable=r.selectable;i.isSelected_=r.selected||false;i.multiSelectable=r.multiSelectable;i.selected(i.isSelected_);if(i.selectable){if(i.multiSelectable){i.el_.setAttribute("role","menuitemcheckbox")}else{i.el_.setAttribute("role","menuitemradio")}}else{i.el_.setAttribute("role","menuitem")}return i}var r=t.prototype;r.createEl=function t(r,i,n){this.nonIconControl=true;var a=e.prototype.createEl.call(this,"li",ne({className:"vjs-menu-item",tabIndex:-1},i),n);a.replaceChild(Me("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),a.querySelector(".vjs-icon-placeholder"));return a};r.handleKeyDown=function t(r){if(!Tn.some((function(e){return d.a.isEventKey(r,e)}))){e.prototype.handleKeyDown.call(this,r)}};r.handleClick=function e(t){this.selected(true)};r.selected=function e(t){if(this.selectable){if(t){this.addClass("vjs-selected");this.el_.setAttribute("aria-checked","true");this.controlText(", selected");this.isSelected_=true}else{this.removeClass("vjs-selected");this.el_.setAttribute("aria-checked","false");this.controlText("");this.isSelected_=false}}};return t}(Ei);ar.registerComponent("MenuItem",Sn);var wn=function(e){p()(t,e);function t(t,r){var i;var a=r.track;var o=t.textTracks();r.label=a.label||a.language||"Unknown";r.selected=a.mode==="showing";i=e.call(this,t,r)||this;i.track=a;i.kinds=(r.kinds||[r.kind||i.track.kind]).filter(Boolean);var u=function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}i.handleTracksChange.apply(c()(i),r)};var l=function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}i.handleSelectedLanguageChange.apply(c()(i),r)};t.on(["loadstart","texttrackchange"],u);o.addEventListener("change",u);o.addEventListener("selectedlanguagechange",l);i.on("dispose",(function(){t.off(["loadstart","texttrackchange"],u);o.removeEventListener("change",u);o.removeEventListener("selectedlanguagechange",l)}));if(o.onchange===undefined){var d;i.on(["tap","click"],(function(){if(typeof n.a.Event!=="object"){try{d=new n.a.Event("change")}catch(e){}}if(!d){d=s.a.createEvent("Event");d.initEvent("change",true,true)}o.dispatchEvent(d)}))}i.handleTracksChange();return i}var r=t.prototype;r.handleClick=function t(r){var i=this.track;var n=this.player_.textTracks();e.prototype.handleClick.call(this,r);if(!n){return}for(var a=0;a<n.length;a++){var s=n[a];if(this.kinds.indexOf(s.kind)===-1){continue}if(s===i){if(s.mode!=="showing"){s.mode="showing"}}else if(s.mode!=="disabled"){s.mode="disabled"}}};r.handleTracksChange=function e(t){var r=this.track.mode==="showing";if(r!==this.isSelected_){this.selected(r)}};r.handleSelectedLanguageChange=function e(t){if(this.track.mode==="showing"){var r=this.player_.cache_.selectedLanguage;if(r&&r.enabled&&r.language===this.track.language&&r.kind!==this.track.kind){return}this.player_.cache_.selectedLanguage={enabled:true,language:this.track.language,kind:this.track.kind}}};r.dispose=function t(){this.track=null;e.prototype.dispose.call(this)};return t}(Sn);ar.registerComponent("TextTrackMenuItem",wn);var En=function(e){p()(t,e);function t(t,r){r.track={player:t,kind:r.kind,kinds:r.kinds,default:false,mode:"disabled"};if(!r.kinds){r.kinds=[r.kind]}if(r.label){r.track.label=r.label}else{r.track.label=r.kinds.join(" and ")+" off"}r.selectable=true;r.multiSelectable=false;return e.call(this,t,r)||this}var r=t.prototype;r.handleTracksChange=function e(t){var r=this.player().textTracks();var i=true;for(var n=0,a=r.length;n<a;n++){var s=r[n];if(this.options_.kinds.indexOf(s.kind)>-1&&s.mode==="showing"){i=false;break}}if(i!==this.isSelected_){this.selected(i)}};r.handleSelectedLanguageChange=function e(t){var r=this.player().textTracks();var i=true;for(var n=0,a=r.length;n<a;n++){var s=r[n];if(["captions","descriptions","subtitles"].indexOf(s.kind)>-1&&s.mode==="showing"){i=false;break}}if(i){this.player_.cache_.selectedLanguage={enabled:false}}};return t}(wn);ar.registerComponent("OffTextTrackMenuItem",En);var kn=function(e){p()(t,e);function t(t,r){if(r===void 0){r={}}r.tracks=t.textTracks();return e.call(this,t,r)||this}var r=t.prototype;r.createItems=function e(t,r){if(t===void 0){t=[]}if(r===void 0){r=wn}var i;if(this.label_){i=this.label_+" off"}t.push(new En(this.player_,{kinds:this.kinds_,kind:this.kind_,label:i}));this.hideThreshold_+=1;var n=this.player_.textTracks();if(!Array.isArray(this.kinds_)){this.kinds_=[this.kind_]}for(var a=0;a<n.length;a++){var s=n[a];if(this.kinds_.indexOf(s.kind)>-1){var o=new r(this.player_,{track:s,kinds:this.kinds_,kind:this.kind_,selectable:true,multiSelectable:false});o.addClass("vjs-"+s.kind+"-menu-item");t.push(o)}}return t};return t}(bn);ar.registerComponent("TextTrackButton",kn);var An=function(e){p()(t,e);function t(t,r){var i;var n=r.track;var a=r.cue;var s=t.currentTime();r.selectable=true;r.multiSelectable=false;r.label=a.text;r.selected=a.startTime<=s&&s<a.endTime;i=e.call(this,t,r)||this;i.track=n;i.cue=a;n.addEventListener("cuechange",Pt(c()(i),i.update));return i}var r=t.prototype;r.handleClick=function t(r){e.prototype.handleClick.call(this);this.player_.currentTime(this.cue.startTime);this.update(this.cue.startTime)};r.update=function e(t){var r=this.cue;var i=this.player_.currentTime();this.selected(r.startTime<=i&&i<r.endTime)};return t}(Sn);ar.registerComponent("ChaptersTrackMenuItem",An);var Cn=function(e){p()(t,e);function t(t,r,i){return e.call(this,t,r,i)||this}var r=t.prototype;r.buildCSSClass=function t(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)};r.buildWrapperCSSClass=function t(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)};r.update=function t(r){if(!this.track_||r&&(r.type==="addtrack"||r.type==="removetrack")){this.setTrack(this.findChaptersTrack())}e.prototype.update.call(this)};r.setTrack=function e(t){if(this.track_===t){return}if(!this.updateHandler_){this.updateHandler_=this.update.bind(this)}if(this.track_){var r=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);if(r){r.removeEventListener("load",this.updateHandler_)}this.track_=null}this.track_=t;if(this.track_){this.track_.mode="hidden";var i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);if(i){i.addEventListener("load",this.updateHandler_)}}};r.findChaptersTrack=function e(){var t=this.player_.textTracks()||[];for(var r=t.length-1;r>=0;r--){var i=t[r];if(i.kind===this.kind_){return i}}};r.getMenuCaption=function e(){if(this.track_&&this.track_.label){return this.track_.label}return this.localize(Jt(this.kind_))};r.createMenu=function t(){this.options_.title=this.getMenuCaption();return e.prototype.createMenu.call(this)};r.createItems=function e(){var t=[];if(!this.track_){return t}var r=this.track_.cues;if(!r){return t}for(var i=0,n=r.length;i<n;i++){var a=r[i];var s=new An(this.player_,{track:this.track_,cue:a});t.push(s)}return t};return t}(kn);Cn.prototype.kind_="chapters";Cn.prototype.controlText_="Chapters";ar.registerComponent("ChaptersButton",Cn);var In=function(e){p()(t,e);function t(t,r,i){var n;n=e.call(this,t,r,i)||this;var a=t.textTracks();var s=Pt(c()(n),n.handleTracksChange);a.addEventListener("change",s);n.on("dispose",(function(){a.removeEventListener("change",s)}));return n}var r=t.prototype;r.handleTracksChange=function e(t){var r=this.player().textTracks();var i=false;for(var n=0,a=r.length;n<a;n++){var s=r[n];if(s.kind!==this.kind_&&s.mode==="showing"){i=true;break}}if(i){this.disable()}else{this.enable()}};r.buildCSSClass=function t(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)};r.buildWrapperCSSClass=function t(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)};return t}(kn);In.prototype.kind_="descriptions";In.prototype.controlText_="Descriptions";ar.registerComponent("DescriptionsButton",In);var Dn=function(e){p()(t,e);function t(t,r,i){return e.call(this,t,r,i)||this}var r=t.prototype;r.buildCSSClass=function t(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)};r.buildWrapperCSSClass=function t(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)};return t}(kn);Dn.prototype.kind_="subtitles";Dn.prototype.controlText_="Subtitles";ar.registerComponent("SubtitlesButton",Dn);var xn=function(e){p()(t,e);function t(t,r){var i;r.track={player:t,kind:r.kind,label:r.kind+" settings",selectable:false,default:false,mode:"disabled"};r.selectable=false;r.name="CaptionSettingsMenuItem";i=e.call(this,t,r)||this;i.addClass("vjs-texttrack-settings");i.controlText(", opens "+r.kind+" settings dialog");return i}var r=t.prototype;r.handleClick=function e(t){this.player().getChild("textTrackSettings").open()};return t}(wn);ar.registerComponent("CaptionSettingsMenuItem",xn);var Ln=function(e){p()(t,e);function t(t,r,i){return e.call(this,t,r,i)||this}var r=t.prototype;r.buildCSSClass=function t(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)};r.buildWrapperCSSClass=function t(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)};r.createItems=function t(){var r=[];if(!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")){r.push(new xn(this.player_,{kind:this.kind_}));this.hideThreshold_+=1}return e.prototype.createItems.call(this,r)};return t}(kn);Ln.prototype.kind_="captions";Ln.prototype.controlText_="Captions";ar.registerComponent("CaptionsButton",Ln);var On=function(e){p()(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.createEl=function t(r,i,n){var a=e.prototype.createEl.call(this,r,i,n);var s=a.querySelector(".vjs-menu-item-text");if(this.options_.track.kind==="captions"){s.appendChild(Me("span",{className:"vjs-icon-placeholder"},{"aria-hidden":true}));s.appendChild(Me("span",{className:"vjs-control-text",textContent:" "+this.localize("Captions")}))}return a};return t}(wn);ar.registerComponent("SubsCapsMenuItem",On);var Pn=function(e){p()(t,e);function t(t,r){var i;if(r===void 0){r={}}i=e.call(this,t,r)||this;i.label_="subtitles";if(["en","en-us","en-ca","fr-ca"].indexOf(i.player_.language_)>-1){i.label_="captions"}i.menuButton_.controlText(Jt(i.label_));return i}var r=t.prototype;r.buildCSSClass=function t(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)};r.buildWrapperCSSClass=function t(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)};r.createItems=function t(){var r=[];if(!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")){r.push(new xn(this.player_,{kind:this.label_}));this.hideThreshold_+=1}r=e.prototype.createItems.call(this,r,On);return r};return t}(kn);Pn.prototype.kinds_=["captions","subtitles"];Pn.prototype.controlText_="Subtitles";ar.registerComponent("SubsCapsButton",Pn);var Rn=function(e){p()(t,e);function t(t,r){var i;var n=r.track;var a=t.audioTracks();r.label=n.label||n.language||"Unknown";r.selected=n.enabled;i=e.call(this,t,r)||this;i.track=n;i.addClass("vjs-"+n.kind+"-menu-item");var s=function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}i.handleTracksChange.apply(c()(i),r)};a.addEventListener("change",s);i.on("dispose",(function(){a.removeEventListener("change",s)}));return i}var r=t.prototype;r.createEl=function t(r,i,n){var a=e.prototype.createEl.call(this,r,i,n);var s=a.querySelector(".vjs-menu-item-text");if(this.options_.track.kind==="main-desc"){s.appendChild(Me("span",{className:"vjs-icon-placeholder"},{"aria-hidden":true}));s.appendChild(Me("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))}return a};r.handleClick=function t(r){e.prototype.handleClick.call(this,r);this.track.enabled=true;if(this.player_.tech_.featuresNativeAudioTracks){var i=this.player_.audioTracks();for(var n=0;n<i.length;n++){var a=i[n];if(a===this.track){continue}a.enabled=a===this.track}}};r.handleTracksChange=function e(t){this.selected(this.track.enabled)};return t}(Sn);ar.registerComponent("AudioTrackMenuItem",Rn);var Un=function(e){p()(t,e);function t(t,r){if(r===void 0){r={}}r.tracks=t.audioTracks();return e.call(this,t,r)||this}var r=t.prototype;r.buildCSSClass=function t(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)};r.buildWrapperCSSClass=function t(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)};r.createItems=function e(t){if(t===void 0){t=[]}this.hideThreshold_=1;var r=this.player_.audioTracks();for(var i=0;i<r.length;i++){var n=r[i];t.push(new Rn(this.player_,{track:n,selectable:true,multiSelectable:false}))}return t};return t}(bn);Un.prototype.controlText_="Audio Track";ar.registerComponent("AudioTrackButton",Un);var Mn=function(e){p()(t,e);function t(t,r){var i;var n=r.rate;var a=parseFloat(n,10);r.label=n;r.selected=a===t.playbackRate();r.selectable=true;r.multiSelectable=false;i=e.call(this,t,r)||this;i.label=n;i.rate=a;i.on(t,"ratechange",(function(e){return i.update(e)}));return i}var r=t.prototype;r.handleClick=function t(r){e.prototype.handleClick.call(this);this.player().playbackRate(this.rate)};r.update=function e(t){this.selected(this.player().playbackRate()===this.rate)};return t}(Sn);Mn.prototype.contentElType="button";ar.registerComponent("PlaybackRateMenuItem",Mn);var Nn=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.menuButton_.el_.setAttribute("aria-describedby",i.labelElId_);i.updateVisibility();i.updateLabel();i.on(t,"loadstart",(function(e){return i.updateVisibility(e)}));i.on(t,"ratechange",(function(e){return i.updateLabel(e)}));i.on(t,"playbackrateschange",(function(e){return i.handlePlaybackRateschange(e)}));return i}var r=t.prototype;r.createEl=function t(){var r=e.prototype.createEl.call(this);this.labelElId_="vjs-playback-rate-value-label-"+this.id_;this.labelEl_=Me("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"});r.appendChild(this.labelEl_);return r};r.dispose=function t(){this.labelEl_=null;e.prototype.dispose.call(this)};r.buildCSSClass=function t(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)};r.buildWrapperCSSClass=function t(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)};r.createItems=function e(){var t=this.playbackRates();var r=[];for(var i=t.length-1;i>=0;i--){r.push(new Mn(this.player(),{rate:t[i]+"x"}))}return r};r.updateARIAAttributes=function e(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())};r.handleClick=function e(t){var r=this.player().playbackRate();var i=this.playbackRates();var n=i.indexOf(r);var a=(n+1)%i.length;this.player().playbackRate(i[a])};r.handlePlaybackRateschange=function e(t){this.update()};r.playbackRates=function e(){var t=this.player();return t.playbackRates&&t.playbackRates()||[]};r.playbackRateSupported=function e(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0};r.updateVisibility=function e(t){if(this.playbackRateSupported()){this.removeClass("vjs-hidden")}else{this.addClass("vjs-hidden")}};r.updateLabel=function e(t){if(this.playbackRateSupported()){this.labelEl_.textContent=this.player().playbackRate()+"x"}};return t}(_n);Nn.prototype.controlText_="Playback Rate";ar.registerComponent("PlaybackRateMenuButton",Nn);var Bn=function(e){p()(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.buildCSSClass=function t(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)};r.createEl=function t(r,i,n){if(r===void 0){r="div"}if(i===void 0){i={}}if(n===void 0){n={}}if(!i.className){i.className=this.buildCSSClass()}return e.prototype.createEl.call(this,r,i,n)};return t}(ar);ar.registerComponent("Spacer",Bn);var Fn=function(e){p()(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.buildCSSClass=function t(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)};r.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),textContent:""})};return t}(Bn);ar.registerComponent("CustomControlSpacer",Fn);var jn=function(e){p()(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})};return t}(ar);jn.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]};if("exitPictureInPicture"in s.a){jn.prototype.options_.children.splice(jn.prototype.options_.children.length-1,0,"pictureInPictureToggle")}ar.registerComponent("ControlBar",jn);var qn=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;i.on(t,"error",(function(e){return i.open(e)}));return i}var r=t.prototype;r.buildCSSClass=function t(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)};r.content=function e(){var t=this.player().error();return t?this.localize(t.message):""};return t}(br);qn.prototype.options_=u()({},br.prototype.options_,{pauseOnOpen:false,fillAlways:true,temporary:false,uncloseable:true});ar.registerComponent("ErrorDisplay",qn);var Hn="vjs-text-track-settings";var Gn=["#000","Black"];var Vn=["#00F","Blue"];var Wn=["#0FF","Cyan"];var zn=["#0F0","Green"];var Kn=["#F0F","Magenta"];var Xn=["#F00","Red"];var Yn=["#FFF","White"];var Qn=["#FF0","Yellow"];var $n=["1","Opaque"];var Jn=["0.5","Semi-Transparent"];var Zn=["0","Transparent"];var ea={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Gn,Yn,Xn,zn,Vn,Qn,Kn,Wn]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[$n,Jn,Zn]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Yn,Gn,Xn,zn,Vn,Qn,Kn,Wn]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function e(t){return t==="1.00"?null:Number(t)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[$n,Jn]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Zn,Jn,$n]}};ea.windowColor.options=ea.backgroundColor.options;function ta(e,t){if(t){e=t(e)}if(e&&e!=="none"){return e}}function ra(e,t){var r=e.options[e.options.selectedIndex].value;return ta(r,t)}function ia(e,t,r){if(!t){return}for(var i=0;i<e.options.length;i++){if(ta(e.options[i].value,r)===t){e.selectedIndex=i;break}}}var na=function(e){p()(t,e);function t(t,r){var i;r.temporary=false;i=e.call(this,t,r)||this;i.updateDisplay=i.updateDisplay.bind(c()(i));i.fill();i.hasBeenOpened_=i.hasBeenFilled_=true;i.endDialog=Me("p",{className:"vjs-control-text",textContent:i.localize("End of dialog window.")});i.el().appendChild(i.endDialog);i.setDefaults();if(r.persistTextTrackSettings===undefined){i.options_.persistTextTrackSettings=i.options_.playerOptions.persistTextTrackSettings}i.on(i.$(".vjs-done-button"),"click",(function(){i.saveSettings();i.close()}));i.on(i.$(".vjs-default-button"),"click",(function(){i.setDefaults();i.updateDisplay()}));re(ea,(function(e){i.on(i.$(e.selector),"change",i.updateDisplay)}));if(i.options_.persistTextTrackSettings){i.restoreSettings()}return i}var r=t.prototype;r.dispose=function t(){this.endDialog=null;e.prototype.dispose.call(this)};r.createElSelect_=function e(t,r,i){var n=this;if(r===void 0){r=""}if(i===void 0){i="label"}var a=ea[t];var s=a.id.replace("%s",this.id_);var o=[r,s].join(" ").trim();return["<"+i+' id="'+s+'" class="'+(i==="label"?"vjs-label":"")+'">',this.localize(a.label),"</"+i+">",'<select aria-labelledby="'+o+'">'].concat(a.options.map((function(e){var t=s+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+o+" "+t+'">',n.localize(e[1]),"</option>"].join("")}))).concat("</select>").join("")};r.createElFgColor_=function e(){var t="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",t),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",t),"</span>","</fieldset>"].join("")};r.createElBgColor_=function e(){var t="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",t),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",t),"</span>","</fieldset>"].join("")};r.createElWinColor_=function e(){var t="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",t),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",t),"</span>","</fieldset>"].join("")};r.createElColors_=function e(){return Me("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})};r.createElFont_=function e(){return Me("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})};r.createElControls_=function e(){var t=this.localize("restore all settings to the default values");return Me("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+t+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+t+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})};r.content=function e(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]};r.label=function e(){return this.localize("Caption Settings Dialog")};r.description=function e(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")};r.buildCSSClass=function t(){return e.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"};r.getValues=function e(){var t=this;return ie(ea,(function(e,r,i){var n=ra(t.$(r.selector),r.parser);if(n!==undefined){e[i]=n}return e}),{})};r.setValues=function e(t){var r=this;re(ea,(function(e,i){ia(r.$(e.selector),t[i],e.parser)}))};r.setDefaults=function e(){var t=this;re(ea,(function(e){var r=e.hasOwnProperty("default")?e["default"]:0;t.$(e.selector).selectedIndex=r}))};r.restoreSettings=function e(){var t;try{t=JSON.parse(n.a.localStorage.getItem(Hn))}catch(e){J.warn(e)}if(t){this.setValues(t)}};r.saveSettings=function e(){if(!this.options_.persistTextTrackSettings){return}var t=this.getValues();try{if(Object.keys(t).length){n.a.localStorage.setItem(Hn,JSON.stringify(t))}else{n.a.localStorage.removeItem(Hn)}}catch(e){J.warn(e)}};r.updateDisplay=function e(){var t=this.player_.getChild("textTrackDisplay");if(t){t.updateDisplay()}};r.conditionalBlur_=function e(){this.previouslyActiveEl_=null;var t=this.player_.controlBar;var r=t&&t.subsCapsButton;var i=t&&t.captionsButton;if(r){r.focus()}else if(i){i.focus()}};return t}(br);ar.registerComponent("TextTrackSettings",na);var aa=function(e){p()(t,e);function t(t,r){var i;var a=r.ResizeObserver||n.a.ResizeObserver;if(r.ResizeObserver===null){a=false}var s=er({createEl:!a,reportTouchActivity:false},r);i=e.call(this,t,s)||this;i.ResizeObserver=r.ResizeObserver||n.a.ResizeObserver;i.loadListener_=null;i.resizeObserver_=null;i.debouncedHandler_=Ut((function(){i.resizeHandler()}),100,false,c()(i));if(a){i.resizeObserver_=new i.ResizeObserver(i.debouncedHandler_);i.resizeObserver_.observe(t.el())}else{i.loadListener_=function(){if(!i.el_||!i.el_.contentWindow){return}var e=i.debouncedHandler_;var t=i.unloadListener_=function(){Ct(this,"resize",e);Ct(this,"unload",t);t=null};At(i.el_.contentWindow,"unload",t);At(i.el_.contentWindow,"resize",e)};i.one("load",i.loadListener_)}return i}var r=t.prototype;r.createEl=function t(){return e.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})};r.resizeHandler=function e(){if(!this.player_||!this.player_.trigger){return}this.player_.trigger("playerresize")};r.dispose=function t(){if(this.debouncedHandler_){this.debouncedHandler_.cancel()}if(this.resizeObserver_){if(this.player_.el()){this.resizeObserver_.unobserve(this.player_.el())}this.resizeObserver_.disconnect()}if(this.loadListener_){this.off("load",this.loadListener_)}if(this.el_&&this.el_.contentWindow&&this.unloadListener_){this.unloadListener_.call(this.el_.contentWindow)}this.ResizeObserver=null;this.resizeObserver=null;this.debouncedHandler_=null;this.loadListener_=null;e.prototype.dispose.call(this)};return t}(ar);ar.registerComponent("ResizeManager",aa);var sa={trackingThreshold:20,liveTolerance:15};var oa=function(e){p()(t,e);function t(t,r){var i;var n=er(sa,r,{createEl:false});i=e.call(this,t,n)||this;i.handleVisibilityChange_=function(e){return i.handleVisibilityChange(e)};i.trackLiveHandler_=function(){return i.trackLive_()};i.handlePlay_=function(e){return i.handlePlay(e)};i.handleFirstTimeupdate_=function(e){return i.handleFirstTimeupdate(e)};i.handleSeeked_=function(e){return i.handleSeeked(e)};i.seekToLiveEdge_=function(e){return i.seekToLiveEdge(e)};i.reset_();i.on(i.player_,"durationchange",(function(e){return i.handleDurationchange(e)}));i.on(i.player_,"canplay",(function(){return i.toggleTracking()}));if(be&&"hidden"in s.a&&"visibilityState"in s.a){i.on(s.a,"visibilitychange",i.handleVisibilityChange_)}return i}var r=t.prototype;r.handleVisibilityChange=function e(){if(this.player_.duration()!==Infinity){return}if(s.a.hidden){this.stopTracking()}else{this.startTracking()}};r.trackLive_=function e(){var t=this.player_.seekable();if(!t||!t.length){return}var r=Number(n.a.performance.now().toFixed(4));var i=this.lastTime_===-1?0:(r-this.lastTime_)/1e3;this.lastTime_=r;this.pastSeekEnd_=this.pastSeekEnd()+i;var a=this.liveCurrentTime();var s=this.player_.currentTime();var o=this.player_.paused()||this.seekedBehindLive_||Math.abs(a-s)>this.options_.liveTolerance;if(!this.timeupdateSeen_||a===Infinity){o=false}if(o!==this.behindLiveEdge_){this.behindLiveEdge_=o;this.trigger("liveedgechange")}};r.handleDurationchange=function e(){this.toggleTracking()};r.toggleTracking=function e(){if(this.player_.duration()===Infinity&&this.liveWindow()>=this.options_.trackingThreshold){if(this.player_.options_.liveui){this.player_.addClass("vjs-liveui")}this.startTracking()}else{this.player_.removeClass("vjs-liveui");this.stopTracking()}};r.startTracking=function e(){if(this.isTracking()){return}if(!this.timeupdateSeen_){this.timeupdateSeen_=this.player_.hasStarted()}this.trackingInterval_=this.setInterval(this.trackLiveHandler_,Ot);this.trackLive_();this.on(this.player_,["play","pause"],this.trackLiveHandler_);if(!this.timeupdateSeen_){this.one(this.player_,"play",this.handlePlay_);this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)}else{this.on(this.player_,"seeked",this.handleSeeked_)}};r.handleFirstTimeupdate=function e(){this.timeupdateSeen_=true;this.on(this.player_,"seeked",this.handleSeeked_)};r.handleSeeked=function e(){var t=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&t>2;this.nextSeekedFromUser_=false;this.trackLive_()};r.handlePlay=function e(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)};r.reset_=function e(){this.lastTime_=-1;this.pastSeekEnd_=0;this.lastSeekEnd_=-1;this.behindLiveEdge_=true;this.timeupdateSeen_=false;this.seekedBehindLive_=false;this.nextSeekedFromUser_=false;this.clearInterval(this.trackingInterval_);this.trackingInterval_=null;this.off(this.player_,["play","pause"],this.trackLiveHandler_);this.off(this.player_,"seeked",this.handleSeeked_);this.off(this.player_,"play",this.handlePlay_);this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_);this.off(this.player_,"timeupdate",this.seekToLiveEdge_)};r.nextSeekedFromUser=function e(){this.nextSeekedFromUser_=true};r.stopTracking=function e(){if(!this.isTracking()){return}this.reset_();this.trigger("liveedgechange")};r.seekableEnd=function e(){var t=this.player_.seekable();var r=[];var i=t?t.length:0;while(i--){r.push(t.end(i))}return r.length?r.sort()[r.length-1]:Infinity};r.seekableStart=function e(){var t=this.player_.seekable();var r=[];var i=t?t.length:0;while(i--){r.push(t.start(i))}return r.length?r.sort()[0]:0};r.liveWindow=function e(){var t=this.liveCurrentTime();if(t===Infinity){return 0}return t-this.seekableStart()};r.isLive=function e(){return this.isTracking()};r.atLiveEdge=function e(){return!this.behindLiveEdge()};r.liveCurrentTime=function e(){return this.pastSeekEnd()+this.seekableEnd()};r.pastSeekEnd=function e(){var t=this.seekableEnd();if(this.lastSeekEnd_!==-1&&t!==this.lastSeekEnd_){this.pastSeekEnd_=0}this.lastSeekEnd_=t;return this.pastSeekEnd_};r.behindLiveEdge=function e(){return this.behindLiveEdge_};r.isTracking=function e(){return typeof this.trackingInterval_==="number"};r.seekToLiveEdge=function e(){this.seekedBehindLive_=false;if(this.atLiveEdge()){return}this.nextSeekedFromUser_=false;this.player_.currentTime(this.liveCurrentTime())};r.dispose=function t(){this.off(s.a,"visibilitychange",this.handleVisibilityChange_);this.stopTracking();e.prototype.dispose.call(this)};return t}(ar);ar.registerComponent("LiveTracker",oa);var ua=function e(t){var r=t.el();if(r.hasAttribute("src")){t.triggerSourceset(r.src);return true}var i=t.$$("source");var n=[];var a="";if(!i.length){return false}for(var s=0;s<i.length;s++){var o=i[s].src;if(o&&n.indexOf(o)===-1){n.push(o)}}if(!n.length){return false}if(n.length===1){a=n[0]}t.triggerSourceset(a);return true};var la=Object.defineProperty({},"innerHTML",{get:function e(){return this.cloneNode(true).innerHTML},set:function e(t){var r=s.a.createElement(this.nodeName.toLowerCase());r.innerHTML=t;var i=s.a.createDocumentFragment();while(r.childNodes.length){i.appendChild(r.childNodes[0])}this.innerText="";n.a.Element.prototype.appendChild.call(this,i);return this.innerHTML}});var da=function e(t,r){var i={};for(var n=0;n<t.length;n++){i=Object.getOwnPropertyDescriptor(t[n],r);if(i&&i.set&&i.get){break}}i.enumerable=true;i.configurable=true;return i};var fa=function e(t){return da([t.el(),n.a.HTMLMediaElement.prototype,n.a.Element.prototype,la],"innerHTML")};var ca=function e(t){var r=t.el();if(r.resetSourceWatch_){return}var i={};var n=fa(t);var a=function e(i){return function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++){n[a]=arguments[a]}var s=i.apply(r,n);ua(t);return s}};["append","appendChild","insertAdjacentHTML"].forEach((function(e){if(!r[e]){return}i[e]=r[e];r[e]=a(i[e])}));Object.defineProperty(r,"innerHTML",er(n,{set:a(n.set)}));r.resetSourceWatch_=function(){r.resetSourceWatch_=null;Object.keys(i).forEach((function(e){r[e]=i[e]}));Object.defineProperty(r,"innerHTML",n)};t.one("sourceset",r.resetSourceWatch_)};var ha=Object.defineProperty({},"src",{get:function e(){if(this.hasAttribute("src")){return Mr(n.a.Element.prototype.getAttribute.call(this,"src"))}return""},set:function e(t){n.a.Element.prototype.setAttribute.call(this,"src",t);return t}});var pa=function e(t){return da([t.el(),n.a.HTMLMediaElement.prototype,ha],"src")};var va=function e(t){if(!t.featuresSourceset){return}var r=t.el();if(r.resetSourceset_){return}var i=pa(t);var n=r.setAttribute;var a=r.load;Object.defineProperty(r,"src",er(i,{set:function e(n){var a=i.set.call(r,n);t.triggerSourceset(r.src);return a}}));r.setAttribute=function(e,i){var a=n.call(r,e,i);if(/src/i.test(e)){t.triggerSourceset(r.src)}return a};r.load=function(){var e=a.call(r);if(!ua(t)){t.triggerSourceset("");ca(t)}return e};if(r.currentSrc){t.triggerSourceset(r.currentSrc)}else if(!ua(t)){ca(t)}r.resetSourceset_=function(){r.resetSourceset_=null;r.load=a;r.setAttribute=n;Object.defineProperty(r,"src",i);if(r.resetSourceWatch_){r.resetSourceWatch_()}}};var ma=function e(t,r,i,n){if(n===void 0){n=true}var a=function e(i){return Object.defineProperty(t,r,{value:i,enumerable:true,writable:true})};var s={configurable:true,enumerable:true,get:function e(){var t=i();a(t);return t}};if(n){s.set=a}return Object.defineProperty(t,r,s)};var ga=function(e){p()(t,e);function t(t,r){var i;i=e.call(this,t,r)||this;var n=t.source;var a=false;if(n&&(i.el_.currentSrc!==n.src||t.tag&&t.tag.initNetworkState_===3)){i.setSource(n)}else{i.handleLateInit_(i.el_)}if(t.enableSourceset){i.setupSourcesetHandling_()}i.isScrubbing_=false;if(i.el_.hasChildNodes()){var s=i.el_.childNodes;var o=s.length;var u=[];while(o--){var l=s[o];var d=l.nodeName.toLowerCase();if(d==="track"){if(!i.featuresNativeTextTracks){u.push(l)}else{i.remoteTextTrackEls().addTrackElement_(l);i.remoteTextTracks().addTrack(l.track);i.textTracks().addTrack(l.track);if(!a&&!i.el_.hasAttribute("crossorigin")&&Br(l.src)){a=true}}}}for(var f=0;f<u.length;f++){i.el_.removeChild(u[f])}}i.proxyNativeTracks_();if(i.featuresNativeTextTracks&&a){J.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n"+"This may prevent text tracks from loading.")}i.restoreMetadataTracksInIOSNativePlayer_();if((we||ke||ve)&&t.nativeControlsForTouch===true){i.setControls(true)}i.proxyWebkitFullscreen_();i.triggerReady();return i}var r=t.prototype;r.dispose=function r(){if(this.el_&&this.el_.resetSourceset_){this.el_.resetSourceset_()}t.disposeMediaElement(this.el_);this.options_=null;e.prototype.dispose.call(this)};r.setupSourcesetHandling_=function e(){va(this)};r.restoreMetadataTracksInIOSNativePlayer_=function e(){var t=this.textTracks();var r;var i=function e(){r=[];for(var i=0;i<t.length;i++){var n=t[i];if(n.kind==="metadata"){r.push({track:n,storedMode:n.mode})}}};i();t.addEventListener("change",i);this.on("dispose",(function(){return t.removeEventListener("change",i)}));var n=function e(){for(var i=0;i<r.length;i++){var n=r[i];if(n.track.mode==="disabled"&&n.track.mode!==n.storedMode){n.track.mode=n.storedMode}}t.removeEventListener("change",e)};this.on("webkitbeginfullscreen",(function(){t.removeEventListener("change",i);t.removeEventListener("change",n);t.addEventListener("change",n)}));this.on("webkitendfullscreen",(function(){t.removeEventListener("change",i);t.addEventListener("change",i);t.removeEventListener("change",n)}))};r.overrideNative_=function e(t,r){var i=this;if(r!==this["featuresNative"+t+"Tracks"]){return}var n=t.toLowerCase();if(this[n+"TracksListeners_"]){Object.keys(this[n+"TracksListeners_"]).forEach((function(e){var t=i.el()[n+"Tracks"];t.removeEventListener(e,i[n+"TracksListeners_"][e])}))}this["featuresNative"+t+"Tracks"]=!r;this[n+"TracksListeners_"]=null;this.proxyNativeTracksForType_(n)};r.overrideNativeAudioTracks=function e(t){this.overrideNative_("Audio",t)};r.overrideNativeVideoTracks=function e(t){this.overrideNative_("Video",t)};r.proxyNativeTracksForType_=function e(t){var r=this;var i=Qr[t];var n=this.el()[i.getterName];var a=this[i.getterName]();if(!this["featuresNative"+i.capitalName+"Tracks"]||!n||!n.addEventListener){return}var s={change:function e(i){var n={type:"change",target:a,currentTarget:a,srcElement:a};a.trigger(n);if(t==="text"){r[$r.remoteText.getterName]().trigger(n)}},addtrack:function e(t){a.addTrack(t.track)},removetrack:function e(t){a.removeTrack(t.track)}};var o=function e(){var t=[];for(var r=0;r<a.length;r++){var i=false;for(var s=0;s<n.length;s++){if(n[s]===a[r]){i=true;break}}if(!i){t.push(a[r])}}while(t.length){a.removeTrack(t.shift())}};this[i.getterName+"Listeners_"]=s;Object.keys(s).forEach((function(e){var t=s[e];n.addEventListener(e,t);r.on("dispose",(function(r){return n.removeEventListener(e,t)}))}));this.on("loadstart",o);this.on("dispose",(function(e){return r.off("loadstart",o)}))};r.proxyNativeTracks_=function e(){var t=this;Qr.names.forEach((function(e){t.proxyNativeTracksForType_(e)}))};r.createEl=function e(){var r=this.options_.tag;if(!r||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(r){var i=r.cloneNode(true);if(r.parentNode){r.parentNode.insertBefore(i,r)}t.disposeMediaElement(r);r=i}else{r=s.a.createElement("video");var n=this.options_.tag&&Ve(this.options_.tag);var a=er({},n);if(!we||this.options_.nativeControlsForTouch!==true){delete a.controls}Ge(r,ne(a,{id:this.options_.techId,class:"vjs-tech"}))}r.playerId=this.options_.playerId}if(typeof this.options_.preload!=="undefined"){ze(r,"preload",this.options_.preload)}if(this.options_.disablePictureInPicture!==undefined){r.disablePictureInPicture=this.options_.disablePictureInPicture}var o=["loop","muted","playsinline","autoplay"];for(var u=0;u<o.length;u++){var l=o[u];var d=this.options_[l];if(typeof d!=="undefined"){if(d){ze(r,l,l)}else{Ke(r,l)}r[l]=d}}return r};r.handleLateInit_=function e(t){if(t.networkState===0||t.networkState===3){return}if(t.readyState===0){var r=false;var i=function e(){r=true};this.on("loadstart",i);var n=function e(){if(!r){this.trigger("loadstart")}};this.on("loadedmetadata",n);this.ready((function(){this.off("loadstart",i);this.off("loadedmetadata",n);if(!r){this.trigger("loadstart")}}));return}var a=["loadstart"];a.push("loadedmetadata");if(t.readyState>=2){a.push("loadeddata")}if(t.readyState>=3){a.push("canplay")}if(t.readyState>=4){a.push("canplaythrough")}this.ready((function(){a.forEach((function(e){this.trigger(e)}),this)}))};r.setScrubbing=function e(t){this.isScrubbing_=t};r.scrubbing=function e(){return this.isScrubbing_};r.setCurrentTime=function e(t){try{if(this.isScrubbing_&&this.el_.fastSeek&&Ce){this.el_.fastSeek(t)}else{this.el_.currentTime=t}}catch(e){J(e,"Video is not ready. (Video.js)")}};r.duration=function e(){var t=this;if(this.el_.duration===Infinity&&he&&ye&&this.el_.currentTime===0){var r=function e(){if(t.el_.currentTime>0){if(t.el_.duration===Infinity){t.trigger("durationchange")}t.off("timeupdate",e)}};this.on("timeupdate",r);return NaN}return this.el_.duration||NaN};r.width=function e(){return this.el_.offsetWidth};r.height=function e(){return this.el_.offsetHeight};r.proxyWebkitFullscreen_=function e(){var t=this;if(!("webkitDisplayingFullscreen"in this.el_)){return}var r=function e(){this.trigger("fullscreenchange",{isFullscreen:false});if(this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()){this.el_.controls=false}};var i=function e(){if("webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"){this.one("webkitendfullscreen",r);this.trigger("fullscreenchange",{isFullscreen:true,nativeIOSFullscreen:true})}};this.on("webkitbeginfullscreen",i);this.on("dispose",(function(){t.off("webkitbeginfullscreen",i);t.off("webkitendfullscreen",r)}))};r.supportsFullScreen=function e(){if(typeof this.el_.webkitEnterFullScreen==="function"){var t=n.a.navigator&&n.a.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t)){return true}}return false};r.enterFullScreen=function e(){var t=this.el_;if(t.paused&&t.networkState<=t.HAVE_METADATA){pr(this.el_.play());this.setTimeout((function(){t.pause();try{t.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}}),0)}else{try{t.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}}};r.exitFullScreen=function e(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()};r.requestPictureInPicture=function e(){return this.el_.requestPictureInPicture()};r.src=function e(t){if(t===undefined){return this.el_.src}this.setSrc(t)};r.reset=function e(){t.resetMediaElement(this.el_)};r.currentSrc=function e(){if(this.currentSource_){return this.currentSource_.src}return this.el_.currentSrc};r.setControls=function e(t){this.el_.controls=!!t};r.addTextTrack=function t(r,i,n){if(!this.featuresNativeTextTracks){return e.prototype.addTextTrack.call(this,r,i,n)}return this.el_.addTextTrack(r,i,n)};r.createRemoteTextTrack=function t(r){if(!this.featuresNativeTextTracks){return e.prototype.createRemoteTextTrack.call(this,r)}var i=s.a.createElement("track");if(r.kind){i.kind=r.kind}if(r.label){i.label=r.label}if(r.language||r.srclang){i.srclang=r.language||r.srclang}if(r["default"]){i["default"]=r["default"]}if(r.id){i.id=r.id}if(r.src){i.src=r.src}return i};r.addRemoteTextTrack=function t(r,i){var n=e.prototype.addRemoteTextTrack.call(this,r,i);if(this.featuresNativeTextTracks){this.el().appendChild(n)}return n};r.removeRemoteTextTrack=function t(r){e.prototype.removeRemoteTextTrack.call(this,r);if(this.featuresNativeTextTracks){var i=this.$$("track");var n=i.length;while(n--){if(r===i[n]||r===i[n].track){this.el().removeChild(i[n])}}}};r.getVideoPlaybackQuality=function e(){if(typeof this.el().getVideoPlaybackQuality==="function"){return this.el().getVideoPlaybackQuality()}var t={};if(typeof this.el().webkitDroppedFrameCount!=="undefined"&&typeof this.el().webkitDecodedFrameCount!=="undefined"){t.droppedVideoFrames=this.el().webkitDroppedFrameCount;t.totalVideoFrames=this.el().webkitDecodedFrameCount}if(n.a.performance&&typeof n.a.performance.now==="function"){t.creationTime=n.a.performance.now()}else if(n.a.performance&&n.a.performance.timing&&typeof n.a.performance.timing.navigationStart==="number"){t.creationTime=n.a.Date.now()-n.a.performance.timing.navigationStart}return t};return t}(ei);ma(ga,"TEST_VID",(function(){if(!Oe()){return}var e=s.a.createElement("video");var t=s.a.createElement("track");t.kind="captions";t.srclang="en";t.label="English";e.appendChild(t);return e}));ga.isSupported=function(){try{ga.TEST_VID.volume=.5}catch(e){return false}return!!(ga.TEST_VID&&ga.TEST_VID.canPlayType)};ga.canPlayType=function(e){return ga.TEST_VID.canPlayType(e)};ga.canPlaySource=function(e,t){return ga.canPlayType(e.type)};ga.canControlVolume=function(){try{var e=ga.TEST_VID.volume;ga.TEST_VID.volume=e/2+.1;var t=e!==ga.TEST_VID.volume;if(t&&Ae){n.a.setTimeout((function(){if(ga&&ga.prototype){ga.prototype.featuresVolumeControl=e!==ga.TEST_VID.volume}}));return false}return t}catch(e){return false}};ga.canMuteVolume=function(){try{var e=ga.TEST_VID.muted;ga.TEST_VID.muted=!e;if(ga.TEST_VID.muted){ze(ga.TEST_VID,"muted","muted")}else{Ke(ga.TEST_VID,"muted","muted")}return e!==ga.TEST_VID.muted}catch(e){return false}};ga.canControlPlaybackRate=function(){if(he&&ye&&_e<58){return false}try{var e=ga.TEST_VID.playbackRate;ga.TEST_VID.playbackRate=e/2+.1;return e!==ga.TEST_VID.playbackRate}catch(e){return false}};ga.canOverrideAttributes=function(){try{var e=function e(){};Object.defineProperty(s.a.createElement("video"),"src",{get:e,set:e});Object.defineProperty(s.a.createElement("audio"),"src",{get:e,set:e});Object.defineProperty(s.a.createElement("video"),"innerHTML",{get:e,set:e});Object.defineProperty(s.a.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return false}return true};ga.supportsNativeTextTracks=function(){return Ce||Ae&&ye};ga.supportsNativeVideoTracks=function(){return!!(ga.TEST_VID&&ga.TEST_VID.videoTracks)};ga.supportsNativeAudioTracks=function(){return!!(ga.TEST_VID&&ga.TEST_VID.audioTracks)};ga.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach((function(e){var t=e[0],r=e[1];ma(ga.prototype,t,(function(){return ga[r]()}),true)}));ga.prototype.featuresVolumeControl=ga.canControlVolume();ga.prototype.movingMediaElementInDOM=!Ae;ga.prototype.featuresFullscreenResize=true;ga.prototype.featuresProgressEvents=true;ga.prototype.featuresTimeupdateEvents=true;var ya;ga.patchCanPlayType=function(){if(pe>=4&&!me&&!ye){ya=ga.TEST_VID&&ga.TEST_VID.constructor.prototype.canPlayType;ga.TEST_VID.constructor.prototype.canPlayType=function(e){var t=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;if(e&&t.test(e)){return"maybe"}return ya.call(this,e)}}};ga.unpatchCanPlayType=function(){var e=ga.TEST_VID.constructor.prototype.canPlayType;if(ya){ga.TEST_VID.constructor.prototype.canPlayType=ya}return e};ga.patchCanPlayType();ga.disposeMediaElement=function(e){if(!e){return}if(e.parentNode){e.parentNode.removeChild(e)}while(e.hasChildNodes()){e.removeChild(e.firstChild)}e.removeAttribute("src");if(typeof e.load==="function"){(function(){try{e.load()}catch(e){}})()}};ga.resetMediaElement=function(e){if(!e){return}var t=e.querySelectorAll("source");var r=t.length;while(r--){e.removeChild(t[r])}e.removeAttribute("src");if(typeof e.load==="function"){(function(){try{e.load()}catch(e){}})()}};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach((function(e){ga.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}}));["muted","defaultMuted","autoplay","loop","playsinline"].forEach((function(e){ga.prototype["set"+Jt(e)]=function(t){this.el_[e]=t;if(t){this.el_.setAttribute(e,e)}else{this.el_.removeAttribute(e)}}}));["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach((function(e){ga.prototype[e]=function(){return this.el_[e]}}));["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach((function(e){ga.prototype["set"+Jt(e)]=function(t){this.el_[e]=t}}));["pause","load","play"].forEach((function(e){ga.prototype[e]=function(){return this.el_[e]()}}));ei.withSourceHandlers(ga);ga.nativeSourceHandler={};ga.nativeSourceHandler.canPlayType=function(e){try{return ga.TEST_VID.canPlayType(e)}catch(e){return""}};ga.nativeSourceHandler.canHandleSource=function(e,t){if(e.type){return ga.nativeSourceHandler.canPlayType(e.type)}else if(e.src){var r=Nr(e.src);return ga.nativeSourceHandler.canPlayType("video/"+r)}return""};ga.nativeSourceHandler.handleSource=function(e,t,r){t.setSrc(e.src)};ga.nativeSourceHandler.dispose=function(){};ga.registerSourceHandler(ga.nativeSourceHandler);ei.registerTech("Html5",ga);var _a=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"];var ba={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"};var Ta=["tiny","xsmall","small","medium","large","xlarge","huge"];var Sa={};Ta.forEach((function(e){var t=e.charAt(0)==="x"?"x-"+e.substring(1):e;Sa[e]="vjs-layout-"+t}));var wa={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:Infinity};var Ea=function(e){p()(t,e);function t(r,i,n){var a;r.id=r.id||i.id||"vjs_video_"+gt();i=ne(t.getTagSettings(r),i);i.initChildren=false;i.createEl=false;i.evented=false;i.reportTouchActivity=false;if(!i.language){if(typeof r.closest==="function"){var o=r.closest("[lang]");if(o&&o.getAttribute){i.language=o.getAttribute("lang")}}else{var u=r;while(u&&u.nodeType===1){if(Ve(u).hasOwnProperty("lang")){i.language=u.getAttribute("lang");break}u=u.parentNode}}}a=e.call(this,null,i,n)||this;a.boundDocumentFullscreenChange_=function(e){return a.documentFullscreenChange_(e)};a.boundFullWindowOnEscKey_=function(e){return a.fullWindowOnEscKey(e)};a.boundUpdateStyleEl_=function(e){return a.updateStyleEl_(e)};a.boundApplyInitTime_=function(e){return a.applyInitTime_(e)};a.boundUpdateCurrentBreakpoint_=function(e){return a.updateCurrentBreakpoint_(e)};a.boundHandleTechClick_=function(e){return a.handleTechClick_(e)};a.boundHandleTechDoubleClick_=function(e){return a.handleTechDoubleClick_(e)};a.boundHandleTechTouchStart_=function(e){return a.handleTechTouchStart_(e)};a.boundHandleTechTouchMove_=function(e){return a.handleTechTouchMove_(e)};a.boundHandleTechTouchEnd_=function(e){return a.handleTechTouchEnd_(e)};a.boundHandleTechTap_=function(e){return a.handleTechTap_(e)};a.isFullscreen_=false;a.log=Z(a.id_);a.fsApi_=G;a.isPosterFromTech_=false;a.queuedCallbacks_=[];a.isReady_=false;a.hasStarted_=false;a.userActive_=false;a.debugEnabled_=false;if(!a.options_||!a.options_.techOrder||!a.options_.techOrder.length){throw new Error("No techOrder specified. Did you overwrite "+"videojs.options instead of just changing the "+"properties you want to override?")}a.tag=r;a.tagAttributes=r&&Ve(r);a.language(a.options_.language);if(i.languages){var l={};Object.getOwnPropertyNames(i.languages).forEach((function(e){l[e.toLowerCase()]=i.languages[e]}));a.languages_=l}else{a.languages_=t.prototype.options_.languages}a.resetCache_();a.poster_=i.poster||"";a.controls_=!!i.controls;r.controls=false;r.removeAttribute("controls");a.changingSrc_=false;a.playCallbacks_=[];a.playTerminatedQueue_=[];if(r.hasAttribute("autoplay")){a.autoplay(true)}else{a.autoplay(a.options_.autoplay)}if(i.plugins){Object.keys(i.plugins).forEach((function(e){if(typeof a[e]!=="function"){throw new Error('plugin "'+e+'" does not exist')}}))}a.scrubbing_=false;a.el_=a.createEl();Xt(c()(a),{eventBusKey:"el_"});if(a.fsApi_.requestFullscreen){At(s.a,a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_);a.on(a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_)}if(a.fluid_){a.on(["playerreset","resize"],a.boundUpdateStyleEl_)}var d=er(a.options_);if(i.plugins){Object.keys(i.plugins).forEach((function(e){a[e](i.plugins[e])}))}if(i.debug){a.debug(true)}a.options_.playerOptions=d;a.middleware_=[];a.playbackRates(i.playbackRates);a.initChildren();a.isAudio(r.nodeName.toLowerCase()==="audio");if(a.controls()){a.addClass("vjs-controls-enabled")}else{a.addClass("vjs-controls-disabled")}a.el_.setAttribute("role","region");if(a.isAudio()){a.el_.setAttribute("aria-label",a.localize("Audio Player"))}else{a.el_.setAttribute("aria-label",a.localize("Video Player"))}if(a.isAudio()){a.addClass("vjs-audio")}if(a.flexNotSupported_()){a.addClass("vjs-no-flex")}if(we){a.addClass("vjs-touch-enabled")}if(!Ae){a.addClass("vjs-workinghover")}t.players[a.id_]=c()(a);var f=N.split(".")[0];a.addClass("vjs-v"+f);a.userActive(true);a.reportUserActivity();a.one("play",(function(e){return a.listenForUserActivity_(e)}));a.on("stageclick",(function(e){return a.handleStageClick_(e)}));a.on("keydown",(function(e){return a.handleKeyDown(e)}));a.on("languagechange",(function(e){return a.handleLanguagechange(e)}));a.breakpoints(a.options_.breakpoints);a.responsive(a.options_.responsive);return a}var r=t.prototype;r.dispose=function r(){var i=this;this.trigger("dispose");this.off("dispose");Ct(s.a,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_);Ct(s.a,"keydown",this.boundFullWindowOnEscKey_);if(this.styleEl_&&this.styleEl_.parentNode){this.styleEl_.parentNode.removeChild(this.styleEl_);this.styleEl_=null}t.players[this.id_]=null;if(this.tag&&this.tag.player){this.tag.player=null}if(this.el_&&this.el_.player){this.el_.player=null}if(this.tech_){this.tech_.dispose();this.isPosterFromTech_=false;this.poster_=""}if(this.playerElIngest_){this.playerElIngest_=null}if(this.tag){this.tag=null}vi(this);Jr.names.forEach((function(e){var t=Jr[e];var r=i[t.getterName]();if(r&&r.off){r.off()}}));e.prototype.dispose.call(this)};r.createEl=function t(){var r=this.tag;var i;var a=this.playerElIngest_=r.parentNode&&r.parentNode.hasAttribute&&r.parentNode.hasAttribute("data-vjs-player");var o=this.tag.tagName.toLowerCase()==="video-js";if(a){i=this.el_=r.parentNode}else if(!o){i=this.el_=e.prototype.createEl.call(this,"div")}var u=Ve(r);if(o){i=this.el_=r;r=this.tag=s.a.createElement("video");while(i.children.length){r.appendChild(i.firstChild)}if(!Fe(i,"video-js")){je(i,"video-js")}i.appendChild(r);a=this.playerElIngest_=i;Object.keys(i).forEach((function(e){try{r[e]=i[e]}catch(e){}}))}r.setAttribute("tabindex","-1");u.tabindex="-1";if(be||ye&&Se){r.setAttribute("role","application");u.role="application"}r.removeAttribute("width");r.removeAttribute("height");if("width"in u){delete u.width}if("height"in u){delete u.height}Object.getOwnPropertyNames(u).forEach((function(e){if(!(o&&e==="class")){i.setAttribute(e,u[e])}if(o){r.setAttribute(e,u[e])}}));r.playerId=r.id;r.id+="_html5_api";r.className="vjs-tech";r.player=i.player=this;this.addClass("vjs-paused");if(n.a.VIDEOJS_NO_DYNAMIC_STYLE!==true){this.styleEl_=ht("vjs-styles-dimensions");var l=at(".vjs-styles-defaults");var d=at("head");d.insertBefore(this.styleEl_,l?l.nextSibling:d.firstChild)}this.fill_=false;this.fluid_=false;this.width(this.options_.width);this.height(this.options_.height);this.fill(this.options_.fill);this.fluid(this.options_.fluid);this.aspectRatio(this.options_.aspectRatio);this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);var f=r.getElementsByTagName("a");for(var c=0;c<f.length;c++){var h=f.item(c);je(h,"vjs-hidden");h.setAttribute("hidden","hidden")}r.initNetworkState_=r.networkState;if(r.parentNode&&!a){r.parentNode.insertBefore(i,r)}Be(r,i);this.children_.unshift(r);this.el_.setAttribute("lang",this.language_);this.el_.setAttribute("translate","no");this.el_=i;return i};r.crossOrigin=function e(t){if(!t){return this.techGet_("crossOrigin")}if(t!=="anonymous"&&t!=="use-credentials"){J.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+t+'"');return}this.techCall_("setCrossOrigin",t);return};r.width=function e(t){return this.dimension("width",t)};r.height=function e(t){return this.dimension("height",t)};r.dimension=function e(t,r){var i=t+"_";if(r===undefined){return this[i]||0}if(r===""||r==="auto"){this[i]=undefined;this.updateStyleEl_();return}var n=parseFloat(r);if(isNaN(n)){J.error('Improper value "'+r+'" supplied for for '+t);return}this[i]=n;this.updateStyleEl_()};r.fluid=function e(t){var r=this;if(t===undefined){return!!this.fluid_}this.fluid_=!!t;if(Ft(this)){this.off(["playerreset","resize"],this.boundUpdateStyleEl_)}if(t){this.addClass("vjs-fluid");this.fill(false);jt(this,(function(){r.on(["playerreset","resize"],r.boundUpdateStyleEl_)}))}else{this.removeClass("vjs-fluid")}this.updateStyleEl_()};r.fill=function e(t){if(t===undefined){return!!this.fill_}this.fill_=!!t;if(t){this.addClass("vjs-fill");this.fluid(false)}else{this.removeClass("vjs-fill")}};r.aspectRatio=function e(t){if(t===undefined){return this.aspectRatio_}if(!/^\d+\:\d+$/.test(t)){throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.")}this.aspectRatio_=t;this.fluid(true);this.updateStyleEl_()};r.updateStyleEl_=function e(){if(n.a.VIDEOJS_NO_DYNAMIC_STYLE===true){var t=typeof this.width_==="number"?this.width_:this.options_.width;var r=typeof this.height_==="number"?this.height_:this.options_.height;var i=this.tech_&&this.tech_.el();if(i){if(t>=0){i.width=t}if(r>=0){i.height=r}}return}var a;var s;var o;var u;if(this.aspectRatio_!==undefined&&this.aspectRatio_!=="auto"){o=this.aspectRatio_}else if(this.videoWidth()>0){o=this.videoWidth()+":"+this.videoHeight()}else{o="16:9"}var l=o.split(":");var d=l[1]/l[0];if(this.width_!==undefined){a=this.width_}else if(this.height_!==undefined){a=this.height_/d}else{a=this.videoWidth()||300}if(this.height_!==undefined){s=this.height_}else{s=a*d}if(/^[^a-zA-Z]/.test(this.id())){u="dimensions-"+this.id()}else{u=this.id()+"-dimensions"}this.addClass(u);pt(this.styleEl_,"\n      ."+u+" {\n        width: "+a+"px;\n        height: "+s+"px;\n      }\n\n      ."+u+".vjs-fluid {\n        padding-top: "+d*100+"%;\n      }\n    ")};r.loadTech_=function e(t,r){var i=this;if(this.tech_){this.unloadTech_()}var n=Jt(t);var a=t.charAt(0).toLowerCase()+t.slice(1);if(n!=="Html5"&&this.tag){ei.getTech("Html5").disposeMediaElement(this.tag);this.tag.player=null;this.tag=null}this.techName_=n;this.isReady_=false;var s=this.autoplay();if(typeof this.autoplay()==="string"||this.autoplay()===true&&this.options_.normalizeAutoplay){s=false}var o={source:r,autoplay:s,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+a+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||false,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};Jr.names.forEach((function(e){var t=Jr[e];o[t.getterName]=i[t.privateName]}));ne(o,this.options_[n]);ne(o,this.options_[a]);ne(o,this.options_[t.toLowerCase()]);if(this.tag){o.tag=this.tag}if(r&&r.src===this.cache_.src&&this.cache_.currentTime>0){o.startTime=this.cache_.currentTime}var u=ei.getTech(t);if(!u){throw new Error("No Tech named '"+n+"' exists! '"+n+"' should be registered using videojs.registerTech()'")}this.tech_=new u(o);this.tech_.ready(Pt(this,this.handleTechReady_),true);yr.jsonToTextTracks(this.textTracksJson_||[],this.tech_);_a.forEach((function(e){i.on(i.tech_,e,(function(t){return i["handleTech"+Jt(e)+"_"](t)}))}));Object.keys(ba).forEach((function(e){i.on(i.tech_,e,(function(t){if(i.tech_.playbackRate()===0&&i.tech_.seeking()){i.queuedCallbacks_.push({callback:i["handleTech"+ba[e]+"_"].bind(i),event:t});return}i["handleTech"+ba[e]+"_"](t)}))}));this.on(this.tech_,"loadstart",(function(e){return i.handleTechLoadStart_(e)}));this.on(this.tech_,"sourceset",(function(e){return i.handleTechSourceset_(e)}));this.on(this.tech_,"waiting",(function(e){return i.handleTechWaiting_(e)}));this.on(this.tech_,"ended",(function(e){return i.handleTechEnded_(e)}));this.on(this.tech_,"seeking",(function(e){return i.handleTechSeeking_(e)}));this.on(this.tech_,"play",(function(e){return i.handleTechPlay_(e)}));this.on(this.tech_,"firstplay",(function(e){return i.handleTechFirstPlay_(e)}));this.on(this.tech_,"pause",(function(e){return i.handleTechPause_(e)}));this.on(this.tech_,"durationchange",(function(e){return i.handleTechDurationChange_(e)}));this.on(this.tech_,"fullscreenchange",(function(e,t){return i.handleTechFullscreenChange_(e,t)}));this.on(this.tech_,"fullscreenerror",(function(e,t){return i.handleTechFullscreenError_(e,t)}));this.on(this.tech_,"enterpictureinpicture",(function(e){return i.handleTechEnterPictureInPicture_(e)}));this.on(this.tech_,"leavepictureinpicture",(function(e){return i.handleTechLeavePictureInPicture_(e)}));this.on(this.tech_,"error",(function(e){return i.handleTechError_(e)}));this.on(this.tech_,"posterchange",(function(e){return i.handleTechPosterChange_(e)}));this.on(this.tech_,"textdata",(function(e){return i.handleTechTextData_(e)}));this.on(this.tech_,"ratechange",(function(e){return i.handleTechRateChange_(e)}));this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_);this.usingNativeControls(this.techGet_("controls"));if(this.controls()&&!this.usingNativeControls()){this.addTechControlsListeners_()}if(this.tech_.el().parentNode!==this.el()&&(n!=="Html5"||!this.tag)){Be(this.tech_.el(),this.el())}if(this.tag){this.tag.player=null;this.tag=null}};r.unloadTech_=function e(){var t=this;Jr.names.forEach((function(e){var r=Jr[e];t[r.privateName]=t[r.getterName]()}));this.textTracksJson_=yr.textTracksToJson(this.tech_);this.isReady_=false;this.tech_.dispose();this.tech_=false;if(this.isPosterFromTech_){this.poster_="";this.trigger("posterchange")}this.isPosterFromTech_=false};r.tech=function e(t){if(t===undefined){J.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\n"+"See https://github.com/videojs/video.js/issues/2617 for more info.\n")}return this.tech_};r.addTechControlsListeners_=function e(){this.removeTechControlsListeners_();this.on(this.tech_,"click",this.boundHandleTechClick_);this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_);this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_);this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_);this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_);this.on(this.tech_,"tap",this.boundHandleTechTap_)};r.removeTechControlsListeners_=function e(){this.off(this.tech_,"tap",this.boundHandleTechTap_);this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_);this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_);this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_);this.off(this.tech_,"click",this.boundHandleTechClick_);this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)};r.handleTechReady_=function e(){this.triggerReady();if(this.cache_.volume){this.techCall_("setVolume",this.cache_.volume)}this.handleTechPosterChange_();this.handleTechDurationChange_()};r.handleTechLoadStart_=function e(){this.removeClass("vjs-ended");this.removeClass("vjs-seeking");this.error(null);this.handleTechDurationChange_();if(!this.paused()){this.trigger("loadstart");this.trigger("firstplay")}else{this.hasStarted(false);this.trigger("loadstart")}this.manualAutoplay_(this.autoplay()===true&&this.options_.normalizeAutoplay?"play":this.autoplay())};r.manualAutoplay_=function e(t){var r=this;if(!this.tech_||typeof t!=="string"){return}var i=function e(){var t=r.muted();r.muted(true);var i=function e(){r.muted(t)};r.playTerminatedQueue_.push(i);var n=r.play();if(!hr(n)){return}return n["catch"]((function(e){i();throw new Error("Rejection at manualAutoplay. Restoring muted value. "+(e?e:""))}))};var n;if(t==="any"&&!this.muted()){n=this.play();if(hr(n)){n=n["catch"](i)}}else if(t==="muted"&&!this.muted()){n=i()}else{n=this.play()}if(!hr(n)){return}return n.then((function(){r.trigger({type:"autoplay-success",autoplay:t})}))["catch"]((function(){r.trigger({type:"autoplay-failure",autoplay:t})}))};r.updateSourceCaches_=function e(t){if(t===void 0){t=""}var r=t;var i="";if(typeof r!=="string"){r=t.src;i=t.type}this.cache_.source=this.cache_.source||{};this.cache_.sources=this.cache_.sources||[];if(r&&!i){i=bi(this,r)}this.cache_.source=er({},t,{src:r,type:i});var n=this.cache_.sources.filter((function(e){return e.src&&e.src===r}));var a=[];var s=this.$$("source");var o=[];for(var u=0;u<s.length;u++){var l=Ve(s[u]);a.push(l);if(l.src&&l.src===r){o.push(l.src)}}if(o.length&&!n.length){this.cache_.sources=a}else if(!n.length){this.cache_.sources=[this.cache_.source]}this.cache_.src=r};r.handleTechSourceset_=function e(t){var r=this;if(!this.changingSrc_){var i=function e(t){return r.updateSourceCaches_(t)};var n=this.currentSource().src;var a=t.src;if(n&&!/^blob:/.test(n)&&/^blob:/.test(a)){if(!this.lastSource_||this.lastSource_.tech!==a&&this.lastSource_.player!==n){i=function e(){}}}i(a);if(!t.src){this.tech_.any(["sourceset","loadstart"],(function(e){if(e.type==="sourceset"){return}var t=r.techGet("currentSrc");r.lastSource_.tech=t;r.updateSourceCaches_(t)}))}}this.lastSource_={player:this.currentSource().src,tech:t.src};this.trigger({src:t.src,type:"sourceset"})};r.hasStarted=function e(t){if(t===undefined){return this.hasStarted_}if(t===this.hasStarted_){return}this.hasStarted_=t;if(this.hasStarted_){this.addClass("vjs-has-started");this.trigger("firstplay")}else{this.removeClass("vjs-has-started")}};r.handleTechPlay_=function e(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.hasStarted(true);this.trigger("play")};r.handleTechRateChange_=function e(){if(this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0){this.queuedCallbacks_.forEach((function(e){return e.callback(e.event)}));this.queuedCallbacks_=[]}this.cache_.lastPlaybackRate=this.tech_.playbackRate();this.trigger("ratechange")};r.handleTechWaiting_=function e(){var t=this;this.addClass("vjs-waiting");this.trigger("waiting");var r=this.currentTime();var i=function e(){if(r!==t.currentTime()){t.removeClass("vjs-waiting");t.off("timeupdate",e)}};this.on("timeupdate",i)};r.handleTechCanPlay_=function e(){this.removeClass("vjs-waiting");this.trigger("canplay")};r.handleTechCanPlayThrough_=function e(){this.removeClass("vjs-waiting");this.trigger("canplaythrough")};r.handleTechPlaying_=function e(){this.removeClass("vjs-waiting");this.trigger("playing")};r.handleTechSeeking_=function e(){this.addClass("vjs-seeking");this.trigger("seeking")};r.handleTechSeeked_=function e(){this.removeClass("vjs-seeking");this.removeClass("vjs-ended");this.trigger("seeked")};r.handleTechFirstPlay_=function e(){if(this.options_.starttime){J.warn("Passing the `starttime` option to the player will be deprecated in 6.0");this.currentTime(this.options_.starttime)}this.addClass("vjs-has-started");this.trigger("firstplay")};r.handleTechPause_=function e(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.trigger("pause")};r.handleTechEnded_=function e(){this.addClass("vjs-ended");this.removeClass("vjs-waiting");if(this.options_.loop){this.currentTime(0);this.play()}else if(!this.paused()){this.pause()}this.trigger("ended")};r.handleTechDurationChange_=function e(){this.duration(this.techGet_("duration"))};r.handleTechClick_=function e(t){if(!this.controls_){return}if(this.options_===undefined||this.options_.userActions===undefined||this.options_.userActions.click===undefined||this.options_.userActions.click!==false){if(this.options_!==undefined&&this.options_.userActions!==undefined&&typeof this.options_.userActions.click==="function"){this.options_.userActions.click.call(this,t)}else if(this.paused()){pr(this.play())}else{this.pause()}}};r.handleTechDoubleClick_=function e(t){if(!this.controls_){return}var r=Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),(function(e){return e.contains(t.target)}));if(!r){if(this.options_===undefined||this.options_.userActions===undefined||this.options_.userActions.doubleClick===undefined||this.options_.userActions.doubleClick!==false){if(this.options_!==undefined&&this.options_.userActions!==undefined&&typeof this.options_.userActions.doubleClick==="function"){this.options_.userActions.doubleClick.call(this,t)}else if(this.isFullscreen()){this.exitFullscreen()}else{this.requestFullscreen()}}}};r.handleTechTap_=function e(){this.userActive(!this.userActive())};r.handleTechTouchStart_=function e(){this.userWasActive=this.userActive()};r.handleTechTouchMove_=function e(){if(this.userWasActive){this.reportUserActivity()}};r.handleTechTouchEnd_=function e(t){if(t.cancelable){t.preventDefault()}};r.handleStageClick_=function e(){this.reportUserActivity()};r.toggleFullscreenClass_=function e(){if(this.isFullscreen()){this.addClass("vjs-fullscreen")}else{this.removeClass("vjs-fullscreen")}};r.documentFullscreenChange_=function e(t){var r=t.target.player;if(r&&r!==this){return}var i=this.el();var n=s.a[this.fsApi_.fullscreenElement]===i;if(!n&&i.matches){n=i.matches(":"+this.fsApi_.fullscreen)}else if(!n&&i.msMatchesSelector){n=i.msMatchesSelector(":"+this.fsApi_.fullscreen)}this.isFullscreen(n)};r.handleTechFullscreenChange_=function e(t,r){var i=this;if(r){if(r.nativeIOSFullscreen){this.addClass("vjs-ios-native-fs");this.tech_.one("webkitendfullscreen",(function(){i.removeClass("vjs-ios-native-fs")}))}this.isFullscreen(r.isFullscreen)}};r.handleTechFullscreenError_=function e(t,r){this.trigger("fullscreenerror",r)};r.togglePictureInPictureClass_=function e(){if(this.isInPictureInPicture()){this.addClass("vjs-picture-in-picture")}else{this.removeClass("vjs-picture-in-picture")}};r.handleTechEnterPictureInPicture_=function e(t){this.isInPictureInPicture(true)};r.handleTechLeavePictureInPicture_=function e(t){this.isInPictureInPicture(false)};r.handleTechError_=function e(){var t=this.tech_.error();this.error(t)};r.handleTechTextData_=function e(){var t=null;if(arguments.length>1){t=arguments[1]}this.trigger("textdata",t)};r.getCache=function e(){return this.cache_};r.resetCache_=function e(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}};r.techCall_=function e(t,r){this.ready((function(){if(t in fi){return ui(this.middleware_,this.tech_,t,r)}else if(t in ci){return li(this.middleware_,this.tech_,t,r)}try{if(this.tech_){this.tech_[t](r)}}catch(e){J(e);throw e}}),true)};r.techGet_=function e(t){if(!this.tech_||!this.tech_.isReady_){return}if(t in di){return oi(this.middleware_,this.tech_,t)}else if(t in ci){return li(this.middleware_,this.tech_,t)}try{return this.tech_[t]()}catch(e){if(this.tech_[t]===undefined){J("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e);throw e}if(e.name==="TypeError"){J("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e);this.tech_.isReady_=false;throw e}J(e);throw e}};r.play=function e(){var t=this;var r=this.options_.Promise||n.a.Promise;if(r){return new r((function(e){t.play_(e)}))}return this.play_()};r.play_=function e(t){var r=this;if(t===void 0){t=pr}this.playCallbacks_.push(t);var i=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_){this.off(["ready","loadstart"],this.waitToPlay_);this.waitToPlay_=null}if(!this.isReady_||!i){this.waitToPlay_=function(e){r.play_()};this.one(["ready","loadstart"],this.waitToPlay_);if(!i&&(Ce||Ae)){this.load()}return}var n=this.techGet_("play");if(n===null){this.runPlayTerminatedQueue_()}else{this.runPlayCallbacks_(n)}};r.runPlayTerminatedQueue_=function e(){var t=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[];t.forEach((function(e){e()}))};r.runPlayCallbacks_=function e(t){var r=this.playCallbacks_.slice(0);this.playCallbacks_=[];this.playTerminatedQueue_=[];r.forEach((function(e){e(t)}))};r.pause=function e(){this.techCall_("pause")};r.paused=function e(){return this.techGet_("paused")===false?false:true};r.played=function e(){return this.techGet_("played")||lr(0,0)};r.scrubbing=function e(t){if(typeof t==="undefined"){return this.scrubbing_}this.scrubbing_=!!t;this.techCall_("setScrubbing",this.scrubbing_);if(t){this.addClass("vjs-scrubbing")}else{this.removeClass("vjs-scrubbing")}};r.currentTime=function e(t){if(typeof t!=="undefined"){if(t<0){t=0}if(!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=t;this.off("canplay",this.boundApplyInitTime_);this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",t);this.cache_.initTime=0;return}this.cache_.currentTime=this.techGet_("currentTime")||0;return this.cache_.currentTime};r.applyInitTime_=function e(){this.currentTime(this.cache_.initTime)};r.duration=function e(t){if(t===undefined){return this.cache_.duration!==undefined?this.cache_.duration:NaN}t=parseFloat(t);if(t<0){t=Infinity}if(t!==this.cache_.duration){this.cache_.duration=t;if(t===Infinity){this.addClass("vjs-live")}else{this.removeClass("vjs-live")}if(!isNaN(t)){this.trigger("durationchange")}}};r.remainingTime=function e(){return this.duration()-this.currentTime()};r.remainingTimeDisplay=function e(){return Math.floor(this.duration())-Math.floor(this.currentTime())};r.buffered=function e(){var e=this.techGet_("buffered");if(!e||!e.length){e=lr(0,0)}return e};r.bufferedPercent=function e(){return dr(this.buffered(),this.duration())};r.bufferedEnd=function e(){var t=this.buffered();var r=this.duration();var i=t.end(t.length-1);if(i>r){i=r}return i};r.volume=function e(t){var r;if(t!==undefined){r=Math.max(0,Math.min(1,parseFloat(t)));this.cache_.volume=r;this.techCall_("setVolume",r);if(r>0){this.lastVolume_(r)}return}r=parseFloat(this.techGet_("volume"));return isNaN(r)?1:r};r.muted=function e(t){if(t!==undefined){this.techCall_("setMuted",t);return}return this.techGet_("muted")||false};r.defaultMuted=function e(t){if(t!==undefined){return this.techCall_("setDefaultMuted",t)}return this.techGet_("defaultMuted")||false};r.lastVolume_=function e(t){if(t!==undefined&&t!==0){this.cache_.lastVolume=t;return}return this.cache_.lastVolume};r.supportsFullScreen=function e(){return this.techGet_("supportsFullScreen")||false};r.isFullscreen=function e(t){if(t!==undefined){var r=this.isFullscreen_;this.isFullscreen_=Boolean(t);if(this.isFullscreen_!==r&&this.fsApi_.prefixed){this.trigger("fullscreenchange")}this.toggleFullscreenClass_();return}return this.isFullscreen_};r.requestFullscreen=function e(t){var r=this.options_.Promise||n.a.Promise;if(r){var i=this;return new r((function(e,r){function n(){i.off("fullscreenerror",s);i.off("fullscreenchange",a)}function a(){n();e()}function s(e,t){n();r(t)}i.one("fullscreenchange",a);i.one("fullscreenerror",s);var o=i.requestFullscreenHelper_(t);if(o){o.then(n,n);o.then(e,r)}}))}return this.requestFullscreenHelper_()};r.requestFullscreenHelper_=function e(t){var r=this;var i;if(!this.fsApi_.prefixed){i=this.options_.fullscreen&&this.options_.fullscreen.options||{};if(t!==undefined){i=t}}if(this.fsApi_.requestFullscreen){var n=this.el_[this.fsApi_.requestFullscreen](i);if(n){n.then((function(){return r.isFullscreen(true)}),(function(){return r.isFullscreen(false)}))}return n}else if(this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow===true){this.techCall_("enterFullScreen")}else{this.enterFullWindow()}};r.exitFullscreen=function e(){var t=this.options_.Promise||n.a.Promise;if(t){var r=this;return new t((function(e,t){function i(){r.off("fullscreenerror",a);r.off("fullscreenchange",n)}function n(){i();e()}function a(e,r){i();t(r)}r.one("fullscreenchange",n);r.one("fullscreenerror",a);var s=r.exitFullscreenHelper_();if(s){s.then(i,i);s.then(e,t)}}))}return this.exitFullscreenHelper_()};r.exitFullscreenHelper_=function e(){var t=this;if(this.fsApi_.requestFullscreen){var r=s.a[this.fsApi_.exitFullscreen]();if(r){pr(r.then((function(){return t.isFullscreen(false)})))}return r}else if(this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow===true){this.techCall_("exitFullScreen")}else{this.exitFullWindow()}};r.enterFullWindow=function e(){this.isFullscreen(true);this.isFullWindow=true;this.docOrigOverflow=s.a.documentElement.style.overflow;At(s.a,"keydown",this.boundFullWindowOnEscKey_);s.a.documentElement.style.overflow="hidden";je(s.a.body,"vjs-full-window");this.trigger("enterFullWindow")};r.fullWindowOnEscKey=function e(t){if(d.a.isEventKey(t,"Esc")){if(this.isFullscreen()===true){if(!this.isFullWindow){this.exitFullscreen()}else{this.exitFullWindow()}}}};r.exitFullWindow=function e(){this.isFullscreen(false);this.isFullWindow=false;Ct(s.a,"keydown",this.boundFullWindowOnEscKey_);s.a.documentElement.style.overflow=this.docOrigOverflow;qe(s.a.body,"vjs-full-window");this.trigger("exitFullWindow")};r.disablePictureInPicture=function e(t){if(t===undefined){return this.techGet_("disablePictureInPicture")}this.techCall_("setDisablePictureInPicture",t);this.options_.disablePictureInPicture=t;this.trigger("disablepictureinpicturechanged")};r.isInPictureInPicture=function e(t){if(t!==undefined){this.isInPictureInPicture_=!!t;this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_};r.requestPictureInPicture=function e(){if("pictureInPictureEnabled"in s.a&&this.disablePictureInPicture()===false){return this.techGet_("requestPictureInPicture")}};r.exitPictureInPicture=function e(){if("pictureInPictureEnabled"in s.a){return s.a.exitPictureInPicture()}};r.handleKeyDown=function e(t){var r=this.options_.userActions;if(!r||!r.hotkeys){return}var i=function e(t){var r=t.tagName.toLowerCase();if(t.isContentEditable){return true}var i=["button","checkbox","hidden","radio","reset","submit"];if(r==="input"){return i.indexOf(t.type)===-1}var n=["textarea"];return n.indexOf(r)!==-1};if(i(this.el_.ownerDocument.activeElement)){return}if(typeof r.hotkeys==="function"){r.hotkeys.call(this,t)}else{this.handleHotkeys(t)}};r.handleHotkeys=function e(t){var r=this.options_.userActions?this.options_.userActions.hotkeys:{};var i=r.fullscreenKey,n=i===void 0?function(e){return d.a.isEventKey(e,"f")}:i,a=r.muteKey,o=a===void 0?function(e){return d.a.isEventKey(e,"m")}:a,u=r.playPauseKey,l=u===void 0?function(e){return d.a.isEventKey(e,"k")||d.a.isEventKey(e,"Space")}:u;if(n.call(this,t)){t.preventDefault();t.stopPropagation();var f=ar.getComponent("FullscreenToggle");if(s.a[this.fsApi_.fullscreenEnabled]!==false){f.prototype.handleClick.call(this,t)}}else if(o.call(this,t)){t.preventDefault();t.stopPropagation();var c=ar.getComponent("MuteToggle");c.prototype.handleClick.call(this,t)}else if(l.call(this,t)){t.preventDefault();t.stopPropagation();var h=ar.getComponent("PlayToggle");h.prototype.handleClick.call(this,t)}};r.canPlayType=function e(t){var r;for(var i=0,n=this.options_.techOrder;i<n.length;i++){var a=n[i];var s=ei.getTech(a);if(!s){s=ar.getComponent(a)}if(!s){J.error('The "'+a+'" tech is undefined. Skipped browser support check for that tech.');continue}if(s.isSupported()){r=s.canPlayType(t);if(r){return r}}}return""};r.selectSource=function e(t){var r=this;var i=this.options_.techOrder.map((function(e){return[e,ei.getTech(e)]})).filter((function(e){var t=e[0],r=e[1];if(r){return r.isSupported()}J.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.');return false}));var n=function e(t,r,i){var n;t.some((function(e){return r.some((function(t){n=i(e,t);if(n){return true}}))}));return n};var a;var s=function e(t){return function(e,r){return t(r,e)}};var o=function e(t,i){var n=t[0],a=t[1];if(a.canPlaySource(i,r.options_[n.toLowerCase()])){return{source:i,tech:n}}};if(this.options_.sourceOrder){a=n(t,i,s(o))}else{a=n(i,t,o)}return a||false};r.handleSrc_=function e(t,r){var i=this;if(typeof t==="undefined"){return this.cache_.src||""}if(this.resetRetryOnError_){this.resetRetryOnError_()}var n=Ti(t);if(!n.length){this.setTimeout((function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})}),0);return}this.changingSrc_=true;if(!r){this.cache_.sources=n}this.updateSourceCaches_(n[0]);ai(this,n[0],(function(e,t){i.middleware_=t;if(!r){i.cache_.sources=n}i.updateSourceCaches_(e);var a=i.src_(e);if(a){if(n.length>1){return i.handleSrc_(n.slice(1))}i.changingSrc_=false;i.setTimeout((function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})}),0);i.triggerReady();return}si(t,i.tech_)}));if(this.options_.retryOnError&&n.length>1){var a=function e(){i.error(null);i.handleSrc_(n.slice(1),true)};var s=function e(){i.off("error",a)};this.one("error",a);this.one("playing",s);this.resetRetryOnError_=function(){i.off("error",a);i.off("playing",s)}}};r.src=function e(t){return this.handleSrc_(t,false)};r.src_=function e(t){var r=this;var i=this.selectSource([t]);if(!i){return true}if(!Zt(i.tech,this.techName_)){this.changingSrc_=true;this.loadTech_(i.tech,i.source);this.tech_.ready((function(){r.changingSrc_=false}));return false}this.ready((function(){if(this.tech_.constructor.prototype.hasOwnProperty("setSource")){this.techCall_("setSource",t)}else{this.techCall_("src",t.src)}this.changingSrc_=false}),true);return false};r.load=function e(){this.techCall_("load")};r.reset=function e(){var t=this;var r=this.options_.Promise||n.a.Promise;if(this.paused()||!r){this.doReset_()}else{var i=this.play();pr(i.then((function(){return t.doReset_()})))}};r.doReset_=function e(){if(this.tech_){this.tech_.clearTracks("text")}this.resetCache_();this.poster("");this.loadTech_(this.options_.techOrder[0],null);this.techCall_("reset");this.resetControlBarUI_();if(Ft(this)){this.trigger("playerreset")}};r.resetControlBarUI_=function e(){this.resetProgressBar_();this.resetPlaybackRate_();this.resetVolumeBar_()};r.resetProgressBar_=function e(){this.currentTime(0);var t=this.controlBar,r=t.durationDisplay,i=t.remainingTimeDisplay;if(r){r.updateContent()}if(i){i.updateContent()}};r.resetPlaybackRate_=function e(){this.playbackRate(this.defaultPlaybackRate());this.handleTechRateChange_()};r.resetVolumeBar_=function e(){this.volume(1);this.trigger("volumechange")};r.currentSources=function e(){var t=this.currentSource();var r=[];if(Object.keys(t).length!==0){r.push(t)}return this.cache_.sources||r};r.currentSource=function e(){return this.cache_.source||{}};r.currentSrc=function e(){return this.currentSource()&&this.currentSource().src||""};r.currentType=function e(){return this.currentSource()&&this.currentSource().type||""};r.preload=function e(t){if(t!==undefined){this.techCall_("setPreload",t);this.options_.preload=t;return}return this.techGet_("preload")};r.autoplay=function e(t){if(t===undefined){return this.options_.autoplay||false}var r;if(typeof t==="string"&&/(any|play|muted)/.test(t)||t===true&&this.options_.normalizeAutoplay){this.options_.autoplay=t;this.manualAutoplay_(typeof t==="string"?t:"play");r=false}else if(!t){this.options_.autoplay=false}else{this.options_.autoplay=true}r=typeof r==="undefined"?this.options_.autoplay:r;if(this.tech_){this.techCall_("setAutoplay",r)}};r.playsinline=function e(t){if(t!==undefined){this.techCall_("setPlaysinline",t);this.options_.playsinline=t;return this}return this.techGet_("playsinline")};r.loop=function e(t){if(t!==undefined){this.techCall_("setLoop",t);this.options_.loop=t;return}return this.techGet_("loop")};r.poster=function e(t){if(t===undefined){return this.poster_}if(!t){t=""}if(t===this.poster_){return}this.poster_=t;this.techCall_("setPoster",t);this.isPosterFromTech_=false;this.trigger("posterchange")};r.handleTechPosterChange_=function e(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var t=this.tech_.poster()||"";if(t!==this.poster_){this.poster_=t;this.isPosterFromTech_=true;this.trigger("posterchange")}}};r.controls=function e(t){if(t===undefined){return!!this.controls_}t=!!t;if(this.controls_===t){return}this.controls_=t;if(this.usingNativeControls()){this.techCall_("setControls",t)}if(this.controls_){this.removeClass("vjs-controls-disabled");this.addClass("vjs-controls-enabled");this.trigger("controlsenabled");if(!this.usingNativeControls()){this.addTechControlsListeners_()}}else{this.removeClass("vjs-controls-enabled");this.addClass("vjs-controls-disabled");this.trigger("controlsdisabled");if(!this.usingNativeControls()){this.removeTechControlsListeners_()}}};r.usingNativeControls=function e(t){if(t===undefined){return!!this.usingNativeControls_}t=!!t;if(this.usingNativeControls_===t){return}this.usingNativeControls_=t;if(this.usingNativeControls_){this.addClass("vjs-using-native-controls");this.trigger("usingnativecontrols")}else{this.removeClass("vjs-using-native-controls");this.trigger("usingcustomcontrols")}};r.error=function e(t){var r=this;if(t===undefined){return this.error_||null}F("beforeerror").forEach((function(e){var i=e(r,t);if(!(ae(i)&&!Array.isArray(i)||typeof i==="string"||typeof i==="number"||i===null)){r.log.error("please return a value that MediaError expects in beforeerror hooks");return}t=i}));if(this.options_.suppressNotSupportedError&&t&&t.code===4){var i=function e(){this.error(t)};this.options_.suppressNotSupportedError=false;this.any(["click","touchstart"],i);this.one("loadstart",(function(){this.off(["click","touchstart"],i)}));return}if(t===null){this.error_=t;this.removeClass("vjs-error");if(this.errorDisplay){this.errorDisplay.close()}return}this.error_=new fr(t);this.addClass("vjs-error");J.error("(CODE:"+this.error_.code+" "+fr.errorTypes[this.error_.code]+")",this.error_.message,this.error_);this.trigger("error");F("error").forEach((function(e){return e(r,r.error_)}));return};r.reportUserActivity=function e(t){this.userActivity_=true};r.userActive=function e(t){if(t===undefined){return this.userActive_}t=!!t;if(t===this.userActive_){return}this.userActive_=t;if(this.userActive_){this.userActivity_=true;this.removeClass("vjs-user-inactive");this.addClass("vjs-user-active");this.trigger("useractive");return}if(this.tech_){this.tech_.one("mousemove",(function(e){e.stopPropagation();e.preventDefault()}))}this.userActivity_=false;this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");this.trigger("userinactive")};r.listenForUserActivity_=function e(){var t;var r;var i;var n=Pt(this,this.reportUserActivity);var a=function e(t){if(t.screenX!==r||t.screenY!==i){r=t.screenX;i=t.screenY;n()}};var s=function e(){n();this.clearInterval(t);t=this.setInterval(n,250)};var o=function e(r){n();this.clearInterval(t)};this.on("mousedown",s);this.on("mousemove",a);this.on("mouseup",o);this.on("mouseleave",o);var u=this.getChild("controlBar");if(u&&!Ae&&!he){u.on("mouseenter",(function(e){if(this.player().options_.inactivityTimeout!==0){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout}this.player().options_.inactivityTimeout=0}));u.on("mouseleave",(function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout}))}this.on("keydown",n);this.on("keyup",n);var l;this.setInterval((function(){if(!this.userActivity_){return}this.userActivity_=false;this.userActive(true);this.clearTimeout(l);var e=this.options_.inactivityTimeout;if(e<=0){return}l=this.setTimeout((function(){if(!this.userActivity_){this.userActive(false)}}),e)}),250)};r.playbackRate=function e(t){if(t!==undefined){this.techCall_("setPlaybackRate",t);return}if(this.tech_&&this.tech_.featuresPlaybackRate){return this.cache_.lastPlaybackRate||this.techGet_("playbackRate")}return 1};r.defaultPlaybackRate=function e(t){if(t!==undefined){return this.techCall_("setDefaultPlaybackRate",t)}if(this.tech_&&this.tech_.featuresPlaybackRate){return this.techGet_("defaultPlaybackRate")}return 1};r.isAudio=function e(t){if(t!==undefined){this.isAudio_=!!t;return}return!!this.isAudio_};r.addTextTrack=function e(t,r,i){if(this.tech_){return this.tech_.addTextTrack(t,r,i)}};r.addRemoteTextTrack=function e(t,r){if(this.tech_){return this.tech_.addRemoteTextTrack(t,r)}};r.removeRemoteTextTrack=function e(t){if(t===void 0){t={}}var r=t,i=r.track;if(!i){i=t}if(this.tech_){return this.tech_.removeRemoteTextTrack(i)}};r.getVideoPlaybackQuality=function e(){return this.techGet_("getVideoPlaybackQuality")};r.videoWidth=function e(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0};r.videoHeight=function e(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0};r.language=function e(t){if(t===undefined){return this.language_}if(this.language_!==String(t).toLowerCase()){this.language_=String(t).toLowerCase();if(Ft(this)){this.trigger("languagechange")}}};r.languages=function e(){return er(t.prototype.options_.languages,this.languages_)};r.toJSON=function e(){var t=er(this.options_);var r=t.tracks;t.tracks=[];for(var i=0;i<r.length;i++){var n=r[i];n=er(n);n.player=undefined;t.tracks[i]=n}return t};r.createModal=function e(t,r){var i=this;r=r||{};r.content=t||"";var n=new br(this,r);this.addChild(n);n.on("dispose",(function(){i.removeChild(n)}));n.open();return n};r.updateCurrentBreakpoint_=function e(){if(!this.responsive()){return}var t=this.currentBreakpoint();var r=this.currentWidth();for(var i=0;i<Ta.length;i++){var n=Ta[i];var a=this.breakpoints_[n];if(r<=a){if(t===n){return}if(t){this.removeClass(Sa[t])}this.addClass(Sa[n]);this.breakpoint_=n;break}}};r.removeCurrentBreakpoint_=function e(){var t=this.currentBreakpointClass();this.breakpoint_="";if(t){this.removeClass(t)}};r.breakpoints=function e(t){if(t===undefined){return ne(this.breakpoints_)}this.breakpoint_="";this.breakpoints_=ne({},wa,t);this.updateCurrentBreakpoint_();return ne(this.breakpoints_)};r.responsive=function e(t){if(t===undefined){return this.responsive_}t=Boolean(t);var r=this.responsive_;if(t===r){return}this.responsive_=t;if(t){this.on("playerresize",this.boundUpdateCurrentBreakpoint_);this.updateCurrentBreakpoint_()}else{this.off("playerresize",this.boundUpdateCurrentBreakpoint_);this.removeCurrentBreakpoint_()}return t};r.currentBreakpoint=function e(){return this.breakpoint_};r.currentBreakpointClass=function e(){return Sa[this.breakpoint_]||""};r.loadMedia=function e(t,r){var i=this;if(!t||typeof t!=="object"){return}this.reset();this.cache_.media=er(t);var n=this.cache_.media,a=n.artwork,s=n.poster,o=n.src,u=n.textTracks;if(!a&&s){this.cache_.media.artwork=[{src:s,type:_i(s)}]}if(o){this.src(o)}if(s){this.poster(s)}if(Array.isArray(u)){u.forEach((function(e){return i.addRemoteTextTrack(e,false)}))}this.ready(r)};r.getMedia=function e(){if(!this.cache_.media){var t=this.poster();var r=this.currentSources();var i=Array.prototype.map.call(this.remoteTextTracks(),(function(e){return{kind:e.kind,label:e.label,language:e.language,src:e.src}}));var n={src:r,textTracks:i};if(t){n.poster=t;n.artwork=[{src:n.poster,type:_i(n.poster)}]}return n}return er(this.cache_.media)};t.getTagSettings=function e(t){var r={sources:[],tracks:[]};var i=Ve(t);var n=i["data-setup"];if(Fe(t,"vjs-fill")){i.fill=true}if(Fe(t,"vjs-fluid")){i.fluid=true}if(n!==null){var a=m()(n||"{}"),s=a[0],o=a[1];if(s){J.error(s)}ne(i,o)}ne(r,i);if(t.hasChildNodes()){var u=t.childNodes;for(var l=0,d=u.length;l<d;l++){var f=u[l];var c=f.nodeName.toLowerCase();if(c==="source"){r.sources.push(Ve(f))}else if(c==="track"){r.tracks.push(Ve(f))}}}return r};r.flexNotSupported_=function e(){var t=s.a.createElement("i");return!("flexBasis"in t.style||"webkitFlexBasis"in t.style||"mozFlexBasis"in t.style||"msFlexBasis"in t.style||"msFlexOrder"in t.style)};r.debug=function e(t){if(t===undefined){return this.debugEnabled_}if(t){this.trigger("debugon");this.previousLogLevel_=this.log.level;this.log.level("debug");this.debugEnabled_=true}else{this.trigger("debugoff");this.log.level(this.previousLogLevel_);this.previousLogLevel_=undefined;this.debugEnabled_=false}};r.playbackRates=function e(t){if(t===undefined){return this.cache_.playbackRates}if(!Array.isArray(t)){return}if(!t.every((function(e){return typeof e==="number"}))){return}this.cache_.playbackRates=t;this.trigger("playbackrateschange")};return t}(ar);Jr.names.forEach((function(e){var t=Jr[e];Ea.prototype[t.getterName]=function(){if(this.tech_){return this.tech_[t.getterName]()}this[t.privateName]=this[t.privateName]||new t.ListClass;return this[t.privateName]}}));Ea.prototype.crossorigin=Ea.prototype.crossOrigin;Ea.players={};var ka=n.a.navigator;Ea.prototype.options_={techOrder:ei.defaultTechOrder_,html5:{},inactivityTimeout:2e3,playbackRates:[],liveui:false,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:ka&&(ka.languages&&ka.languages[0]||ka.userLanguage||ka.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:false,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:false};["ended","seeking","seekable","networkState","readyState"].forEach((function(e){Ea.prototype[e]=function(){return this.techGet_(e)}}));_a.forEach((function(e){Ea.prototype["handleTech"+Jt(e)+"_"]=function(){return this.trigger(e)}}));ar.registerComponent("Player",Ea);var Aa="plugin";var Ca="activePlugins_";var Ia={};var Da=function e(t){return Ia.hasOwnProperty(t)};var xa=function e(t){return Da(t)?Ia[t]:undefined};var La=function e(t,r){t[Ca]=t[Ca]||{};t[Ca][r]=true};var Oa=function e(t,r,i){var n=(i?"before":"")+"pluginsetup";t.trigger(n,r);t.trigger(n+":"+r.name,r)};var Pa=function e(t,r){var i=function e(){Oa(this,{name:t,plugin:r,instance:null},true);var i=r.apply(this,arguments);La(this,t);Oa(this,{name:t,plugin:r,instance:i});return i};Object.keys(r).forEach((function(e){i[e]=r[e]}));return i};var Ra=function e(t,r){r.prototype.name=t;return function(){Oa(this,{name:t,plugin:r,instance:null},true);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++){i[n]=arguments[n]}var a=S()(r,[this].concat(i));this[t]=function(){return a};Oa(this,a.getEventHash());return a}};var Ua=function(){function e(t){if(this.constructor===e){throw new Error("Plugin must be sub-classed; not directly instantiated.")}this.player=t;if(!this.log){this.log=this.player.log.createLogger(this.name)}Xt(this);delete this.trigger;Qt(this,this.constructor.defaultState);La(t,this.name);this.dispose=this.dispose.bind(this);t.on("dispose",this.dispose)}var t=e.prototype;t.version=function e(){return this.constructor.VERSION};t.getEventHash=function e(t){if(t===void 0){t={}}t.name=this.name;t.plugin=this.constructor;t.instance=this;return t};t.trigger=function e(t,r){if(r===void 0){r={}}return It(this.eventBusEl_,t,this.getEventHash(r))};t.handleStateChanged=function e(t){};t.dispose=function e(){var t=this.name,r=this.player;this.trigger("dispose");this.off();r.off("dispose",this.dispose);r[Ca][t]=false;this.player=this.state=null;r[t]=Ra(t,Ia[t])};e.isBasic=function t(r){var i=typeof r==="string"?xa(r):r;return typeof i==="function"&&!e.prototype.isPrototypeOf(i.prototype)};e.registerPlugin=function t(r,i){if(typeof r!=="string"){throw new Error('Illegal plugin name, "'+r+'", must be a string, was '+typeof r+".")}if(Da(r)){J.warn('A plugin named "'+r+'" already exists. You may want to avoid re-registering plugins!')}else if(Ea.prototype.hasOwnProperty(r)){throw new Error('Illegal plugin name, "'+r+'", cannot share a name with an existing player method!')}if(typeof i!=="function"){throw new Error('Illegal plugin for "'+r+'", must be a function, was '+typeof i+".")}Ia[r]=i;if(r!==Aa){if(e.isBasic(i)){Ea.prototype[r]=Pa(r,i)}else{Ea.prototype[r]=Ra(r,i)}}return i};e.deregisterPlugin=function e(t){if(t===Aa){throw new Error("Cannot de-register base plugin.")}if(Da(t)){delete Ia[t];delete Ea.prototype[t]}};e.getPlugins=function e(t){if(t===void 0){t=Object.keys(Ia)}var r;t.forEach((function(e){var t=xa(e);if(t){r=r||{};r[e]=t}}));return r};e.getPluginVersion=function e(t){var r=xa(t);return r&&r.VERSION||""};return e}();Ua.getPlugin=xa;Ua.BASE_PLUGIN_NAME=Aa;Ua.registerPlugin(Aa,Ua);Ea.prototype.usingPlugin=function(e){return!!this[Ca]&&this[Ca][e]===true};Ea.prototype.hasPlugin=function(e){return!!Da(e)};var Ma=function e(t,r){if(r===void 0){r={}}var i=function e(){t.apply(this,arguments)};var n={};if(typeof r==="object"){if(r.constructor!==Object.prototype.constructor){i=r.constructor}n=r}else if(typeof r==="function"){i=r}E()(i,t);if(t){i.super_=t}for(var a in n){if(n.hasOwnProperty(a)){i.prototype[a]=n[a]}}return i};var Na=function e(t){return t.indexOf("#")===0?t.slice(1):t};function Ba(e,t,r){var i=Ba.getPlayer(e);if(i){if(t){J.warn('Player "'+e+'" is already initialised. Options will not be applied.')}if(r){i.ready(r)}return i}var n=typeof e==="string"?at("#"+Na(e)):e;if(!Pe(n)){throw new TypeError("The element or ID supplied is not valid. (videojs)")}if(!n.ownerDocument.defaultView||!n.ownerDocument.body.contains(n)){J.warn("The element supplied is not included in the DOM")}t=t||{};F("beforesetup").forEach((function(e){var r=e(n,er(t));if(!ae(r)||Array.isArray(r)){J.error("please return an object in beforesetup hooks");return}t=er(t,r)}));var a=ar.getComponent("Player");i=new a(n,t,r);F("setup").forEach((function(e){return e(i)}));return i}Ba.hooks_=B;Ba.hooks=F;Ba.hook=j;Ba.hookOnce=H;Ba.removeHook=q;if(n.a.VIDEOJS_NO_DYNAMIC_STYLE!==true&&Oe()){var Fa=at(".vjs-styles-defaults");if(!Fa){Fa=ht("vjs-styles-defaults");var ja=at("head");if(ja){ja.insertBefore(Fa,ja.firstChild)}pt(Fa,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}ft(1,Ba);Ba.VERSION=N;Ba.options=Ea.prototype.options_;Ba.getPlayers=function(){return Ea.players};Ba.getPlayer=function(e){var t=Ea.players;var r;if(typeof e==="string"){var i=Na(e);var n=t[i];if(n){return n}r=at("#"+i)}else{r=e}if(Pe(r)){var a=r,s=a.player,o=a.playerId;if(s||t[o]){return s||t[o]}}};Ba.getAllPlayers=function(){return Object.keys(Ea.players).map((function(e){return Ea.players[e]})).filter(Boolean)};Ba.players=Ea.players;Ba.getComponent=ar.getComponent;Ba.registerComponent=function(e,t){if(ei.isTech(t)){J.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)")}ar.registerComponent.call(ar,e,t)};Ba.getTech=ei.getTech;Ba.registerTech=ei.registerTech;Ba.use=ni;Object.defineProperty(Ba,"middleware",{value:{},writeable:false,enumerable:true});Object.defineProperty(Ba.middleware,"TERMINATOR",{value:ii,writeable:false,enumerable:true});Ba.browser=Ie;Ba.TOUCH_ENABLED=we;Ba.extend=Ma;Ba.mergeOptions=er;Ba.bind=Pt;Ba.registerPlugin=Ua.registerPlugin;Ba.deregisterPlugin=Ua.deregisterPlugin;Ba.plugin=function(e,t){J.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead");return Ua.registerPlugin(e,t)};Ba.getPlugins=Ua.getPlugins;Ba.getPlugin=Ua.getPlugin;Ba.getPluginVersion=Ua.getPluginVersion;Ba.addLanguage=function(e,t){var r;e=(""+e).toLowerCase();Ba.options.languages=er(Ba.options.languages,(r={},r[e]=t,r));return Ba.options.languages[e]};Ba.log=J;Ba.createLogger=Z;Ba.createTimeRange=Ba.createTimeRanges=lr;Ba.formatTime=qi;Ba.setFormatTime=Fi;Ba.resetFormatTime=ji;Ba.parseUrl=Ur;Ba.isCrossOrigin=Br;Ba.EventTarget=Mt;Ba.on=At;Ba.one=Dt;Ba.off=Ct;Ba.trigger=It;Ba.xhr=y.a;Ba.TextTrack=Hr;Ba.AudioTrack=Gr;Ba.VideoTrack=Vr;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach((function(e){Ba[e]=function(){J.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead");return ot[e].apply(null,arguments)}}));Ba.computedStyle=oe;Ba.dom=ot;Ba.url=Fr;Ba.defineLazyProperty=ma;Ba.addLanguage("en",{"Non-Fullscreen":"Exit Fullscreen"});var qa=k["a"];var Ha=function e(t,r,i){if(t&&i&&i.responseURL&&r!==i.responseURL){return i.responseURL}return r};var Ga=function e(t){if(Ba.log.debug){return Ba.log.debug.bind(Ba,"VHS:",t+" >")}return function(){}};var Va=1/30;var Wa=Va*3;var za=function e(t,r){var i=[];var n;if(t&&t.length){for(n=0;n<t.length;n++){if(r(t.start(n),t.end(n))){i.push([t.start(n),t.end(n)])}}}return Ba.createTimeRanges(i)};var Ka=function e(t,r){return za(t,(function(e,t){return e-Wa<=r&&t+Wa>=r}))};var Xa=function e(t,r){return za(t,(function(e){return e-Va>=r}))};var Ya=function e(t){if(t.length<2){return Ba.createTimeRanges()}var r=[];for(var i=1;i<t.length;i++){var n=t.end(i-1);var a=t.start(i);r.push([n,a])}return Ba.createTimeRanges(r)};var Qa=function e(t,r){var i=null;var n=null;var a=0;var s=[];var o=[];if(!t||!t.length||!r||!r.length){return Ba.createTimeRange()}var u=t.length;while(u--){s.push({time:t.start(u),type:"start"});s.push({time:t.end(u),type:"end"})}u=r.length;while(u--){s.push({time:r.start(u),type:"start"});s.push({time:r.end(u),type:"end"})}s.sort((function(e,t){return e.time-t.time}));for(u=0;u<s.length;u++){if(s[u].type==="start"){a++;if(a===2){i=s[u].time}}else if(s[u].type==="end"){a--;if(a===1){n=s[u].time}}if(i!==null&&n!==null){o.push([i,n]);i=null;n=null}}return Ba.createTimeRanges(o)};var $a=function e(t){var r=[];if(!t||!t.length){return""}for(var i=0;i<t.length;i++){r.push(t.start(i)+" => "+t.end(i))}return r.join(", ")};var Ja=function e(t,r,i){if(i===void 0){i=1}var n=t.length?t.end(t.length-1):0;return(n-r)/i};var Za=function e(t){var r=[];for(var i=0;i<t.length;i++){r.push({start:t.start(i),end:t.end(i)})}return r};var es=function e(t,r){if(t===r){return false}if(!t&&r||!r&&t){return true}if(t.length!==r.length){return true}for(var i=0;i<t.length;i++){if(t.start(i)!==r.start(i)||t.end(i)!==r.end(i)){return true}}return false};var ts=function e(t){if(!t||!t.length||!t.end){return}return t.end(t.length-1)};var rs=function e(t,r){var i=0;if(!t||!t.length){return i}for(var n=0;n<t.length;n++){var a=t.start(n);var s=t.end(n);if(r>s){continue}if(r>a&&r<=s){i+=s-r;continue}i+=s-a}return i};var is=Ba.createTimeRange;var ns=function e(t,r){if(!r.preload){return r.duration}var i=0;(r.parts||[]).forEach((function(e){i+=e.duration}));(r.preloadHints||[]).forEach((function(e){if(e.type==="PART"){i+=t.partTargetDuration}}));return i};var as=function e(t){return(t.segments||[]).reduce((function(e,t,r){if(t.parts){t.parts.forEach((function(i,n){e.push({duration:i.duration,segmentIndex:r,partIndex:n,part:i,segment:t})}))}else{e.push({duration:t.duration,segmentIndex:r,partIndex:null,segment:t,part:null})}return e}),[])};var ss=function e(t){var r=t.segments&&t.segments.length&&t.segments[t.segments.length-1];return r&&r.parts||[]};var os=function e(t){var r=t.preloadSegment;if(!r){return}var i=r.parts,n=r.preloadHints;var a=(n||[]).reduce((function(e,t){return e+(t.type==="PART"?1:0)}),0);a+=i&&i.length?i.length:0;return a};var us=function e(t,r){if(r.endList){return 0}if(t&&t.suggestedPresentationDelay){return t.suggestedPresentationDelay}var i=ss(r).length>0;if(i&&r.serverControl&&r.serverControl.partHoldBack){return r.serverControl.partHoldBack}else if(i&&r.partTargetDuration){return r.partTargetDuration*3}else if(r.serverControl&&r.serverControl.holdBack){return r.serverControl.holdBack}else if(r.targetDuration){return r.targetDuration*3}return 0};var ls=function e(t,r){var i=0;var n=r-t.mediaSequence;var a=t.segments[n];if(a){if(typeof a.start!=="undefined"){return{result:a.start,precise:true}}if(typeof a.end!=="undefined"){return{result:a.end-a.duration,precise:true}}}while(n--){a=t.segments[n];if(typeof a.end!=="undefined"){return{result:i+a.end,precise:true}}i+=ns(t,a);if(typeof a.start!=="undefined"){return{result:i+a.start,precise:true}}}return{result:i,precise:false}};var ds=function e(t,r){var i=0;var n;var a=r-t.mediaSequence;for(;a<t.segments.length;a++){n=t.segments[a];if(typeof n.start!=="undefined"){return{result:n.start-i,precise:true}}i+=ns(t,n);if(typeof n.end!=="undefined"){return{result:n.end-i,precise:true}}}return{result:-1,precise:false}};var fs=function e(t,r,i){if(typeof r==="undefined"){r=t.mediaSequence+t.segments.length}if(r<t.mediaSequence){return 0}var n=ls(t,r);if(n.precise){return n.result}var a=ds(t,r);if(a.precise){return a.result}return n.result+i};var cs=function e(t,r,i){if(!t){return 0}if(typeof i!=="number"){i=0}if(typeof r==="undefined"){if(t.totalDuration){return t.totalDuration}if(!t.endList){return n.a.Infinity}}return fs(t,r,i)};var hs=function e(t){var r=t.defaultDuration,i=t.durationList,n=t.startIndex,a=t.endIndex;var s=0;if(n>a){var o=[a,n];n=o[0];a=o[1]}if(n<0){for(var u=n;u<Math.min(0,a);u++){s+=r}n=0}for(var l=n;l<a;l++){s+=i[l].duration}return s};var ps=function e(t,r,i,n){if(!t||!t.segments){return null}if(t.endList){return cs(t)}if(r===null){return null}r=r||0;var a=fs(t,t.mediaSequence+t.segments.length,r);if(i){n=typeof n==="number"?n:us(null,t);a-=n}return Math.max(0,a)};var vs=function e(t,r,i){var n=true;var a=r||0;var s=ps(t,r,n,i);if(s===null){return is()}return is(a,s)};var ms=function e(t){var r=t.playlist,i=t.currentTime,n=t.startingSegmentIndex,a=t.startingPartIndex,s=t.startTime,o=t.experimentalExactManifestTimings;var u=i-s;var l=as(r);var d=0;for(var f=0;f<l.length;f++){var c=l[f];if(n!==c.segmentIndex){continue}if(typeof a==="number"&&typeof c.partIndex==="number"&&a!==c.partIndex){continue}d=f;break}if(u<0){if(d>0){for(var h=d-1;h>=0;h--){var p=l[h];u+=p.duration;if(o){if(u<0){continue}}else if(u+Va<=0){continue}return{partIndex:p.partIndex,segmentIndex:p.segmentIndex,startTime:s-hs({defaultDuration:r.targetDuration,durationList:l,startIndex:d,endIndex:h})}}}return{partIndex:l[0]&&l[0].partIndex||null,segmentIndex:l[0]&&l[0].segmentIndex||0,startTime:i}}if(d<0){for(var v=d;v<0;v++){u-=r.targetDuration;if(u<0){return{partIndex:l[0]&&l[0].partIndex||null,segmentIndex:l[0]&&l[0].segmentIndex||0,startTime:i}}}d=0}for(var m=d;m<l.length;m++){var g=l[m];u-=g.duration;if(o){if(u>0){continue}}else if(u-Va>=0){continue}return{partIndex:g.partIndex,segmentIndex:g.segmentIndex,startTime:s+hs({defaultDuration:r.targetDuration,durationList:l,startIndex:d,endIndex:m})}}return{segmentIndex:l[l.length-1].segmentIndex,partIndex:l[l.length-1].partIndex,startTime:i}};var gs=function e(t){return t.excludeUntil&&t.excludeUntil>Date.now()};var ys=function e(t){return t.excludeUntil&&t.excludeUntil===Infinity};var _s=function e(t){var r=gs(t);return!t.disabled&&!r};var bs=function e(t){return t.disabled};var Ts=function e(t){for(var r=0;r<t.segments.length;r++){if(t.segments[r].key){return true}}return false};var Ss=function e(t,r){return r.attributes&&r.attributes[t]};var ws=function e(t,r,i,n){if(n===void 0){n=0}if(!Ss("BANDWIDTH",i)){return NaN}var a=t*i.attributes.BANDWIDTH;return(a-n*8)/r};var Es=function e(t,r){if(t.playlists.length===1){return true}var i=r.attributes.BANDWIDTH||Number.MAX_VALUE;return t.playlists.filter((function(e){if(!_s(e)){return false}return(e.attributes.BANDWIDTH||0)<i})).length===0};var ks=function e(t,r){if(!t&&!r||!t&&r||t&&!r){return false}if(t===r){return true}if(t.id&&r.id&&t.id===r.id){return true}if(t.resolvedUri&&r.resolvedUri&&t.resolvedUri===r.resolvedUri){return true}if(t.uri&&r.uri&&t.uri===r.uri){return true}return false};var As=function e(t,r){var i=t&&t.mediaGroups&&t.mediaGroups.AUDIO||{};var n=false;for(var a in i){for(var s in i[a]){n=r(i[a][s]);if(n){break}}if(n){break}}return!!n};var Cs=function e(t){if(!t||!t.playlists||!t.playlists.length){var r=As(t,(function(e){return e.playlists&&e.playlists.length||e.uri}));return r}var i=function e(r){var i=t.playlists[r];var n=i.attributes&&i.attributes.CODECS;if(n&&n.split(",").every((function(e){return Object(C["f"])(e)}))){return"continue"}var a=As(t,(function(e){return ks(i,e)}));if(a){return"continue"}return{v:false}};for(var n=0;n<t.playlists.length;n++){var a=i(n);if(a==="continue")continue;if(typeof a==="object")return a.v}return true};var Is={liveEdgeDelay:us,duration:cs,seekable:vs,getMediaInfoForTime:ms,isEnabled:_s,isDisabled:bs,isBlacklisted:gs,isIncompatible:ys,playlistEnd:ps,isAes:Ts,hasAttribute:Ss,estimateSegmentRequestTime:ws,isLowestEnabledRendition:Es,isAudioOnly:Cs,playlistMatch:ks,segmentDurationWithParts:ns};var Ds=Ba.log;var xs=function e(t,r){return t+"-"+r};var Ls=function e(t){var r=t.onwarn,i=t.oninfo,n=t.manifestString,a=t.customTagParsers,s=a===void 0?[]:a,o=t.customTagMappers,u=o===void 0?[]:o,l=t.experimentalLLHLS;var d=new A["a"];if(r){d.on("warn",r)}if(i){d.on("info",i)}s.forEach((function(e){return d.addParser(e)}));u.forEach((function(e){return d.addTagMapper(e)}));d.push(n);d.end();var f=d.manifest;if(!l){["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach((function(e){if(f.hasOwnProperty(e)){delete f[e]}}));if(f.segments){f.segments.forEach((function(e){["parts","preloadHints"].forEach((function(t){if(e.hasOwnProperty(t)){delete e[t]}}))}))}}if(!f.targetDuration){var c=10;if(f.segments&&f.segments.length){c=f.segments.reduce((function(e,t){return Math.max(e,t.duration)}),0)}if(r){r("manifest has no targetDuration defaulting to "+c)}f.targetDuration=c}var h=ss(f);if(h.length&&!f.partTargetDuration){var p=h.reduce((function(e,t){return Math.max(e,t.duration)}),0);if(r){r("manifest has no partTargetDuration defaulting to "+p);Ds.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")}f.partTargetDuration=p}return f};var Os=function e(t,r){if(!t.mediaGroups){return}["AUDIO","SUBTITLES"].forEach((function(e){if(!t.mediaGroups[e]){return}for(var i in t.mediaGroups[e]){for(var n in t.mediaGroups[e][i]){var a=t.mediaGroups[e][i][n];r(a,e,i,n)}}}))};var Ps=function e(t){var r=t.playlist,i=t.uri,n=t.id;r.id=n;r.playlistErrors_=0;if(i){r.uri=i}r.attributes=r.attributes||{}};var Rs=function e(t){var r=t.playlists.length;while(r--){var i=t.playlists[r];Ps({playlist:i,id:xs(r,i.uri)});i.resolvedUri=qa(t.uri,i.uri);t.playlists[i.id]=i;t.playlists[i.uri]=i;if(!i.attributes.BANDWIDTH){Ds.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}};var Us=function e(t){Os(t,(function(e){if(e.uri){e.resolvedUri=qa(t.uri,e.uri)}}))};var Ms=function e(t,r){var i=xs(0,r);var a={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:n.a.location.href,resolvedUri:n.a.location.href,playlists:[{uri:r,id:i,resolvedUri:r,attributes:{}}]};a.playlists[i]=a.playlists[0];a.playlists[r]=a.playlists[0];return a};var Ns=function e(t,r){t.uri=r;for(var i=0;i<t.playlists.length;i++){if(!t.playlists[i].uri){var n="placeholder-uri-"+i;t.playlists[i].uri=n}}var a=Cs(t);Os(t,(function(e,r,i,n){var s="placeholder-uri-"+r+"-"+i+"-"+n;if(!e.playlists||!e.playlists.length){if(a&&r==="AUDIO"&&!e.uri){for(var o=0;o<t.playlists.length;o++){var l=t.playlists[o];if(l.attributes&&l.attributes.AUDIO&&l.attributes.AUDIO===i){return}}}e.playlists=[u()({},e)]}e.playlists.forEach((function(e,r){var i=xs(r,s);if(e.uri){e.resolvedUri=e.resolvedUri||qa(t.uri,e.uri)}else{e.uri=r===0?s:i;e.resolvedUri=e.uri}e.id=e.id||i;e.attributes=e.attributes||{};t.playlists[e.id]=e;t.playlists[e.uri]=e}))}));Rs(t);Us(t)};var Bs=Ba.mergeOptions,Fs=Ba.EventTarget;var js=function e(t,r){if(r.endList||!r.serverControl){return t}var i={};if(r.serverControl.canBlockReload){var a=r.preloadSegment;var s=r.mediaSequence+r.segments.length;if(a){var o=a.parts||[];var u=os(r)-1;if(u>-1&&u!==o.length-1){i._HLS_part=u}if(u>-1||o.length){s--}}i._HLS_msn=s}if(r.serverControl&&r.serverControl.canSkipUntil){i._HLS_skip=r.serverControl.canSkipDateranges?"v2":"YES"}if(Object.keys(i).length){var l=new n.a.URL(t);["_HLS_skip","_HLS_msn","_HLS_part"].forEach((function(e){if(!i.hasOwnProperty(e)){return}l.searchParams.set(e,i[e])}));t=l.toString()}return t};var qs=function e(t,r){if(!t){return r}var i=Bs(t,r);if(t.preloadHints&&!r.preloadHints){delete i.preloadHints}if(t.parts&&!r.parts){delete i.parts}else if(t.parts&&r.parts){for(var n=0;n<r.parts.length;n++){if(t.parts&&t.parts[n]){i.parts[n]=Bs(t.parts[n],r.parts[n])}}}if(!t.skipped&&r.skipped){i.skipped=false}if(t.preload&&!r.preload){i.preload=false}return i};var Hs=function e(t,r,i){var n=t.slice();var a=r.slice();i=i||0;var s=[];var o;for(var u=0;u<a.length;u++){var l=n[u+i];var d=a[u];if(l){o=l.map||o;s.push(qs(l,d))}else{if(o&&!d.map){d.map=o}s.push(d)}}return s};var Gs=function e(t,r){if(!t.resolvedUri&&t.uri){t.resolvedUri=qa(r,t.uri)}if(t.key&&!t.key.resolvedUri){t.key.resolvedUri=qa(r,t.key.uri)}if(t.map&&!t.map.resolvedUri){t.map.resolvedUri=qa(r,t.map.uri)}if(t.map&&t.map.key&&!t.map.key.resolvedUri){t.map.key.resolvedUri=qa(r,t.map.key.uri)}if(t.parts&&t.parts.length){t.parts.forEach((function(e){if(e.resolvedUri){return}e.resolvedUri=qa(r,e.uri)}))}if(t.preloadHints&&t.preloadHints.length){t.preloadHints.forEach((function(e){if(e.resolvedUri){return}e.resolvedUri=qa(r,e.uri)}))}};var Vs=function e(t){var r=t.segments||[];var i=t.preloadSegment;if(i&&i.parts&&i.parts.length){if(i.preloadHints){for(var n=0;n<i.preloadHints.length;n++){if(i.preloadHints[n].type==="MAP"){return r}}}i.duration=t.targetDuration;i.preload=true;r.push(i)}return r};var Ws=function e(t,r){return t===r||t.segments&&r.segments&&t.segments.length===r.segments.length&&t.endList===r.endList&&t.mediaSequence===r.mediaSequence&&t.preloadSegment===r.preloadSegment};var zs=function e(t,r,i){if(i===void 0){i=Ws}var n=Bs(t,{});var a=n.playlists[r.id];if(!a){return null}if(i(a,r)){return null}r.segments=Vs(r);var s=Bs(a,r);if(s.preloadSegment&&!r.preloadSegment){delete s.preloadSegment}if(a.segments){if(r.skip){r.segments=r.segments||[];for(var o=0;o<r.skip.skippedSegments;o++){r.segments.unshift({skipped:true})}}s.segments=Hs(a.segments,r.segments,r.mediaSequence-a.mediaSequence)}s.segments.forEach((function(e){Gs(e,s.resolvedUri)}));for(var u=0;u<n.playlists.length;u++){if(n.playlists[u].id===r.id){n.playlists[u]=s}}n.playlists[r.id]=s;n.playlists[r.uri]=s;Os(t,(function(e,t,i,n){if(!e.playlists){return}for(var a=0;a<e.playlists.length;a++){if(r.id===e.playlists[a].id){e.playlists[a]=r}}}));return n};var Ks=function e(t,r){var i=t.segments||[];var n=i[i.length-1];var a=n&&n.parts&&n.parts[n.parts.length-1];var s=a&&a.duration||n&&n.duration;if(r&&s){return s*1e3}return(t.partTargetDuration||t.targetDuration||10)*500};var Xs=function(e){p()(t,e);function t(t,r,i){var n;if(i===void 0){i={}}n=e.call(this)||this;if(!t){throw new Error("A non-empty playlist URL or object is required")}n.logger_=Ga("PlaylistLoader");var a=i,s=a.withCredentials,o=s===void 0?false:s,u=a.handleManifestRedirects,l=u===void 0?false:u;n.src=t;n.vhs_=r;n.withCredentials=o;n.handleManifestRedirects=l;var d=r.options_;n.customTagParsers=d&&d.customTagParsers||[];n.customTagMappers=d&&d.customTagMappers||[];n.experimentalLLHLS=d&&d.experimentalLLHLS||false;if(Ba.browser.IE_VERSION){n.experimentalLLHLS=false}n.state="HAVE_NOTHING";n.handleMediaupdatetimeout_=n.handleMediaupdatetimeout_.bind(c()(n));n.on("mediaupdatetimeout",n.handleMediaupdatetimeout_);return n}var r=t.prototype;r.handleMediaupdatetimeout_=function e(){var t=this;if(this.state!=="HAVE_METADATA"){return}var r=this.media();var i=qa(this.master.uri,r.uri);if(this.experimentalLLHLS){i=js(i,r)}this.state="HAVE_CURRENT_METADATA";this.request=this.vhs_.xhr({uri:i,withCredentials:this.withCredentials},(function(e,r){if(!t.request){return}if(e){return t.playlistRequestError(t.request,t.media(),"HAVE_METADATA")}t.haveMetadata({playlistString:t.request.responseText,url:t.media().uri,id:t.media().id})}))};r.playlistRequestError=function e(t,r,i){var n=r.uri,a=r.id;this.request=null;if(i){this.state=i}this.error={playlist:this.master.playlists[a],status:t.status,message:"HLS playlist request error at URL: "+n+".",responseText:t.responseText,code:t.status>=500?4:2};this.trigger("error")};r.parseManifest_=function e(t){var r=this;var i=t.url,n=t.manifestString;return Ls({onwarn:function e(t){var n=t.message;return r.logger_("m3u8-parser warn for "+i+": "+n)},oninfo:function e(t){var n=t.message;return r.logger_("m3u8-parser info for "+i+": "+n)},manifestString:n,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,experimentalLLHLS:this.experimentalLLHLS})};r.haveMetadata=function e(t){var r=t.playlistString,i=t.playlistObject,n=t.url,a=t.id;this.request=null;this.state="HAVE_METADATA";var s=i||this.parseManifest_({url:n,manifestString:r});s.lastRequest=Date.now();Ps({playlist:s,uri:n,id:a});var o=zs(this.master,s);this.targetDuration=s.partTargetDuration||s.targetDuration;this.pendingMedia_=null;if(o){this.master=o;this.media_=this.master.playlists[a]}else{this.trigger("playlistunchanged")}this.updateMediaUpdateTimeout_(Ks(this.media(),!!o));this.trigger("loadedplaylist")};r.dispose=function e(){this.trigger("dispose");this.stopRequest();n.a.clearTimeout(this.mediaUpdateTimeout);n.a.clearTimeout(this.finalRenditionTimeout);this.off()};r.stopRequest=function e(){if(this.request){var t=this.request;this.request=null;t.onreadystatechange=null;t.abort()}};r.media=function e(t,r){var i=this;if(!t){return this.media_}if(this.state==="HAVE_NOTHING"){throw new Error("Cannot switch media playlist from "+this.state)}if(typeof t==="string"){if(!this.master.playlists[t]){throw new Error("Unknown playlist URI: "+t)}t=this.master.playlists[t]}n.a.clearTimeout(this.finalRenditionTimeout);if(r){var a=(t.partTargetDuration||t.targetDuration)/2*1e3||5*1e3;this.finalRenditionTimeout=n.a.setTimeout(this.media.bind(this,t,false),a);return}var s=this.state;var o=!this.media_||t.id!==this.media_.id;var u=this.master.playlists[t.id];if(u&&u.endList||t.endList&&t.segments.length){if(this.request){this.request.onreadystatechange=null;this.request.abort();this.request=null}this.state="HAVE_METADATA";this.media_=t;if(o){this.trigger("mediachanging");if(s==="HAVE_MASTER"){this.trigger("loadedmetadata")}else{this.trigger("mediachange")}}return}this.updateMediaUpdateTimeout_(Ks(t,true));if(!o){return}this.state="SWITCHING_MEDIA";if(this.request){if(t.resolvedUri===this.request.url){return}this.request.onreadystatechange=null;this.request.abort();this.request=null}if(this.media_){this.trigger("mediachanging")}this.pendingMedia_=t;this.request=this.vhs_.xhr({uri:t.resolvedUri,withCredentials:this.withCredentials},(function(e,r){if(!i.request){return}t.lastRequest=Date.now();t.resolvedUri=Ha(i.handleManifestRedirects,t.resolvedUri,r);if(e){return i.playlistRequestError(i.request,t,s)}i.haveMetadata({playlistString:r.responseText,url:t.uri,id:t.id});if(s==="HAVE_MASTER"){i.trigger("loadedmetadata")}else{i.trigger("mediachange")}}))};r.pause=function e(){if(this.mediaUpdateTimeout){n.a.clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null}this.stopRequest();if(this.state==="HAVE_NOTHING"){this.started=false}if(this.state==="SWITCHING_MEDIA"){if(this.media_){this.state="HAVE_METADATA"}else{this.state="HAVE_MASTER"}}else if(this.state==="HAVE_CURRENT_METADATA"){this.state="HAVE_METADATA"}};r.load=function e(t){var r=this;if(this.mediaUpdateTimeout){n.a.clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null}var i=this.media();if(t){var a=i?(i.partTargetDuration||i.targetDuration)/2*1e3:5*1e3;this.mediaUpdateTimeout=n.a.setTimeout((function(){r.mediaUpdateTimeout=null;r.load()}),a);return}if(!this.started){this.start();return}if(i&&!i.endList){this.trigger("mediaupdatetimeout")}else{this.trigger("loadedplaylist")}};r.updateMediaUpdateTimeout_=function e(t){var r=this;if(this.mediaUpdateTimeout){n.a.clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null}if(!this.media()||this.media().endList){return}this.mediaUpdateTimeout=n.a.setTimeout((function(){r.mediaUpdateTimeout=null;r.trigger("mediaupdatetimeout");r.updateMediaUpdateTimeout_(t)}),t)};r.start=function e(){var t=this;this.started=true;if(typeof this.src==="object"){if(!this.src.uri){this.src.uri=n.a.location.href}this.src.resolvedUri=this.src.uri;setTimeout((function(){t.setupInitialPlaylist(t.src)}),0);return}this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},(function(e,r){if(!t.request){return}t.request=null;if(e){t.error={status:r.status,message:"HLS playlist request error at URL: "+t.src+".",responseText:r.responseText,code:2};if(t.state==="HAVE_NOTHING"){t.started=false}return t.trigger("error")}t.src=Ha(t.handleManifestRedirects,t.src,r);var i=t.parseManifest_({manifestString:r.responseText,url:t.src});t.setupInitialPlaylist(i)}))};r.srcUri=function e(){return typeof this.src==="string"?this.src:this.src.uri};r.setupInitialPlaylist=function e(t){this.state="HAVE_MASTER";if(t.playlists){this.master=t;Ns(this.master,this.srcUri());t.playlists.forEach((function(e){e.segments=Vs(e);e.segments.forEach((function(t){Gs(t,e.resolvedUri)}))}));this.trigger("loadedplaylist");if(!this.request){this.media(this.master.playlists[0])}return}var r=this.srcUri()||n.a.location.href;this.master=Ms(t,r);this.haveMetadata({playlistObject:t,url:r,id:this.master.playlists[0].id});this.trigger("loadedmetadata")};return t}(Fs);var Ys=Ba.xhr,Qs=Ba.mergeOptions;var $s=function e(t,r,i,n){var a=t.responseType==="arraybuffer"?t.response:t.responseText;if(!r&&a){t.responseTime=Date.now();t.roundTripTime=t.responseTime-t.requestTime;t.bytesReceived=a.byteLength||a.length;if(!t.bandwidth){t.bandwidth=Math.floor(t.bytesReceived/t.roundTripTime*8*1e3)}}if(i.headers){t.responseHeaders=i.headers}if(r&&r.code==="ETIMEDOUT"){t.timedout=true}if(!r&&!t.aborted&&i.statusCode!==200&&i.statusCode!==206&&i.statusCode!==0){r=new Error("XHR Failed with a response of: "+(t&&(a||t.responseText)))}n(r,t)};var Js=function e(){var t=function e(t,r){t=Qs({timeout:45e3},t);var i=e.beforeRequest||Ba.Vhs.xhr.beforeRequest;if(i&&typeof i==="function"){var n=i(t);if(n){t=n}}var a=Ba.Vhs.xhr.original===true?Ys:Ba.Vhs.xhr;var s=a(t,(function(e,t){return $s(s,e,t,r)}));var o=s.abort;s.abort=function(){s.aborted=true;return o.apply(s,arguments)};s.uri=t.uri;s.requestTime=Date.now();return s};t.original=true;return t};var Zs=function e(t){var r;var i=t.offset;if(typeof t.offset==="bigint"||typeof t.length==="bigint"){r=n.a.BigInt(t.offset)+n.a.BigInt(t.length)-n.a.BigInt(1)}else{r=t.offset+t.length-1}return"bytes="+i+"-"+r};var eo=function e(t){var r={};if(t.byterange){r.Range=Zs(t.byterange)}return r};var to=function e(t,r){return t.start(r)+"-"+t.end(r)};var ro=function e(t,r){var i=t.toString(16);return"00".substring(0,2-i.length)+i+(r%2?" ":"")};var io=function e(t){if(t>=32&&t<126){return String.fromCharCode(t)}return"."};var no=function e(t){var r={};Object.keys(t).forEach((function(e){var i=t[e];if(ArrayBuffer.isView(i)){r[e]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}}else{r[e]=i}}));return r};var ao=function e(t){var r=t.byterange||{length:Infinity,offset:0};return[r.length,r.offset,t.resolvedUri].join(",")};var so=function e(t){return t.resolvedUri};var oo=function e(t){var r=Array.prototype.slice.call(t);var i=16;var n="";var a;var s;for(var o=0;o<r.length/i;o++){a=r.slice(o*i,o*i+i).map(ro).join("");s=r.slice(o*i,o*i+i).map(io).join("");n+=a+" "+s+"\n"}return n};var uo=function e(t){var r=t.bytes;return oo(r)};var lo=function e(t){var r="";var i;for(i=0;i<t.length;i++){r+=to(t,i)+" "}return r};var fo=Object.freeze({__proto__:null,createTransferableMessage:no,initSegmentId:ao,segmentKeyId:so,hexDump:oo,tagDump:uo,textRanges:lo});var co=.25;var ho=function e(t,r){if(!r.dateTimeObject){return null}var i=r.videoTimingInfo.transmuxerPrependedSeconds;var n=r.videoTimingInfo.transmuxedPresentationStart;var a=n+i;var s=t-a;return new Date(r.dateTimeObject.getTime()+s*1e3)};var po=function e(t){return t.transmuxedPresentationEnd-t.transmuxedPresentationStart-t.transmuxerPrependedSeconds};var vo=function e(t,r){var i;try{i=new Date(t)}catch(e){return null}if(!r||!r.segments||r.segments.length===0){return null}var n=r.segments[0];if(i<n.dateTimeObject){return null}for(var a=0;a<r.segments.length-1;a++){n=r.segments[a];var s=r.segments[a+1].dateTimeObject;if(i<s){break}}var o=r.segments[r.segments.length-1];var u=o.dateTimeObject;var l=o.videoTimingInfo?po(o.videoTimingInfo):o.duration+o.duration*co;var d=new Date(u.getTime()+l*1e3);if(i>d){return null}if(i>u){n=o}return{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:Is.duration(r,r.mediaSequence+r.segments.indexOf(n)),type:n.videoTimingInfo?"accurate":"estimate"}};var mo=function e(t,r){if(!r||!r.segments||r.segments.length===0){return null}var i=0;var n;for(var a=0;a<r.segments.length;a++){n=r.segments[a];i=n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationEnd:i+n.duration;if(t<=i){break}}var s=r.segments[r.segments.length-1];if(s.videoTimingInfo&&s.videoTimingInfo.transmuxedPresentationEnd<t){return null}if(t>i){if(t>i+s.duration*co){return null}n=s}return{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:i-n.duration,type:n.videoTimingInfo?"accurate":"estimate"}};var go=function e(t,r){var i;var n;try{i=new Date(t);n=new Date(r)}catch(e){}var a=i.getTime();var s=n.getTime();return(s-a)/1e3};var yo=function e(t){if(!t.segments||t.segments.length===0){return false}for(var r=0;r<t.segments.length;r++){var i=t.segments[r];if(!i.dateTimeObject){return false}}return true};var _o=function e(t){var r=t.playlist,i=t.time,n=i===void 0?undefined:i,a=t.callback;if(!a){throw new Error("getProgramTime: callback must be provided")}if(!r||n===undefined){return a({message:"getProgramTime: playlist and time must be provided"})}var s=mo(n,r);if(!s){return a({message:"valid programTime was not found"})}if(s.type==="estimate"){return a({message:"Accurate programTime could not be determined."+" Please seek to e.seekTime and try again",seekTime:s.estimatedStart})}var o={mediaSeconds:n};var u=ho(n,s.segment);if(u){o.programDateTime=u.toISOString()}return a(null,o)};var bo=function e(t){var r=t.programTime,i=t.playlist,n=t.retryCount,a=n===void 0?2:n,s=t.seekTo,o=t.pauseAfterSeek,u=o===void 0?true:o,l=t.tech,d=t.callback;if(!d){throw new Error("seekToProgramTime: callback must be provided")}if(typeof r==="undefined"||!i||!s){return d({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"})}if(!i.endList&&!l.hasStarted_){return d({message:"player must be playing a live stream to start buffering"})}if(!yo(i)){return d({message:"programDateTime tags must be provided in the manifest "+i.resolvedUri})}var f=vo(r,i);if(!f){return d({message:r+" was not found in the stream"})}var c=f.segment;var h=go(c.dateTimeObject,r);if(f.type==="estimate"){if(a===0){return d({message:r+" is not buffered yet. Try again"})}s(f.estimatedStart+h);l.one("seeked",(function(){e({programTime:r,playlist:i,retryCount:a-1,seekTo:s,pauseAfterSeek:u,tech:l,callback:d})}));return}var p=c.start+h;var v=function e(){return d(null,l.currentTime())};l.one("seeked",v);if(u){l.pause()}s(p)};var To=function e(t,r){if(t.readyState===4){return r()}return};var So=function e(t,r,i){var n=[];var a;var s=false;var o=function e(t,r,n,a){r.abort();s=true;return i(t,r,n,a)};var u=function e(t,r){if(s){return}if(t){return o(t,r,"",n)}var i=r.responseText.substring(n&&n.byteLength||0,r.responseText.length);n=Object(R["d"])(n,Object(R["g"])(i,true));a=a||Object(O["a"])(n);if(n.length<10||a&&n.length<a+2){return To(r,(function(){return o(t,r,"",n)}))}var u=Object(P["a"])(n);if(u==="ts"&&n.length<188){return To(r,(function(){return o(t,r,"",n)}))}if(!u&&n.length<376){return To(r,(function(){return o(t,r,"",n)}))}return o(null,r,u,n)};var l={uri:t,beforeSend:function e(t){t.overrideMimeType("text/plain; charset=x-user-defined");t.addEventListener("progress",(function(e){e.total;e.loaded;return $s(t,null,{statusCode:t.status},u)}))}};var d=r(l,(function(e,t){return $s(d,e,t,u)}));return d};var wo=Ba.EventTarget,Eo=Ba.mergeOptions;var ko=function e(t,r){if(!Ws(t,r)){return false}if(t.sidx&&r.sidx&&(t.sidx.offset!==r.sidx.offset||t.sidx.length!==r.sidx.length)){return false}else if(!t.sidx&&r.sidx||t.sidx&&!r.sidx){return false}if(t.segments&&!r.segments||!t.segments&&r.segments){return false}if(!t.segments&&!r.segments){return true}for(var i=0;i<t.segments.length;i++){var n=t.segments[i];var a=r.segments[i];if(n.uri!==a.uri){return false}if(!n.byterange&&!a.byterange){continue}var s=n.byterange;var o=a.byterange;if(s&&!o||!s&&o){return false}if(s.offset!==o.offset||s.length!==o.length){return false}}return true};var Ao=function e(t){var r=t.masterXml,i=t.srcUrl,n=t.clientOffset,a=t.sidxMapping,s=t.previousManifest;var o=Object(D["c"])(r,{manifestUri:i,clientOffset:n,sidxMapping:a,previousManifest:s});Ns(o,i);return o};var Co=function e(t,r,i){var n=true;var a=Eo(t,{duration:r.duration,minimumUpdatePeriod:r.minimumUpdatePeriod,timelineStarts:r.timelineStarts});for(var s=0;s<r.playlists.length;s++){var o=r.playlists[s];if(o.sidx){var u=Object(D["b"])(o.sidx);if(i&&i[u]&&i[u].sidx){Object(D["a"])(o,i[u].sidx,o.sidx.resolvedUri)}}var l=zs(a,o,ko);if(l){a=l;n=false}}Os(r,(function(e,t,r,i){if(e.playlists&&e.playlists.length){var s=e.playlists[0].id;var o=zs(a,e.playlists[0],ko);if(o){a=o;a.mediaGroups[t][r][i].playlists[0]=a.playlists[s];n=false}}}));if(r.minimumUpdatePeriod!==t.minimumUpdatePeriod){n=false}if(n){return null}return a};var Io=function e(t,r){var i=Boolean(!t.map&&!r.map);var n=i||Boolean(t.map&&r.map&&t.map.byterange.offset===r.map.byterange.offset&&t.map.byterange.length===r.map.byterange.length);return n&&t.uri===r.uri&&t.byterange.offset===r.byterange.offset&&t.byterange.length===r.byterange.length};var Do=function e(t,r){var i={};for(var n in t){var a=t[n];var s=a.sidx;if(s){var o=Object(D["b"])(s);if(!r[o]){break}var u=r[o].sidxInfo;if(Io(u,s)){i[o]=r[o]}}}return i};var xo=function e(t,r){var i=Do(t.playlists,r);var n=i;Os(t,(function(e,t,i,a){if(e.playlists&&e.playlists.length){var s=e.playlists;n=Eo(n,Do(s,r))}}));return n};var Lo=function(e){p()(t,e);function t(t,r,i,n){var a;if(i===void 0){i={}}a=e.call(this)||this;a.masterPlaylistLoader_=n||c()(a);if(!n){a.isMaster_=true}var s=i,o=s.withCredentials,u=o===void 0?false:o,l=s.handleManifestRedirects,d=l===void 0?false:l;a.vhs_=r;a.withCredentials=u;a.handleManifestRedirects=d;if(!t){throw new Error("A non-empty playlist URL or object is required")}a.on("minimumUpdatePeriod",(function(){a.refreshXml_()}));a.on("mediaupdatetimeout",(function(){a.refreshMedia_(a.media().id)}));a.state="HAVE_NOTHING";a.loadedPlaylists_={};a.logger_=Ga("DashPlaylistLoader");if(a.isMaster_){a.masterPlaylistLoader_.srcUrl=t;a.masterPlaylistLoader_.sidxMapping_={}}else{a.childPlaylist_=t}return a}var r=t.prototype;r.requestErrored_=function e(t,r,i){if(!this.request){return true}this.request=null;if(t){this.error=typeof t==="object"&&!(t instanceof Error)?t:{status:r.status,message:"DASH request error at URL: "+r.uri,response:r.response,code:2};if(i){this.state=i}this.trigger("error");return true}};r.addSidxSegments_=function e(t,r,i){var a=this;var s=t.sidx&&Object(D["b"])(t.sidx);if(!t.sidx||!s||this.masterPlaylistLoader_.sidxMapping_[s]){this.mediaRequest_=n.a.setTimeout((function(){return i(false)}),0);return}var o=Ha(this.handleManifestRedirects,t.sidx.resolvedUri);var u=function e(n,o){if(a.requestErrored_(n,o,r)){return}var u=a.masterPlaylistLoader_.sidxMapping_;var l;try{l=L()(Object(R["j"])(o.response).subarray(8))}catch(e){a.requestErrored_(e,o,r);return}u[s]={sidxInfo:t.sidx,sidx:l};Object(D["a"])(t,l,t.sidx.resolvedUri);return i(true)};this.request=So(o,this.vhs_.xhr,(function(e,r,i,n){if(e){return u(e,r)}if(!i||i!=="mp4"){return u({status:r.status,message:"Unsupported "+(i||"unknown")+" container type for sidx segment at URL: "+o,response:"",playlist:t,internal:true,blacklistDuration:Infinity,code:2},r)}var s=t.sidx.byterange,l=s.offset,d=s.length;if(n.length>=d+l){return u(e,{response:n.subarray(l,l+d),status:r.status,uri:r.uri})}a.request=a.vhs_.xhr({uri:o,responseType:"arraybuffer",headers:eo({byterange:t.sidx.byterange})},u)}))};r.dispose=function e(){this.trigger("dispose");this.stopRequest();this.loadedPlaylists_={};n.a.clearTimeout(this.minimumUpdatePeriodTimeout_);n.a.clearTimeout(this.mediaRequest_);n.a.clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null;this.mediaRequest_=null;this.minimumUpdatePeriodTimeout_=null;if(this.masterPlaylistLoader_.createMupOnMedia_){this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_);this.masterPlaylistLoader_.createMupOnMedia_=null}this.off()};r.hasPendingRequest=function e(){return this.request||this.mediaRequest_};r.stopRequest=function e(){if(this.request){var t=this.request;this.request=null;t.onreadystatechange=null;t.abort()}};r.media=function e(t){var r=this;if(!t){return this.media_}if(this.state==="HAVE_NOTHING"){throw new Error("Cannot switch media playlist from "+this.state)}var i=this.state;if(typeof t==="string"){if(!this.masterPlaylistLoader_.master.playlists[t]){throw new Error("Unknown playlist URI: "+t)}t=this.masterPlaylistLoader_.master.playlists[t]}var n=!this.media_||t.id!==this.media_.id;if(n&&this.loadedPlaylists_[t.id]&&this.loadedPlaylists_[t.id].endList){this.state="HAVE_METADATA";this.media_=t;if(n){this.trigger("mediachanging");this.trigger("mediachange")}return}if(!n){return}if(this.media_){this.trigger("mediachanging")}this.addSidxSegments_(t,i,(function(e){r.haveMetadata({startingState:i,playlist:t})}))};r.haveMetadata=function e(t){var r=t.startingState,i=t.playlist;this.state="HAVE_METADATA";this.loadedPlaylists_[i.id]=i;this.mediaRequest_=null;this.refreshMedia_(i.id);if(r==="HAVE_MASTER"){this.trigger("loadedmetadata")}else{this.trigger("mediachange")}};r.pause=function e(){if(this.masterPlaylistLoader_.createMupOnMedia_){this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_);this.masterPlaylistLoader_.createMupOnMedia_=null}this.stopRequest();n.a.clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null;if(this.isMaster_){n.a.clearTimeout(this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_);this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_=null}if(this.state==="HAVE_NOTHING"){this.started=false}};r.load=function e(t){var r=this;n.a.clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null;var i=this.media();if(t){var a=i?i.targetDuration/2*1e3:5*1e3;this.mediaUpdateTimeout=n.a.setTimeout((function(){return r.load()}),a);return}if(!this.started){this.start();return}if(i&&!i.endList){if(this.isMaster_&&!this.minimumUpdatePeriodTimeout_){this.trigger("minimumUpdatePeriod");this.updateMinimumUpdatePeriodTimeout_()}this.trigger("mediaupdatetimeout")}else{this.trigger("loadedplaylist")}};r.start=function e(){var t=this;this.started=true;if(!this.isMaster_){this.mediaRequest_=n.a.setTimeout((function(){return t.haveMaster_()}),0);return}this.requestMaster_((function(e,r){t.haveMaster_();if(!t.hasPendingRequest()&&!t.media_){t.media(t.masterPlaylistLoader_.master.playlists[0])}}))};r.requestMaster_=function e(t){var r=this;this.request=this.vhs_.xhr({uri:this.masterPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},(function(e,i){if(r.requestErrored_(e,i)){if(r.state==="HAVE_NOTHING"){r.started=false}return}var n=i.responseText!==r.masterPlaylistLoader_.masterXml_;r.masterPlaylistLoader_.masterXml_=i.responseText;if(i.responseHeaders&&i.responseHeaders.date){r.masterLoaded_=Date.parse(i.responseHeaders.date)}else{r.masterLoaded_=Date.now()}r.masterPlaylistLoader_.srcUrl=Ha(r.handleManifestRedirects,r.masterPlaylistLoader_.srcUrl,i);if(n){r.handleMaster_();r.syncClientServerClock_((function(){return t(i,n)}));return}return t(i,n)}))};r.syncClientServerClock_=function e(t){var r=this;var i=Object(D["d"])(this.masterPlaylistLoader_.masterXml_);if(i===null){this.masterPlaylistLoader_.clientOffset_=this.masterLoaded_-Date.now();return t()}if(i.method==="DIRECT"){this.masterPlaylistLoader_.clientOffset_=i.value-Date.now();return t()}this.request=this.vhs_.xhr({uri:qa(this.masterPlaylistLoader_.srcUrl,i.value),method:i.method,withCredentials:this.withCredentials},(function(e,n){if(!r.request){return}if(e){r.masterPlaylistLoader_.clientOffset_=r.masterLoaded_-Date.now();return t()}var a;if(i.method==="HEAD"){if(!n.responseHeaders||!n.responseHeaders.date){a=r.masterLoaded_}else{a=Date.parse(n.responseHeaders.date)}}else{a=Date.parse(n.responseText)}r.masterPlaylistLoader_.clientOffset_=a-Date.now();t()}))};r.haveMaster_=function e(){this.state="HAVE_MASTER";if(this.isMaster_){this.trigger("loadedplaylist")}else if(!this.media_){this.media(this.childPlaylist_)}};r.handleMaster_=function e(){this.mediaRequest_=null;var t=this.masterPlaylistLoader_.master;var r=Ao({masterXml:this.masterPlaylistLoader_.masterXml_,srcUrl:this.masterPlaylistLoader_.srcUrl,clientOffset:this.masterPlaylistLoader_.clientOffset_,sidxMapping:this.masterPlaylistLoader_.sidxMapping_,previousManifest:t});if(t){r=Co(t,r,this.masterPlaylistLoader_.sidxMapping_)}this.masterPlaylistLoader_.master=r?r:t;var i=this.masterPlaylistLoader_.master.locations&&this.masterPlaylistLoader_.master.locations[0];if(i&&i!==this.masterPlaylistLoader_.srcUrl){this.masterPlaylistLoader_.srcUrl=i}if(!t||r&&r.minimumUpdatePeriod!==t.minimumUpdatePeriod){this.updateMinimumUpdatePeriodTimeout_()}return Boolean(r)};r.updateMinimumUpdatePeriodTimeout_=function e(){var t=this.masterPlaylistLoader_;if(t.createMupOnMedia_){t.off("loadedmetadata",t.createMupOnMedia_);t.createMupOnMedia_=null}if(t.minimumUpdatePeriodTimeout_){n.a.clearTimeout(t.minimumUpdatePeriodTimeout_);t.minimumUpdatePeriodTimeout_=null}var r=t.master&&t.master.minimumUpdatePeriod;if(r===0){if(t.media()){r=t.media().targetDuration*1e3}else{t.createMupOnMedia_=t.updateMinimumUpdatePeriodTimeout_;t.one("loadedmetadata",t.createMupOnMedia_)}}if(typeof r!=="number"||r<=0){if(r<0){this.logger_("found invalid minimumUpdatePeriod of "+r+", not setting a timeout")}return}this.createMUPTimeout_(r)};r.createMUPTimeout_=function e(t){var r=this.masterPlaylistLoader_;r.minimumUpdatePeriodTimeout_=n.a.setTimeout((function(){r.minimumUpdatePeriodTimeout_=null;r.trigger("minimumUpdatePeriod");r.createMUPTimeout_(t)}),t)};r.refreshXml_=function e(){var t=this;this.requestMaster_((function(e,r){if(!r){return}if(t.media_){t.media_=t.masterPlaylistLoader_.master.playlists[t.media_.id]}t.masterPlaylistLoader_.sidxMapping_=xo(t.masterPlaylistLoader_.master,t.masterPlaylistLoader_.sidxMapping_);t.addSidxSegments_(t.media(),t.state,(function(e){t.refreshMedia_(t.media().id)}))}))};r.refreshMedia_=function e(t){var r=this;if(!t){throw new Error("refreshMedia_ must take a media id")}if(this.media_&&this.isMaster_){this.handleMaster_()}var i=this.masterPlaylistLoader_.master.playlists;var a=!this.media_||this.media_!==i[t];if(a){this.media_=i[t]}else{this.trigger("playlistunchanged")}if(!this.mediaUpdateTimeout){var s=function e(){if(r.media().endList){return}r.mediaUpdateTimeout=n.a.setTimeout((function(){r.trigger("mediaupdatetimeout");e()}),Ks(r.media(),Boolean(a)))};s()}this.trigger("loadedplaylist")};return t}(wo);var Oo={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};var Po=function e(t){var r=new Uint8Array(new ArrayBuffer(t.length));for(var i=0;i<t.length;i++){r[i]=t.charCodeAt(i)}return r.buffer};var Ro=function e(t){t.on=t.addEventListener;t.off=t.removeEventListener;return t};var Uo=function e(t){try{return URL.createObjectURL(new Blob([t],{type:"application/javascript"}))}catch(e){var r=new BlobBuilder;r.append(t);return URL.createObjectURL(r.getBlob())}};var Mo=function e(t){return function(){var e=Uo(t);var r=Ro(new Worker(e));r.objURL=e;var i=r.terminate;r.on=r.addEventListener;r.off=r.removeEventListener;r.terminate=function(){URL.revokeObjectURL(e);return i.call(this)};return r}};var No=function e(t){return"var browserWorkerPolyFill = "+Ro.toString()+";\n"+"browserWorkerPolyFill(self);\n"+t};var Bo=function e(t){return t.toString().replace(/^function.+?{/,"").slice(0,-1)};var Fo=No(Bo((function(){var t=function e(){this.init=function(){var e={};this.on=function(t,r){if(!e[t]){e[t]=[]}e[t]=e[t].concat(r)};this.off=function(t,r){var i;if(!e[t]){return false}i=e[t].indexOf(r);e[t]=e[t].slice();e[t].splice(i,1);return i>-1};this.trigger=function(t){var r,i,n,a;r=e[t];if(!r){return}if(arguments.length===2){n=r.length;for(i=0;i<n;++i){r[i].call(this,arguments[1])}}else{a=[];i=arguments.length;for(i=1;i<arguments.length;++i){a.push(arguments[i])}n=r.length;for(i=0;i<n;++i){r[i].apply(this,a)}}};this.dispose=function(){e={}}}};t.prototype.pipe=function(e){this.on("data",(function(t){e.push(t)}));this.on("done",(function(t){e.flush(t)}));this.on("partialdone",(function(t){e.partialFlush(t)}));this.on("endedtimeline",(function(t){e.endTimeline(t)}));this.on("reset",(function(t){e.reset(t)}));return e};t.prototype.push=function(e){this.trigger("data",e)};t.prototype.flush=function(e){this.trigger("done",e)};t.prototype.partialFlush=function(e){this.trigger("partialdone",e)};t.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)};t.prototype.reset=function(e){this.trigger("reset",e)};var r=t;var i=Math.pow(2,32);var n=function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);var n;if(r.getBigUint64){n=r.getBigUint64(0);if(n<Number.MAX_SAFE_INTEGER){return Number(n)}return n}return r.getUint32(0)*i+r.getUint32(4)};var a={getUint64:n,MAX_UINT32:i};var s=a.MAX_UINT32;var o,u,l,d,f,c,h,p,v,m,g,y,_,b,T,S,w,E,k,A,C,I,D,x,L,O,P,R,U,M,N,B,F,j,q,H;(function(){var e;D={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]};if(typeof Uint8Array==="undefined"){return}for(e in D){if(D.hasOwnProperty(e)){D[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]}}x=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]);O=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]);L=new Uint8Array([0,0,0,1]);P=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);R=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);U={video:P,audio:R};B=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);N=new Uint8Array([0,0,0,0,0,0,0,0]);F=new Uint8Array([0,0,0,0,0,0,0,0]);j=F;q=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);H=F;M=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])})();o=function e(t){var r=[],i=0,n,a,s;for(n=1;n<arguments.length;n++){r.push(arguments[n])}n=r.length;while(n--){i+=r[n].byteLength}a=new Uint8Array(i+8);s=new DataView(a.buffer,a.byteOffset,a.byteLength);s.setUint32(0,a.byteLength);a.set(t,4);for(n=0,i=8;n<r.length;n++){a.set(r[n],i);i+=r[n].byteLength}return a};u=function e(){return o(D.dinf,o(D.dref,B))};l=function e(t){return o(D.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))};d=function e(){return o(D.ftyp,x,L,x,O)};S=function e(t){return o(D.hdlr,U[t])};f=function e(t){return o(D.mdat,t)};T=function e(t){var r=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,t.duration&255,85,196,0,0]);if(t.samplerate){r[12]=t.samplerate>>>24&255;r[13]=t.samplerate>>>16&255;r[14]=t.samplerate>>>8&255;r[15]=t.samplerate&255}return o(D.mdhd,r)};b=function e(t){return o(D.mdia,T(t),S(t.type),h(t))};c=function e(t){return o(D.mfhd,new Uint8Array([0,0,0,0,(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255]))};h=function e(t){return o(D.minf,t.type==="video"?o(D.vmhd,M):o(D.smhd,N),u(),E(t))};p=function e(t,r){var i=[],n=r.length;while(n--){i[n]=A(r[n])}return o.apply(null,[D.moof,c(t)].concat(i))};v=function e(t){var r=t.length,i=[];while(r--){i[r]=y(t[r])}return o.apply(null,[D.moov,g(4294967295)].concat(i).concat(m(t)))};m=function e(t){var r=t.length,i=[];while(r--){i[r]=C(t[r])}return o.apply(null,[D.mvex].concat(i))};g=function e(t){var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return o(D.mvhd,r)};w=function e(t){var r=t.samples||[],i=new Uint8Array(4+r.length),n,a;for(a=0;a<r.length;a++){n=r[a].flags;i[a+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy}return o(D.sdtp,i)};E=function e(t){return o(D.stbl,k(t),o(D.stts,H),o(D.stsc,j),o(D.stsz,q),o(D.stco,F))};(function(){var e,t;k=function r(i){return o(D.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),i.type==="video"?e(i):t(i))};e=function e(t){var r=t.sps||[],i=t.pps||[],n=[],a=[],s,u;for(s=0;s<r.length;s++){n.push((r[s].byteLength&65280)>>>8);n.push(r[s].byteLength&255);n=n.concat(Array.prototype.slice.call(r[s]))}for(s=0;s<i.length;s++){a.push((i[s].byteLength&65280)>>>8);a.push(i[s].byteLength&255);a=a.concat(Array.prototype.slice.call(i[s]))}u=[D.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(t.width&65280)>>8,t.width&255,(t.height&65280)>>8,t.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o(D.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([r.length],n,[i.length],a))),o(D.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))];if(t.sarRatio){var l=t.sarRatio[0],d=t.sarRatio[1];u.push(o(D.pasp,new Uint8Array([(l&4278190080)>>24,(l&16711680)>>16,(l&65280)>>8,l&255,(d&4278190080)>>24,(d&16711680)>>16,(d&65280)>>8,d&255])))}return o.apply(null,u)};t=function e(t){return o(D.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(t.channelcount&65280)>>8,t.channelcount&255,(t.samplesize&65280)>>8,t.samplesize&255,0,0,0,0,(t.samplerate&65280)>>8,t.samplerate&255,0,0]),l(t))}})();_=function e(t){var r=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(t.id&4278190080)>>24,(t.id&16711680)>>16,(t.id&65280)>>8,t.id&255,0,0,0,0,(t.duration&4278190080)>>24,(t.duration&16711680)>>16,(t.duration&65280)>>8,t.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(t.width&65280)>>8,t.width&255,0,0,(t.height&65280)>>8,t.height&255,0,0]);return o(D.tkhd,r)};A=function e(t){var r,i,n,a,u,l,d;r=o(D.tfhd,new Uint8Array([0,0,0,58,(t.id&4278190080)>>24,(t.id&16711680)>>16,(t.id&65280)>>8,t.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]));l=Math.floor(t.baseMediaDecodeTime/s);d=Math.floor(t.baseMediaDecodeTime%s);i=o(D.tfdt,new Uint8Array([1,0,0,0,l>>>24&255,l>>>16&255,l>>>8&255,l&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255]));u=32+20+8+16+8+8;if(t.type==="audio"){n=I(t,u);return o(D.traf,r,i,n)}a=w(t);n=I(t,a.length+u);return o(D.traf,r,i,n,a)};y=function e(t){t.duration=t.duration||4294967295;return o(D.trak,_(t),b(t))};C=function e(t){var r=new Uint8Array([0,0,0,0,(t.id&4278190080)>>24,(t.id&16711680)>>16,(t.id&65280)>>8,t.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);if(t.type!=="video"){r[r.length-1]=0}return o(D.trex,r)};(function(){var e,t,r;r=function e(t,r){var i=0,n=0,a=0,s=0;if(t.length){if(t[0].duration!==undefined){i=1}if(t[0].size!==undefined){n=2}if(t[0].flags!==undefined){a=4}if(t[0].compositionTimeOffset!==undefined){s=8}}return[0,0,i|n|a|s,1,(t.length&4278190080)>>>24,(t.length&16711680)>>>16,(t.length&65280)>>>8,t.length&255,(r&4278190080)>>>24,(r&16711680)>>>16,(r&65280)>>>8,r&255]};t=function e(t,i){var n,a,s,u,l,d;u=t.samples||[];i+=8+12+16*u.length;s=r(u,i);a=new Uint8Array(s.length+u.length*16);a.set(s);n=s.length;for(d=0;d<u.length;d++){l=u[d];a[n++]=(l.duration&4278190080)>>>24;a[n++]=(l.duration&16711680)>>>16;a[n++]=(l.duration&65280)>>>8;a[n++]=l.duration&255;a[n++]=(l.size&4278190080)>>>24;a[n++]=(l.size&16711680)>>>16;a[n++]=(l.size&65280)>>>8;a[n++]=l.size&255;a[n++]=l.flags.isLeading<<2|l.flags.dependsOn;a[n++]=l.flags.isDependedOn<<6|l.flags.hasRedundancy<<4|l.flags.paddingValue<<1|l.flags.isNonSyncSample;a[n++]=l.flags.degradationPriority&240<<8;a[n++]=l.flags.degradationPriority&15;a[n++]=(l.compositionTimeOffset&4278190080)>>>24;a[n++]=(l.compositionTimeOffset&16711680)>>>16;a[n++]=(l.compositionTimeOffset&65280)>>>8;a[n++]=l.compositionTimeOffset&255}return o(D.trun,a)};e=function e(t,i){var n,a,s,u,l,d;u=t.samples||[];i+=8+12+8*u.length;s=r(u,i);n=new Uint8Array(s.length+u.length*8);n.set(s);a=s.length;for(d=0;d<u.length;d++){l=u[d];n[a++]=(l.duration&4278190080)>>>24;n[a++]=(l.duration&16711680)>>>16;n[a++]=(l.duration&65280)>>>8;n[a++]=l.duration&255;n[a++]=(l.size&4278190080)>>>24;n[a++]=(l.size&16711680)>>>16;n[a++]=(l.size&65280)>>>8;n[a++]=l.size&255}return o(D.trun,n)};I=function r(i,n){if(i.type==="audio"){return e(i,n)}return t(i,n)}})();var G={ftyp:d,mdat:f,moof:p,moov:v,initSegment:function e(t){var r=d(),i=v(t),n;n=new Uint8Array(r.byteLength+i.byteLength);n.set(r);n.set(i,r.byteLength);return n}};var V=function e(t){var r,i,n=[],a=[];a.byteLength=0;a.nalCount=0;a.duration=0;n.byteLength=0;for(r=0;r<t.length;r++){i=t[r];if(i.nalUnitType==="access_unit_delimiter_rbsp"){if(n.length){n.duration=i.dts-n.dts;a.byteLength+=n.byteLength;a.nalCount+=n.length;a.duration+=n.duration;a.push(n)}n=[i];n.byteLength=i.data.byteLength;n.pts=i.pts;n.dts=i.dts}else{if(i.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"){n.keyFrame=true}n.duration=i.dts-n.dts;n.byteLength+=i.data.byteLength;n.push(i)}}if(a.length&&(!n.duration||n.duration<=0)){n.duration=a[a.length-1].duration}a.byteLength+=n.byteLength;a.nalCount+=n.length;a.duration+=n.duration;a.push(n);return a};var W=function e(t){var r,i,n=[],a=[];n.byteLength=0;n.nalCount=0;n.duration=0;n.pts=t[0].pts;n.dts=t[0].dts;a.byteLength=0;a.nalCount=0;a.duration=0;a.pts=t[0].pts;a.dts=t[0].dts;for(r=0;r<t.length;r++){i=t[r];if(i.keyFrame){if(n.length){a.push(n);a.byteLength+=n.byteLength;a.nalCount+=n.nalCount;a.duration+=n.duration}n=[i];n.nalCount=i.length;n.byteLength=i.byteLength;n.pts=i.pts;n.dts=i.dts;n.duration=i.duration}else{n.duration+=i.duration;n.nalCount+=i.length;n.byteLength+=i.byteLength;n.push(i)}}if(a.length&&n.duration<=0){n.duration=a[a.length-1].duration}a.byteLength+=n.byteLength;a.nalCount+=n.nalCount;a.duration+=n.duration;a.push(n);return a};var z=function e(t){var r;if(!t[0][0].keyFrame&&t.length>1){r=t.shift();t.byteLength-=r.byteLength;t.nalCount-=r.nalCount;t[0][0].dts=r.dts;t[0][0].pts=r.pts;t[0][0].duration+=r.duration}return t};var K=function e(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}};var X=function e(t,r){var i=K();i.dataOffset=r;i.compositionTimeOffset=t.pts-t.dts;i.duration=t.duration;i.size=4*t.length;i.size+=t.byteLength;if(t.keyFrame){i.flags.dependsOn=2;i.flags.isNonSyncSample=0}return i};var Y=function e(t,r){var i,n,a,s,o,u=r||0,l=[];for(i=0;i<t.length;i++){s=t[i];for(n=0;n<s.length;n++){o=s[n];a=X(o,u);u+=a.size;l.push(a)}}return l};var Q=function e(t){var r,i,n,a,s,o,u=0,l=t.byteLength,d=t.nalCount,f=l+4*d,c=new Uint8Array(f),h=new DataView(c.buffer);for(r=0;r<t.length;r++){a=t[r];for(i=0;i<a.length;i++){s=a[i];for(n=0;n<s.length;n++){o=s[n];h.setUint32(u,o.data.byteLength);u+=4;c.set(o.data,u);u+=o.data.byteLength}}}return c};var $=function e(t,r){var i,n=r||0,a=[];i=X(t,n);a.push(i);return a};var J=function e(t){var r,i,n=0,a=t.byteLength,s=t.length,o=a+4*s,u=new Uint8Array(o),l=new DataView(u.buffer);for(r=0;r<t.length;r++){i=t[r];l.setUint32(n,i.data.byteLength);n+=4;u.set(i.data,n);n+=i.data.byteLength}return u};var Z={groupNalsIntoFrames:V,groupFramesIntoGops:W,extendFirstKeyFrame:z,generateSampleTable:Y,concatenateNalData:Q,generateSampleTableForFrame:$,concatenateNalDataForFrame:J};var ee=[33,16,5,32,164,27];var te=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252];var re=function e(t){var r=[];while(t--){r.push(0)}return r};var ie=function e(t){return Object.keys(t).reduce((function(e,r){e[r]=new Uint8Array(t[r].reduce((function(e,t){return e.concat(t)}),[]));return e}),{})};var ne;var ae=function e(){if(!ne){var t={96e3:[ee,[227,64],re(154),[56]],88200:[ee,[231],re(170),[56]],64e3:[ee,[248,192],re(240),[56]],48e3:[ee,[255,192],re(268),[55,148,128],re(54),[112]],44100:[ee,[255,192],re(268),[55,163,128],re(84),[112]],32e3:[ee,[255,192],re(268),[55,234],re(226),[112]],24e3:[ee,[255,192],re(268),[55,255,128],re(268),[111,112],re(126),[224]],16e3:[ee,[255,192],re(268),[55,255,128],re(268),[111,255],re(269),[223,108],re(195),[1,192]],12e3:[te,re(268),[3,127,248],re(268),[6,255,240],re(268),[13,255,224],re(268),[27,253,128],re(259),[56]],11025:[te,re(268),[3,127,248],re(268),[6,255,240],re(268),[13,255,224],re(268),[27,255,192],re(268),[55,175,128],re(108),[112]],8e3:[te,re(268),[3,121,16],re(47),[7]]};ne=ie(t)}return ne};var se=9e4,oe,ue,le,de,fe,ce,he;oe=function e(t){return t*se};ue=function e(t,r){return t*r};le=function e(t){return t/se};de=function e(t,r){return t/r};fe=function e(t,r){return oe(de(t,r))};ce=function e(t,r){return ue(le(t),r)};he=function e(t,r,i){return le(i?t:t-r)};var pe={ONE_SECOND_IN_TS:se,secondsToVideoTs:oe,secondsToAudioTs:ue,videoTsToSeconds:le,audioTsToSeconds:de,audioTsToVideoTs:fe,videoTsToAudioTs:ce,metadataTsToSeconds:he};var ve=function e(t){var r,i,n=0;for(r=0;r<t.length;r++){i=t[r];n+=i.data.byteLength}return n};var me=function e(t,r,i,n){var a,s=0,o=0,u=0,l=0,d,f,c;if(!r.length){return}a=pe.audioTsToVideoTs(t.baseMediaDecodeTime,t.samplerate);s=Math.ceil(pe.ONE_SECOND_IN_TS/(t.samplerate/1024));if(i&&n){o=a-Math.max(i,n);u=Math.floor(o/s);l=u*s}if(u<1||l>pe.ONE_SECOND_IN_TS/2){return}d=ae()[t.samplerate];if(!d){d=r[0].data}for(f=0;f<u;f++){c=r[0];r.splice(0,0,{data:d,dts:c.dts-s,pts:c.pts-s})}t.baseMediaDecodeTime-=Math.floor(pe.videoTsToAudioTs(l,t.samplerate));return l};var ge=function e(t,r,i){if(r.minSegmentDts>=i){return t}r.minSegmentDts=Infinity;return t.filter((function(e){if(e.dts>=i){r.minSegmentDts=Math.min(r.minSegmentDts,e.dts);r.minSegmentPts=r.minSegmentDts;return true}return false}))};var ye=function e(t){var r,i,n=[];for(r=0;r<t.length;r++){i=t[r];n.push({size:i.data.byteLength,duration:1024})}return n};var _e=function e(t){var r,i,n=0,a=new Uint8Array(ve(t));for(r=0;r<t.length;r++){i=t[r];a.set(i.data,n);n+=i.data.byteLength}return a};var be={prefixWithSilence:me,trimAdtsFramesByEarliestDts:ge,generateSampleTable:ye,concatenateFrameData:_e};var Te=pe.ONE_SECOND_IN_TS;var Se=function e(t,r){if(typeof r.pts==="number"){if(t.timelineStartInfo.pts===undefined){t.timelineStartInfo.pts=r.pts}if(t.minSegmentPts===undefined){t.minSegmentPts=r.pts}else{t.minSegmentPts=Math.min(t.minSegmentPts,r.pts)}if(t.maxSegmentPts===undefined){t.maxSegmentPts=r.pts}else{t.maxSegmentPts=Math.max(t.maxSegmentPts,r.pts)}}if(typeof r.dts==="number"){if(t.timelineStartInfo.dts===undefined){t.timelineStartInfo.dts=r.dts}if(t.minSegmentDts===undefined){t.minSegmentDts=r.dts}else{t.minSegmentDts=Math.min(t.minSegmentDts,r.dts)}if(t.maxSegmentDts===undefined){t.maxSegmentDts=r.dts}else{t.maxSegmentDts=Math.max(t.maxSegmentDts,r.dts)}}};var we=function e(t){delete t.minSegmentDts;delete t.maxSegmentDts;delete t.minSegmentPts;delete t.maxSegmentPts};var Ee=function e(t,r){var i,n,a=t.minSegmentDts;if(!r){a-=t.timelineStartInfo.dts}i=t.timelineStartInfo.baseMediaDecodeTime;i+=a;i=Math.max(0,i);if(t.type==="audio"){n=t.samplerate/Te;i*=n;i=Math.floor(i)}return i};var ke={clearDtsInfo:we,calculateTrackBaseMediaDecodeTime:Ee,collectDtsInfo:Se};var Ae=4,Ce=128;var Ie=function e(t){var r=0,i={payloadType:-1,payloadSize:0},n=0,a=0;while(r<t.byteLength){if(t[r]===Ce){break}while(t[r]===255){n+=255;r++}n+=t[r++];while(t[r]===255){a+=255;r++}a+=t[r++];if(!i.payload&&n===Ae){var s=String.fromCharCode(t[r+3],t[r+4],t[r+5],t[r+6]);if(s==="GA94"){i.payloadType=n;i.payloadSize=a;i.payload=t.subarray(r,r+a);break}else{i.payload=void 0}}r+=a;n=0;a=0}return i};var De=function e(t){if(t.payload[0]!==181){return null}if((t.payload[1]<<8|t.payload[2])!==49){return null}if(String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6])!=="GA94"){return null}if(t.payload[7]!==3){return null}return t.payload.subarray(8,t.payload.length-1)};var xe=function e(t,r){var i=[],n,a,s,o;if(!(r[0]&64)){return i}a=r[0]&31;for(n=0;n<a;n++){s=n*3;o={type:r[s+2]&3,pts:t};if(r[s+2]&4){o.ccData=r[s+3]<<8|r[s+4];i.push(o)}}return i};var Le=function e(t){var r=t.byteLength,i=[],n=1,a,s;while(n<r-2){if(t[n]===0&&t[n+1]===0&&t[n+2]===3){i.push(n+2);n+=2}else{n++}}if(i.length===0){return t}a=r-i.length;s=new Uint8Array(a);var o=0;for(n=0;n<a;o++,n++){if(o===i[0]){o++;i.shift()}s[n]=t[o]}return s};var Oe={parseSei:Ie,parseUserData:De,parseCaptionPackets:xe,discardEmulationPreventionBytes:Le,USER_DATA_REGISTERED_ITU_T_T35:Ae};var Pe=function e(t){t=t||{};e.prototype.init.call(this);this.parse708captions_=typeof t.parse708captions==="boolean"?t.parse708captions:true;this.captionPackets_=[];this.ccStreams_=[new We(0,0),new We(0,1),new We(1,0),new We(1,1)];if(this.parse708captions_){this.cc708Stream_=new Fe({captionServices:t.captionServices})}this.reset();this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data"));e.on("partialdone",this.trigger.bind(this,"partialdone"));e.on("done",this.trigger.bind(this,"done"))}),this);if(this.parse708captions_){this.cc708Stream_.on("data",this.trigger.bind(this,"data"));this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone"));this.cc708Stream_.on("done",this.trigger.bind(this,"done"))}};Pe.prototype=new r;Pe.prototype.push=function(e){var t,r,i;if(e.nalUnitType!=="sei_rbsp"){return}t=Oe.parseSei(e.escapedRBSP);if(!t.payload){return}if(t.payloadType!==Oe.USER_DATA_REGISTERED_ITU_T_T35){return}r=Oe.parseUserData(t);if(!r){return}if(e.dts<this.latestDts_){this.ignoreNextEqualDts_=true;return}else if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;if(!this.numSameDts_){this.ignoreNextEqualDts_=false}return}i=Oe.parseCaptionPackets(e.pts,r);this.captionPackets_=this.captionPackets_.concat(i);if(this.latestDts_!==e.dts){this.numSameDts_=0}this.numSameDts_++;this.latestDts_=e.dts};Pe.prototype.flushCCStreams=function(e){this.ccStreams_.forEach((function(t){return e==="flush"?t.flush():t.partialFlush()}),this)};Pe.prototype.flushStream=function(e){if(!this.captionPackets_.length){this.flushCCStreams(e);return}this.captionPackets_.forEach((function(e,t){e.presortIndex=t}));this.captionPackets_.sort((function(e,t){if(e.pts===t.pts){return e.presortIndex-t.presortIndex}return e.pts-t.pts}));this.captionPackets_.forEach((function(e){if(e.type<2){this.dispatchCea608Packet(e)}else{this.dispatchCea708Packet(e)}}),this);this.captionPackets_.length=0;this.flushCCStreams(e)};Pe.prototype.flush=function(){return this.flushStream("flush")};Pe.prototype.partialFlush=function(){return this.flushStream("partialFlush")};Pe.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=false;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach((function(e){e.reset()}))};Pe.prototype.dispatchCea608Packet=function(e){if(this.setsTextOrXDSActive(e)){this.activeCea608Channel_[e.type]=null}else if(this.setsChannel1Active(e)){this.activeCea608Channel_[e.type]=0}else if(this.setsChannel2Active(e)){this.activeCea608Channel_[e.type]=1}if(this.activeCea608Channel_[e.type]===null){return}this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)};Pe.prototype.setsChannel1Active=function(e){return(e.ccData&30720)===4096};Pe.prototype.setsChannel2Active=function(e){return(e.ccData&30720)===6144};Pe.prototype.setsTextOrXDSActive=function(e){return(e.ccData&28928)===256||(e.ccData&30974)===4138||(e.ccData&30974)===6186};Pe.prototype.dispatchCea708Packet=function(e){if(this.parse708captions_){this.cc708Stream_.push(e)}};var Re={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600};var Ue=function e(t){var r=Re[t]||t;if(t&4096&&t===r){return""}return String.fromCharCode(r)};var Me=function e(t){return 32<=t&&t<=127||160<=t&&t<=255};var Ne=function e(t){this.windowNum=t;this.reset()};Ne.prototype.reset=function(){this.clearText();this.pendingNewLine=false;this.winAttr={};this.penAttr={};this.penLoc={};this.penColor={};this.visible=0;this.rowLock=0;this.columnLock=0;this.priority=0;this.relativePositioning=0;this.anchorVertical=0;this.anchorHorizontal=0;this.anchorPoint=0;this.rowCount=1;this.virtualRowCount=this.rowCount+1;this.columnCount=41;this.windowStyle=0;this.penStyle=0};Ne.prototype.getText=function(){return this.rows.join("\n")};Ne.prototype.clearText=function(){this.rows=[""];this.rowIdx=0};Ne.prototype.newLine=function(e){if(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow==="function"){this.beforeRowOverflow(e)}if(this.rows.length>0){this.rows.push("");this.rowIdx++}while(this.rows.length>this.virtualRowCount){this.rows.shift();this.rowIdx--}};Ne.prototype.isEmpty=function(){if(this.rows.length===0){return true}else if(this.rows.length===1){return this.rows[0]===""}return false};Ne.prototype.addText=function(e){this.rows[this.rowIdx]+=e};Ne.prototype.backspace=function(){if(!this.isEmpty()){var e=this.rows[this.rowIdx];this.rows[this.rowIdx]=e.substr(0,e.length-1)}};var Be=function e(t,r,i){this.serviceNum=t;this.text="";this.currentWindow=new Ne(-1);this.windows=[];this.stream=i;if(typeof r==="string"){this.createTextDecoder(r)}};Be.prototype.init=function(e,t){this.startPts=e;for(var r=0;r<8;r++){this.windows[r]=new Ne(r);if(typeof t==="function"){this.windows[r].beforeRowOverflow=t}}};Be.prototype.setCurrentWindow=function(e){this.currentWindow=this.windows[e]};Be.prototype.createTextDecoder=function(e){if(typeof TextDecoder==="undefined"){this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"})}else{try{this.textDecoder_=new TextDecoder(e)}catch(t){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+e+" encoding. "+t})}}};var Fe=function e(t){t=t||{};e.prototype.init.call(this);var r=this;var i=t.captionServices||{};var n={};var a;Object.keys(i).forEach((function(e){a=i[e];if(/^SERVICE/.test(e)){n[e]=a.encoding}}));this.serviceEncodings=n;this.current708Packet=null;this.services={};this.push=function(e){if(e.type===3){r.new708Packet();r.add708Bytes(e)}else{if(r.current708Packet===null){r.new708Packet()}r.add708Bytes(e)}}};Fe.prototype=new r;Fe.prototype.new708Packet=function(){if(this.current708Packet!==null){this.push708Packet()}this.current708Packet={data:[],ptsVals:[]}};Fe.prototype.add708Bytes=function(e){var t=e.ccData;var r=t>>>8;var i=t&255;this.current708Packet.ptsVals.push(e.pts);this.current708Packet.data.push(r);this.current708Packet.data.push(i)};Fe.prototype.push708Packet=function(){var e=this.current708Packet;var t=e.data;var r=null;var i=null;var n=0;var a=t[n++];e.seq=a>>6;e.sizeCode=a&63;for(;n<t.length;n++){a=t[n++];r=a>>5;i=a&31;if(r===7&&i>0){a=t[n++];r=a}this.pushServiceBlock(r,n,i);if(i>0){n+=i-1}}};Fe.prototype.pushServiceBlock=function(e,t,r){var i;var n=t;var a=this.current708Packet.data;var s=this.services[e];if(!s){s=this.initService(e,n)}for(;n<t+r&&n<a.length;n++){i=a[n];if(Me(i)){n=this.handleText(n,s)}else if(i===24){n=this.multiByteCharacter(n,s)}else if(i===16){n=this.extendedCommands(n,s)}else if(128<=i&&i<=135){n=this.setCurrentWindow(n,s)}else if(152<=i&&i<=159){n=this.defineWindow(n,s)}else if(i===136){n=this.clearWindows(n,s)}else if(i===140){n=this.deleteWindows(n,s)}else if(i===137){n=this.displayWindows(n,s)}else if(i===138){n=this.hideWindows(n,s)}else if(i===139){n=this.toggleWindows(n,s)}else if(i===151){n=this.setWindowAttributes(n,s)}else if(i===144){n=this.setPenAttributes(n,s)}else if(i===145){n=this.setPenColor(n,s)}else if(i===146){n=this.setPenLocation(n,s)}else if(i===143){s=this.reset(n,s)}else if(i===8){s.currentWindow.backspace()}else if(i===12){s.currentWindow.clearText()}else if(i===13){s.currentWindow.pendingNewLine=true}else if(i===14){s.currentWindow.clearText()}else if(i===141){n++}else;}};Fe.prototype.extendedCommands=function(e,t){var r=this.current708Packet.data;var i=r[++e];if(Me(i)){e=this.handleText(e,t,{isExtended:true})}return e};Fe.prototype.getPts=function(e){return this.current708Packet.ptsVals[Math.floor(e/2)]};Fe.prototype.initService=function(e,t){var r="SERVICE"+e;var i=this;var r;var n;if(r in this.serviceEncodings){n=this.serviceEncodings[r]}this.services[e]=new Be(e,n,i);this.services[e].init(this.getPts(t),(function(t){i.flushDisplayed(t,i.services[e])}));return this.services[e]};Fe.prototype.handleText=function(e,t,r){var i=r&&r.isExtended;var n=r&&r.isMultiByte;var a=this.current708Packet.data;var s=i?4096:0;var o=a[e];var u=a[e+1];var l=t.currentWindow;var d;var f;if(t.textDecoder_&&!i){if(n){f=[o,u];e++}else{f=[o]}d=t.textDecoder_.decode(new Uint8Array(f))}else{d=Ue(s|o)}if(l.pendingNewLine&&!l.isEmpty()){l.newLine(this.getPts(e))}l.pendingNewLine=false;l.addText(d);return e};Fe.prototype.multiByteCharacter=function(e,t){var r=this.current708Packet.data;var i=r[e+1];var n=r[e+2];if(Me(i)&&Me(n)){e=this.handleText(++e,t,{isMultiByte:true})}return e};Fe.prototype.setCurrentWindow=function(e,t){var r=this.current708Packet.data;var i=r[e];var n=i&7;t.setCurrentWindow(n);return e};Fe.prototype.defineWindow=function(e,t){var r=this.current708Packet.data;var i=r[e];var n=i&7;t.setCurrentWindow(n);var a=t.currentWindow;i=r[++e];a.visible=(i&32)>>5;a.rowLock=(i&16)>>4;a.columnLock=(i&8)>>3;a.priority=i&7;i=r[++e];a.relativePositioning=(i&128)>>7;a.anchorVertical=i&127;i=r[++e];a.anchorHorizontal=i;i=r[++e];a.anchorPoint=(i&240)>>4;a.rowCount=i&15;i=r[++e];a.columnCount=i&63;i=r[++e];a.windowStyle=(i&56)>>3;a.penStyle=i&7;a.virtualRowCount=a.rowCount+1;return e};Fe.prototype.setWindowAttributes=function(e,t){var r=this.current708Packet.data;var i=r[e];var n=t.currentWindow.winAttr;i=r[++e];n.fillOpacity=(i&192)>>6;n.fillRed=(i&48)>>4;n.fillGreen=(i&12)>>2;n.fillBlue=i&3;i=r[++e];n.borderType=(i&192)>>6;n.borderRed=(i&48)>>4;n.borderGreen=(i&12)>>2;n.borderBlue=i&3;i=r[++e];n.borderType+=(i&128)>>5;n.wordWrap=(i&64)>>6;n.printDirection=(i&48)>>4;n.scrollDirection=(i&12)>>2;n.justify=i&3;i=r[++e];n.effectSpeed=(i&240)>>4;n.effectDirection=(i&12)>>2;n.displayEffect=i&3;return e};Fe.prototype.flushDisplayed=function(e,t){var r=[];for(var i=0;i<8;i++){if(t.windows[i].visible&&!t.windows[i].isEmpty()){r.push(t.windows[i].getText())}}t.endPts=e;t.text=r.join("\n\n");this.pushCaption(t);t.startPts=e};Fe.prototype.pushCaption=function(e){if(e.text!==""){this.trigger("data",{startPts:e.startPts,endPts:e.endPts,text:e.text,stream:"cc708_"+e.serviceNum});e.text="";e.startPts=e.endPts}};Fe.prototype.displayWindows=function(e,t){var r=this.current708Packet.data;var i=r[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++){if(i&1<<a){t.windows[a].visible=1}}return e};Fe.prototype.hideWindows=function(e,t){var r=this.current708Packet.data;var i=r[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++){if(i&1<<a){t.windows[a].visible=0}}return e};Fe.prototype.toggleWindows=function(e,t){var r=this.current708Packet.data;var i=r[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++){if(i&1<<a){t.windows[a].visible^=1}}return e};Fe.prototype.clearWindows=function(e,t){var r=this.current708Packet.data;var i=r[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++){if(i&1<<a){t.windows[a].clearText()}}return e};Fe.prototype.deleteWindows=function(e,t){var r=this.current708Packet.data;var i=r[++e];var n=this.getPts(e);this.flushDisplayed(n,t);for(var a=0;a<8;a++){if(i&1<<a){t.windows[a].reset()}}return e};Fe.prototype.setPenAttributes=function(e,t){var r=this.current708Packet.data;var i=r[e];var n=t.currentWindow.penAttr;i=r[++e];n.textTag=(i&240)>>4;n.offset=(i&12)>>2;n.penSize=i&3;i=r[++e];n.italics=(i&128)>>7;n.underline=(i&64)>>6;n.edgeType=(i&56)>>3;n.fontStyle=i&7;return e};Fe.prototype.setPenColor=function(e,t){var r=this.current708Packet.data;var i=r[e];var n=t.currentWindow.penColor;i=r[++e];n.fgOpacity=(i&192)>>6;n.fgRed=(i&48)>>4;n.fgGreen=(i&12)>>2;n.fgBlue=i&3;i=r[++e];n.bgOpacity=(i&192)>>6;n.bgRed=(i&48)>>4;n.bgGreen=(i&12)>>2;n.bgBlue=i&3;i=r[++e];n.edgeRed=(i&48)>>4;n.edgeGreen=(i&12)>>2;n.edgeBlue=i&3;return e};Fe.prototype.setPenLocation=function(e,t){var r=this.current708Packet.data;var i=r[e];var n=t.currentWindow.penLoc;t.currentWindow.pendingNewLine=true;i=r[++e];n.row=i&15;i=r[++e];n.column=i&63;return e};Fe.prototype.reset=function(e,t){var r=this.getPts(e);this.flushDisplayed(r,t);return this.initService(t.serviceNum,e)};var je={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496};var qe=function e(t){if(t===null){return""}t=je[t]||t;return String.fromCharCode(t)};var He=14;var Ge=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152];var Ve=function e(){var t=[],r=He+1;while(r--){t.push("")}return t};var We=function e(t,r){e.prototype.init.call(this);this.field_=t||0;this.dataChannel_=r||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(e){var t,r,i,n,a;t=e.ccData&32639;if(t===this.lastControlCode_){this.lastControlCode_=null;return}if((t&61440)===4096){this.lastControlCode_=t}else if(t!==this.PADDING_){this.lastControlCode_=null}i=t>>>8;n=t&255;if(t===this.PADDING_){return}else if(t===this.RESUME_CAPTION_LOADING_){this.mode_="popOn"}else if(t===this.END_OF_CAPTION_){this.mode_="popOn";this.clearFormatting(e.pts);this.flushDisplayed(e.pts);r=this.displayed_;this.displayed_=this.nonDisplayed_;this.nonDisplayed_=r;this.startPts_=e.pts}else if(t===this.ROLL_UP_2_ROWS_){this.rollUpRows_=2;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_3_ROWS_){this.rollUpRows_=3;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_4_ROWS_){this.rollUpRows_=4;this.setRollUp(e.pts)}else if(t===this.CARRIAGE_RETURN_){this.clearFormatting(e.pts);this.flushDisplayed(e.pts);this.shiftRowsUp_();this.startPts_=e.pts}else if(t===this.BACKSPACE_){if(this.mode_==="popOn"){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}}else if(t===this.ERASE_DISPLAYED_MEMORY_){this.flushDisplayed(e.pts);this.displayed_=Ve()}else if(t===this.ERASE_NON_DISPLAYED_MEMORY_){this.nonDisplayed_=Ve()}else if(t===this.RESUME_DIRECT_CAPTIONING_){if(this.mode_!=="paintOn"){this.flushDisplayed(e.pts);this.displayed_=Ve()}this.mode_="paintOn";this.startPts_=e.pts}else if(this.isSpecialCharacter(i,n)){i=(i&3)<<8;a=qe(i|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isExtCharacter(i,n)){if(this.mode_==="popOn"){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}i=(i&3)<<8;a=qe(i|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isMidRowCode(i,n)){this.clearFormatting(e.pts);this[this.mode_](e.pts," ");this.column_++;if((n&14)===14){this.addFormatting(e.pts,["i"])}if((n&1)===1){this.addFormatting(e.pts,["u"])}}else if(this.isOffsetControlCode(i,n)){this.column_+=n&3}else if(this.isPAC(i,n)){var s=Ge.indexOf(t&7968);if(this.mode_==="rollUp"){if(s-this.rollUpRows_+1<0){s=this.rollUpRows_-1}this.setRollUp(e.pts,s)}if(s!==this.row_){this.clearFormatting(e.pts);this.row_=s}if(n&1&&this.formatting_.indexOf("u")===-1){this.addFormatting(e.pts,["u"])}if((t&16)===16){this.column_=((t&14)>>1)*4}if(this.isColorPAC(n)){if((n&14)===14){this.addFormatting(e.pts,["i"])}}}else if(this.isNormalChar(i)){if(n===0){n=null}a=qe(i);a+=qe(n);this[this.mode_](e.pts,a);this.column_+=a.length}}};We.prototype=new r;We.prototype.flushDisplayed=function(e){var t=this.displayed_.map((function(e,t){try{return e.trim()}catch(e){this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+t+"."});return""}}),this).join("\n").replace(/^\n+|\n+$/g,"");if(t.length){this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})}};We.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=Ve();this.nonDisplayed_=Ve();this.lastControlCode_=null;this.column_=0;this.row_=He;this.rollUpRows_=2;this.formatting_=[]};We.prototype.setConstants=function(){if(this.dataChannel_===0){this.BASE_=16;this.EXT_=17;this.CONTROL_=(20|this.field_)<<8;this.OFFSET_=23}else if(this.dataChannel_===1){this.BASE_=24;this.EXT_=25;this.CONTROL_=(28|this.field_)<<8;this.OFFSET_=31}this.PADDING_=0;this.RESUME_CAPTION_LOADING_=this.CONTROL_|32;this.END_OF_CAPTION_=this.CONTROL_|47;this.ROLL_UP_2_ROWS_=this.CONTROL_|37;this.ROLL_UP_3_ROWS_=this.CONTROL_|38;this.ROLL_UP_4_ROWS_=this.CONTROL_|39;this.CARRIAGE_RETURN_=this.CONTROL_|45;this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41;this.BACKSPACE_=this.CONTROL_|33;this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44;this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46};We.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63};We.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63};We.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47};We.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35};We.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127};We.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127};We.prototype.isNormalChar=function(e){return e>=32&&e<=127};We.prototype.setRollUp=function(e,t){if(this.mode_!=="rollUp"){this.row_=He;this.mode_="rollUp";this.flushDisplayed(e);this.nonDisplayed_=Ve();this.displayed_=Ve()}if(t!==undefined&&t!==this.row_){for(var r=0;r<this.rollUpRows_;r++){this.displayed_[t-r]=this.displayed_[this.row_-r];this.displayed_[this.row_-r]=""}}if(t===undefined){t=this.row_}this.topRow_=t-this.rollUpRows_+1};We.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var r=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,r)};We.prototype.clearFormatting=function(e){if(!this.formatting_.length){return}var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[];this[this.mode_](e,t)};We.prototype.popOn=function(e,t){var r=this.nonDisplayed_[this.row_];r+=t;this.nonDisplayed_[this.row_]=r};We.prototype.rollUp=function(e,t){var r=this.displayed_[this.row_];r+=t;this.displayed_[this.row_]=r};We.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++){this.displayed_[e]=""}for(e=this.row_+1;e<He+1;e++){this.displayed_[e]=""}for(e=this.topRow_;e<this.row_;e++){this.displayed_[e]=this.displayed_[e+1]}this.displayed_[this.row_]=""};We.prototype.paintOn=function(e,t){var r=this.displayed_[this.row_];r+=t;this.displayed_[this.row_]=r};var ze={CaptionStream:Pe,Cea608Stream:We,Cea708Stream:Fe};var Ke={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21};var Xe=8589934592;var Ye=4294967296;var Qe="shared";var $e=function e(t,r){var i=1;if(t>r){i=-1}while(Math.abs(r-t)>Ye){t+=i*Xe}return t};var Je=function e(t){var r,i;e.prototype.init.call(this);this.type_=t||Qe;this.push=function(e){if(this.type_!==Qe&&e.type!==this.type_){return}if(i===undefined){i=e.dts}e.dts=$e(e.dts,i);e.pts=$e(e.pts,i);r=e.dts;this.trigger("data",e)};this.flush=function(){i=r;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};this.discontinuity=function(){i=void 0;r=void 0};this.reset=function(){this.discontinuity();this.trigger("reset")}};Je.prototype=new r;var Ze={TimestampRolloverStream:Je,handleRollover:$e};var et=function e(t,r,i){var n,a="";for(n=r;n<i;n++){a+="%"+("00"+t[n].toString(16)).slice(-2)}return a},tt=function e(t,r,i){return decodeURIComponent(et(t,r,i))},rt=function e(t,r,i){return unescape(et(t,r,i))},it=function e(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},nt={TXXX:function e(t){var r;if(t.data[0]!==3){return}for(r=1;r<t.data.length;r++){if(t.data[r]===0){t.description=tt(t.data,1,r);t.value=tt(t.data,r+1,t.data.length).replace(/\0*$/,"");break}}t.data=t.value},WXXX:function e(t){var r;if(t.data[0]!==3){return}for(r=1;r<t.data.length;r++){if(t.data[r]===0){t.description=tt(t.data,1,r);t.url=tt(t.data,r+1,t.data.length);break}}},PRIV:function e(t){var r;for(r=0;r<t.data.length;r++){if(t.data[r]===0){t.owner=rt(t.data,0,r);break}}t.privateData=t.data.subarray(r+1);t.data=t.privateData}},at;at=function e(t){var r={descriptor:t&&t.descriptor},i=0,n=[],a=0,s;at.prototype.init.call(this);this.dispatchType=Ke.METADATA_STREAM_TYPE.toString(16);if(r.descriptor){for(s=0;s<r.descriptor.length;s++){this.dispatchType+=("00"+r.descriptor[s].toString(16)).slice(-2)}}this.push=function(e){var t,r,s,o,u,l;if(e.type!=="timed-metadata"){return}if(e.dataAlignmentIndicator){a=0;n.length=0}if(n.length===0&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0))){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}n.push(e);a+=e.data.byteLength;if(n.length===1){i=it(e.data.subarray(6,10));i+=10}if(a<i){return}t={data:new Uint8Array(i),frames:[],pts:n[0].pts,dts:n[0].dts};for(u=0;u<i;){t.data.set(n[0].data.subarray(0,i-u),u);u+=n[0].data.byteLength;a-=n[0].data.byteLength;n.shift()}r=10;if(t.data[5]&64){r+=4;r+=it(t.data.subarray(10,14));i-=it(t.data.subarray(16,20))}do{s=it(t.data.subarray(r+4,r+8));if(s<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping metadata parsing."});return}l=String.fromCharCode(t.data[r],t.data[r+1],t.data[r+2],t.data[r+3]);o={id:l,data:t.data.subarray(r+10,r+s+10)};o.key=o.id;if(nt[o.id]){nt[o.id](o);if(o.owner==="com.apple.streaming.transportStreamTimestamp"){var d=o.data,f=(d[3]&1)<<30|d[4]<<22|d[5]<<14|d[6]<<6|d[7]>>>2;f*=4;f+=d[7]&3;o.timeStamp=f;if(t.pts===undefined&&t.dts===undefined){t.pts=o.timeStamp;t.dts=o.timeStamp}this.trigger("timestamp",o)}}t.frames.push(o);r+=10;r+=s}while(r<i);this.trigger("data",t)}};at.prototype=new r;var st=at;var ot=Ze.TimestampRolloverStream;var ut,lt,dt;var ft=188,ct=71;ut=function e(){var t=new Uint8Array(ft),r=0;ut.prototype.init.call(this);this.push=function(e){var i=0,n=ft,a;if(r){a=new Uint8Array(e.byteLength+r);a.set(t.subarray(0,r));a.set(e,r);r=0}else{a=e}while(n<a.byteLength){if(a[i]===ct&&a[n]===ct){this.trigger("data",a.subarray(i,n));i+=ft;n+=ft;continue}i++;n++}if(i<a.byteLength){t.set(a.subarray(i),0);r=a.byteLength-i}};this.flush=function(){if(r===ft&&t[0]===ct){this.trigger("data",t);r=0}this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};this.reset=function(){r=0;this.trigger("reset")}};ut.prototype=new r;lt=function e(){var t,r,i,n;lt.prototype.init.call(this);n=this;this.packetsWaitingForPmt=[];this.programMapTable=undefined;t=function e(t,n){var a=0;if(n.payloadUnitStartIndicator){a+=t[a]+1}if(n.type==="pat"){r(t.subarray(a),n)}else{i(t.subarray(a),n)}};r=function e(t,r){r.section_number=t[7];r.last_section_number=t[8];n.pmtPid=(t[10]&31)<<8|t[11];r.pmtPid=n.pmtPid};i=function e(t,r){var i,a,s,o;if(!(t[5]&1)){return}n.programMapTable={video:null,audio:null,"timed-metadata":{}};i=(t[1]&15)<<8|t[2];a=3+i-4;s=(t[10]&15)<<8|t[11];o=12+s;while(o<a){var u=t[o];var l=(t[o+1]&31)<<8|t[o+2];if(u===Ke.H264_STREAM_TYPE&&n.programMapTable.video===null){n.programMapTable.video=l}else if(u===Ke.ADTS_STREAM_TYPE&&n.programMapTable.audio===null){n.programMapTable.audio=l}else if(u===Ke.METADATA_STREAM_TYPE){n.programMapTable["timed-metadata"][l]=u}o+=((t[o+3]&15)<<8|t[o+4])+5}r.programMapTable=n.programMapTable};this.push=function(e){var r={},i=4;r.payloadUnitStartIndicator=!!(e[1]&64);r.pid=e[1]&31;r.pid<<=8;r.pid|=e[2];if((e[3]&48)>>>4>1){i+=e[i]+1}if(r.pid===0){r.type="pat";t(e.subarray(i),r);this.trigger("data",r)}else if(r.pid===this.pmtPid){r.type="pmt";t(e.subarray(i),r);this.trigger("data",r);while(this.packetsWaitingForPmt.length){this.processPes_.apply(this,this.packetsWaitingForPmt.shift())}}else if(this.programMapTable===undefined){this.packetsWaitingForPmt.push([e,i,r])}else{this.processPes_(e,i,r)}};this.processPes_=function(e,t,r){if(r.pid===this.programMapTable.video){r.streamType=Ke.H264_STREAM_TYPE}else if(r.pid===this.programMapTable.audio){r.streamType=Ke.ADTS_STREAM_TYPE}else{r.streamType=this.programMapTable["timed-metadata"][r.pid]}r.type="pes";r.data=e.subarray(t);this.trigger("data",r)}};lt.prototype=new r;lt.STREAM_TYPES={h264:27,adts:15};dt=function e(){var t=this,r=false,i={data:[],size:0},n={data:[],size:0},a={data:[],size:0},s,o=function e(t,r){var i;var n=t[0]<<16|t[1]<<8|t[2];r.data=new Uint8Array;if(n!==1){return}r.packetLength=6+(t[4]<<8|t[5]);r.dataAlignmentIndicator=(t[6]&4)!==0;i=t[7];if(i&192){r.pts=(t[9]&14)<<27|(t[10]&255)<<20|(t[11]&254)<<12|(t[12]&255)<<5|(t[13]&254)>>>3;r.pts*=4;r.pts+=(t[13]&6)>>>1;r.dts=r.pts;if(i&64){r.dts=(t[14]&14)<<27|(t[15]&255)<<20|(t[16]&254)<<12|(t[17]&255)<<5|(t[18]&254)>>>3;r.dts*=4;r.dts+=(t[18]&6)>>>1}}r.data=t.subarray(9+t[8])},u=function e(r,i,n){var a=new Uint8Array(r.size),s={type:i},u=0,l=0,d=false,f;if(!r.data.length||r.size<9){return}s.trackId=r.data[0].pid;for(u=0;u<r.data.length;u++){f=r.data[u];a.set(f.data,l);l+=f.data.byteLength}o(a,s);d=i==="video"||s.packetLength<=r.size;if(n||d){r.size=0;r.data.length=0}if(d){t.trigger("data",s)}};dt.prototype.init.call(this);this.push=function(e){({pat:function e(){},pes:function t(){var r,s;switch(e.streamType){case Ke.H264_STREAM_TYPE:r=i;s="video";break;case Ke.ADTS_STREAM_TYPE:r=n;s="audio";break;case Ke.METADATA_STREAM_TYPE:r=a;s="timed-metadata";break;default:return}if(e.payloadUnitStartIndicator){u(r,s,true)}r.data.push(e);r.size+=e.data.byteLength},pmt:function i(){var n={type:"metadata",tracks:[]};s=e.programMapTable;if(s.video!==null){n.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+s.video,codec:"avc",type:"video"})}if(s.audio!==null){n.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+s.audio,codec:"adts",type:"audio"})}r=true;t.trigger("data",n)}})[e.type]()};this.reset=function(){i.size=0;i.data.length=0;n.size=0;n.data.length=0;this.trigger("reset")};this.flushStreams_=function(){u(i,"video");u(n,"audio");u(a,"timed-metadata")};this.flush=function(){if(!r&&s){var e={type:"metadata",tracks:[]};if(s.video!==null){e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+s.video,codec:"avc",type:"video"})}if(s.audio!==null){e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+s.audio,codec:"adts",type:"audio"})}t.trigger("data",e)}r=false;this.flushStreams_();this.trigger("done")}};dt.prototype=new r;var ht={PAT_PID:0,MP2T_PACKET_LENGTH:ft,TransportPacketStream:ut,TransportParseStream:lt,ElementaryStream:dt,TimestampRolloverStream:ot,CaptionStream:ze.CaptionStream,Cea608Stream:ze.Cea608Stream,Cea708Stream:ze.Cea708Stream,MetadataStream:st};for(var pt in Ke){if(Ke.hasOwnProperty(pt)){ht[pt]=Ke[pt]}}var vt=ht;var mt=pe.ONE_SECOND_IN_TS;var gt;var yt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];gt=function e(t){var r,i=0;gt.prototype.init.call(this);this.skipWarn_=function(e,t){this.trigger("log",{level:"warn",message:"adts skiping bytes "+e+" to "+t+" in frame "+i+" outside syncword"})};this.push=function(e){var n=0,a,s,o,u,l;if(!t){i=0}if(e.type!=="audio"){return}if(r&&r.length){o=r;r=new Uint8Array(o.byteLength+e.data.byteLength);r.set(o);r.set(e.data,o.byteLength)}else{r=e.data}var d;while(n+7<r.length){if(r[n]!==255||(r[n+1]&246)!==240){if(typeof d!=="number"){d=n}n++;continue}if(typeof d==="number"){this.skipWarn_(d,n);d=null}s=(~r[n+1]&1)*2;a=(r[n+3]&3)<<11|r[n+4]<<3|(r[n+5]&224)>>5;u=((r[n+6]&3)+1)*1024;l=u*mt/yt[(r[n+2]&60)>>>2];if(r.byteLength-n<a){break}this.trigger("data",{pts:e.pts+i*l,dts:e.dts+i*l,sampleCount:u,audioobjecttype:(r[n+2]>>>6&3)+1,channelcount:(r[n+2]&1)<<2|(r[n+3]&192)>>>6,samplerate:yt[(r[n+2]&60)>>>2],samplingfrequencyindex:(r[n+2]&60)>>>2,samplesize:16,data:r.subarray(n+7+s,n+a)});i++;n+=a}if(typeof d==="number"){this.skipWarn_(d,n);d=null}r=r.subarray(n)};this.flush=function(){i=0;this.trigger("done")};this.reset=function(){r=void 0;this.trigger("reset")};this.endTimeline=function(){r=void 0;this.trigger("endedtimeline")}};gt.prototype=new r;var _t=gt;var bt;bt=function e(t){var r=t.byteLength,i=0,n=0;this.length=function(){return 8*r};this.bitsAvailable=function(){return 8*r+n};this.loadWord=function(){var e=t.byteLength-r,a=new Uint8Array(4),s=Math.min(4,r);if(s===0){throw new Error("no bytes available")}a.set(t.subarray(e,e+s));i=new DataView(a.buffer).getUint32(0);n=s*8;r-=s};this.skipBits=function(e){var t;if(n>e){i<<=e;n-=e}else{e-=n;t=Math.floor(e/8);e-=t*8;r-=t;this.loadWord();i<<=e;n-=e}};this.readBits=function(e){var t=Math.min(n,e),a=i>>>32-t;n-=t;if(n>0){i<<=t}else if(r>0){this.loadWord()}t=e-t;if(t>0){return a<<t|this.readBits(t)}return a};this.skipLeadingZeros=function(){var e;for(e=0;e<n;++e){if((i&2147483648>>>e)!==0){i<<=e;n-=e;return e}}this.loadWord();return e+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1};this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();if(1&e){return 1+e>>>1}return-1*(e>>>1)};this.readBoolean=function(){return this.readBits(1)===1};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};var Tt=bt;var St,wt;var Et;wt=function e(){var t=0,r,i;wt.prototype.init.call(this);this.push=function(e){var n;if(!i){i=e.data}else{n=new Uint8Array(i.byteLength+e.data.byteLength);n.set(i);n.set(e.data,i.byteLength);i=n}var a=i.byteLength;for(;t<a-3;t++){if(i[t+2]===1){r=t+5;break}}while(r<a){switch(i[r]){case 0:if(i[r-1]!==0){r+=2;break}else if(i[r-2]!==0){r++;break}if(t+3!==r-2){this.trigger("data",i.subarray(t+3,r-2))}do{r++}while(i[r]!==1&&r<a);t=r-2;r+=3;break;case 1:if(i[r-1]!==0||i[r-2]!==0){r+=3;break}this.trigger("data",i.subarray(t+3,r-2));t=r-2;r+=3;break;default:r+=3;break}}i=i.subarray(t);r-=t;t=0};this.reset=function(){i=null;t=0;this.trigger("reset")};this.flush=function(){if(i&&i.byteLength>3){this.trigger("data",i.subarray(t+3))}i=null;t=0;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")}};wt.prototype=new r;Et={100:true,110:true,122:true,244:true,44:true,83:true,86:true,118:true,128:true,138:true,139:true,134:true};St=function e(){var t=new wt,r,i,n,a,s,o,u;St.prototype.init.call(this);r=this;this.push=function(e){if(e.type!=="video"){return}i=e.trackId;n=e.pts;a=e.dts;t.push(e)};t.on("data",(function(e){var t={trackId:i,pts:n,dts:a,data:e,nalUnitTypeCode:e[0]&31};switch(t.nalUnitTypeCode){case 5:t.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:t.nalUnitType="sei_rbsp";t.escapedRBSP=s(e.subarray(1));break;case 7:t.nalUnitType="seq_parameter_set_rbsp";t.escapedRBSP=s(e.subarray(1));t.config=o(t.escapedRBSP);break;case 8:t.nalUnitType="pic_parameter_set_rbsp";break;case 9:t.nalUnitType="access_unit_delimiter_rbsp";break}r.trigger("data",t)}));t.on("done",(function(){r.trigger("done")}));t.on("partialdone",(function(){r.trigger("partialdone")}));t.on("reset",(function(){r.trigger("reset")}));t.on("endedtimeline",(function(){r.trigger("endedtimeline")}));this.flush=function(){t.flush()};this.partialFlush=function(){t.partialFlush()};this.reset=function(){t.reset()};this.endTimeline=function(){t.endTimeline()};u=function e(t,r){var i=8,n=8,a,s;for(a=0;a<t;a++){if(n!==0){s=r.readExpGolomb();n=(i+s+256)%256}i=n===0?i:n}};s=function e(t){var r=t.byteLength,i=[],n=1,a,s;while(n<r-2){if(t[n]===0&&t[n+1]===0&&t[n+2]===3){i.push(n+2);n+=2}else{n++}}if(i.length===0){return t}a=r-i.length;s=new Uint8Array(a);var o=0;for(n=0;n<a;o++,n++){if(o===i[0]){o++;i.shift()}s[n]=t[o]}return s};o=function e(t){var r=0,i=0,n=0,a=0,s,o,l,d,f,c,h,p,v,m,g,y=[1,1],_,b;s=new Tt(t);o=s.readUnsignedByte();d=s.readUnsignedByte();l=s.readUnsignedByte();s.skipUnsignedExpGolomb();if(Et[o]){f=s.readUnsignedExpGolomb();if(f===3){s.skipBits(1)}s.skipUnsignedExpGolomb();s.skipUnsignedExpGolomb();s.skipBits(1);if(s.readBoolean()){g=f!==3?8:12;for(b=0;b<g;b++){if(s.readBoolean()){if(b<6){u(16,s)}else{u(64,s)}}}}}s.skipUnsignedExpGolomb();c=s.readUnsignedExpGolomb();if(c===0){s.readUnsignedExpGolomb()}else if(c===1){s.skipBits(1);s.skipExpGolomb();s.skipExpGolomb();h=s.readUnsignedExpGolomb();for(b=0;b<h;b++){s.skipExpGolomb()}}s.skipUnsignedExpGolomb();s.skipBits(1);p=s.readUnsignedExpGolomb();v=s.readUnsignedExpGolomb();m=s.readBits(1);if(m===0){s.skipBits(1)}s.skipBits(1);if(s.readBoolean()){r=s.readUnsignedExpGolomb();i=s.readUnsignedExpGolomb();n=s.readUnsignedExpGolomb();a=s.readUnsignedExpGolomb()}if(s.readBoolean()){if(s.readBoolean()){_=s.readUnsignedByte();switch(_){case 1:y=[1,1];break;case 2:y=[12,11];break;case 3:y=[10,11];break;case 4:y=[16,11];break;case 5:y=[40,33];break;case 6:y=[24,11];break;case 7:y=[20,11];break;case 8:y=[32,11];break;case 9:y=[80,33];break;case 10:y=[18,11];break;case 11:y=[15,11];break;case 12:y=[64,33];break;case 13:y=[160,99];break;case 14:y=[4,3];break;case 15:y=[3,2];break;case 16:y=[2,1];break;case 255:{y=[s.readUnsignedByte()<<8|s.readUnsignedByte(),s.readUnsignedByte()<<8|s.readUnsignedByte()];break}}if(y){y[0]/y[1]}}}return{profileIdc:o,levelIdc:l,profileCompatibility:d,width:(p+1)*16-r*2-i*2,height:(2-m)*(v+1)*16-n*2-a*2,sarRatio:y}}};St.prototype=new r;var kt={H264Stream:St,NalByteStream:wt};var At=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];var Ct=function e(t,r){var i=t[r+6]<<21|t[r+7]<<14|t[r+8]<<7|t[r+9],n=t[r+5],a=(n&16)>>4;i=i>=0?i:0;if(a){return i+20}return i+10};var It=function e(t,r){if(t.length-r<10||t[r]!=="I".charCodeAt(0)||t[r+1]!=="D".charCodeAt(0)||t[r+2]!=="3".charCodeAt(0)){return r}r+=Ct(t,r);return e(t,r)};var Dt=function e(t){var r=It(t,0);return t.length>=r+2&&(t[r]&255)===255&&(t[r+1]&240)===240&&(t[r+1]&22)===16};var xt=function e(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]};var Lt=function e(t,r,i){var n,a="";for(n=r;n<i;n++){a+="%"+("00"+t[n].toString(16)).slice(-2)}return a};var Ot=function e(t,r,i){return unescape(Lt(t,r,i))};var Pt=function e(t,r){var i=(t[r+5]&224)>>5,n=t[r+4]<<3,a=t[r+3]&3<<11;return a|n|i};var Rt=function e(t,r){if(t[r]==="I".charCodeAt(0)&&t[r+1]==="D".charCodeAt(0)&&t[r+2]==="3".charCodeAt(0)){return"timed-metadata"}else if(t[r]&255===255&&(t[r+1]&240)===240){return"audio"}return null};var Ut=function e(t){var r=0;while(r+5<t.length){if(t[r]!==255||(t[r+1]&246)!==240){r++;continue}return At[(t[r+2]&60)>>>2]}return null};var Mt=function e(t){var r,i,n,a;r=10;if(t[5]&64){r+=4;r+=xt(t.subarray(10,14))}do{i=xt(t.subarray(r+4,r+8));if(i<1){return null}a=String.fromCharCode(t[r],t[r+1],t[r+2],t[r+3]);if(a==="PRIV"){n=t.subarray(r+10,r+i+10);for(var s=0;s<n.byteLength;s++){if(n[s]===0){var o=Ot(n,0,s);if(o==="com.apple.streaming.transportStreamTimestamp"){var u=n.subarray(s+1);var l=(u[3]&1)<<30|u[4]<<22|u[5]<<14|u[6]<<6|u[7]>>>2;l*=4;l+=u[7]&3;return l}break}}}r+=10;r+=i}while(r<t.byteLength);return null};var Nt={isLikelyAacData:Dt,parseId3TagSize:Ct,parseAdtsSize:Pt,parseType:Rt,parseSampleRate:Ut,parseAacTimestamp:Mt};var Bt;Bt=function e(){var t=new Uint8Array,r=0;Bt.prototype.init.call(this);this.setTimestamp=function(e){r=e};this.push=function(e){var i=0,n=0,a,s,o,u;if(t.length){u=t.length;t=new Uint8Array(e.byteLength+u);t.set(t.subarray(0,u));t.set(e,u)}else{t=e}while(t.length-n>=3){if(t[n]==="I".charCodeAt(0)&&t[n+1]==="D".charCodeAt(0)&&t[n+2]==="3".charCodeAt(0)){if(t.length-n<10){break}i=Nt.parseId3TagSize(t,n);if(n+i>t.length){break}s={type:"timed-metadata",data:t.subarray(n,n+i)};this.trigger("data",s);n+=i;continue}else if((t[n]&255)===255&&(t[n+1]&240)===240){if(t.length-n<7){break}i=Nt.parseAdtsSize(t,n);if(n+i>t.length){break}o={type:"audio",data:t.subarray(n,n+i),pts:r,dts:r};this.trigger("data",o);n+=i;continue}n++}a=t.length-n;if(a>0){t=t.subarray(n)}else{t=new Uint8Array}};this.reset=function(){t=new Uint8Array;this.trigger("reset")};this.endTimeline=function(){t=new Uint8Array;this.trigger("endedtimeline")}};Bt.prototype=new r;var Ft=Bt;var jt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"];var qt=jt;var Ht=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"];var Gt=Ht;var Vt=kt.H264Stream;var Wt=Nt.isLikelyAacData;var zt=pe.ONE_SECOND_IN_TS;var Kt,Xt,Yt,Qt;var $t=function e(t,r){r.stream=t;this.trigger("log",r)};var Jt=function e(t,r){var i=Object.keys(r);for(var n=0;n<i.length;n++){var a=i[n];if(a==="headOfPipeline"||!r[a].on){continue}r[a].on("log",$t.bind(t,a))}};var Zt=function e(t,r){var i;if(t.length!==r.length){return false}for(i=0;i<t.length;i++){if(t[i]!==r[i]){return false}}return true};var er=function e(t,r,i,n,a,s){var o=i-r,u=n-r,l=a-i;return{start:{dts:t,pts:t+o},end:{dts:t+u,pts:t+l},prependedContentDuration:s,baseMediaDecodeTime:t}};Xt=function e(t,r){var i=[],n,a=0,s=0,o=Infinity;r=r||{};n=r.firstSequenceNumber||0;Xt.prototype.init.call(this);this.push=function(e){ke.collectDtsInfo(t,e);if(t){qt.forEach((function(r){t[r]=e[r]}))}i.push(e)};this.setEarliestDts=function(e){a=e};this.setVideoBaseMediaDecodeTime=function(e){o=e};this.setAudioAppendStart=function(e){s=e};this.flush=function(){var e,u,l,d,f,c,h;if(i.length===0){this.trigger("done","AudioSegmentStream");return}e=be.trimAdtsFramesByEarliestDts(i,t,a);t.baseMediaDecodeTime=ke.calculateTrackBaseMediaDecodeTime(t,r.keepOriginalTimestamps);h=be.prefixWithSilence(t,e,s,o);t.samples=be.generateSampleTable(e);l=G.mdat(be.concatenateFrameData(e));i=[];u=G.moof(n,[t]);d=new Uint8Array(u.byteLength+l.byteLength);n++;d.set(u);d.set(l,u.byteLength);ke.clearDtsInfo(t);f=Math.ceil(zt*1024/t.samplerate);if(e.length){c=e.length*f;this.trigger("segmentTimingInfo",er(pe.audioTsToVideoTs(t.baseMediaDecodeTime,t.samplerate),e[0].dts,e[0].pts,e[0].dts+c,e[0].pts+c,h||0));this.trigger("timingInfo",{start:e[0].pts,end:e[0].pts+c})}this.trigger("data",{track:t,boxes:d});this.trigger("done","AudioSegmentStream")};this.reset=function(){ke.clearDtsInfo(t);i=[];this.trigger("reset")}};Xt.prototype=new r;Kt=function e(t,r){var i,n=[],a=[],s,o;r=r||{};i=r.firstSequenceNumber||0;Kt.prototype.init.call(this);delete t.minPTS;this.gopCache_=[];this.push=function(e){ke.collectDtsInfo(t,e);if(e.nalUnitType==="seq_parameter_set_rbsp"&&!s){s=e.config;t.sps=[e.data];Gt.forEach((function(e){t[e]=s[e]}),this)}if(e.nalUnitType==="pic_parameter_set_rbsp"&&!o){o=e.data;t.pps=[e.data]}n.push(e)};this.flush=function(){var e,s,o,u,l,d,f=0,c,h;while(n.length){if(n[0].nalUnitType==="access_unit_delimiter_rbsp"){break}n.shift()}if(n.length===0){this.resetStream_();this.trigger("done","VideoSegmentStream");return}e=Z.groupNalsIntoFrames(n);o=Z.groupFramesIntoGops(e);if(!o[0][0].keyFrame){s=this.getGopForFusion_(n[0],t);if(s){f=s.duration;o.unshift(s);o.byteLength+=s.byteLength;o.nalCount+=s.nalCount;o.pts=s.pts;o.dts=s.dts;o.duration+=s.duration}else{o=Z.extendFirstKeyFrame(o)}}if(a.length){var p;if(r.alignGopsAtEnd){p=this.alignGopsAtEnd_(o)}else{p=this.alignGopsAtStart_(o)}if(!p){this.gopCache_.unshift({gop:o.pop(),pps:t.pps,sps:t.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);n=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}ke.clearDtsInfo(t);o=p}ke.collectDtsInfo(t,o);t.samples=Z.generateSampleTable(o);l=G.mdat(Z.concatenateNalData(o));t.baseMediaDecodeTime=ke.calculateTrackBaseMediaDecodeTime(t,r.keepOriginalTimestamps);this.trigger("processedGopsInfo",o.map((function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})));c=o[0];h=o[o.length-1];this.trigger("segmentTimingInfo",er(t.baseMediaDecodeTime,c.dts,c.pts,h.dts+h.duration,h.pts+h.duration,f));this.trigger("timingInfo",{start:o[0].pts,end:o[o.length-1].pts+o[o.length-1].duration});this.gopCache_.unshift({gop:o.pop(),pps:t.pps,sps:t.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);n=[];this.trigger("baseMediaDecodeTime",t.baseMediaDecodeTime);this.trigger("timelineStartInfo",t.timelineStartInfo);u=G.moof(i,[t]);d=new Uint8Array(u.byteLength+l.byteLength);i++;d.set(u);d.set(l,u.byteLength);this.trigger("data",{track:t,boxes:d});this.resetStream_();this.trigger("done","VideoSegmentStream")};this.reset=function(){this.resetStream_();n=[];this.gopCache_.length=0;a.length=0;this.trigger("reset")};this.resetStream_=function(){ke.clearDtsInfo(t);s=undefined;o=undefined};this.getGopForFusion_=function(e){var r=45e3,i=1e4,n=Infinity,a,s,o,u,l;for(l=0;l<this.gopCache_.length;l++){u=this.gopCache_[l];o=u.gop;if(!(t.pps&&Zt(t.pps[0],u.pps[0]))||!(t.sps&&Zt(t.sps[0],u.sps[0]))){continue}if(o.dts<t.timelineStartInfo.dts){continue}a=e.dts-o.dts-o.duration;if(a>=-i&&a<=r){if(!s||n>a){s=u;n=a}}}if(s){return s.gop}return null};this.alignGopsAtStart_=function(e){var t,r,i,n,s,o,u,l;s=e.byteLength;o=e.nalCount;u=e.duration;t=r=0;while(t<a.length&&r<e.length){i=a[t];n=e[r];if(i.pts===n.pts){break}if(n.pts>i.pts){t++;continue}r++;s-=n.byteLength;o-=n.nalCount;u-=n.duration}if(r===0){return e}if(r===e.length){return null}l=e.slice(r);l.byteLength=s;l.duration=u;l.nalCount=o;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsAtEnd_=function(e){var t,r,i,n,s,o;t=a.length-1;r=e.length-1;s=null;o=false;while(t>=0&&r>=0){i=a[t];n=e[r];if(i.pts===n.pts){o=true;break}if(i.pts>n.pts){t--;continue}if(t===a.length-1){s=r}r--}if(!o&&s===null){return null}var u;if(o){u=r}else{u=s}if(u===0){return e}var l=e.slice(u);var d=l.reduce((function(e,t){e.byteLength+=t.byteLength;e.duration+=t.duration;e.nalCount+=t.nalCount;return e}),{byteLength:0,duration:0,nalCount:0});l.byteLength=d.byteLength;l.duration=d.duration;l.nalCount=d.nalCount;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsWith=function(e){a=e}};Kt.prototype=new r;Qt=function e(t,r){this.numberOfTracks=0;this.metadataStream=r;t=t||{};if(typeof t.remux!=="undefined"){this.remuxTracks=!!t.remux}else{this.remuxTracks=true}if(typeof t.keepOriginalTimestamps==="boolean"){this.keepOriginalTimestamps=t.keepOriginalTimestamps}else{this.keepOriginalTimestamps=false}this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.pendingBytes=0;this.emittedTracks=0;Qt.prototype.init.call(this);this.push=function(e){if(e.text){return this.pendingCaptions.push(e)}if(e.frames){return this.pendingMetadata.push(e)}this.pendingTracks.push(e.track);this.pendingBytes+=e.boxes.byteLength;if(e.track.type==="video"){this.videoTrack=e.track;this.pendingBoxes.push(e.boxes)}if(e.track.type==="audio"){this.audioTrack=e.track;this.pendingBoxes.unshift(e.boxes)}}};Qt.prototype=new r;Qt.prototype.flush=function(e){var t=0,r={captions:[],captionStreams:{},metadata:[],info:{}},i,n,a,s=0,o;if(this.pendingTracks.length<this.numberOfTracks){if(e!=="VideoSegmentStream"&&e!=="AudioSegmentStream"){return}else if(this.remuxTracks){return}else if(this.pendingTracks.length===0){this.emittedTracks++;if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}return}}if(this.videoTrack){s=this.videoTrack.timelineStartInfo.pts;Gt.forEach((function(e){r.info[e]=this.videoTrack[e]}),this)}else if(this.audioTrack){s=this.audioTrack.timelineStartInfo.pts;qt.forEach((function(e){r.info[e]=this.audioTrack[e]}),this)}if(this.videoTrack||this.audioTrack){if(this.pendingTracks.length===1){r.type=this.pendingTracks[0].type}else{r.type="combined"}this.emittedTracks+=this.pendingTracks.length;a=G.initSegment(this.pendingTracks);r.initSegment=new Uint8Array(a.byteLength);r.initSegment.set(a);r.data=new Uint8Array(this.pendingBytes);for(o=0;o<this.pendingBoxes.length;o++){r.data.set(this.pendingBoxes[o],t);t+=this.pendingBoxes[o].byteLength}for(o=0;o<this.pendingCaptions.length;o++){i=this.pendingCaptions[o];i.startTime=pe.metadataTsToSeconds(i.startPts,s,this.keepOriginalTimestamps);i.endTime=pe.metadataTsToSeconds(i.endPts,s,this.keepOriginalTimestamps);r.captionStreams[i.stream]=true;r.captions.push(i)}for(o=0;o<this.pendingMetadata.length;o++){n=this.pendingMetadata[o];n.cueTime=pe.metadataTsToSeconds(n.pts,s,this.keepOriginalTimestamps);r.metadata.push(n)}r.metadata.dispatchType=this.metadataStream.dispatchType;this.pendingTracks.length=0;this.videoTrack=null;this.pendingBoxes.length=0;this.pendingCaptions.length=0;this.pendingBytes=0;this.pendingMetadata.length=0;this.trigger("data",r);for(o=0;o<r.captions.length;o++){i=r.captions[o];this.trigger("caption",i)}for(o=0;o<r.metadata.length;o++){n=r.metadata[o];this.trigger("id3Frame",n)}}if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}};Qt.prototype.setRemux=function(e){this.remuxTracks=e};Yt=function e(t){var r=this,i=true,n,a;Yt.prototype.init.call(this);t=t||{};this.baseMediaDecodeTime=t.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var e={};this.transmuxPipeline_=e;e.type="aac";e.metadataStream=new vt.MetadataStream;e.aacStream=new Ft;e.audioTimestampRolloverStream=new vt.TimestampRolloverStream("audio");e.timedMetadataTimestampRolloverStream=new vt.TimestampRolloverStream("timed-metadata");e.adtsStream=new _t;e.coalesceStream=new Qt(t,e.metadataStream);e.headOfPipeline=e.aacStream;e.aacStream.pipe(e.audioTimestampRolloverStream).pipe(e.adtsStream);e.aacStream.pipe(e.timedMetadataTimestampRolloverStream).pipe(e.metadataStream).pipe(e.coalesceStream);e.metadataStream.on("timestamp",(function(t){e.aacStream.setTimestamp(t.timeStamp)}));e.aacStream.on("data",(function(i){if(i.type!=="timed-metadata"&&i.type!=="audio"||e.audioSegmentStream){return}a=a||{timelineStartInfo:{baseMediaDecodeTime:r.baseMediaDecodeTime},codec:"adts",type:"audio"};e.coalesceStream.numberOfTracks++;e.audioSegmentStream=new Xt(a,t);e.audioSegmentStream.on("log",r.getLogTrigger_("audioSegmentStream"));e.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo"));e.adtsStream.pipe(e.audioSegmentStream).pipe(e.coalesceStream);r.trigger("trackinfo",{hasAudio:!!a,hasVideo:!!n})}));e.coalesceStream.on("data",this.trigger.bind(this,"data"));e.coalesceStream.on("done",this.trigger.bind(this,"done"));Jt(this,e)};this.setupTsPipeline=function(){var e={};this.transmuxPipeline_=e;e.type="ts";e.metadataStream=new vt.MetadataStream;e.packetStream=new vt.TransportPacketStream;e.parseStream=new vt.TransportParseStream;e.elementaryStream=new vt.ElementaryStream;e.timestampRolloverStream=new vt.TimestampRolloverStream;e.adtsStream=new _t;e.h264Stream=new Vt;e.captionStream=new vt.CaptionStream(t);e.coalesceStream=new Qt(t,e.metadataStream);e.headOfPipeline=e.packetStream;e.packetStream.pipe(e.parseStream).pipe(e.elementaryStream).pipe(e.timestampRolloverStream);e.timestampRolloverStream.pipe(e.h264Stream);e.timestampRolloverStream.pipe(e.adtsStream);e.timestampRolloverStream.pipe(e.metadataStream).pipe(e.coalesceStream);e.h264Stream.pipe(e.captionStream).pipe(e.coalesceStream);e.elementaryStream.on("data",(function(i){var s;if(i.type==="metadata"){s=i.tracks.length;while(s--){if(!n&&i.tracks[s].type==="video"){n=i.tracks[s];n.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime}else if(!a&&i.tracks[s].type==="audio"){a=i.tracks[s];a.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime}}if(n&&!e.videoSegmentStream){e.coalesceStream.numberOfTracks++;e.videoSegmentStream=new Kt(n,t);e.videoSegmentStream.on("log",r.getLogTrigger_("videoSegmentStream"));e.videoSegmentStream.on("timelineStartInfo",(function(i){if(a&&!t.keepOriginalTimestamps){a.timelineStartInfo=i;e.audioSegmentStream.setEarliestDts(i.dts-r.baseMediaDecodeTime)}}));e.videoSegmentStream.on("processedGopsInfo",r.trigger.bind(r,"gopInfo"));e.videoSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"videoSegmentTimingInfo"));e.videoSegmentStream.on("baseMediaDecodeTime",(function(t){if(a){e.audioSegmentStream.setVideoBaseMediaDecodeTime(t)}}));e.videoSegmentStream.on("timingInfo",r.trigger.bind(r,"videoTimingInfo"));e.h264Stream.pipe(e.videoSegmentStream).pipe(e.coalesceStream)}if(a&&!e.audioSegmentStream){e.coalesceStream.numberOfTracks++;e.audioSegmentStream=new Xt(a,t);e.audioSegmentStream.on("log",r.getLogTrigger_("audioSegmentStream"));e.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo"));e.audioSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"audioSegmentTimingInfo"));e.adtsStream.pipe(e.audioSegmentStream).pipe(e.coalesceStream)}r.trigger("trackinfo",{hasAudio:!!a,hasVideo:!!n})}}));e.coalesceStream.on("data",this.trigger.bind(this,"data"));e.coalesceStream.on("id3Frame",(function(t){t.dispatchType=e.metadataStream.dispatchType;r.trigger("id3Frame",t)}));e.coalesceStream.on("caption",this.trigger.bind(this,"caption"));e.coalesceStream.on("done",this.trigger.bind(this,"done"));Jt(this,e)};this.setBaseMediaDecodeTime=function(e){var r=this.transmuxPipeline_;if(!t.keepOriginalTimestamps){this.baseMediaDecodeTime=e}if(a){a.timelineStartInfo.dts=undefined;a.timelineStartInfo.pts=undefined;ke.clearDtsInfo(a);if(r.audioTimestampRolloverStream){r.audioTimestampRolloverStream.discontinuity()}}if(n){if(r.videoSegmentStream){r.videoSegmentStream.gopCache_=[]}n.timelineStartInfo.dts=undefined;n.timelineStartInfo.pts=undefined;ke.clearDtsInfo(n);r.captionStream.reset()}if(r.timestampRolloverStream){r.timestampRolloverStream.discontinuity()}};this.setAudioAppendStart=function(e){if(a){this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)}};this.setRemux=function(e){var r=this.transmuxPipeline_;t.remux=e;if(r&&r.coalesceStream){r.coalesceStream.setRemux(e)}};this.alignGopsWith=function(e){if(n&&this.transmuxPipeline_.videoSegmentStream){this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)}};this.getLogTrigger_=function(e){var t=this;return function(r){r.stream=e;t.trigger("log",r)}};this.push=function(e){if(i){var t=Wt(e);if(t&&this.transmuxPipeline_.type!=="aac"){this.setupAacPipeline()}else if(!t&&this.transmuxPipeline_.type!=="ts"){this.setupTsPipeline()}i=false}this.transmuxPipeline_.headOfPipeline.push(e)};this.flush=function(){i=true;this.transmuxPipeline_.headOfPipeline.flush()};this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()};this.reset=function(){if(this.transmuxPipeline_.headOfPipeline){this.transmuxPipeline_.headOfPipeline.reset()}};this.resetCaptions=function(){if(this.transmuxPipeline_.captionStream){this.transmuxPipeline_.captionStream.reset()}}};Yt.prototype=new r;var tr={Transmuxer:Yt,VideoSegmentStream:Kt,AudioSegmentStream:Xt,AUDIO_PROPERTIES:qt,VIDEO_PROPERTIES:Gt,generateSegmentTimingInfo:er};var rr=function e(t){return t>>>0};var ir=function e(t){return("00"+t.toString(16)).slice(-2)};var nr={toUnsigned:rr,toHexString:ir};var ar=function e(t){var r="";r+=String.fromCharCode(t[0]);r+=String.fromCharCode(t[1]);r+=String.fromCharCode(t[2]);r+=String.fromCharCode(t[3]);return r};var sr=ar;var or=nr.toUnsigned;var ur=function e(t,r){var i=[],n,a,s,o,u;if(!r.length){return null}for(n=0;n<t.byteLength;){a=or(t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]);s=sr(t.subarray(n+4,n+8));o=a>1?n+a:t.byteLength;if(s===r[0]){if(r.length===1){i.push(t.subarray(n+8,o))}else{u=e(t.subarray(n+8,o),r.slice(1));if(u.length){i=i.concat(u)}}}n=o}return i};var lr=ur;var dr=nr.toUnsigned;var fr=a.getUint64;var cr=function e(t){var r={version:t[0],flags:new Uint8Array(t.subarray(1,4))};if(r.version===1){r.baseMediaDecodeTime=fr(t.subarray(4))}else{r.baseMediaDecodeTime=dr(t[4]<<24|t[5]<<16|t[6]<<8|t[7])}return r};var hr=cr;var pr=function e(t){return{isLeading:(t[0]&12)>>>2,dependsOn:t[0]&3,isDependedOn:(t[1]&192)>>>6,hasRedundancy:(t[1]&48)>>>4,paddingValue:(t[1]&14)>>>1,isNonSyncSample:t[1]&1,degradationPriority:t[2]<<8|t[3]}};var vr=pr;var mr=function e(t){var r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},i=new DataView(t.buffer,t.byteOffset,t.byteLength),n=r.flags[2]&1,a=r.flags[2]&4,s=r.flags[1]&1,o=r.flags[1]&2,u=r.flags[1]&4,l=r.flags[1]&8,d=i.getUint32(4),f=8,c;if(n){r.dataOffset=i.getInt32(f);f+=4}if(a&&d){c={flags:vr(t.subarray(f,f+4))};f+=4;if(s){c.duration=i.getUint32(f);f+=4}if(o){c.size=i.getUint32(f);f+=4}if(l){if(r.version===1){c.compositionTimeOffset=i.getInt32(f)}else{c.compositionTimeOffset=i.getUint32(f)}f+=4}r.samples.push(c);d--}while(d--){c={};if(s){c.duration=i.getUint32(f);f+=4}if(o){c.size=i.getUint32(f);f+=4}if(u){c.flags=vr(t.subarray(f,f+4));f+=4}if(l){if(r.version===1){c.compositionTimeOffset=i.getInt32(f)}else{c.compositionTimeOffset=i.getUint32(f)}f+=4}r.samples.push(c)}return r};var gr=mr;var yr=function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:r.getUint32(4)},n=i.flags[2]&1,a=i.flags[2]&2,s=i.flags[2]&8,o=i.flags[2]&16,u=i.flags[2]&32,l=i.flags[0]&65536,d=i.flags[0]&131072,f;f=8;if(n){f+=4;i.baseDataOffset=r.getUint32(12);f+=4}if(a){i.sampleDescriptionIndex=r.getUint32(f);f+=4}if(s){i.defaultSampleDuration=r.getUint32(f);f+=4}if(o){i.defaultSampleSize=r.getUint32(f);f+=4}if(u){i.defaultSampleFlags=r.getUint32(f)}if(l){i.durationIsEmpty=true}if(!n&&d){i.baseDataOffsetIsMoof=true}return i};var _r=yr;var br=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof e!=="undefined"?e:typeof self!=="undefined"?self:{};var Tr;if(typeof window!=="undefined"){Tr=window}else if(typeof br!=="undefined"){Tr=br}else if(typeof self!=="undefined"){Tr=self}else{Tr={}}var Sr=Tr;var wr=Oe.discardEmulationPreventionBytes;var Er=ze.CaptionStream;var kr=function e(t,r){var i=t;for(var n=0;n<r.length;n++){var a=r[n];if(i<a.size){return a}i-=a.size}return null};var Ar=function e(t,r,i){var n=new DataView(t.buffer,t.byteOffset,t.byteLength),a={logs:[],seiNals:[]},s,o,u,l;for(o=0;o+4<t.length;o+=u){u=n.getUint32(o);o+=4;if(u<=0){continue}switch(t[o]&31){case 6:var d=t.subarray(o+1,o+1+u);var f=kr(o,r);s={nalUnitType:"sei_rbsp",size:u,data:d,escapedRBSP:wr(d),trackId:i};if(f){s.pts=f.pts;s.dts=f.dts;l=f}else if(l){s.pts=l.pts;s.dts=l.dts}else{a.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+o+" for trackId "+i+". See mux.js#223."});break}a.seiNals.push(s);break}}return a};var Cr=function e(t,r,i){var n=r;var a=i.defaultSampleDuration||0;var s=i.defaultSampleSize||0;var o=i.trackId;var u=[];t.forEach((function(e){var t=gr(e);var r=t.samples;r.forEach((function(e){if(e.duration===undefined){e.duration=a}if(e.size===undefined){e.size=s}e.trackId=o;e.dts=n;if(e.compositionTimeOffset===undefined){e.compositionTimeOffset=0}if(typeof n==="bigint"){e.pts=n+Sr.BigInt(e.compositionTimeOffset);n+=Sr.BigInt(e.duration)}else{e.pts=n+e.compositionTimeOffset;n+=e.duration}}));u=u.concat(r)}));return u};var Ir=function e(t,r){var i=lr(t,["moof","traf"]);var n=lr(t,["mdat"]);var a={};var s=[];n.forEach((function(e,t){var r=i[t];s.push({mdat:e,traf:r})}));s.forEach((function(e){var t=e.mdat;var i=e.traf;var n=lr(i,["tfhd"]);var s=_r(n[0]);var o=s.trackId;var u=lr(i,["tfdt"]);var l=u.length>0?hr(u[0]).baseMediaDecodeTime:0;var d=lr(i,["trun"]);var f;var c;if(r===o&&d.length>0){f=Cr(d,l,s);c=Ar(t,f,o);if(!a[o]){a[o]={seiNals:[],logs:[]}}a[o].seiNals=a[o].seiNals.concat(c.seiNals);a[o].logs=a[o].logs.concat(c.logs)}}));return a};var Dr=function e(t,r,i){var n;if(r===null){return null}n=Ir(t,r);var a=n[r]||{};return{seiNals:a.seiNals,logs:a.logs,timescale:i}};var xr=function e(){var t=false;var r;var i;var n;var a;var s;var o;this.isInitialized=function(){return t};this.init=function(e){r=new Er;t=true;o=e?e.isPartial:false;r.on("data",(function(e){e.startTime=e.startPts/a;e.endTime=e.endPts/a;s.captions.push(e);s.captionStreams[e.stream]=true}));r.on("log",(function(e){s.logs.push(e)}))};this.isNewInit=function(e,t){if(e&&e.length===0||t&&typeof t==="object"&&Object.keys(t).length===0){return false}return n!==e[0]||a!==t[n]};this.parse=function(e,t,r){var o;if(!this.isInitialized()){return null}else if(!t||!r){return null}else if(this.isNewInit(t,r)){n=t[0];a=r[n]}else if(n===null||!a){i.push(e);return null}while(i.length>0){var u=i.shift();this.parse(u,t,r)}o=Dr(e,n,a);if(o&&o.logs){s.logs=s.logs.concat(o.logs)}if(o===null||!o.seiNals){if(s.logs.length){return{logs:s.logs,captions:[],captionStreams:[]}}return null}this.pushNals(o.seiNals);this.flushStream();return s};this.pushNals=function(e){if(!this.isInitialized()||!e||e.length===0){return null}e.forEach((function(e){r.push(e)}))};this.flushStream=function(){if(!this.isInitialized()){return null}if(!o){r.flush()}else{r.partialFlush()}};this.clearParsedCaptions=function(){s.captions=[];s.captionStreams={};s.logs=[]};this.resetCaptionStream=function(){if(!this.isInitialized()){return null}r.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){i=[];n=null;a=null;if(!s){s={captions:[],captionStreams:{},logs:[]}}else{this.clearParsedCaptions()}this.resetCaptionStream()};this.reset()};var Lr=xr;var Or=nr.toUnsigned;var Pr=nr.toHexString;var Rr=a.getUint64;var Ur,Mr,Nr,Br,Fr,jr;Ur=function e(t){var r={},i=lr(t,["moov","trak"]);return i.reduce((function(e,t){var r,i,n,a,s;r=lr(t,["tkhd"])[0];if(!r){return null}i=r[0];n=i===0?12:20;a=Or(r[n]<<24|r[n+1]<<16|r[n+2]<<8|r[n+3]);s=lr(t,["mdia","mdhd"])[0];if(!s){return null}i=s[0];n=i===0?12:20;e[a]=Or(s[n]<<24|s[n+1]<<16|s[n+2]<<8|s[n+3]);return e}),r)};Mr=function e(t,r){var i;i=lr(r,["moof","traf"]);var n=i.reduce((function(e,r){var i=lr(r,["tfhd"])[0];var n=Or(i[4]<<24|i[5]<<16|i[6]<<8|i[7]);var a=t[n]||9e4;var s=lr(r,["tfdt"])[0];var o=new DataView(s.buffer,s.byteOffset,s.byteLength);var u;if(s[0]===1){u=Rr(s.subarray(4,12))}else{u=o.getUint32(4)}var l;if(typeof u==="bigint"){l=u/Sr.BigInt(a)}else if(typeof u==="number"&&!isNaN(u)){l=u/a}if(l<Number.MAX_SAFE_INTEGER){l=Number(l)}if(l<e){e=l}return e}),Infinity);return typeof n==="bigint"||isFinite(n)?n:0};Nr=function e(t,r){var i=lr(r,["moof","traf"]);var n=0;var a=0;var s;if(i&&i.length){var o=lr(i[0],["tfhd"])[0];var u=lr(i[0],["trun"])[0];var l=lr(i[0],["tfdt"])[0];if(o){var d=_r(o);s=d.trackId}if(l){var f=hr(l);n=f.baseMediaDecodeTime}if(u){var c=gr(u);if(c.samples&&c.samples.length){a=c.samples[0].compositionTimeOffset||0}}}var h=t[s]||9e4;if(typeof n==="bigint"){a=Sr.BigInt(a);h=Sr.BigInt(h)}var p=(n+a)/h;if(typeof p==="bigint"&&p<Number.MAX_SAFE_INTEGER){p=Number(p)}return p};Br=function e(t){var r=lr(t,["moov","trak"]);var i=[];r.forEach((function(e){var t=lr(e,["mdia","hdlr"]);var r=lr(e,["tkhd"]);t.forEach((function(e,t){var n=sr(e.subarray(8,12));var a=r[t];var s;var o;var u;if(n==="vide"){s=new DataView(a.buffer,a.byteOffset,a.byteLength);o=s.getUint8(0);u=o===0?s.getUint32(12):s.getUint32(20);i.push(u)}}))}));return i};jr=function e(t){var r=t[0];var i=r===0?12:20;return Or(t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3])};Fr=function e(t){var r=lr(t,["moov","trak"]);var i=[];r.forEach((function(e){var t={};var r=lr(e,["tkhd"])[0];var n,a;if(r){n=new DataView(r.buffer,r.byteOffset,r.byteLength);a=n.getUint8(0);t.id=a===0?n.getUint32(12):n.getUint32(20)}var s=lr(e,["mdia","hdlr"])[0];if(s){var o=sr(s.subarray(8,12));if(o==="vide"){t.type="video"}else if(o==="soun"){t.type="audio"}else{t.type=o}}var u=lr(e,["mdia","minf","stbl","stsd"])[0];if(u){var l=u.subarray(8);t.codec=sr(l.subarray(4,8));var d=lr(l,[t.codec])[0];var f,c;if(d){if(/^[asm]vc[1-9]$/i.test(t.codec)){f=d.subarray(78);c=sr(f.subarray(4,8));if(c==="avcC"&&f.length>11){t.codec+=".";t.codec+=Pr(f[9]);t.codec+=Pr(f[10]);t.codec+=Pr(f[11])}else{t.codec="avc1.4d400d"}}else if(/^mp4[a,v]$/i.test(t.codec)){f=d.subarray(28);c=sr(f.subarray(4,8));if(c==="esds"&&f.length>20&&f[19]!==0){t.codec+="."+Pr(f[19]);t.codec+="."+Pr(f[20]>>>2&63).replace(/^0/,"")}else{t.codec="mp4a.40.2"}}else{t.codec=t.codec.toLowerCase()}}}var h=lr(e,["mdia","mdhd"])[0];if(h){t.timescale=jr(h)}i.push(t)}));return i};var qr={findBox:lr,parseType:sr,timescale:Ur,startTime:Mr,compositionStartTime:Nr,videoTrackIds:Br,tracks:Fr,getTimescaleFromMediaHeader:jr};var Hr=function e(t){var r=t[1]&31;r<<=8;r|=t[2];return r};var Gr=function e(t){return!!(t[1]&64)};var Vr=function e(t){var r=0;if((t[3]&48)>>>4>1){r+=t[4]+1}return r};var Wr=function e(t,r){var i=Hr(t);if(i===0){return"pat"}else if(i===r){return"pmt"}else if(r){return"pes"}return null};var zr=function e(t){var r=Gr(t);var i=4+Vr(t);if(r){i+=t[i]+1}return(t[i+10]&31)<<8|t[i+11]};var Kr=function e(t){var r={};var i=Gr(t);var n=4+Vr(t);if(i){n+=t[n]+1}if(!(t[n+5]&1)){return}var a,s,o;a=(t[n+1]&15)<<8|t[n+2];s=3+a-4;o=(t[n+10]&15)<<8|t[n+11];var u=12+o;while(u<s){var l=n+u;r[(t[l+1]&31)<<8|t[l+2]]=t[l];u+=((t[l+3]&15)<<8|t[l+4])+5}return r};var Xr=function e(t,r){var i=Hr(t);var n=r[i];switch(n){case Ke.H264_STREAM_TYPE:return"video";case Ke.ADTS_STREAM_TYPE:return"audio";case Ke.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}};var Yr=function e(t){var r=Gr(t);if(!r){return null}var i=4+Vr(t);if(i>=t.byteLength){return null}var n=null;var a;a=t[i+7];if(a&192){n={};n.pts=(t[i+9]&14)<<27|(t[i+10]&255)<<20|(t[i+11]&254)<<12|(t[i+12]&255)<<5|(t[i+13]&254)>>>3;n.pts*=4;n.pts+=(t[i+13]&6)>>>1;n.dts=n.pts;if(a&64){n.dts=(t[i+14]&14)<<27|(t[i+15]&255)<<20|(t[i+16]&254)<<12|(t[i+17]&255)<<5|(t[i+18]&254)>>>3;n.dts*=4;n.dts+=(t[i+18]&6)>>>1}}return n};var Qr=function e(t){switch(t){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}};var $r=function e(t){var r=4+Vr(t);var i=t.subarray(r);var n=0;var a=0;var s=false;var o;for(;a<i.byteLength-3;a++){if(i[a+2]===1){n=a+5;break}}while(n<i.byteLength){switch(i[n]){case 0:if(i[n-1]!==0){n+=2;break}else if(i[n-2]!==0){n++;break}if(a+3!==n-2){o=Qr(i[a+3]&31);if(o==="slice_layer_without_partitioning_rbsp_idr"){s=true}}do{n++}while(i[n]!==1&&n<i.length);a=n-2;n+=3;break;case 1:if(i[n-1]!==0||i[n-2]!==0){n+=3;break}o=Qr(i[a+3]&31);if(o==="slice_layer_without_partitioning_rbsp_idr"){s=true}a=n-2;n+=3;break;default:n+=3;break}}i=i.subarray(a);n-=a;a=0;if(i&&i.byteLength>3){o=Qr(i[a+3]&31);if(o==="slice_layer_without_partitioning_rbsp_idr"){s=true}}return s};var Jr={parseType:Wr,parsePat:zr,parsePmt:Kr,parsePayloadUnitStartIndicator:Gr,parsePesType:Xr,parsePesTime:Yr,videoPacketContainsKeyFrame:$r};var Zr=Ze.handleRollover;var ei={};ei.ts=Jr;ei.aac=Nt;var ti=pe.ONE_SECOND_IN_TS;var ri=188,ii=71;var ni=function e(t,r){var i=0,n=ri,a,s;while(n<t.byteLength){if(t[i]===ii&&t[n]===ii){a=t.subarray(i,n);s=ei.ts.parseType(a,r.pid);switch(s){case"pat":r.pid=ei.ts.parsePat(a);break;case"pmt":var o=ei.ts.parsePmt(a);r.table=r.table||{};Object.keys(o).forEach((function(e){r.table[e]=o[e]}));break}i+=ri;n+=ri;continue}i++;n++}};var ai=function e(t,r,i){var n=0,a=ri,s,o,u,l,d;var f=false;while(a<=t.byteLength){if(t[n]===ii&&(t[a]===ii||a===t.byteLength)){s=t.subarray(n,a);o=ei.ts.parseType(s,r.pid);switch(o){case"pes":u=ei.ts.parsePesType(s,r.table);l=ei.ts.parsePayloadUnitStartIndicator(s);if(u==="audio"&&l){d=ei.ts.parsePesTime(s);if(d){d.type="audio";i.audio.push(d);f=true}}break}if(f){break}n+=ri;a+=ri;continue}n++;a++}a=t.byteLength;n=a-ri;f=false;while(n>=0){if(t[n]===ii&&(t[a]===ii||a===t.byteLength)){s=t.subarray(n,a);o=ei.ts.parseType(s,r.pid);switch(o){case"pes":u=ei.ts.parsePesType(s,r.table);l=ei.ts.parsePayloadUnitStartIndicator(s);if(u==="audio"&&l){d=ei.ts.parsePesTime(s);if(d){d.type="audio";i.audio.push(d);f=true}}break}if(f){break}n-=ri;a-=ri;continue}n--;a--}};var si=function e(t,r,i){var n=0,a=ri,s,o,u,l,d,f,c,h;var p=false;var v={data:[],size:0};while(a<t.byteLength){if(t[n]===ii&&t[a]===ii){s=t.subarray(n,a);o=ei.ts.parseType(s,r.pid);switch(o){case"pes":u=ei.ts.parsePesType(s,r.table);l=ei.ts.parsePayloadUnitStartIndicator(s);if(u==="video"){if(l&&!p){d=ei.ts.parsePesTime(s);if(d){d.type="video";i.video.push(d);p=true}}if(!i.firstKeyFrame){if(l){if(v.size!==0){f=new Uint8Array(v.size);c=0;while(v.data.length){h=v.data.shift();f.set(h,c);c+=h.byteLength}if(ei.ts.videoPacketContainsKeyFrame(f)){var m=ei.ts.parsePesTime(f);if(m){i.firstKeyFrame=m;i.firstKeyFrame.type="video"}else{console.warn("Failed to extract PTS/DTS from PES at first keyframe. "+"This could be an unusual TS segment, or else mux.js did not "+"parse your TS segment correctly. If you know your TS "+"segments do contain PTS/DTS on keyframes please file a bug "+"report! You can try ffprobe to double check for yourself.")}}v.size=0}}v.data.push(s);v.size+=s.byteLength}}break}if(p&&i.firstKeyFrame){break}n+=ri;a+=ri;continue}n++;a++}a=t.byteLength;n=a-ri;p=false;while(n>=0){if(t[n]===ii&&t[a]===ii){s=t.subarray(n,a);o=ei.ts.parseType(s,r.pid);switch(o){case"pes":u=ei.ts.parsePesType(s,r.table);l=ei.ts.parsePayloadUnitStartIndicator(s);if(u==="video"&&l){d=ei.ts.parsePesTime(s);if(d){d.type="video";i.video.push(d);p=true}}break}if(p){break}n-=ri;a-=ri;continue}n--;a--}};var oi=function e(t,r){if(t.audio&&t.audio.length){var i=r;if(typeof i==="undefined"||isNaN(i)){i=t.audio[0].dts}t.audio.forEach((function(e){e.dts=Zr(e.dts,i);e.pts=Zr(e.pts,i);e.dtsTime=e.dts/ti;e.ptsTime=e.pts/ti}))}if(t.video&&t.video.length){var n=r;if(typeof n==="undefined"||isNaN(n)){n=t.video[0].dts}t.video.forEach((function(e){e.dts=Zr(e.dts,n);e.pts=Zr(e.pts,n);e.dtsTime=e.dts/ti;e.ptsTime=e.pts/ti}));if(t.firstKeyFrame){var a=t.firstKeyFrame;a.dts=Zr(a.dts,n);a.pts=Zr(a.pts,n);a.dtsTime=a.dts/ti;a.ptsTime=a.pts/ti}}};var ui=function e(t){var r=false,i=0,n=null,a=null,s=0,o=0,u;while(t.length-o>=3){var l=ei.aac.parseType(t,o);switch(l){case"timed-metadata":if(t.length-o<10){r=true;break}s=ei.aac.parseId3TagSize(t,o);if(s>t.length){r=true;break}if(a===null){u=t.subarray(o,o+s);a=ei.aac.parseAacTimestamp(u)}o+=s;break;case"audio":if(t.length-o<7){r=true;break}s=ei.aac.parseAdtsSize(t,o);if(s>t.length){r=true;break}if(n===null){u=t.subarray(o,o+s);n=ei.aac.parseSampleRate(u)}i++;o+=s;break;default:o++;break}if(r){return null}}if(n===null||a===null){return null}var d=ti/n;var f={audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+i*1024*d,pts:a+i*1024*d}]};return f};var li=function e(t){var r={pid:null,table:null};var i={};ni(t,r);for(var n in r.table){if(r.table.hasOwnProperty(n)){var a=r.table[n];switch(a){case Ke.H264_STREAM_TYPE:i.video=[];si(t,r,i);if(i.video.length===0){delete i.video}break;case Ke.ADTS_STREAM_TYPE:i.audio=[];ai(t,r,i);if(i.audio.length===0){delete i.audio}break}}}return i};var di=function e(t,r){var i=ei.aac.isLikelyAacData(t);var n;if(i){n=ui(t)}else{n=li(t)}if(!n||!n.audio&&!n.video){return null}oi(n,r);return n};var fi={inspect:di,parseAudioPes_:ai};var ci=function e(t,r){r.on("data",(function(e){var r=e.initSegment;e.initSegment={data:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength};var i=e.data;e.data=i.buffer;t.postMessage({action:"data",segment:e,byteOffset:i.byteOffset,byteLength:i.byteLength},[e.data])}));r.on("done",(function(e){t.postMessage({action:"done"})}));r.on("gopInfo",(function(e){t.postMessage({action:"gopInfo",gopInfo:e})}));r.on("videoSegmentTimingInfo",(function(e){var r={start:{decode:pe.videoTsToSeconds(e.start.dts),presentation:pe.videoTsToSeconds(e.start.pts)},end:{decode:pe.videoTsToSeconds(e.end.dts),presentation:pe.videoTsToSeconds(e.end.pts)},baseMediaDecodeTime:pe.videoTsToSeconds(e.baseMediaDecodeTime)};if(e.prependedContentDuration){r.prependedContentDuration=pe.videoTsToSeconds(e.prependedContentDuration)}t.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:r})}));r.on("audioSegmentTimingInfo",(function(e){var r={start:{decode:pe.videoTsToSeconds(e.start.dts),presentation:pe.videoTsToSeconds(e.start.pts)},end:{decode:pe.videoTsToSeconds(e.end.dts),presentation:pe.videoTsToSeconds(e.end.pts)},baseMediaDecodeTime:pe.videoTsToSeconds(e.baseMediaDecodeTime)};if(e.prependedContentDuration){r.prependedContentDuration=pe.videoTsToSeconds(e.prependedContentDuration)}t.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:r})}));r.on("id3Frame",(function(e){t.postMessage({action:"id3Frame",id3Frame:e})}));r.on("caption",(function(e){t.postMessage({action:"caption",caption:e})}));r.on("trackinfo",(function(e){t.postMessage({action:"trackinfo",trackInfo:e})}));r.on("audioTimingInfo",(function(e){t.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:pe.videoTsToSeconds(e.start),end:pe.videoTsToSeconds(e.end)}})}));r.on("videoTimingInfo",(function(e){t.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:pe.videoTsToSeconds(e.start),end:pe.videoTsToSeconds(e.end)}})}));r.on("log",(function(e){t.postMessage({action:"log",log:e})}))};var hi=function(){function e(e,t){this.options=t||{};this.self=e;this.init()}var t=e.prototype;t.init=function e(){if(this.transmuxer){this.transmuxer.dispose()}this.transmuxer=new tr.Transmuxer(this.options);ci(this.self,this.transmuxer)};t.pushMp4Captions=function e(t){if(!this.captionParser){this.captionParser=new Lr;this.captionParser.init()}var r=new Uint8Array(t.data,t.byteOffset,t.byteLength);var i=this.captionParser.parse(r,t.trackIds,t.timescales);this.self.postMessage({action:"mp4Captions",captions:i&&i.captions||[],logs:i&&i.logs||[],data:r.buffer},[r.buffer])};t.probeMp4StartTime=function e(t){var r=t.timescales,i=t.data;var n=qr.startTime(r,i);this.self.postMessage({action:"probeMp4StartTime",startTime:n,data:i},[i.buffer])};t.probeMp4Tracks=function e(t){var r=t.data;var i=qr.tracks(r);this.self.postMessage({action:"probeMp4Tracks",tracks:i,data:r},[r.buffer])};t.probeTs=function e(t){var r=t.data,i=t.baseStartTime;var n=typeof i==="number"&&!isNaN(i)?i*pe.ONE_SECOND_IN_TS:void 0;var a=fi.inspect(r,n);var s=null;if(a){s={hasVideo:a.video&&a.video.length===2||false,hasAudio:a.audio&&a.audio.length===2||false};if(s.hasVideo){s.videoStart=a.video[0].ptsTime}if(s.hasAudio){s.audioStart=a.audio[0].ptsTime}}this.self.postMessage({action:"probeTs",result:s,data:r},[r.buffer])};t.clearAllMp4Captions=function e(){if(this.captionParser){this.captionParser.clearAllCaptions()}};t.clearParsedMp4Captions=function e(){if(this.captionParser){this.captionParser.clearParsedCaptions()}};t.push=function e(t){var r=new Uint8Array(t.data,t.byteOffset,t.byteLength);this.transmuxer.push(r)};t.reset=function e(){this.transmuxer.reset()};t.setTimestampOffset=function e(t){var r=t.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(pe.secondsToVideoTs(r)))};t.setAudioAppendStart=function e(t){this.transmuxer.setAudioAppendStart(Math.ceil(pe.secondsToVideoTs(t.appendStart)))};t.setRemux=function e(t){this.transmuxer.setRemux(t.remux)};t.flush=function e(t){this.transmuxer.flush();self.postMessage({action:"done",type:"transmuxed"})};t.endTimeline=function e(){this.transmuxer.endTimeline();self.postMessage({action:"endedtimeline",type:"transmuxed"})};t.alignGopsWith=function e(t){this.transmuxer.alignGopsWith(t.gopsToAlignWith.slice())};return e}();self.onmessage=function(e){if(e.data.action==="init"&&e.data.options){this.messageHandlers=new hi(self,e.data.options);return}if(!this.messageHandlers){this.messageHandlers=new hi(self)}if(e.data&&e.data.action&&e.data.action!=="init"){if(this.messageHandlers[e.data.action]){this.messageHandlers[e.data.action](e.data)}}}})));var jo=Mo(Fo);var qo=function e(t,r,i){var n=t.data.segment,a=n.type,s=n.initSegment,o=n.captions,u=n.captionStreams,l=n.metadata,d=n.videoFrameDtsTime,f=n.videoFramePtsTime;r.buffer.push({captions:o,captionStreams:u,metadata:l});var c=t.data.segment.boxes||{data:t.data.segment.data};var h={type:a,data:new Uint8Array(c.data,c.data.byteOffset,c.data.byteLength),initSegment:new Uint8Array(s.data,s.byteOffset,s.byteLength)};if(typeof d!=="undefined"){h.videoFrameDtsTime=d}if(typeof f!=="undefined"){h.videoFramePtsTime=f}i(h)};var Ho=function e(t){var r=t.transmuxedData,i=t.callback;r.buffer=[];i(r)};var Go=function e(t,r){r.gopInfo=t.data.gopInfo};var Vo=function e(t){var r=t.transmuxer,i=t.bytes,n=t.audioAppendStart,a=t.gopsToAlignWith,s=t.remux,o=t.onData,u=t.onTrackInfo,l=t.onAudioTimingInfo,d=t.onVideoTimingInfo,f=t.onVideoSegmentTimingInfo,c=t.onAudioSegmentTimingInfo,h=t.onId3,p=t.onCaptions,v=t.onDone,m=t.onEndedTimeline,g=t.onTransmuxerLog,y=t.isEndOfTimeline;var _={buffer:[]};var b=y;var T=function e(i){if(r.currentTransmux!==t){return}if(i.data.action==="data"){qo(i,_,o)}if(i.data.action==="trackinfo"){u(i.data.trackInfo)}if(i.data.action==="gopInfo"){Go(i,_)}if(i.data.action==="audioTimingInfo"){l(i.data.audioTimingInfo)}if(i.data.action==="videoTimingInfo"){d(i.data.videoTimingInfo)}if(i.data.action==="videoSegmentTimingInfo"){f(i.data.videoSegmentTimingInfo)}if(i.data.action==="audioSegmentTimingInfo"){c(i.data.audioSegmentTimingInfo)}if(i.data.action==="id3Frame"){h([i.data.id3Frame],i.data.id3Frame.dispatchType)}if(i.data.action==="caption"){p(i.data.caption)}if(i.data.action==="endedtimeline"){b=false;m()}if(i.data.action==="log"){g(i.data.log)}if(i.data.type!=="transmuxed"){return}if(b){return}r.onmessage=null;Ho({transmuxedData:_,callback:v});Wo(r)};r.onmessage=T;if(n){r.postMessage({action:"setAudioAppendStart",appendStart:n})}if(Array.isArray(a)){r.postMessage({action:"alignGopsWith",gopsToAlignWith:a})}if(typeof s!=="undefined"){r.postMessage({action:"setRemux",remux:s})}if(i.byteLength){var S=i instanceof ArrayBuffer?i:i.buffer;var w=i instanceof ArrayBuffer?0:i.byteOffset;r.postMessage({action:"push",data:S,byteOffset:w,byteLength:i.byteLength},[S])}if(y){r.postMessage({action:"endTimeline"})}r.postMessage({action:"flush"})};var Wo=function e(t){t.currentTransmux=null;if(t.transmuxQueue.length){t.currentTransmux=t.transmuxQueue.shift();if(typeof t.currentTransmux==="function"){t.currentTransmux()}else{Vo(t.currentTransmux)}}};var zo=function e(t,r){t.postMessage({action:r});Wo(t)};var Ko=function e(t,r){if(!r.currentTransmux){r.currentTransmux=t;zo(r,t);return}r.transmuxQueue.push(zo.bind(null,r,t))};var Xo=function e(t){Ko("reset",t)};var Yo=function e(t){Ko("endTimeline",t)};var Qo=function e(t){if(!t.transmuxer.currentTransmux){t.transmuxer.currentTransmux=t;Vo(t);return}t.transmuxer.transmuxQueue.push(t)};var $o=function e(t){var r=new jo;r.currentTransmux=null;r.transmuxQueue=[];var i=r.terminate;r.terminate=function(){r.currentTransmux=null;r.transmuxQueue.length=0;return i.call(r)};r.postMessage({action:"init",options:t});return r};var Jo={reset:Xo,endTimeline:Yo,transmux:Qo,createTransmuxer:$o};var Zo=function e(t){var r=t.transmuxer;var i=t.endAction||t.action;var n=t.callback;var a=u()({},t,{endAction:null,transmuxer:null,callback:null});var s=function e(a){if(a.data.action!==i){return}r.removeEventListener("message",e);if(a.data.data){a.data.data=new Uint8Array(a.data.data,t.byteOffset||0,t.byteLength||a.data.data.byteLength);if(t.data){t.data=a.data.data}}n(a.data)};r.addEventListener("message",s);if(t.data){var o=t.data instanceof ArrayBuffer;a.byteOffset=o?0:t.data.byteOffset;a.byteLength=t.data.byteLength;var l=[o?t.data:t.data.buffer];r.postMessage(a,l)}else{r.postMessage(a)}};var eu={FAILURE:2,TIMEOUT:-101,ABORTED:-102};var tu=function e(t){t.forEach((function(e){e.abort()}))};var ru=function e(t){return{bandwidth:t.bandwidth,bytesReceived:t.bytesReceived||0,roundTripTime:t.roundTripTime||0}};var iu=function e(t){var r=t.target;var i=Date.now()-r.requestTime;var n={bandwidth:Infinity,bytesReceived:0,roundTripTime:i||0};n.bytesReceived=t.loaded;n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3);return n};var nu=function e(t,r){if(r.timedout){return{status:r.status,message:"HLS request timed-out at URL: "+r.uri,code:eu.TIMEOUT,xhr:r}}if(r.aborted){return{status:r.status,message:"HLS request aborted at URL: "+r.uri,code:eu.ABORTED,xhr:r}}if(t){return{status:r.status,message:"HLS request errored at URL: "+r.uri,code:eu.FAILURE,xhr:r}}if(r.responseType==="arraybuffer"&&r.response.byteLength===0){return{status:r.status,message:"Empty HLS response at URL: "+r.uri,code:eu.FAILURE,xhr:r}}return null};var au=function e(t,r,i){return function(e,n){var a=n.response;var s=nu(e,n);if(s){return i(s,t)}if(a.byteLength!==16){return i({status:n.status,message:"Invalid HLS key at URL: "+n.uri,code:eu.FAILURE,xhr:n},t)}var o=new DataView(a);var u=new Uint32Array([o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12)]);for(var l=0;l<r.length;l++){r[l].bytes=u}return i(null,t)}};var su=function e(t,r){var i=Object(P["a"])(t.map.bytes);if(i!=="mp4"){var n=t.map.resolvedUri||t.map.uri;return r({internal:true,message:"Found unsupported "+(i||"unknown")+" container for initialization segment at URL: "+n,code:eu.FAILURE})}Zo({action:"probeMp4Tracks",data:t.map.bytes,transmuxer:t.transmuxer,callback:function e(i){var n=i.tracks,a=i.data;t.map.bytes=a;n.forEach((function(e){t.map.tracks=t.map.tracks||{};if(t.map.tracks[e.type]){return}t.map.tracks[e.type]=e;if(typeof e.id==="number"&&e.timescale){t.map.timescales=t.map.timescales||{};t.map.timescales[e.id]=e.timescale}}));return r(null)}})};var ou=function e(t){var r=t.segment,i=t.finishProcessingFn;return function(e,t){var n=nu(e,t);if(n){return i(n,r)}var a=new Uint8Array(t.response);if(r.map.key){r.map.encryptedBytes=a;return i(null,r)}r.map.bytes=a;su(r,(function(e){if(e){e.xhr=t;e.status=t.status;return i(e,r)}i(null,r)}))}};var uu=function e(t){var r=t.segment,i=t.finishProcessingFn,n=t.responseType;return function(e,t){var a=nu(e,t);if(a){return i(a,r)}var s=n==="arraybuffer"||!t.responseText?t.response:Po(t.responseText.substring(r.lastReachedChar||0));r.stats=ru(t);if(r.key){r.encryptedBytes=new Uint8Array(s)}else{r.bytes=new Uint8Array(s)}return i(null,r)}};var lu=function e(t){var r=t.segment,i=t.bytes,n=t.trackInfoFn,a=t.timingInfoFn,s=t.videoSegmentTimingInfoFn,o=t.audioSegmentTimingInfoFn,u=t.id3Fn,l=t.captionsFn,d=t.isEndOfTimeline,f=t.endedTimelineFn,c=t.dataFn,h=t.doneFn,p=t.onTransmuxerLog;var v=r.map&&r.map.tracks||{};var m=Boolean(v.audio&&v.video);var g=a.bind(null,r,"audio","start");var y=a.bind(null,r,"audio","end");var _=a.bind(null,r,"video","start");var b=a.bind(null,r,"video","end");var T=function e(){return Qo({bytes:i,transmuxer:r.transmuxer,audioAppendStart:r.audioAppendStart,gopsToAlignWith:r.gopsToAlignWith,remux:m,onData:function e(t){t.type=t.type==="combined"?"video":t.type;c(r,t)},onTrackInfo:function e(t){if(n){if(m){t.isMuxed=true}n(r,t)}},onAudioTimingInfo:function e(t){if(g&&typeof t.start!=="undefined"){g(t.start);g=null}if(y&&typeof t.end!=="undefined"){y(t.end)}},onVideoTimingInfo:function e(t){if(_&&typeof t.start!=="undefined"){_(t.start);_=null}if(b&&typeof t.end!=="undefined"){b(t.end)}},onVideoSegmentTimingInfo:function e(t){s(t)},onAudioSegmentTimingInfo:function e(t){o(t)},onId3:function e(t,i){u(r,t,i)},onCaptions:function e(t){l(r,[t])},isEndOfTimeline:d,onEndedTimeline:function e(){f()},onTransmuxerLog:p,onDone:function e(t){if(!h){return}t.type=t.type==="combined"?"video":t.type;h(null,r,t)}})};Zo({action:"probeTs",transmuxer:r.transmuxer,data:i,baseStartTime:r.baseStartTime,callback:function e(t){r.bytes=i=t.data;var a=t.result;if(a){n(r,{hasAudio:a.hasAudio,hasVideo:a.hasVideo,isMuxed:m});n=null;if(a.hasAudio&&!m){g(a.audioStart)}if(a.hasVideo){_(a.videoStart)}g=null;_=null}T()}})};var du=function e(t){var r=t.segment,i=t.bytes,n=t.trackInfoFn,a=t.timingInfoFn,s=t.videoSegmentTimingInfoFn,o=t.audioSegmentTimingInfoFn,u=t.id3Fn,l=t.captionsFn,d=t.isEndOfTimeline,f=t.endedTimelineFn,c=t.dataFn,h=t.doneFn,p=t.onTransmuxerLog;var v=new Uint8Array(i);if(Object(P["b"])(v)){r.isFmp4=true;var m=r.map.tracks;var g={isFmp4:true,hasVideo:!!m.video,hasAudio:!!m.audio};if(m.audio&&m.audio.codec&&m.audio.codec!=="enca"){g.audioCodec=m.audio.codec}if(m.video&&m.video.codec&&m.video.codec!=="encv"){g.videoCodec=m.video.codec}if(m.video&&m.audio){g.isMuxed=true}n(r,g);var y=function e(t){c(r,{data:v,type:g.hasAudio&&!g.isMuxed?"audio":"video"});if(t&&t.length){l(r,t)}h(null,r,{})};Zo({action:"probeMp4StartTime",timescales:r.map.timescales,data:v,transmuxer:r.transmuxer,callback:function e(t){var n=t.data,s=t.startTime;i=n.buffer;r.bytes=v=n;if(g.hasAudio&&!g.isMuxed){a(r,"audio","start",s)}if(g.hasVideo){a(r,"video","start",s)}if(!m.video||!n.byteLength||!r.transmuxer){y();return}Zo({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:r.transmuxer,data:v,timescales:r.map.timescales,trackIds:[m.video.id],callback:function e(t){i=t.data.buffer;r.bytes=v=t.data;t.logs.forEach((function(e){p(Ba.mergeOptions(e,{stream:"mp4CaptionParser"}))}));y(t.captions)}})}});return}if(!r.transmuxer){h(null,r,{});return}if(typeof r.container==="undefined"){r.container=Object(P["a"])(v)}if(r.container!=="ts"&&r.container!=="aac"){n(r,{hasAudio:false,hasVideo:false});h(null,r,{});return}lu({segment:r,bytes:i,trackInfoFn:n,timingInfoFn:a,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:o,id3Fn:u,captionsFn:l,isEndOfTimeline:d,endedTimelineFn:f,dataFn:c,doneFn:h,onTransmuxerLog:p})};var fu=function e(t,r){var i=t.id,n=t.key,a=t.encryptedBytes,s=t.decryptionWorker;var o=function e(t){if(t.data.source===i){s.removeEventListener("message",e);var n=t.data.decrypted;r(new Uint8Array(n.bytes,n.byteOffset,n.byteLength))}};s.addEventListener("message",o);var u;if(n.bytes.slice){u=n.bytes.slice()}else{u=new Uint32Array(Array.prototype.slice.call(n.bytes))}s.postMessage(no({source:i,encrypted:a,key:u,iv:n.iv}),[a.buffer,u.buffer])};var cu=function e(t){var r=t.decryptionWorker,i=t.segment,n=t.trackInfoFn,a=t.timingInfoFn,s=t.videoSegmentTimingInfoFn,o=t.audioSegmentTimingInfoFn,u=t.id3Fn,l=t.captionsFn,d=t.isEndOfTimeline,f=t.endedTimelineFn,c=t.dataFn,h=t.doneFn,p=t.onTransmuxerLog;fu({id:i.requestId,key:i.key,encryptedBytes:i.encryptedBytes,decryptionWorker:r},(function(e){i.bytes=e;du({segment:i,bytes:i.bytes,trackInfoFn:n,timingInfoFn:a,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:o,id3Fn:u,captionsFn:l,isEndOfTimeline:d,endedTimelineFn:f,dataFn:c,doneFn:h,onTransmuxerLog:p})}))};var hu=function e(t){var r=t.activeXhrs,i=t.decryptionWorker,n=t.trackInfoFn,a=t.timingInfoFn,s=t.videoSegmentTimingInfoFn,o=t.audioSegmentTimingInfoFn,u=t.id3Fn,l=t.captionsFn,d=t.isEndOfTimeline,f=t.endedTimelineFn,c=t.dataFn,h=t.doneFn,p=t.onTransmuxerLog;var v=0;var m=false;return function(e,t){if(m){return}if(e){m=true;tu(r);return h(e,t)}v+=1;if(v===r.length){var g=function e(){if(t.encryptedBytes){return cu({decryptionWorker:i,segment:t,trackInfoFn:n,timingInfoFn:a,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:o,id3Fn:u,captionsFn:l,isEndOfTimeline:d,endedTimelineFn:f,dataFn:c,doneFn:h,onTransmuxerLog:p})}du({segment:t,bytes:t.bytes,trackInfoFn:n,timingInfoFn:a,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:o,id3Fn:u,captionsFn:l,isEndOfTimeline:d,endedTimelineFn:f,dataFn:c,doneFn:h,onTransmuxerLog:p})};t.endOfAllRequests=Date.now();if(t.map&&t.map.encryptedBytes&&!t.map.bytes){return fu({decryptionWorker:i,id:t.requestId+"-init",encryptedBytes:t.map.encryptedBytes,key:t.map.key},(function(e){t.map.bytes=e;su(t,(function(e){if(e){tu(r);return h(e,t)}g()}))}))}g()}}};var pu=function e(t){var r=t.loadendState,i=t.abortFn;return function(e){var t=e.target;if(t.aborted&&i&&!r.calledAbortFn){i();r.calledAbortFn=true}}};var vu=function e(t){var r=t.segment,i=t.progressFn;t.trackInfoFn;t.timingInfoFn;t.videoSegmentTimingInfoFn;t.audioSegmentTimingInfoFn;t.id3Fn;t.captionsFn;t.isEndOfTimeline;t.endedTimelineFn;t.dataFn;return function(e){var t=e.target;if(t.aborted){return}r.stats=Ba.mergeOptions(r.stats,iu(e));if(!r.stats.firstBytesReceivedAt&&r.stats.bytesReceived){r.stats.firstBytesReceivedAt=Date.now()}return i(e,r)}};var mu=function e(t){var r=t.xhr,i=t.xhrOptions,n=t.decryptionWorker,a=t.segment,s=t.abortFn,o=t.progressFn,u=t.trackInfoFn,l=t.timingInfoFn,d=t.videoSegmentTimingInfoFn,f=t.audioSegmentTimingInfoFn,c=t.id3Fn,h=t.captionsFn,p=t.isEndOfTimeline,v=t.endedTimelineFn,m=t.dataFn,g=t.doneFn,y=t.onTransmuxerLog;var _=[];var b=hu({activeXhrs:_,decryptionWorker:n,trackInfoFn:u,timingInfoFn:l,videoSegmentTimingInfoFn:d,audioSegmentTimingInfoFn:f,id3Fn:c,captionsFn:h,isEndOfTimeline:p,endedTimelineFn:v,dataFn:m,doneFn:g,onTransmuxerLog:y});if(a.key&&!a.key.bytes){var T=[a.key];if(a.map&&!a.map.bytes&&a.map.key&&a.map.key.resolvedUri===a.key.resolvedUri){T.push(a.map.key)}var S=Ba.mergeOptions(i,{uri:a.key.resolvedUri,responseType:"arraybuffer"});var w=au(a,T,b);var E=r(S,w);_.push(E)}if(a.map&&!a.map.bytes){var k=a.map.key&&(!a.key||a.key.resolvedUri!==a.map.key.resolvedUri);if(k){var A=Ba.mergeOptions(i,{uri:a.map.key.resolvedUri,responseType:"arraybuffer"});var C=au(a,[a.map.key],b);var I=r(A,C);_.push(I)}var D=Ba.mergeOptions(i,{uri:a.map.resolvedUri,responseType:"arraybuffer",headers:eo(a.map)});var x=ou({segment:a,finishProcessingFn:b});var L=r(D,x);_.push(L)}var O=Ba.mergeOptions(i,{uri:a.part&&a.part.resolvedUri||a.resolvedUri,responseType:"arraybuffer",headers:eo(a)});var P=uu({segment:a,finishProcessingFn:b,responseType:O.responseType});var R=r(O,P);R.addEventListener("progress",vu({segment:a,progressFn:o,trackInfoFn:u,timingInfoFn:l,videoSegmentTimingInfoFn:d,audioSegmentTimingInfoFn:f,id3Fn:c,captionsFn:h,isEndOfTimeline:p,endedTimelineFn:v,dataFn:m}));_.push(R);var U={};_.forEach((function(e){e.addEventListener("loadend",pu({loadendState:U,abortFn:s}))}));return function(){return tu(_)}};var gu=Ga("CodecUtils");var yu=function e(t){var r=t.attributes||{};if(r.CODECS){return Object(C["h"])(r.CODECS)}};var _u=function e(t,r){var i=r.attributes||{};return t&&t.mediaGroups&&t.mediaGroups.AUDIO&&i.AUDIO&&t.mediaGroups.AUDIO[i.AUDIO]};var bu=function e(t,r){if(!_u(t,r)){return true}var i=r.attributes||{};var n=t.mediaGroups.AUDIO[i.AUDIO];for(var a in n){if(!n[a].uri&&!n[a].playlists){return true}}return false};var Tu=function e(t){var r={};t.forEach((function(e){var t=e.mediaType,i=e.type,n=e.details;r[t]=r[t]||[];r[t].push(Object(C["i"])(""+i+n))}));Object.keys(r).forEach((function(e){if(r[e].length>1){gu("multiple "+e+" codecs found as attributes: "+r[e].join(", ")+". Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.");r[e]=null;return}r[e]=r[e][0]}));return r};var Su=function e(t){var r=0;if(t.audio){r++}if(t.video){r++}return r};var wu=function e(t,r){var i=r.attributes||{};var n=Tu(yu(r)||[]);if(_u(t,r)&&!n.audio){if(!bu(t,r)){var a=Tu(Object(C["d"])(t,i.AUDIO)||[]);if(a.audio){n.audio=a.audio}}}return n};var Eu=Ga("PlaylistSelector");var ku=function e(t){if(!t||!t.playlist){return}var r=t.playlist;return JSON.stringify({id:r.id,bandwidth:t.bandwidth,width:t.width,height:t.height,codecs:r.attributes&&r.attributes.CODECS||""})};var Au=function e(t,r){if(!t){return""}var i=n.a.getComputedStyle(t);if(!i){return""}return i[r]};var Cu=function e(t,r){var i=t.slice();t.sort((function(e,t){var n=r(e,t);if(n===0){return i.indexOf(e)-i.indexOf(t)}return n}))};var Iu=function e(t,r){var i;var a;if(t.attributes.BANDWIDTH){i=t.attributes.BANDWIDTH}i=i||n.a.Number.MAX_VALUE;if(r.attributes.BANDWIDTH){a=r.attributes.BANDWIDTH}a=a||n.a.Number.MAX_VALUE;return i-a};var Du=function e(t,r){var i;var a;if(t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width){i=t.attributes.RESOLUTION.width}i=i||n.a.Number.MAX_VALUE;if(r.attributes.RESOLUTION&&r.attributes.RESOLUTION.width){a=r.attributes.RESOLUTION.width}a=a||n.a.Number.MAX_VALUE;if(i===a&&t.attributes.BANDWIDTH&&r.attributes.BANDWIDTH){return t.attributes.BANDWIDTH-r.attributes.BANDWIDTH}return i-a};var xu=function e(t,r,i,a,s,o){if(!t){return}var u={bandwidth:r,width:i,height:a,limitRenditionByPlayerDimensions:s};var l=t.playlists;if(Is.isAudioOnly(t)){l=o.getAudioTrackPlaylists_();u.audioOnly=true}var d=l.map((function(e){var t;var r=e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width;var i=e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height;t=e.attributes&&e.attributes.BANDWIDTH;t=t||n.a.Number.MAX_VALUE;return{bandwidth:t,width:r,height:i,playlist:e}}));Cu(d,(function(e,t){return e.bandwidth-t.bandwidth}));d=d.filter((function(e){return!Is.isIncompatible(e.playlist)}));var f=d.filter((function(e){return Is.isEnabled(e.playlist)}));if(!f.length){f=d.filter((function(e){return!Is.isDisabled(e.playlist)}))}var c=f.filter((function(e){return e.bandwidth*Oo.BANDWIDTH_VARIANCE<r}));var h=c[c.length-1];var p=c.filter((function(e){return e.bandwidth===h.bandwidth}))[0];if(s===false){var v=p||f[0]||d[0];if(v&&v.playlist){var m="sortedPlaylistReps";if(p){m="bandwidthBestRep"}if(f[0]){m="enabledPlaylistReps"}Eu("choosing "+ku(v)+" using "+m+" with options",u);return v.playlist}Eu("could not choose a playlist with options",u);return null}var g=c.filter((function(e){return e.width&&e.height}));Cu(g,(function(e,t){return e.width-t.width}));var y=g.filter((function(e){return e.width===i&&e.height===a}));h=y[y.length-1];var _=y.filter((function(e){return e.bandwidth===h.bandwidth}))[0];var b;var T;var S;if(!_){b=g.filter((function(e){return e.width>i||e.height>a}));T=b.filter((function(e){return e.width===b[0].width&&e.height===b[0].height}));h=T[T.length-1];S=T.filter((function(e){return e.bandwidth===h.bandwidth}))[0]}var w;if(o.experimentalLeastPixelDiffSelector){var E=g.map((function(e){e.pixelDiff=Math.abs(e.width-i)+Math.abs(e.height-a);return e}));Cu(E,(function(e,t){if(e.pixelDiff===t.pixelDiff){return t.bandwidth-e.bandwidth}return e.pixelDiff-t.pixelDiff}));w=E[0]}var k=w||S||_||p||f[0]||d[0];if(k&&k.playlist){var A="sortedPlaylistReps";if(w){A="leastPixelDiffRep"}else if(S){A="resolutionPlusOneRep"}else if(_){A="resolutionBestRep"}else if(p){A="bandwidthBestRep"}else if(f[0]){A="enabledPlaylistReps"}Eu("choosing "+ku(k)+" using "+A+" with options",u);return k.playlist}Eu("could not choose a playlist with options",u);return null};var Lu=function e(){var t=this.useDevicePixelRatio?n.a.devicePixelRatio||1:1;return xu(this.playlists.master,this.systemBandwidth,parseInt(Au(this.tech_.el(),"width"),10)*t,parseInt(Au(this.tech_.el(),"height"),10)*t,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)};var Ou=function e(t){var r=-1;var i=-1;if(t<0||t>1){throw new Error("Moving average bandwidth decay must be between 0 and 1.")}return function(){var e=this.useDevicePixelRatio?n.a.devicePixelRatio||1:1;if(r<0){r=this.systemBandwidth;i=this.systemBandwidth}if(this.systemBandwidth>0&&this.systemBandwidth!==i){r=t*this.systemBandwidth+(1-t)*r;i=this.systemBandwidth}return xu(this.playlists.master,r,parseInt(Au(this.tech_.el(),"width"),10)*e,parseInt(Au(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)}};var Pu=function e(t){var r=t.master,i=t.currentTime,n=t.bandwidth,a=t.duration,s=t.segmentDuration,o=t.timeUntilRebuffer,u=t.currentTimeline,l=t.syncController;var d=r.playlists.filter((function(e){return!Is.isIncompatible(e)}));var f=d.filter(Is.isEnabled);if(!f.length){f=d.filter((function(e){return!Is.isDisabled(e)}))}var c=f.filter(Is.hasAttribute.bind(null,"BANDWIDTH"));var h=c.map((function(e){var t=l.getSyncPoint(e,a,u,i);var r=t?1:2;var d=Is.estimateSegmentRequestTime(s,n,e);var f=d*r-o;return{playlist:e,rebufferingImpact:f}}));var p=h.filter((function(e){return e.rebufferingImpact<=0}));Cu(p,(function(e,t){return Iu(t.playlist,e.playlist)}));if(p.length){return p[0]}Cu(h,(function(e,t){return e.rebufferingImpact-t.rebufferingImpact}));return h[0]||null};var Ru=function e(){var t=this;var r=this.playlists.master.playlists.filter(Is.isEnabled);Cu(r,(function(e,t){return Iu(e,t)}));var i=r.filter((function(e){return!!wu(t.playlists.master,e).video}));return i[0]||null};var Uu=function e(t){var r=0;var i;if(t.bytes){i=new Uint8Array(t.bytes);t.segments.forEach((function(e){i.set(e,r);r+=e.byteLength}))}return i};var Mu=function e(t,r,i){if(!t[i]){r.trigger({type:"usage",name:"vhs-608"});r.trigger({type:"usage",name:"hls-608"});var n=i;if(/^cc708_/.test(i)){n="SERVICE"+i.split("_")[1]}var a=r.textTracks().getTrackById(n);if(a){t[i]=a}else{var s=r.options_.vhs&&r.options_.vhs.captionServices||{};var o=i;var u=i;var l=false;var d=s[n];if(d){o=d.label;u=d.language;l=d["default"]}t[i]=r.addRemoteTextTrack({kind:"captions",id:n,default:l,label:o,language:u},false).track}}};var Nu=function e(t){var r=t.inbandTextTracks,i=t.captionArray,a=t.timestampOffset;if(!i){return}var s=n.a.WebKitDataCue||n.a.VTTCue;i.forEach((function(e){var t=e.stream;r[t].addCue(new s(e.startTime+a,e.endTime+a,e.text))}))};var Bu=function e(t){Object.defineProperties(t.frame,{id:{get:function e(){Ba.log.warn("cue.frame.id is deprecated. Use cue.value.key instead.");return t.value.key}},value:{get:function e(){Ba.log.warn("cue.frame.value is deprecated. Use cue.value.data instead.");return t.value.data}},privateData:{get:function e(){Ba.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead.");return t.value.data}}})};var Fu=function e(t){var r=t.inbandTextTracks,i=t.metadataArray,a=t.timestampOffset,s=t.videoDuration;if(!i){return}var o=n.a.WebKitDataCue||n.a.VTTCue;var u=r.metadataTrack_;if(!u){return}i.forEach((function(e){var t=e.cueTime+a;if(typeof t!=="number"||n.a.isNaN(t)||t<0||!(t<Infinity)){return}e.frames.forEach((function(e){var r=new o(t,t,e.value||e.url||e.data||"");r.frame=e;r.value=e;Bu(r);u.addCue(r)}))}));if(!u.cues||!u.cues.length){return}var l=u.cues;var d=[];for(var f=0;f<l.length;f++){if(l[f]){d.push(l[f])}}var c=d.reduce((function(e,t){var r=e[t.startTime]||[];r.push(t);e[t.startTime]=r;return e}),{});var h=Object.keys(c).sort((function(e,t){return Number(e)-Number(t)}));h.forEach((function(e,t){var r=c[e];var i=Number(h[t+1])||s;r.forEach((function(e){e.endTime=i}))}))};var ju=function e(t,r,i){if(t.metadataTrack_){return}t.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},false).track;t.metadataTrack_.inBandMetadataTrackDispatchType=r};var qu=function e(t,r,i){var n;var a;if(!i){return}if(!i.cues){return}n=i.cues.length;while(n--){a=i.cues[n];if(a.startTime>=t&&a.endTime<=r){i.removeCue(a)}}};var Hu=function e(t){var r=t.cues;if(!r){return}for(var i=0;i<r.length;i++){var n=[];var a=0;for(var s=0;s<r.length;s++){if(r[i].startTime===r[s].startTime&&r[i].endTime===r[s].endTime&&r[i].text===r[s].text){a++;if(a>1){n.push(r[s])}}}if(n.length){n.forEach((function(e){return t.removeCue(e)}))}}};var Gu=function e(t,r,i){if(typeof r==="undefined"||r===null||!t.length){return[]}var n=Math.ceil((r-i+3)*U["ONE_SECOND_IN_TS"]);var a;for(a=0;a<t.length;a++){if(t[a].pts>n){break}}return t.slice(a)};var Vu=function e(t,r,i){if(!r.length){return t}if(i){return r.slice()}var n=r[0].pts;var a=0;for(a;a<t.length;a++){if(t[a].pts>=n){break}}return t.slice(0,a).concat(r)};var Wu=function e(t,r,i,n){var a=Math.ceil((r-n)*U["ONE_SECOND_IN_TS"]);var s=Math.ceil((i-n)*U["ONE_SECOND_IN_TS"]);var o=t.slice();var u=t.length;while(u--){if(t[u].pts<=s){break}}if(u===-1){return o}var l=u+1;while(l--){if(t[l].pts<=a){break}}l=Math.max(l,0);o.splice(l,u-l+1);return o};var zu=function e(t,r){if(!t&&!r||!t&&r||t&&!r){return false}if(t===r){return true}var i=Object.keys(t).sort();var n=Object.keys(r).sort();if(i.length!==n.length){return false}for(var a=0;a<i.length;a++){var s=i[a];if(s!==n[a]){return false}if(t[s]!==r[s]){return false}}return true};var Ku=22;var Xu=function e(t,r,i){r=r||[];var n=[];var a=0;for(var s=0;s<r.length;s++){var o=r[s];if(t===o.timeline){n.push(s);a+=o.duration;if(a>i){return s}}}if(n.length===0){return 0}return n[n.length-1]};var Yu=1;var Qu=500;var $u=function e(t){return typeof t==="number"&&isFinite(t)};var Ju=1/60;var Zu=function e(t,r,i){if(t!=="main"||!r||!i){return null}if(!i.hasAudio&&!i.hasVideo){return"Neither audio nor video found in segment."}if(r.hasVideo&&!i.hasVideo){return"Only audio found in segment when we expected video."+" We can't switch to audio only from a stream that had video."+" To get rid of this message, please add codec information to the manifest."}if(!r.hasVideo&&i.hasVideo){return"Video found in segment when we expected only audio."+" We can't switch to a stream with video from an audio only stream."+" To get rid of this message, please add codec information to the manifest."}return null};var el=function e(t,r,i){var n=r-Oo.BACK_BUFFER_LENGTH;if(t.length){n=Math.max(n,t.start(0))}var a=r-i;return Math.min(a,n)};var tl=function e(t){var r=t.startOfSegment,i=t.duration,n=t.segment,a=t.part,s=t.playlist,o=s.mediaSequence,u=s.id,l=s.segments,d=l===void 0?[]:l,f=t.mediaIndex,c=t.partIndex,h=t.timeline;var p=d.length-1;var v="mediaIndex/partIndex increment";if(t.getMediaInfoForTime){v="getMediaInfoForTime ("+t.getMediaInfoForTime+")"}else if(t.isSyncRequest){v="getSyncSegmentCandidate (isSyncRequest)"}if(t.independent){v+=" with independent "+t.independent}var m=typeof c==="number";var g=t.segment.uri?"segment":"pre-segment";var y=m?os({preloadSegment:n})-1:0;return g+" ["+(o+f)+"/"+(o+p)+"]"+(m?" part ["+c+"/"+y+"]":"")+(" segment start/end ["+n.start+" => "+n.end+"]")+(m?" part start/end ["+a.start+" => "+a.end+"]":"")+(" startOfSegment ["+r+"]")+(" duration ["+i+"]")+(" timeline ["+h+"]")+(" selected by ["+v+"]")+(" playlist ["+u+"]")};var rl=function e(t){return t+"TimingInfo"};var il=function e(t){var r=t.segmentTimeline,i=t.currentTimeline,n=t.startOfSegment,a=t.buffered,s=t.overrideCheck;if(!s&&r===i){return null}if(r<i){return n}return a.length?a.end(a.length-1):n};var nl=function e(t){var r=t.timelineChangeController,i=t.currentTimeline,n=t.segmentTimeline,a=t.loaderType,s=t.audioDisabled;if(i===n){return false}if(a==="audio"){var o=r.lastTimelineChange({type:"main"});return!o||o.to!==n}if(a==="main"&&s){var u=r.pendingTimelineChange({type:"audio"});if(u&&u.to===n){return false}return true}return false};var al=function e(t){var r=0;["video","audio"].forEach((function(e){var i=t[e+"TimingInfo"];if(!i){return}var a=i.start,s=i.end;var o;if(typeof a==="bigint"||typeof s==="bigint"){o=n.a.BigInt(s)-n.a.BigInt(a)}else if(typeof a==="number"&&typeof s==="number"){o=s-a}if(typeof o!=="undefined"&&o>r){r=o}}));if(typeof r==="bigint"&&r<Number.MAX_SAFE_INTEGER){r=Number(r)}return r};var sl=function e(t){var r=t.segmentDuration,i=t.maxDuration;if(!r){return false}return Math.round(r)>i+Va};var ol=function e(t,r){if(r!=="hls"){return null}var i=al({audioTimingInfo:t.audioTimingInfo,videoTimingInfo:t.videoTimingInfo});if(!i){return null}var n=t.playlist.targetDuration;var a=sl({segmentDuration:i,maxDuration:n*2});var s=sl({segmentDuration:i,maxDuration:n});var o="Segment with index "+t.mediaIndex+" "+("from playlist "+t.playlist.id+" ")+("has a duration of "+i+" ")+("when the reported duration is "+t.duration+" ")+("and the target duration is "+n+". ")+"For HLS content, a duration in excess of the target duration may result in "+"playback issues. See the HLS specification section on EXT-X-TARGETDURATION for "+"more details: "+"https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1";if(a||s){return{severity:a?"warn":"info",message:o}}return null};var ul=function(e){p()(t,e);function t(t,r){var i;i=e.call(this)||this;if(!t){throw new TypeError("Initialization settings are required")}if(typeof t.currentTime!=="function"){throw new TypeError("No currentTime getter specified")}if(!t.mediaSource){throw new TypeError("No MediaSource specified")}i.bandwidth=t.bandwidth;i.throughput={rate:0,count:0};i.roundTrip=NaN;i.resetStats_();i.mediaIndex=null;i.partIndex=null;i.hasPlayed_=t.hasPlayed;i.currentTime_=t.currentTime;i.seekable_=t.seekable;i.seeking_=t.seeking;i.duration_=t.duration;i.mediaSource_=t.mediaSource;i.vhs_=t.vhs;i.loaderType_=t.loaderType;i.currentMediaInfo_=void 0;i.startingMediaInfo_=void 0;i.segmentMetadataTrack_=t.segmentMetadataTrack;i.goalBufferLength_=t.goalBufferLength;i.sourceType_=t.sourceType;i.sourceUpdater_=t.sourceUpdater;i.inbandTextTracks_=t.inbandTextTracks;i.state_="INIT";i.timelineChangeController_=t.timelineChangeController;i.shouldSaveSegmentTimingInfo_=true;i.parse708captions_=t.parse708captions;i.captionServices_=t.captionServices;i.experimentalExactManifestTimings=t.experimentalExactManifestTimings;i.checkBufferTimeout_=null;i.error_=void 0;i.currentTimeline_=-1;i.pendingSegment_=null;i.xhrOptions_=null;i.pendingSegments_=[];i.audioDisabled_=false;i.isPendingTimestampOffset_=false;i.gopBuffer_=[];i.timeMapping_=0;i.safeAppend_=Ba.browser.IE_VERSION>=11;i.appendInitSegment_={audio:true,video:true};i.playlistOfLastInitSegment_={audio:null,video:null};i.callQueue_=[];i.loadQueue_=[];i.metadataQueue_={id3:[],caption:[]};i.waitingOnRemove_=false;i.quotaExceededErrorRetryTimeout_=null;i.activeInitSegmentId_=null;i.initSegments_={};i.cacheEncryptionKeys_=t.cacheEncryptionKeys;i.keyCache_={};i.decrypter_=t.decrypter;i.syncController_=t.syncController;i.syncPoint_={segmentIndex:0,time:0};i.transmuxer_=i.createTransmuxer_();i.triggerSyncInfoUpdate_=function(){return i.trigger("syncinfoupdate")};i.syncController_.on("syncinfoupdate",i.triggerSyncInfoUpdate_);i.mediaSource_.addEventListener("sourceopen",(function(){if(!i.isEndOfStream_()){i.ended_=false}}));i.fetchAtBuffer_=false;i.logger_=Ga("SegmentLoader["+i.loaderType_+"]");Object.defineProperty(c()(i),"state",{get:function e(){return this.state_},set:function e(t){if(t!==this.state_){this.logger_(this.state_+" -> "+t);this.state_=t;this.trigger("statechange")}}});i.sourceUpdater_.on("ready",(function(){if(i.hasEnoughInfoToAppend_()){i.processCallQueue_()}}));if(i.loaderType_==="main"){i.timelineChangeController_.on("pendingtimelinechange",(function(){if(i.hasEnoughInfoToAppend_()){i.processCallQueue_()}}))}if(i.loaderType_==="audio"){i.timelineChangeController_.on("timelinechange",(function(){if(i.hasEnoughInfoToLoad_()){i.processLoadQueue_()}if(i.hasEnoughInfoToAppend_()){i.processCallQueue_()}}))}return i}var r=t.prototype;r.createTransmuxer_=function e(){return Jo.createTransmuxer({remux:false,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:true,parse708captions:this.parse708captions_,captionServices:this.captionServices_})};r.resetStats_=function e(){this.mediaBytesTransferred=0;this.mediaRequests=0;this.mediaRequestsAborted=0;this.mediaRequestsTimedout=0;this.mediaRequestsErrored=0;this.mediaTransferDuration=0;this.mediaSecondsLoaded=0;this.mediaAppends=0};r.dispose=function e(){this.trigger("dispose");this.state="DISPOSED";this.pause();this.abort_();if(this.transmuxer_){this.transmuxer_.terminate()}this.resetStats_();if(this.checkBufferTimeout_){n.a.clearTimeout(this.checkBufferTimeout_)}if(this.syncController_&&this.triggerSyncInfoUpdate_){this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_)}this.off()};r.setAudio=function e(t){this.audioDisabled_=!t;if(t){this.appendInitSegment_.audio=true}else{this.sourceUpdater_.removeAudio(0,this.duration_())}};r.abort=function e(){if(this.state!=="WAITING"){if(this.pendingSegment_){this.pendingSegment_=null}return}this.abort_();this.state="READY";if(!this.paused()){this.monitorBuffer_()}};r.abort_=function e(){if(this.pendingSegment_&&this.pendingSegment_.abortRequests){this.pendingSegment_.abortRequests()}this.pendingSegment_=null;this.callQueue_=[];this.loadQueue_=[];this.metadataQueue_.id3=[];this.metadataQueue_.caption=[];this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_);this.waitingOnRemove_=false;n.a.clearTimeout(this.quotaExceededErrorRetryTimeout_);this.quotaExceededErrorRetryTimeout_=null};r.checkForAbort_=function e(t){if(this.state==="APPENDING"&&!this.pendingSegment_){this.state="READY";return true}if(!this.pendingSegment_||this.pendingSegment_.requestId!==t){return true}return false};r.error=function e(t){if(typeof t!=="undefined"){this.logger_("error occurred:",t);this.error_=t}this.pendingSegment_=null;return this.error_};r.endOfStream=function e(){this.ended_=true;if(this.transmuxer_){Jo.reset(this.transmuxer_)}this.gopBuffer_.length=0;this.pause();this.trigger("ended")};r.buffered_=function e(){var t=this.getMediaInfo_();if(!this.sourceUpdater_||!t){return Ba.createTimeRanges()}if(this.loaderType_==="main"){var r=t.hasAudio,i=t.hasVideo,n=t.isMuxed;if(i&&r&&!this.audioDisabled_&&!n){return this.sourceUpdater_.buffered()}if(i){return this.sourceUpdater_.videoBuffered()}}return this.sourceUpdater_.audioBuffered()};r.initSegmentForMap=function e(t,r){if(r===void 0){r=false}if(!t){return null}var i=ao(t);var n=this.initSegments_[i];if(r&&!n&&t.bytes){this.initSegments_[i]=n={resolvedUri:t.resolvedUri,byterange:t.byterange,bytes:t.bytes,tracks:t.tracks,timescales:t.timescales}}return n||t};r.segmentKey=function e(t,r){if(r===void 0){r=false}if(!t){return null}var i=so(t);var n=this.keyCache_[i];if(this.cacheEncryptionKeys_&&r&&!n&&t.bytes){this.keyCache_[i]=n={resolvedUri:t.resolvedUri,bytes:t.bytes}}var a={resolvedUri:(n||t).resolvedUri};if(n){a.bytes=n.bytes}return a};r.couldBeginLoading_=function e(){return this.playlist_&&!this.paused()};r.load=function e(){this.monitorBuffer_();if(!this.playlist_){return}if(this.state==="INIT"&&this.couldBeginLoading_()){return this.init_()}if(!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"){return}this.state="READY"};r.init_=function e(){this.state="READY";this.resetEverything();return this.monitorBuffer_()};r.playlist=function e(t,r){if(r===void 0){r={}}if(!t){return}var i=this.playlist_;var n=this.pendingSegment_;this.playlist_=t;this.xhrOptions_=r;if(this.state==="INIT"){t.syncInfo={mediaSequence:t.mediaSequence,time:0};if(this.loaderType_==="main"){this.syncController_.setDateTimeMappingForStart(t)}}var a=null;if(i){if(i.id){a=i.id}else if(i.uri){a=i.uri}}this.logger_("playlist update ["+a+" => "+(t.id||t.uri)+"]");this.trigger("syncinfoupdate");if(this.state==="INIT"&&this.couldBeginLoading_()){return this.init_()}if(!i||i.uri!==t.uri){if(this.mediaIndex!==null){if(!t.endList){this.resetLoader()}else{this.resyncLoader()}}this.currentMediaInfo_=void 0;this.trigger("playlistupdate");return}var s=t.mediaSequence-i.mediaSequence;this.logger_("live window shift ["+s+"]");if(this.mediaIndex!==null){this.mediaIndex-=s;if(this.mediaIndex<0){this.mediaIndex=null;this.partIndex=null}else{var o=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!o.parts||!o.parts.length||!o.parts[this.partIndex])){var u=this.mediaIndex;this.logger_("currently processing part (index "+this.partIndex+") no longer exists.");this.resetLoader();this.mediaIndex=u}}}if(n){n.mediaIndex-=s;if(n.mediaIndex<0){n.mediaIndex=null;n.partIndex=null}else{if(n.mediaIndex>=0){n.segment=t.segments[n.mediaIndex]}if(n.partIndex>=0&&n.segment.parts){n.part=n.segment.parts[n.partIndex]}}}this.syncController_.saveExpiredSegmentInfo(i,t)};r.pause=function e(){if(this.checkBufferTimeout_){n.a.clearTimeout(this.checkBufferTimeout_);this.checkBufferTimeout_=null}};r.paused=function e(){return this.checkBufferTimeout_===null};r.resetEverything=function e(t){this.ended_=false;this.appendInitSegment_={audio:true,video:true};this.resetLoader();this.remove(0,Infinity,t);if(this.transmuxer_){this.transmuxer_.postMessage({action:"clearAllMp4Captions"});this.transmuxer_.postMessage({action:"reset"})}};r.resetLoader=function e(){this.fetchAtBuffer_=false;this.resyncLoader()};r.resyncLoader=function e(){if(this.transmuxer_){Jo.reset(this.transmuxer_)}this.mediaIndex=null;this.partIndex=null;this.syncPoint_=null;this.isPendingTimestampOffset_=false;this.callQueue_=[];this.loadQueue_=[];this.metadataQueue_.id3=[];this.metadataQueue_.caption=[];this.abort();if(this.transmuxer_){this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}};r.remove=function e(t,r,i,n){if(i===void 0){i=function e(){}}if(n===void 0){n=false}if(r===Infinity){r=this.duration_()}if(r<=t){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}var a=1;var s=function e(){a--;if(a===0){i()}};if(n||!this.audioDisabled_){a++;this.sourceUpdater_.removeAudio(t,r,s)}if(n||this.loaderType_==="main"){this.gopBuffer_=Wu(this.gopBuffer_,t,r,this.timeMapping_);a++;this.sourceUpdater_.removeVideo(t,r,s)}for(var o in this.inbandTextTracks_){qu(t,r,this.inbandTextTracks_[o])}qu(t,r,this.segmentMetadataTrack_);s()};r.monitorBuffer_=function e(){if(this.checkBufferTimeout_){n.a.clearTimeout(this.checkBufferTimeout_)}this.checkBufferTimeout_=n.a.setTimeout(this.monitorBufferTick_.bind(this),1)};r.monitorBufferTick_=function e(){if(this.state==="READY"){this.fillBuffer_()}if(this.checkBufferTimeout_){n.a.clearTimeout(this.checkBufferTimeout_)}this.checkBufferTimeout_=n.a.setTimeout(this.monitorBufferTick_.bind(this),Qu)};r.fillBuffer_=function e(){if(this.sourceUpdater_.updating()){return}var t=this.chooseNextRequest_();if(!t){return}if(typeof t.timestampOffset==="number"){this.isPendingTimestampOffset_=false;this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:t.timeline})}this.loadSegment_(t)};r.isEndOfStream_=function e(t,r,i){if(t===void 0){t=this.mediaIndex}if(r===void 0){r=this.playlist_}if(i===void 0){i=this.partIndex}if(!r||!this.mediaSource_){return false}var n=typeof t==="number"&&r.segments[t];var a=t+1===r.segments.length;var s=!n||!n.parts||i+1===n.parts.length;return r.endList&&this.mediaSource_.readyState==="open"&&a&&s};r.chooseNextRequest_=function e(){var t=this.buffered_();var r=ts(t)||0;var i=rs(t,this.currentTime_());var n=!this.hasPlayed_()&&i>=1;var a=i>=this.goalBufferLength_();var s=this.playlist_.segments;if(!s.length||n||a){return null}this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());var o={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(o.isSyncRequest){o.mediaIndex=Xu(this.currentTimeline_,s,r)}else if(this.mediaIndex!==null){var u=s[this.mediaIndex];var l=typeof this.partIndex==="number"?this.partIndex:-1;o.startOfSegment=u.end?u.end:r;if(u.parts&&u.parts[l+1]){o.mediaIndex=this.mediaIndex;o.partIndex=l+1}else{o.mediaIndex=this.mediaIndex+1}}else{var d=Is.getMediaInfoForTime({experimentalExactManifestTimings:this.experimentalExactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?r:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time}),f=d.segmentIndex,c=d.startTime,h=d.partIndex;o.getMediaInfoForTime=this.fetchAtBuffer_?"bufferedEnd "+r:"currentTime "+this.currentTime_();o.mediaIndex=f;o.startOfSegment=c;o.partIndex=h}var p=s[o.mediaIndex];var v=p&&typeof o.partIndex==="number"&&p.parts&&p.parts[o.partIndex];if(!p||typeof o.partIndex==="number"&&!v){return null}if(typeof o.partIndex!=="number"&&p.parts){o.partIndex=0;v=p.parts[0]}if(!i&&v&&!v.independent){if(o.partIndex===0){var m=s[o.mediaIndex-1];var g=m.parts&&m.parts.length&&m.parts[m.parts.length-1];if(g&&g.independent){o.mediaIndex-=1;o.partIndex=m.parts.length-1;o.independent="previous segment"}}else if(p.parts[o.partIndex-1].independent){o.partIndex-=1;o.independent="previous part"}}var y=this.mediaSource_&&this.mediaSource_.readyState==="ended";if(o.mediaIndex>=s.length-1&&y&&!this.seeking_()){return null}return this.generateSegmentInfo_(o)};r.generateSegmentInfo_=function e(t){var r=t.independent,i=t.playlist,n=t.mediaIndex,a=t.startOfSegment,s=t.isSyncRequest,o=t.partIndex,u=t.forceTimestampOffset,l=t.getMediaInfoForTime;var d=i.segments[n];var f=typeof o==="number"&&d.parts[o];var c={requestId:"segment-loader-"+Math.random(),uri:f&&f.resolvedUri||d.resolvedUri,mediaIndex:n,partIndex:f?o:null,isSyncRequest:s,startOfSegment:a,playlist:i,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:d.timeline,duration:f&&f.duration||d.duration,segment:d,part:f,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:l,independent:r};var h=typeof u!=="undefined"?u:this.isPendingTimestampOffset_;c.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:d.timeline,currentTimeline:this.currentTimeline_,startOfSegment:a,buffered:this.buffered_(),overrideCheck:h});var p=ts(this.sourceUpdater_.audioBuffered());if(typeof p==="number"){c.audioAppendStart=p-this.sourceUpdater_.audioTimestampOffset()}if(this.sourceUpdater_.videoBuffered().length){c.gopsToAlignWith=Gu(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)}return c};r.timestampOffsetForSegment_=function e(t){return il(t)};r.earlyAbortWhenNeeded_=function e(t){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH){return}if(Date.now()-(t.firstBytesReceivedAt||Date.now())<1e3){return}var r=this.currentTime_();var i=t.bandwidth;var n=this.pendingSegment_.duration;var a=Is.estimateSegmentRequestTime(n,i,this.playlist_,t.bytesReceived);var s=Ja(this.buffered_(),r,this.vhs_.tech_.playbackRate())-1;if(a<=s){return}var o=Pu({master:this.vhs_.playlists.master,currentTime:r,bandwidth:i,duration:this.duration_(),segmentDuration:n,timeUntilRebuffer:s,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!o){return}var u=a-s;var l=u-o.rebufferingImpact;var d=.5;if(s<=Va){d=1}if(!o.playlist||o.playlist.uri===this.playlist_.uri||l<d){return}this.bandwidth=o.playlist.attributes.BANDWIDTH*Oo.BANDWIDTH_VARIANCE+1;this.trigger("earlyabort")};r.handleAbort_=function e(t){this.logger_("Aborting "+tl(t));this.mediaRequestsAborted+=1};r.handleProgress_=function e(t,r){this.earlyAbortWhenNeeded_(r.stats);if(this.checkForAbort_(r.requestId)){return}this.trigger("progress")};r.handleTrackInfo_=function e(t,r){this.earlyAbortWhenNeeded_(t.stats);if(this.checkForAbort_(t.requestId)){return}if(this.checkForIllegalMediaSwitch(r)){return}r=r||{};if(!zu(this.currentMediaInfo_,r)){this.appendInitSegment_={audio:true,video:true};this.startingMediaInfo_=r;this.currentMediaInfo_=r;this.logger_("trackinfo update",r);this.trigger("trackinfo")}if(this.checkForAbort_(t.requestId)){return}this.pendingSegment_.trackInfo=r;if(this.hasEnoughInfoToAppend_()){this.processCallQueue_()}};r.handleTimingInfo_=function e(t,r,i,n){this.earlyAbortWhenNeeded_(t.stats);if(this.checkForAbort_(t.requestId)){return}var a=this.pendingSegment_;var s=rl(r);a[s]=a[s]||{};a[s][i]=n;this.logger_("timinginfo: "+r+" - "+i+" - "+n);if(this.hasEnoughInfoToAppend_()){this.processCallQueue_()}};r.handleCaptions_=function e(t,r){var i=this;this.earlyAbortWhenNeeded_(t.stats);if(this.checkForAbort_(t.requestId)){return}if(r.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}var n=this.pendingSegment_;if(!n.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,t,r));return}var a=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();var s={};r.forEach((function(e){s[e.stream]=s[e.stream]||{startTime:Infinity,captions:[],endTime:0};var t=s[e.stream];t.startTime=Math.min(t.startTime,e.startTime+a);t.endTime=Math.max(t.endTime,e.endTime+a);t.captions.push(e)}));Object.keys(s).forEach((function(e){var t=s[e],r=t.startTime,n=t.endTime,o=t.captions;var u=i.inbandTextTracks_;i.logger_("adding cues from "+r+" -> "+n+" for "+e);Mu(u,i.vhs_.tech_,e);qu(r,n,u[e]);Nu({captionArray:o,inbandTextTracks:u,timestampOffset:a})}));if(this.transmuxer_){this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}};r.handleId3_=function e(t,r,i){this.earlyAbortWhenNeeded_(t.stats);if(this.checkForAbort_(t.requestId)){return}var n=this.pendingSegment_;if(!n.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,t,r,i));return}var a=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();ju(this.inbandTextTracks_,i,this.vhs_.tech_);Fu({inbandTextTracks:this.inbandTextTracks_,metadataArray:r,timestampOffset:a,videoDuration:this.duration_()})};r.processMetadataQueue_=function e(){this.metadataQueue_.id3.forEach((function(e){return e()}));this.metadataQueue_.caption.forEach((function(e){return e()}));this.metadataQueue_.id3=[];this.metadataQueue_.caption=[]};r.processCallQueue_=function e(){var t=this.callQueue_;this.callQueue_=[];t.forEach((function(e){return e()}))};r.processLoadQueue_=function e(){var t=this.loadQueue_;this.loadQueue_=[];t.forEach((function(e){return e()}))};r.hasEnoughInfoToLoad_=function e(){if(this.loaderType_!=="audio"){return true}var t=this.pendingSegment_;if(!t){return false}if(!this.getCurrentMediaInfo_()){return true}if(nl({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:t.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_})){return false}return true};r.getCurrentMediaInfo_=function e(t){if(t===void 0){t=this.pendingSegment_}return t&&t.trackInfo||this.currentMediaInfo_};r.getMediaInfo_=function e(t){if(t===void 0){t=this.pendingSegment_}return this.getCurrentMediaInfo_(t)||this.startingMediaInfo_};r.hasEnoughInfoToAppend_=function e(){if(!this.sourceUpdater_.ready()){return false}if(this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_){return false}var t=this.pendingSegment_;var r=this.getCurrentMediaInfo_();if(!t||!r){return false}var i=r.hasAudio,n=r.hasVideo,a=r.isMuxed;if(n&&!t.videoTimingInfo){return false}if(i&&!this.audioDisabled_&&!a&&!t.audioTimingInfo){return false}if(nl({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:t.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_})){return false}return true};r.handleData_=function e(t,r){this.earlyAbortWhenNeeded_(t.stats);if(this.checkForAbort_(t.requestId)){return}if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){this.callQueue_.push(this.handleData_.bind(this,t,r));return}var i=this.pendingSegment_;this.setTimeMapping_(i.timeline);this.updateMediaSecondsLoaded_(i.part||i.segment);if(this.mediaSource_.readyState==="closed"){return}if(t.map){t.map=this.initSegmentForMap(t.map,true);i.segment.map=t.map}if(t.key){this.segmentKey(t.key,true)}i.isFmp4=t.isFmp4;i.timingInfo=i.timingInfo||{};if(i.isFmp4){this.trigger("fmp4");i.timingInfo.start=i[rl(r.type)].start}else{var n=this.getCurrentMediaInfo_();var a=this.loaderType_==="main"&&n&&n.hasVideo;var s;if(a){s=i.videoTimingInfo.start}i.timingInfo.start=this.trueSegmentStart_({currentStart:i.timingInfo.start,playlist:i.playlist,mediaIndex:i.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:a,firstVideoFrameTimeForData:s,videoTimingInfo:i.videoTimingInfo,audioTimingInfo:i.audioTimingInfo})}this.updateAppendInitSegmentStatus(i,r.type);this.updateSourceBufferTimestampOffset_(i);if(i.isSyncRequest){this.updateTimingInfoEnd_(i);this.syncController_.saveSegmentTimingInfo({segmentInfo:i,shouldSaveTimelineMapping:this.loaderType_==="main"});var o=this.chooseNextRequest_();if(o.mediaIndex!==i.mediaIndex||o.partIndex!==i.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}i.hasAppendedData_=true;this.processMetadataQueue_();this.appendData_(i,r)};r.updateAppendInitSegmentStatus=function e(t,r){if(this.loaderType_==="main"&&typeof t.timestampOffset==="number"&&!t.changedTimestampOffset){this.appendInitSegment_={audio:true,video:true}}if(this.playlistOfLastInitSegment_[r]!==t.playlist){this.appendInitSegment_[r]=true}};r.getInitSegmentAndUpdateState_=function e(t){var r=t.type,i=t.initSegment,n=t.map,a=t.playlist;if(n){var s=ao(n);if(this.activeInitSegmentId_===s){return null}i=this.initSegmentForMap(n,true).bytes;this.activeInitSegmentId_=s}if(i&&this.appendInitSegment_[r]){this.playlistOfLastInitSegment_[r]=a;this.appendInitSegment_[r]=false;this.activeInitSegmentId_=null;return i}return null};r.handleQuotaExceededError_=function e(t,r){var i=this;var a=t.segmentInfo,s=t.type,o=t.bytes;var u=this.sourceUpdater_.audioBuffered();var l=this.sourceUpdater_.videoBuffered();if(u.length>1){this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+Za(u).join(", "))}if(l.length>1){this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+Za(l).join(", "))}var d=u.length?u.start(0):0;var f=u.length?u.end(u.length-1):0;var c=l.length?l.start(0):0;var h=l.length?l.end(l.length-1):0;if(f-d<=Yu&&h-c<=Yu){this.logger_("On QUOTA_EXCEEDED_ERR, single segment too large to append to "+"buffer, triggering an error. "+("Appended byte length: "+o.byteLength+", ")+("audio buffer: "+Za(u).join(", ")+", ")+("video buffer: "+Za(l).join(", ")+", "));this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:Infinity});this.trigger("error");return}this.waitingOnRemove_=true;this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:a,type:s,bytes:o}));var p=this.currentTime_();var v=p-Yu;this.logger_("On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to "+v);this.remove(0,v,(function(){i.logger_("On QUOTA_EXCEEDED_ERR, retrying append in "+Yu+"s");i.waitingOnRemove_=false;i.quotaExceededErrorRetryTimeout_=n.a.setTimeout((function(){i.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue");i.quotaExceededErrorRetryTimeout_=null;i.processCallQueue_()}),Yu*1e3)}),true)};r.handleAppendError_=function e(t,r){var i=t.segmentInfo,n=t.type,a=t.bytes;if(!r){return}if(r.code===Ku){this.handleQuotaExceededError_({segmentInfo:i,type:n,bytes:a});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",r);this.error(n+" append of "+a.length+"b failed for segment "+("#"+i.mediaIndex+" in playlist "+i.playlist.id));this.trigger("appenderror")};r.appendToSourceBuffer_=function e(t){var r=t.segmentInfo,i=t.type,n=t.initSegment,a=t.data,s=t.bytes;if(!s){var o=[a];var u=a.byteLength;if(n){o.unshift(n);u+=n.byteLength}s=Uu({bytes:u,segments:o})}this.sourceUpdater_.appendBuffer({segmentInfo:r,type:i,bytes:s},this.handleAppendError_.bind(this,{segmentInfo:r,type:i,bytes:s}))};r.handleSegmentTimingInfo_=function e(t,r,i){if(!this.pendingSegment_||r!==this.pendingSegment_.requestId){return}var n=this.pendingSegment_.segment;var a=t+"TimingInfo";if(!n[a]){n[a]={}}n[a].transmuxerPrependedSeconds=i.prependedContentDuration||0;n[a].transmuxedPresentationStart=i.start.presentation;n[a].transmuxedDecodeStart=i.start.decode;n[a].transmuxedPresentationEnd=i.end.presentation;n[a].transmuxedDecodeEnd=i.end.decode;n[a].baseMediaDecodeTime=i.baseMediaDecodeTime};r.appendData_=function e(t,r){var i=r.type,n=r.data;if(!n||!n.byteLength){return}if(i==="audio"&&this.audioDisabled_){return}var a=this.getInitSegmentAndUpdateState_({type:i,initSegment:r.initSegment,playlist:t.playlist,map:t.isFmp4?t.segment.map:null});this.appendToSourceBuffer_({segmentInfo:t,type:i,initSegment:a,data:n})};r.loadSegment_=function e(t){var r=this;this.state="WAITING";this.pendingSegment_=t;this.trimBackBuffer_(t);if(typeof t.timestampOffset==="number"){if(this.transmuxer_){this.transmuxer_.postMessage({action:"clearAllMp4Captions"})}}if(!this.hasEnoughInfoToLoad_()){this.loadQueue_.push((function(){var e=u()({},t,{forceTimestampOffset:true});u()(t,r.generateSegmentInfo_(e));r.isPendingTimestampOffset_=false;r.updateTransmuxerAndRequestSegment_(t)}));return}this.updateTransmuxerAndRequestSegment_(t)};r.updateTransmuxerAndRequestSegment_=function e(t){var r=this;if(this.shouldUpdateTransmuxerTimestampOffset_(t.timestampOffset)){this.gopBuffer_.length=0;t.gopsToAlignWith=[];this.timeMapping_=0;this.transmuxer_.postMessage({action:"reset"});this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:t.timestampOffset})}var i=this.createSimplifiedSegmentObj_(t);var n=this.isEndOfStream_(t.mediaIndex,t.playlist,t.partIndex);var a=this.mediaIndex!==null;var s=t.timeline!==this.currentTimeline_&&t.timeline>0;var o=n||a&&s;this.logger_("Requesting "+tl(t));if(i.map&&!i.map.bytes){this.logger_("going to request init segment.");this.appendInitSegment_={video:true,audio:true}}t.abortRequests=mu({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:i,abortFn:this.handleAbort_.bind(this,t),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",t.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",t.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:o,endedTimelineFn:function e(){r.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:function e(i){var n=i.message,a=i.level,s=i.stream;r.logger_(tl(t)+" logged from transmuxer stream "+s+" as a "+a+": "+n)}})};r.trimBackBuffer_=function e(t){var r=el(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);if(r>0){this.remove(0,r)}};r.createSimplifiedSegmentObj_=function e(t){var r=t.segment;var i=t.part;var n={resolvedUri:i?i.resolvedUri:r.resolvedUri,byterange:i?i.byterange:r.byterange,requestId:t.requestId,transmuxer:t.transmuxer,audioAppendStart:t.audioAppendStart,gopsToAlignWith:t.gopsToAlignWith,part:t.part};var a=t.playlist.segments[t.mediaIndex-1];if(a&&a.timeline===r.timeline){if(a.videoTimingInfo){n.baseStartTime=a.videoTimingInfo.transmuxedDecodeEnd}else if(a.audioTimingInfo){n.baseStartTime=a.audioTimingInfo.transmuxedDecodeEnd}}if(r.key){var s=r.key.iv||new Uint32Array([0,0,0,t.mediaIndex+t.playlist.mediaSequence]);n.key=this.segmentKey(r.key);n.key.iv=s}if(r.map){n.map=this.initSegmentForMap(r.map)}return n};r.saveTransferStats_=function e(t){this.mediaRequests+=1;if(t){this.mediaBytesTransferred+=t.bytesReceived;this.mediaTransferDuration+=t.roundTripTime}};r.saveBandwidthRelatedStats_=function e(t,r){this.pendingSegment_.byteLength=r.bytesReceived;if(t<Ju){this.logger_("Ignoring segment's bandwidth because its duration of "+t+(" is less than the min to record "+Ju));return}this.bandwidth=r.bandwidth;this.roundTrip=r.roundTripTime};r.handleTimeout_=function e(){this.mediaRequestsTimedout+=1;this.bandwidth=1;this.roundTrip=NaN;this.trigger("bandwidthupdate")};r.segmentRequestFinished_=function e(t,r,i){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,t,r,i));return}this.saveTransferStats_(r.stats);if(!this.pendingSegment_){return}if(r.requestId!==this.pendingSegment_.requestId){return}if(t){this.pendingSegment_=null;this.state="READY";if(t.code===eu.ABORTED){return}this.pause();if(t.code===eu.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1;this.error(t);this.trigger("error");return}var n=this.pendingSegment_;this.saveBandwidthRelatedStats_(n.duration,r.stats);n.endOfAllRequests=r.endOfAllRequests;if(i.gopInfo){this.gopBuffer_=Vu(this.gopBuffer_,i.gopInfo,this.safeAppend_)}this.state="APPENDING";this.trigger("appending");this.waitForAppendsToComplete_(n)};r.setTimeMapping_=function e(t){var r=this.syncController_.mappingForTimeline(t);if(r!==null){this.timeMapping_=r}};r.updateMediaSecondsLoaded_=function e(t){if(typeof t.start==="number"&&typeof t.end==="number"){this.mediaSecondsLoaded+=t.end-t.start}else{this.mediaSecondsLoaded+=t.duration}};r.shouldUpdateTransmuxerTimestampOffset_=function e(t){if(t===null){return false}if(this.loaderType_==="main"&&t!==this.sourceUpdater_.videoTimestampOffset()){return true}if(!this.audioDisabled_&&t!==this.sourceUpdater_.audioTimestampOffset()){return true}return false};r.trueSegmentStart_=function e(t){var r=t.currentStart,i=t.playlist,n=t.mediaIndex,a=t.firstVideoFrameTimeForData,s=t.currentVideoTimestampOffset,o=t.useVideoTimingInfo,u=t.videoTimingInfo,l=t.audioTimingInfo;if(typeof r!=="undefined"){return r}if(!o){return l.start}var d=i.segments[n-1];if(n===0||!d||typeof d.start==="undefined"||d.end!==a+s){return a}return u.start};r.waitForAppendsToComplete_=function e(t){var r=this.getCurrentMediaInfo_(t);if(!r){this.error({message:"No starting media returned, likely due to an unsupported media format.",blacklistDuration:Infinity});this.trigger("error");return}var i=r.hasAudio,n=r.hasVideo,a=r.isMuxed;var s=this.loaderType_==="main"&&n;var o=!this.audioDisabled_&&i&&!a;t.waitingOnAppends=0;if(!t.hasAppendedData_){if(!t.timingInfo&&typeof t.timestampOffset==="number"){this.isPendingTimestampOffset_=true}t.timingInfo={start:0};t.waitingOnAppends++;if(!this.isPendingTimestampOffset_){this.updateSourceBufferTimestampOffset_(t);this.processMetadataQueue_()}this.checkAppendsDone_(t);return}if(s){t.waitingOnAppends++}if(o){t.waitingOnAppends++}if(s){this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,t))}if(o){this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,t))}};r.checkAppendsDone_=function e(t){if(this.checkForAbort_(t.requestId)){return}t.waitingOnAppends--;if(t.waitingOnAppends===0){this.handleAppendsDone_()}};r.checkForIllegalMediaSwitch=function e(t){var r=Zu(this.loaderType_,this.getCurrentMediaInfo_(),t);if(r){this.error({message:r,blacklistDuration:Infinity});this.trigger("error");return true}return false};r.updateSourceBufferTimestampOffset_=function e(t){if(t.timestampOffset===null||typeof t.timingInfo.start!=="number"||t.changedTimestampOffset||this.loaderType_!=="main"){return}var r=false;t.timestampOffset-=t.timingInfo.start;t.changedTimestampOffset=true;if(t.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()){this.sourceUpdater_.videoTimestampOffset(t.timestampOffset);r=true}if(t.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()){this.sourceUpdater_.audioTimestampOffset(t.timestampOffset);r=true}if(r){this.trigger("timestampoffset")}};r.updateTimingInfoEnd_=function e(t){t.timingInfo=t.timingInfo||{};var r=this.getMediaInfo_();var i=this.loaderType_==="main"&&r&&r.hasVideo;var n=i&&t.videoTimingInfo?t.videoTimingInfo:t.audioTimingInfo;if(!n){return}t.timingInfo.end=typeof n.end==="number"?n.end:n.start+t.duration};r.handleAppendsDone_=function e(){if(this.pendingSegment_){this.trigger("appendsdone")}if(!this.pendingSegment_){this.state="READY";if(!this.paused()){this.monitorBuffer_()}return}var t=this.pendingSegment_;this.updateTimingInfoEnd_(t);if(this.shouldSaveSegmentTimingInfo_){this.syncController_.saveSegmentTimingInfo({segmentInfo:t,shouldSaveTimelineMapping:this.loaderType_==="main"})}var r=ol(t,this.sourceType_);if(r){if(r.severity==="warn"){Ba.log.warn(r.message)}else{this.logger_(r.message)}}this.recordThroughput_(t);this.pendingSegment_=null;this.state="READY";if(t.isSyncRequest){this.trigger("syncinfoupdate");if(!t.hasAppendedData_){this.logger_("Throwing away un-appended sync request "+tl(t));return}}this.logger_("Appended "+tl(t));this.addSegmentMetadataCue_(t);this.fetchAtBuffer_=true;if(this.currentTimeline_!==t.timeline){this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:t.timeline});if(this.loaderType_==="main"&&!this.audioDisabled_){this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:t.timeline})}}this.currentTimeline_=t.timeline;this.trigger("syncinfoupdate");var i=t.segment;var n=t.part;var a=i.end&&this.currentTime_()-i.end>t.playlist.targetDuration*3;var s=n&&n.end&&this.currentTime_()-n.end>t.playlist.partTargetDuration*3;if(a||s){this.logger_("bad "+(a?"segment":"part")+" "+tl(t));this.resetEverything();return}var o=this.mediaIndex!==null;if(o){this.trigger("bandwidthupdate")}this.trigger("progress");this.mediaIndex=t.mediaIndex;this.partIndex=t.partIndex;if(this.isEndOfStream_(t.mediaIndex,t.playlist,t.partIndex)){this.endOfStream()}this.trigger("appended");if(t.hasAppendedData_){this.mediaAppends++}if(!this.paused()){this.monitorBuffer_()}};r.recordThroughput_=function e(t){if(t.duration<Ju){this.logger_("Ignoring segment's throughput because its duration of "+t.duration+(" is less than the min to record "+Ju));return}var r=this.throughput.rate;var i=Date.now()-t.endOfAllRequests+1;var n=Math.floor(t.byteLength/i*8*1e3);this.throughput.rate+=(n-r)/++this.throughput.count};r.addSegmentMetadataCue_=function e(t){if(!this.segmentMetadataTrack_){return}var r=t.segment;var i=r.start;var a=r.end;if(!$u(i)||!$u(a)){return}qu(i,a,this.segmentMetadataTrack_);var s=n.a.WebKitDataCue||n.a.VTTCue;var o={custom:r.custom,dateTimeObject:r.dateTimeObject,dateTimeString:r.dateTimeString,bandwidth:t.playlist.attributes.BANDWIDTH,resolution:t.playlist.attributes.RESOLUTION,codecs:t.playlist.attributes.CODECS,byteLength:t.byteLength,uri:t.uri,timeline:t.timeline,playlist:t.playlist.id,start:i,end:a};var u=JSON.stringify(o);var l=new s(i,a,u);l.value=o;this.segmentMetadataTrack_.addCue(l)};return t}(Ba.EventTarget);function ll(){}var dl=function e(t){if(typeof t!=="string"){return t}return t.replace(/./,(function(e){return e.toUpperCase()}))};var fl=["video","audio"];var cl=function e(t,r){var i=r[t+"Buffer"];return i&&i.updating||r.queuePending[t]};var hl=function e(t,r){for(var i=0;i<r.length;i++){var n=r[i];if(n.type==="mediaSource"){return null}if(n.type===t){return i}}return null};var pl=function e(t,r){if(r.queue.length===0){return}var i=0;var n=r.queue[i];if(n.type==="mediaSource"){if(!r.updating()&&r.mediaSource.readyState!=="closed"){r.queue.shift();n.action(r);if(n.doneFn){n.doneFn()}e("audio",r);e("video",r)}return}if(t==="mediaSource"){return}if(!r.ready()||r.mediaSource.readyState==="closed"||cl(t,r)){return}if(n.type!==t){i=hl(t,r.queue);if(i===null){return}n=r.queue[i]}r.queue.splice(i,1);r.queuePending[t]=n;n.action(t,r);if(!n.doneFn){r.queuePending[t]=null;e(t,r);return}};var vl=function e(t,r){var i=r[t+"Buffer"];var n=dl(t);if(!i){return}i.removeEventListener("updateend",r["on"+n+"UpdateEnd_"]);i.removeEventListener("error",r["on"+n+"Error_"]);r.codecs[t]=null;r[t+"Buffer"]=null};var ml=function e(t,r){return t&&r&&Array.prototype.indexOf.call(t.sourceBuffers,r)!==-1};var gl={appendBuffer:function e(t,r,i){return function(e,n){var a=n[e+"Buffer"];if(!ml(n.mediaSource,a)){return}n.logger_("Appending segment "+r.mediaIndex+"'s "+t.length+" bytes to "+e+"Buffer");try{a.appendBuffer(t)}catch(t){n.logger_("Error with code "+t.code+" "+(t.code===Ku?"(QUOTA_EXCEEDED_ERR) ":"")+("when appending segment "+r.mediaIndex+" to "+e+"Buffer"));n.queuePending[e]=null;i(t)}}},remove:function e(t,r){return function(e,i){var n=i[e+"Buffer"];if(!ml(i.mediaSource,n)){return}i.logger_("Removing "+t+" to "+r+" from "+e+"Buffer");try{n.remove(t,r)}catch(n){i.logger_("Remove "+t+" to "+r+" from "+e+"Buffer failed")}}},timestampOffset:function e(t){return function(e,r){var i=r[e+"Buffer"];if(!ml(r.mediaSource,i)){return}r.logger_("Setting "+e+"timestampOffset to "+t);i.timestampOffset=t}},callback:function e(t){return function(e,r){t()}},endOfStream:function e(t){return function(e){if(e.mediaSource.readyState!=="open"){return}e.logger_("Calling mediaSource endOfStream("+(t||"")+")");try{e.mediaSource.endOfStream(t)}catch(e){Ba.log.warn("Failed to call media source endOfStream",e)}}},duration:function e(t){return function(e){e.logger_("Setting mediaSource duration to "+t);try{e.mediaSource.duration=t}catch(e){Ba.log.warn("Failed to set media source duration",e)}}},abort:function e(){return function(e,t){if(t.mediaSource.readyState!=="open"){return}var r=t[e+"Buffer"];if(!ml(t.mediaSource,r)){return}t.logger_("calling abort on "+e+"Buffer");try{r.abort()}catch(t){Ba.log.warn("Failed to abort on "+e+"Buffer",t)}}},addSourceBuffer:function e(t,r){return function(e){var i=dl(t);var n=Object(C["e"])(r);e.logger_("Adding "+t+"Buffer with codec "+r+" to mediaSource");var a=e.mediaSource.addSourceBuffer(n);a.addEventListener("updateend",e["on"+i+"UpdateEnd_"]);a.addEventListener("error",e["on"+i+"Error_"]);e.codecs[t]=r;e[t+"Buffer"]=a}},removeSourceBuffer:function e(t){return function(e){var r=e[t+"Buffer"];vl(t,e);if(!ml(e.mediaSource,r)){return}e.logger_("Removing "+t+"Buffer with codec "+e.codecs[t]+" from mediaSource");try{e.mediaSource.removeSourceBuffer(r)}catch(e){Ba.log.warn("Failed to removeSourceBuffer "+t+"Buffer",e)}}},changeType:function e(t){return function(e,r){var i=r[e+"Buffer"];var n=Object(C["e"])(t);if(!ml(r.mediaSource,i)){return}if(r.codecs[e]===t){return}r.logger_("changing "+e+"Buffer codec from "+r.codecs[e]+" to "+t);i.changeType(n);r.codecs[e]=t}}};var yl=function e(t){var r=t.type,i=t.sourceUpdater,n=t.action,a=t.doneFn,s=t.name;i.queue.push({type:r,action:n,doneFn:a,name:s});pl(r,i)};var _l=function e(t,r){return function(e){if(r.queuePending[t]){var i=r.queuePending[t].doneFn;r.queuePending[t]=null;if(i){i(r[t+"Error_"])}}pl(t,r)}};var bl=function(e){p()(t,e);function t(t){var r;r=e.call(this)||this;r.mediaSource=t;r.sourceopenListener_=function(){return pl("mediaSource",c()(r))};r.mediaSource.addEventListener("sourceopen",r.sourceopenListener_);r.logger_=Ga("SourceUpdater");r.audioTimestampOffset_=0;r.videoTimestampOffset_=0;r.queue=[];r.queuePending={audio:null,video:null};r.delayedAudioAppendQueue_=[];r.videoAppendQueued_=false;r.codecs={};r.onVideoUpdateEnd_=_l("video",c()(r));r.onAudioUpdateEnd_=_l("audio",c()(r));r.onVideoError_=function(e){r.videoError_=e};r.onAudioError_=function(e){r.audioError_=e};r.createdSourceBuffers_=false;r.initializedEme_=false;r.triggeredReady_=false;return r}var r=t.prototype;r.initializedEme=function e(){this.initializedEme_=true;this.triggerReady()};r.hasCreatedSourceBuffers=function e(){return this.createdSourceBuffers_};r.hasInitializedAnyEme=function e(){return this.initializedEme_};r.ready=function e(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()};r.createSourceBuffers=function e(t){if(this.hasCreatedSourceBuffers()){return}this.addOrChangeSourceBuffers(t);this.createdSourceBuffers_=true;this.trigger("createdsourcebuffers");this.triggerReady()};r.triggerReady=function e(){if(this.ready()&&!this.triggeredReady_){this.triggeredReady_=true;this.trigger("ready")}};r.addSourceBuffer=function e(t,r){yl({type:"mediaSource",sourceUpdater:this,action:gl.addSourceBuffer(t,r),name:"addSourceBuffer"})};r.abort=function e(t){yl({type:t,sourceUpdater:this,action:gl.abort(t),name:"abort"})};r.removeSourceBuffer=function e(t){if(!this.canRemoveSourceBuffer()){Ba.log.error("removeSourceBuffer is not supported!");return}yl({type:"mediaSource",sourceUpdater:this,action:gl.removeSourceBuffer(t),name:"removeSourceBuffer"})};r.canRemoveSourceBuffer=function e(){return!Ba.browser.IE_VERSION&&!Ba.browser.IS_FIREFOX&&n.a.MediaSource&&n.a.MediaSource.prototype&&typeof n.a.MediaSource.prototype.removeSourceBuffer==="function"};t.canChangeType=function e(){return n.a.SourceBuffer&&n.a.SourceBuffer.prototype&&typeof n.a.SourceBuffer.prototype.changeType==="function"};r.canChangeType=function e(){return this.constructor.canChangeType()};r.changeType=function e(t,r){if(!this.canChangeType()){Ba.log.error("changeType is not supported!");return}yl({type:t,sourceUpdater:this,action:gl.changeType(r),name:"changeType"})};r.addOrChangeSourceBuffers=function e(t){var r=this;if(!t||typeof t!=="object"||Object.keys(t).length===0){throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs")}Object.keys(t).forEach((function(e){var i=t[e];if(!r.hasCreatedSourceBuffers()){return r.addSourceBuffer(e,i)}if(r.canChangeType()){r.changeType(e,i)}}))};r.appendBuffer=function e(t,r){var i=this;var n=t.segmentInfo,a=t.type,s=t.bytes;this.processedAppend_=true;if(a==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([t,r]);this.logger_("delayed audio append of "+s.length+" until video append");return}var o=r;yl({type:a,sourceUpdater:this,action:gl.appendBuffer(s,n||{mediaIndex:-1},o),doneFn:r,name:"appendBuffer"});if(a==="video"){this.videoAppendQueued_=true;if(!this.delayedAudioAppendQueue_.length){return}var u=this.delayedAudioAppendQueue_.slice();this.logger_("queuing delayed audio "+u.length+" appendBuffers");this.delayedAudioAppendQueue_.length=0;u.forEach((function(e){i.appendBuffer.apply(i,e)}))}};r.audioBuffered=function e(){if(!ml(this.mediaSource,this.audioBuffer)){return Ba.createTimeRange()}return this.audioBuffer.buffered?this.audioBuffer.buffered:Ba.createTimeRange()};r.videoBuffered=function e(){if(!ml(this.mediaSource,this.videoBuffer)){return Ba.createTimeRange()}return this.videoBuffer.buffered?this.videoBuffer.buffered:Ba.createTimeRange()};r.buffered=function e(){var t=ml(this.mediaSource,this.videoBuffer)?this.videoBuffer:null;var r=ml(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;if(r&&!t){return this.audioBuffered()}if(t&&!r){return this.videoBuffered()}return Qa(this.audioBuffered(),this.videoBuffered())};r.setDuration=function e(t,r){if(r===void 0){r=ll}yl({type:"mediaSource",sourceUpdater:this,action:gl.duration(t),name:"duration",doneFn:r})};r.endOfStream=function e(t,r){if(t===void 0){t=null}if(r===void 0){r=ll}if(typeof t!=="string"){t=undefined}yl({type:"mediaSource",sourceUpdater:this,action:gl.endOfStream(t),name:"endOfStream",doneFn:r})};r.removeAudio=function e(t,r,i){if(i===void 0){i=ll}if(!this.audioBuffered().length||this.audioBuffered().end(0)===0){i();return}yl({type:"audio",sourceUpdater:this,action:gl.remove(t,r),doneFn:i,name:"remove"})};r.removeVideo=function e(t,r,i){if(i===void 0){i=ll}if(!this.videoBuffered().length||this.videoBuffered().end(0)===0){i();return}yl({type:"video",sourceUpdater:this,action:gl.remove(t,r),doneFn:i,name:"remove"})};r.updating=function e(){if(cl("audio",this)||cl("video",this)){return true}return false};r.audioTimestampOffset=function e(t){if(typeof t!=="undefined"&&this.audioBuffer&&this.audioTimestampOffset_!==t){yl({type:"audio",sourceUpdater:this,action:gl.timestampOffset(t),name:"timestampOffset"});this.audioTimestampOffset_=t}return this.audioTimestampOffset_};r.videoTimestampOffset=function e(t){if(typeof t!=="undefined"&&this.videoBuffer&&this.videoTimestampOffset!==t){yl({type:"video",sourceUpdater:this,action:gl.timestampOffset(t),name:"timestampOffset"});this.videoTimestampOffset_=t}return this.videoTimestampOffset_};r.audioQueueCallback=function e(t){if(!this.audioBuffer){return}yl({type:"audio",sourceUpdater:this,action:gl.callback(t),name:"callback"})};r.videoQueueCallback=function e(t){if(!this.videoBuffer){return}yl({type:"video",sourceUpdater:this,action:gl.callback(t),name:"callback"})};r.dispose=function e(){var t=this;this.trigger("dispose");fl.forEach((function(e){t.abort(e);if(t.canRemoveSourceBuffer()){t.removeSourceBuffer(e)}else{t[e+"QueueCallback"]((function(){return vl(e,t)}))}}));this.videoAppendQueued_=false;this.delayedAudioAppendQueue_.length=0;if(this.sourceopenListener_){this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_)}this.off()};return t}(Ba.EventTarget);var Tl=function e(t){return decodeURIComponent(escape(String.fromCharCode.apply(null,t)))};var Sl=new Uint8Array("\n\n".split("").map((function(e){return e.charCodeAt(0)})));var wl=function(e){p()(t,e);function t(t,r){var i;if(r===void 0){r={}}i=e.call(this,t,r)||this;i.mediaSource_=null;i.subtitlesTrack_=null;i.loaderType_="subtitle";i.featuresNativeTextTracks_=t.featuresNativeTextTracks;i.shouldSaveSegmentTimingInfo_=false;return i}var r=t.prototype;r.createTransmuxer_=function e(){return null};r.buffered_=function e(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length){return Ba.createTimeRanges()}var t=this.subtitlesTrack_.cues;var r=t[0].startTime;var i=t[t.length-1].startTime;return Ba.createTimeRanges([[r,i]])};r.initSegmentForMap=function e(t,r){if(r===void 0){r=false}if(!t){return null}var i=ao(t);var n=this.initSegments_[i];if(r&&!n&&t.bytes){var a=Sl.byteLength+t.bytes.byteLength;var s=new Uint8Array(a);s.set(t.bytes);s.set(Sl,t.bytes.byteLength);this.initSegments_[i]=n={resolvedUri:t.resolvedUri,byterange:t.byterange,bytes:s}}return n||t};r.couldBeginLoading_=function e(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()};r.init_=function e(){this.state="READY";this.resetEverything();return this.monitorBuffer_()};r.track=function e(t){if(typeof t==="undefined"){return this.subtitlesTrack_}this.subtitlesTrack_=t;if(this.state==="INIT"&&this.couldBeginLoading_()){this.init_()}return this.subtitlesTrack_};r.remove=function e(t,r){qu(t,r,this.subtitlesTrack_)};r.fillBuffer_=function e(){var t=this;var r=this.chooseNextRequest_();if(!r){return}if(this.syncController_.timestampOffsetForTimeline(r.timeline)===null){var i=function e(){t.state="READY";if(!t.paused()){t.monitorBuffer_()}};this.syncController_.one("timestampoffset",i);this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(r)};r.timestampOffsetForSegment_=function e(){return null};r.chooseNextRequest_=function t(){return this.skipEmptySegments_(e.prototype.chooseNextRequest_.call(this))};r.skipEmptySegments_=function e(t){while(t&&t.segment.empty){if(t.mediaIndex+1>=t.playlist.segments.length){t=null;break}t=this.generateSegmentInfo_({playlist:t.playlist,mediaIndex:t.mediaIndex+1,startOfSegment:t.startOfSegment+t.duration,isSyncRequest:t.isSyncRequest})}return t};r.stopForError=function e(t){this.error(t);this.state="READY";this.pause();this.trigger("error")};r.segmentRequestFinished_=function e(t,r,i){var a=this;if(!this.subtitlesTrack_){this.state="READY";return}this.saveTransferStats_(r.stats);if(!this.pendingSegment_){this.state="READY";this.mediaRequestsAborted+=1;return}if(t){if(t.code===eu.TIMEOUT){this.handleTimeout_()}if(t.code===eu.ABORTED){this.mediaRequestsAborted+=1}else{this.mediaRequestsErrored+=1}this.stopForError(t);return}var s=this.pendingSegment_;this.saveBandwidthRelatedStats_(s.duration,r.stats);this.state="APPENDING";this.trigger("appending");var o=s.segment;if(o.map){o.map.bytes=r.map.bytes}s.bytes=r.bytes;if(typeof n.a.WebVTT!=="function"&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var u;var l=function e(){a.subtitlesTrack_.tech_.off("vttjsloaded",u);a.stopForError({message:"Error loading vtt.js"});return};u=function e(){a.subtitlesTrack_.tech_.off("vttjserror",l);a.segmentRequestFinished_(t,r,i)};this.state="WAITING_ON_VTTJS";this.subtitlesTrack_.tech_.one("vttjsloaded",u);this.subtitlesTrack_.tech_.one("vttjserror",l);return}o.requested=true;try{this.parseVTTCues_(s)}catch(e){this.stopForError({message:e.message});return}this.updateTimeMapping_(s,this.syncController_.timelines[s.timeline],this.playlist_);if(s.cues.length){s.timingInfo={start:s.cues[0].startTime,end:s.cues[s.cues.length-1].endTime}}else{s.timingInfo={start:s.startOfSegment,end:s.startOfSegment+s.duration}}if(s.isSyncRequest){this.trigger("syncinfoupdate");this.pendingSegment_=null;this.state="READY";return}s.byteLength=s.bytes.byteLength;this.mediaSecondsLoaded+=o.duration;s.cues.forEach((function(e){a.subtitlesTrack_.addCue(a.featuresNativeTextTracks_?new n.a.VTTCue(e.startTime,e.endTime,e.text):e)}));Hu(this.subtitlesTrack_);this.handleAppendsDone_()};r.handleData_=function e(){};r.updateTimingInfoEnd_=function e(){};r.parseVTTCues_=function e(t){var r;var i=false;if(typeof n.a.TextDecoder==="function"){r=new n.a.TextDecoder("utf8")}else{r=n.a.WebVTT.StringDecoder();i=true}var a=new n.a.WebVTT.Parser(n.a,n.a.vttjs,r);t.cues=[];t.timestampmap={MPEGTS:0,LOCAL:0};a.oncue=t.cues.push.bind(t.cues);a.ontimestampmap=function(e){t.timestampmap=e};a.onparsingerror=function(e){Ba.log.warn("Error encountered when parsing cues: "+e.message)};if(t.segment.map){var s=t.segment.map.bytes;if(i){s=Tl(s)}a.parse(s)}var o=t.bytes;if(i){o=Tl(o)}a.parse(o);a.flush()};r.updateTimeMapping_=function e(t,r,i){var n=t.segment;if(!r){return}if(!t.cues.length){n.empty=true;return}var a=t.timestampmap;var s=a.MPEGTS/U["ONE_SECOND_IN_TS"]-a.LOCAL+r.mapping;t.cues.forEach((function(e){e.startTime+=s;e.endTime+=s}));if(!i.syncInfo){var o=t.cues[0].startTime;var u=t.cues[t.cues.length-1].startTime;i.syncInfo={mediaSequence:i.mediaSequence+t.mediaIndex,time:Math.min(o,u-n.duration)}}};return t}(ul);var El=function e(t,r){var i=t.cues;for(var n=0;n<i.length;n++){var a=i[n];if(r>=a.adStartTime&&r<=a.adEndTime){return a}}return null};var kl=function e(t,r,i){if(i===void 0){i=0}if(!t.segments){return}var a=i;var s;for(var o=0;o<t.segments.length;o++){var u=t.segments[o];if(!s){s=El(r,a+u.duration/2)}if(s){if("cueIn"in u){s.endTime=a;s.adEndTime=a;a+=u.duration;s=null;continue}if(a<s.endTime){a+=u.duration;continue}s.endTime+=u.duration}else{if("cueOut"in u){s=new n.a.VTTCue(a,a+u.duration,u.cueOut);s.adStartTime=a;s.adEndTime=a+parseFloat(u.cueOut);r.addCue(s)}if("cueOutCont"in u){var l=u.cueOutCont.split("/").map(parseFloat),d=l[0],f=l[1];s=new n.a.VTTCue(a,a+u.duration,"");s.adStartTime=a-d;s.adEndTime=s.adStartTime+f;r.addCue(s)}}a+=u.duration}};var Al=86400;var Cl=[{name:"VOD",run:function e(t,r,i,n,a){if(i!==Infinity){var s={time:0,segmentIndex:0,partIndex:null};return s}return null}},{name:"ProgramDateTime",run:function e(t,r,i,n,a){if(!Object.keys(t.timelineToDatetimeMappings).length){return null}var s=null;var o=null;var u=as(r);a=a||0;for(var l=0;l<u.length;l++){var d=r.endList||a===0?l:u.length-(l+1);var f=u[d];var c=f.segment;var h=t.timelineToDatetimeMappings[c.timeline];if(!h||!c.dateTimeObject){continue}var p=c.dateTimeObject.getTime()/1e3;var v=p+h;if(c.parts&&typeof f.partIndex==="number"){for(var m=0;m<f.partIndex;m++){v+=c.parts[m].duration}}var g=Math.abs(a-v);if(o!==null&&(g===0||o<g)){break}o=g;s={time:v,segmentIndex:f.segmentIndex,partIndex:f.partIndex}}return s}},{name:"Segment",run:function e(t,r,i,n,a){var s=null;var o=null;a=a||0;var u=as(r);for(var l=0;l<u.length;l++){var d=r.endList||a===0?l:u.length-(l+1);var f=u[d];var c=f.segment;var h=f.part&&f.part.start||c&&c.start;if(c.timeline===n&&typeof h!=="undefined"){var p=Math.abs(a-h);if(o!==null&&o<p){break}if(!s||o===null||o>=p){o=p;s={time:h,segmentIndex:f.segmentIndex,partIndex:f.partIndex}}}}return s}},{name:"Discontinuity",run:function e(t,r,i,n,a){var s=null;a=a||0;if(r.discontinuityStarts&&r.discontinuityStarts.length){var o=null;for(var u=0;u<r.discontinuityStarts.length;u++){var l=r.discontinuityStarts[u];var d=r.discontinuitySequence+u+1;var f=t.discontinuities[d];if(f){var c=Math.abs(a-f.time);if(o!==null&&o<c){break}if(!s||o===null||o>=c){o=c;s={time:f.time,segmentIndex:l,partIndex:null}}}}}return s}},{name:"Playlist",run:function e(t,r,i,n,a){if(r.syncInfo){var s={time:r.syncInfo.time,segmentIndex:r.syncInfo.mediaSequence-r.mediaSequence,partIndex:null};return s}return null}}];var Il=function(e){p()(t,e);function t(t){var r;r=e.call(this)||this;r.timelines=[];r.discontinuities=[];r.timelineToDatetimeMappings={};r.logger_=Ga("SyncController");return r}var r=t.prototype;r.getSyncPoint=function e(t,r,i,n){var a=this.runStrategies_(t,r,i,n);if(!a.length){return null}return this.selectSyncPoint_(a,{key:"time",value:n})};r.getExpiredTime=function e(t,r){if(!t||!t.segments){return null}var i=this.runStrategies_(t,r,t.discontinuitySequence,0);if(!i.length){return null}var n=this.selectSyncPoint_(i,{key:"segmentIndex",value:0});if(n.segmentIndex>0){n.time*=-1}return Math.abs(n.time+hs({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:n.segmentIndex,endIndex:0}))};r.runStrategies_=function e(t,r,i,n){var a=[];for(var s=0;s<Cl.length;s++){var o=Cl[s];var u=o.run(this,t,r,i,n);if(u){u.strategy=o.name;a.push({strategy:o.name,syncPoint:u})}}return a};r.selectSyncPoint_=function e(t,r){var i=t[0].syncPoint;var n=Math.abs(t[0].syncPoint[r.key]-r.value);var a=t[0].strategy;for(var s=1;s<t.length;s++){var o=Math.abs(t[s].syncPoint[r.key]-r.value);if(o<n){n=o;i=t[s].syncPoint;a=t[s].strategy}}this.logger_("syncPoint for ["+r.key+": "+r.value+"] chosen with strategy"+(" ["+a+"]: [time:"+i.time+",")+(" segmentIndex:"+i.segmentIndex)+(typeof i.partIndex==="number"?",partIndex:"+i.partIndex:"")+"]");return i};r.saveExpiredSegmentInfo=function e(t,r){var i=r.mediaSequence-t.mediaSequence;if(i>Al){Ba.log.warn("Not saving expired segment info. Media sequence gap "+i+" is too large.");return}for(var n=i-1;n>=0;n--){var a=t.segments[n];if(a&&typeof a.start!=="undefined"){r.syncInfo={mediaSequence:t.mediaSequence+n,time:a.start};this.logger_("playlist refresh sync: [time:"+r.syncInfo.time+","+(" mediaSequence: "+r.syncInfo.mediaSequence+"]"));this.trigger("syncinfoupdate");break}}};r.setDateTimeMappingForStart=function e(t){this.timelineToDatetimeMappings={};if(t.segments&&t.segments.length&&t.segments[0].dateTimeObject){var r=t.segments[0];var i=r.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[r.timeline]=-i}};r.saveSegmentTimingInfo=function e(t){var r=t.segmentInfo,i=t.shouldSaveTimelineMapping;var n=this.calculateSegmentTimeMapping_(r,r.timingInfo,i);var a=r.segment;if(n){this.saveDiscontinuitySyncInfo_(r);if(!r.playlist.syncInfo){r.playlist.syncInfo={mediaSequence:r.playlist.mediaSequence+r.mediaIndex,time:a.start}}}var s=a.dateTimeObject;if(a.discontinuity&&i&&s){this.timelineToDatetimeMappings[a.timeline]=-(s.getTime()/1e3)}};r.timestampOffsetForTimeline=function e(t){if(typeof this.timelines[t]==="undefined"){return null}return this.timelines[t].time};r.mappingForTimeline=function e(t){if(typeof this.timelines[t]==="undefined"){return null}return this.timelines[t].mapping};r.calculateSegmentTimeMapping_=function e(t,r,i){var n=t.segment;var a=t.part;var s=this.timelines[t.timeline];var o;var u;if(typeof t.timestampOffset==="number"){s={time:t.startOfSegment,mapping:t.startOfSegment-r.start};if(i){this.timelines[t.timeline]=s;this.trigger("timestampoffset");this.logger_("time mapping for timeline "+t.timeline+": "+("[time: "+s.time+"] [mapping: "+s.mapping+"]"))}o=t.startOfSegment;u=r.end+s.mapping}else if(s){o=r.start+s.mapping;u=r.end+s.mapping}else{return false}if(a){a.start=o;a.end=u}if(!n.start||o<n.start){n.start=o}n.end=u;return true};r.saveDiscontinuitySyncInfo_=function e(t){var r=t.playlist;var i=t.segment;if(i.discontinuity){this.discontinuities[i.timeline]={time:i.start,accuracy:0}}else if(r.discontinuityStarts&&r.discontinuityStarts.length){for(var n=0;n<r.discontinuityStarts.length;n++){var a=r.discontinuityStarts[n];var s=r.discontinuitySequence+n+1;var o=a-t.mediaIndex;var u=Math.abs(o);if(!this.discontinuities[s]||this.discontinuities[s].accuracy>u){var l=void 0;if(o<0){l=i.start-hs({defaultDuration:r.targetDuration,durationList:r.segments,startIndex:t.mediaIndex,endIndex:a})}else{l=i.end+hs({defaultDuration:r.targetDuration,durationList:r.segments,startIndex:t.mediaIndex+1,endIndex:a})}this.discontinuities[s]={time:l,accuracy:u}}}}};r.dispose=function e(){this.trigger("dispose");this.off()};return t}(Ba.EventTarget);var Dl=function(e){p()(t,e);function t(){var t;t=e.call(this)||this;t.pendingTimelineChanges_={};t.lastTimelineChanges_={};return t}var r=t.prototype;r.clearPendingTimelineChange=function e(t){this.pendingTimelineChanges_[t]=null;this.trigger("pendingtimelinechange")};r.pendingTimelineChange=function e(t){var r=t.type,i=t.from,n=t.to;if(typeof i==="number"&&typeof n==="number"){this.pendingTimelineChanges_[r]={type:r,from:i,to:n};this.trigger("pendingtimelinechange")}return this.pendingTimelineChanges_[r]};r.lastTimelineChange=function e(t){var r=t.type,i=t.from,n=t.to;if(typeof i==="number"&&typeof n==="number"){this.lastTimelineChanges_[r]={type:r,from:i,to:n};delete this.pendingTimelineChanges_[r];this.trigger("timelinechange")}return this.lastTimelineChanges_[r]};r.dispose=function e(){this.trigger("dispose");this.pendingTimelineChanges_={};this.lastTimelineChanges_={};this.off()};return t}(Ba.EventTarget);var xl=No(Bo((function(){function e(e,r,i){return i={path:r,exports:{},require:function e(r,n){return t(r,n===undefined||n===null?i.path:n)}},e(i,i.exports),i.exports}function t(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var r=e((function(e){function t(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function r(e,r,i){if(r)t(e.prototype,r);if(i)t(e,i);return e}e.exports=r;e.exports["default"]=e.exports,e.exports.__esModule=true}));var i=e((function(e){function t(r,i){e.exports=t=Object.setPrototypeOf||function e(t,r){t.__proto__=r;return t};e.exports["default"]=e.exports,e.exports.__esModule=true;return t(r,i)}e.exports=t;e.exports["default"]=e.exports,e.exports.__esModule=true}));var n=e((function(e){function t(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;i(e,t)}e.exports=t;e.exports["default"]=e.exports,e.exports.__esModule=true}));var a=function(){function e(){this.listeners={}}var t=e.prototype;t.on=function e(t,r){if(!this.listeners[t]){this.listeners[t]=[]}this.listeners[t].push(r)};t.off=function e(t,r){if(!this.listeners[t]){return false}var i=this.listeners[t].indexOf(r);this.listeners[t]=this.listeners[t].slice(0);this.listeners[t].splice(i,1);return i>-1};t.trigger=function e(t){var r=this.listeners[t];if(!r){return}if(arguments.length===2){var i=r.length;for(var n=0;n<i;++n){r[n].call(this,arguments[1])}}else{var a=Array.prototype.slice.call(arguments,1);var s=r.length;for(var o=0;o<s;++o){r[o].apply(this,a)}}};t.dispose=function e(){this.listeners={}};t.pipe=function e(t){this.on("data",(function(e){t.push(e)}))};return e}();function s(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}var o=function e(){var t=[[[],[],[],[],[]],[[],[],[],[],[]]];var r=t[0];var i=t[1];var n=r[4];var a=i[4];var s;var o;var u;var l=[];var d=[];var f;var c;var h;var p;var v;var m;for(s=0;s<256;s++){d[(l[s]=s<<1^(s>>7)*283)^s]=s}for(o=u=0;!n[o];o^=f||1,u=d[u]||1){p=u^u<<1^u<<2^u<<3^u<<4;p=p>>8^p&255^99;n[o]=p;a[p]=o;h=l[c=l[f=l[o]]];m=h*16843009^c*65537^f*257^o*16843008;v=l[p]*257^p*16843008;for(s=0;s<4;s++){r[s][o]=v=v<<24^v>>>8;i[s][p]=m=m<<24^m>>>8}}for(s=0;s<5;s++){r[s]=r[s].slice(0);i[s]=i[s].slice(0)}return t};var u=null;var l=function(){function e(e){if(!u){u=o()}this._tables=[[u[0][0].slice(),u[0][1].slice(),u[0][2].slice(),u[0][3].slice(),u[0][4].slice()],[u[1][0].slice(),u[1][1].slice(),u[1][2].slice(),u[1][3].slice(),u[1][4].slice()]];var t;var r;var i;var n=this._tables[0][4];var a=this._tables[1];var s=e.length;var l=1;if(s!==4&&s!==6&&s!==8){throw new Error("Invalid aes key size")}var d=e.slice(0);var f=[];this._key=[d,f];for(t=s;t<4*s+28;t++){i=d[t-1];if(t%s===0||s===8&&t%s===4){i=n[i>>>24]<<24^n[i>>16&255]<<16^n[i>>8&255]<<8^n[i&255];if(t%s===0){i=i<<8^i>>>24^l<<24;l=l<<1^(l>>7)*283}}d[t]=d[t-s]^i}for(r=0;t;r++,t--){i=d[r&3?t:t-4];if(t<=4||r<4){f[r]=i}else{f[r]=a[0][n[i>>>24]]^a[1][n[i>>16&255]]^a[2][n[i>>8&255]]^a[3][n[i&255]]}}}var t=e.prototype;t.decrypt=function e(t,r,i,n,a,s){var o=this._key[1];var u=t^o[0];var l=n^o[1];var d=i^o[2];var f=r^o[3];var c;var h;var p;var v=o.length/4-2;var m;var g=4;var y=this._tables[1];var _=y[0];var b=y[1];var T=y[2];var S=y[3];var w=y[4];for(m=0;m<v;m++){c=_[u>>>24]^b[l>>16&255]^T[d>>8&255]^S[f&255]^o[g];h=_[l>>>24]^b[d>>16&255]^T[f>>8&255]^S[u&255]^o[g+1];p=_[d>>>24]^b[f>>16&255]^T[u>>8&255]^S[l&255]^o[g+2];f=_[f>>>24]^b[u>>16&255]^T[l>>8&255]^S[d&255]^o[g+3];g+=4;u=c;l=h;d=p}for(m=0;m<4;m++){a[(3&-m)+s]=w[u>>>24]<<24^w[l>>16&255]<<16^w[d>>8&255]<<8^w[f&255]^o[g++];c=u;u=l;l=d;d=f;f=c}};return e}();var d=function(e){n(t,e);function t(){var t;t=e.call(this,a)||this;t.jobs=[];t.delay=1;t.timeout_=null;return t}var r=t.prototype;r.processJob_=function e(){this.jobs.shift()();if(this.jobs.length){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}else{this.timeout_=null}};r.push=function e(t){this.jobs.push(t);if(!this.timeout_){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}};return t}(a);var f=function e(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24};var c=function e(t,r,i){var n=new Int32Array(t.buffer,t.byteOffset,t.byteLength>>2);var a=new l(Array.prototype.slice.call(r));var s=new Uint8Array(t.byteLength);var o=new Int32Array(s.buffer);var u;var d;var c;var h;var p;var v;var m;var g;var y;u=i[0];d=i[1];c=i[2];h=i[3];for(y=0;y<n.length;y+=4){p=f(n[y]);v=f(n[y+1]);m=f(n[y+2]);g=f(n[y+3]);a.decrypt(p,v,m,g,o,y);o[y]=f(o[y]^u);o[y+1]=f(o[y+1]^d);o[y+2]=f(o[y+2]^c);o[y+3]=f(o[y+3]^h);u=p;d=v;c=m;h=g}return s};var h=function(){function e(t,r,i,n){var a=e.STEP;var o=new Int32Array(t.buffer);var u=new Uint8Array(t.byteLength);var l=0;this.asyncStream_=new d;this.asyncStream_.push(this.decryptChunk_(o.subarray(l,l+a),r,i,u));for(l=a;l<o.length;l+=a){i=new Uint32Array([f(o[l-4]),f(o[l-3]),f(o[l-2]),f(o[l-1])]);this.asyncStream_.push(this.decryptChunk_(o.subarray(l,l+a),r,i,u))}this.asyncStream_.push((function(){n(null,s(u))}))}var t=e.prototype;t.decryptChunk_=function e(t,r,i,n){return function(){var e=c(t,r,i);n.set(e,t.byteOffset)}};r(e,null,[{key:"STEP",get:function e(){return 32e3}}]);return e}();var p=function e(t){var r={};Object.keys(t).forEach((function(e){var i=t[e];if(ArrayBuffer.isView(i)){r[e]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}}else{r[e]=i}}));return r};self.onmessage=function(e){var t=e.data;var r=new Uint8Array(t.encrypted.bytes,t.encrypted.byteOffset,t.encrypted.byteLength);var i=new Uint32Array(t.key.bytes,t.key.byteOffset,t.key.byteLength/4);var n=new Uint32Array(t.iv.bytes,t.iv.byteOffset,t.iv.byteLength/4);new h(r,i,n,(function(e,r){self.postMessage(p({source:t.source,decrypted:r}),[r.buffer])}))}})));var Ll=Mo(xl);var Ol=function e(t){var r=t["default"]?"main":"alternative";if(t.characteristics&&t.characteristics.indexOf("public.accessibility.describes-video")>=0){r="main-desc"}return r};var Pl=function e(t,r){t.abort();t.pause();if(r&&r.activePlaylistLoader){r.activePlaylistLoader.pause();r.activePlaylistLoader=null}};var Rl=function e(t,r){r.activePlaylistLoader=t;t.load()};var Ul=function e(t,r){return function(){var e=r.segmentLoaders,i=e[t],n=e.main,a=r.mediaTypes[t];var s=a.activeTrack();var o=a.getActiveGroup();var u=a.activePlaylistLoader;var l=a.lastGroup_;if(o&&l&&o.id===l.id){return}a.lastGroup_=o;a.lastTrack_=s;Pl(i,a);if(!o||o.isMasterPlaylist){return}if(!o.playlistLoader){if(u){n.resetEverything()}return}i.resyncLoader();Rl(o.playlistLoader,a)}};var Ml=function e(t,r){return function(){var e=r.segmentLoaders[t],i=r.mediaTypes[t];i.lastGroup_=null;e.abort();e.pause()}};var Nl=function e(t,r){return function(){var e=r.masterPlaylistLoader,i=r.segmentLoaders,n=i[t],a=i.main,s=r.mediaTypes[t];var o=s.activeTrack();var u=s.getActiveGroup();var l=s.activePlaylistLoader;var d=s.lastTrack_;if(d&&o&&d.id===o.id){return}s.lastGroup_=u;s.lastTrack_=o;Pl(n,s);if(!u){return}if(u.isMasterPlaylist){if(!o||!d||o.id===d.id){return}var f=r.vhs.masterPlaylistController_;var c=f.selectPlaylist();if(f.media()===c){return}s.logger_("track change. Switching master audio from "+d.id+" to "+o.id);e.pause();a.resetEverything();f.fastQualityChange_(c);return}if(t==="AUDIO"){if(!u.playlistLoader){a.setAudio(true);a.resetEverything();return}n.setAudio(true);a.setAudio(false)}if(l===u.playlistLoader){Rl(u.playlistLoader,s);return}if(n.track){n.track(o)}n.resetEverything();Rl(u.playlistLoader,s)}};var Bl={AUDIO:function e(t,r){return function(){var e=r.segmentLoaders[t],i=r.mediaTypes[t],n=r.blacklistCurrentPlaylist;Pl(e,i);var a=i.activeTrack();var s=i.activeGroup();var o=(s.filter((function(e){return e["default"]}))[0]||s[0]).id;var u=i.tracks[o];if(a===u){n({message:"Problem encountered loading the default audio track."});return}Ba.log.warn("Problem encountered loading the alternate audio track."+"Switching back to default.");for(var l in i.tracks){i.tracks[l].enabled=i.tracks[l]===u}i.onTrackChanged()}},SUBTITLES:function e(t,r){return function(){var e=r.segmentLoaders[t],i=r.mediaTypes[t];Ba.log.warn("Problem encountered loading the subtitle track."+"Disabling subtitle track.");Pl(e,i);var n=i.activeTrack();if(n){n.mode="disabled"}i.onTrackChanged()}}};var Fl={AUDIO:function e(t,r,i){if(!r){return}var n=i.tech,a=i.requestOptions,s=i.segmentLoaders[t];r.on("loadedmetadata",(function(){var e=r.media();s.playlist(e,a);if(!n.paused()||e.endList&&n.preload()!=="none"){s.load()}}));r.on("loadedplaylist",(function(){s.playlist(r.media(),a);if(!n.paused()){s.load()}}));r.on("error",Bl[t](t,i))},SUBTITLES:function e(t,r,i){var n=i.tech,a=i.requestOptions,s=i.segmentLoaders[t],o=i.mediaTypes[t];r.on("loadedmetadata",(function(){var e=r.media();s.playlist(e,a);s.track(o.activeTrack());if(!n.paused()||e.endList&&n.preload()!=="none"){s.load()}}));r.on("loadedplaylist",(function(){s.playlist(r.media(),a);if(!n.paused()){s.load()}}));r.on("error",Bl[t](t,i))}};var jl={AUDIO:function e(t,r){var i=r.vhs,n=r.sourceType,a=r.segmentLoaders[t],s=r.requestOptions,o=r.master.mediaGroups,u=r.mediaTypes[t],l=u.groups,d=u.tracks,f=u.logger_,c=r.masterPlaylistLoader;var h=Cs(c.master);if(!o[t]||Object.keys(o[t]).length===0){o[t]={main:{default:{default:true}}};if(h){o[t].main["default"].playlists=c.master.playlists}}for(var p in o[t]){if(!l[p]){l[p]=[]}for(var v in o[t][p]){var m=o[t][p][v];var g=void 0;if(h){f("AUDIO group '"+p+"' label '"+v+"' is a master playlist");m.isMasterPlaylist=true;g=null}else if(n==="vhs-json"&&m.playlists){g=new Xs(m.playlists[0],i,s)}else if(m.resolvedUri){g=new Xs(m.resolvedUri,i,s)}else if(m.playlists&&n==="dash"){g=new Lo(m.playlists[0],i,s,c)}else{g=null}m=Ba.mergeOptions({id:v,playlistLoader:g},m);Fl[t](t,m.playlistLoader,r);l[p].push(m);if(typeof d[v]==="undefined"){var y=new Ba.AudioTrack({id:v,kind:Ol(m),enabled:false,language:m.language,default:m["default"],label:v});d[v]=y}}}a.on("error",Bl[t](t,r))},SUBTITLES:function e(t,r){var i=r.tech,n=r.vhs,a=r.sourceType,s=r.segmentLoaders[t],o=r.requestOptions,u=r.master.mediaGroups,l=r.mediaTypes[t],d=l.groups,f=l.tracks,c=r.masterPlaylistLoader;for(var h in u[t]){if(!d[h]){d[h]=[]}for(var p in u[t][h]){if(u[t][h][p].forced){continue}var v=u[t][h][p];var m=void 0;if(a==="hls"){m=new Xs(v.resolvedUri,n,o)}else if(a==="dash"){var g=v.playlists.filter((function(e){return e.excludeUntil!==Infinity}));if(!g.length){return}m=new Lo(v.playlists[0],n,o,c)}else if(a==="vhs-json"){m=new Xs(v.playlists?v.playlists[0]:v.resolvedUri,n,o)}v=Ba.mergeOptions({id:p,playlistLoader:m},v);Fl[t](t,v.playlistLoader,r);d[h].push(v);if(typeof f[p]==="undefined"){var y=i.addRemoteTextTrack({id:p,kind:"subtitles",default:v["default"]&&v.autoselect,language:v.language,label:p},false).track;f[p]=y}}}s.on("error",Bl[t](t,r))},"CLOSED-CAPTIONS":function e(t,r){var i=r.tech,n=r.master.mediaGroups,a=r.mediaTypes[t],s=a.groups,o=a.tracks;for(var u in n[t]){if(!s[u]){s[u]=[]}for(var l in n[t][u]){var d=n[t][u][l];if(!/^(?:CC|SERVICE)/.test(d.instreamId)){continue}var f=i.options_.vhs&&i.options_.vhs.captionServices||{};var c={label:l,language:d.language,instreamId:d.instreamId,default:d["default"]&&d.autoselect};if(f[c.instreamId]){c=Ba.mergeOptions(c,f[c.instreamId])}if(c["default"]===undefined){delete c["default"]}s[u].push(Ba.mergeOptions({id:l},d));if(typeof o[l]==="undefined"){var h=i.addRemoteTextTrack({id:c.instreamId,kind:"captions",default:c["default"],language:c.language,label:c.label},false).track;o[l]=h}}}}};var ql=function e(t,r){for(var i=0;i<t.length;i++){if(ks(r,t[i])){return true}if(t[i].playlists&&e(t[i].playlists,r)){return true}}return false};var Hl=function e(t,r){return function(e){var i=r.masterPlaylistLoader,n=r.mediaTypes[t].groups;var a=i.media();if(!a){return null}var s=null;if(a.attributes[t]){s=n[a.attributes[t]]}var o=Object.keys(n);if(!s){if(t==="AUDIO"&&o.length>1&&Cs(r.master)){for(var u=0;u<o.length;u++){var l=n[o[u]];if(ql(l,a)){s=l;break}}}else if(n.main){s=n.main}else if(o.length===1){s=n[o[0]]}}if(typeof e==="undefined"){return s}if(e===null||!s){return null}return s.filter((function(t){return t.id===e.id}))[0]||null}};var Gl={AUDIO:function e(t,r){return function(){var e=r.mediaTypes[t].tracks;for(var i in e){if(e[i].enabled){return e[i]}}return null}},SUBTITLES:function e(t,r){return function(){var e=r.mediaTypes[t].tracks;for(var i in e){if(e[i].mode==="showing"||e[i].mode==="hidden"){return e[i]}}return null}}};var Vl=function e(t,r){var i=r.mediaTypes;return function(){var e=i[t].activeTrack();if(!e){return null}return i[t].activeGroup(e)}};var Wl=function e(t){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(e){jl[e](e,t)}));var r=t.mediaTypes,i=t.masterPlaylistLoader,n=t.tech,a=t.vhs,s=t.segmentLoaders,o=s["AUDIO"],u=s.main;["AUDIO","SUBTITLES"].forEach((function(e){r[e].activeGroup=Hl(e,t);r[e].activeTrack=Gl[e](e,t);r[e].onGroupChanged=Ul(e,t);r[e].onGroupChanging=Ml(e,t);r[e].onTrackChanged=Nl(e,t);r[e].getActiveGroup=Vl(e,t)}));var l=r.AUDIO.activeGroup();if(l){var d=(l.filter((function(e){return e["default"]}))[0]||l[0]).id;r.AUDIO.tracks[d].enabled=true;r.AUDIO.onGroupChanged();r.AUDIO.onTrackChanged();var f=r.AUDIO.getActiveGroup();if(!f.playlistLoader){u.setAudio(true)}else{u.setAudio(false);o.setAudio(true)}}i.on("mediachange",(function(){["AUDIO","SUBTITLES"].forEach((function(e){return r[e].onGroupChanged()}))}));i.on("mediachanging",(function(){["AUDIO","SUBTITLES"].forEach((function(e){return r[e].onGroupChanging()}))}));var c=function e(){r.AUDIO.onTrackChanged();n.trigger({type:"usage",name:"vhs-audio-change"});n.trigger({type:"usage",name:"hls-audio-change"})};n.audioTracks().addEventListener("change",c);n.remoteTextTracks().addEventListener("change",r.SUBTITLES.onTrackChanged);a.on("dispose",(function(){n.audioTracks().removeEventListener("change",c);n.remoteTextTracks().removeEventListener("change",r.SUBTITLES.onTrackChanged)}));n.clearTracks("audio");for(var h in r.AUDIO.tracks){n.audioTracks().addTrack(r.AUDIO.tracks[h])}};var zl=function e(){var t={};["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(e){t[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:ll,activeTrack:ll,getActiveGroup:ll,onGroupChanged:ll,onTrackChanged:ll,lastTrack_:null,logger_:Ga("MediaGroups["+e+"]")}}));return t};var Kl=60*2;var Xl;var Yl=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"];var Ql=function e(t){return this.audioSegmentLoader_[t]+this.mainSegmentLoader_[t]};var $l=function e(t){var r=t.currentPlaylist,i=t.buffered,n=t.currentTime,a=t.nextPlaylist,s=t.bufferLowWaterLine,o=t.bufferHighWaterLine,u=t.duration,l=t.experimentalBufferBasedABR,d=t.log;if(!a){Ba.log.warn("We received no playlist to switch to. Please check your stream.");return false}var f="allowing switch "+(r&&r.id||"null")+" -> "+a.id;if(!r){d(f+" as current playlist is not set");return true}if(a.id===r.id){return false}var c=Boolean(Ka(i,n).length);if(!r.endList){if(!c&&typeof r.partTargetDuration==="number"){d("not "+f+" as current playlist is live llhls, but currentTime isn't in buffered.");return false}d(f+" as current playlist is live");return true}var h=rs(i,n);var p=l?Oo.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Oo.MAX_BUFFER_LOW_WATER_LINE;if(u<p){d(f+" as duration < max low water line ("+u+" < "+p+")");return true}var v=a.attributes.BANDWIDTH;var m=r.attributes.BANDWIDTH;if(v<m&&(!l||h<o)){var g=f+" as next bandwidth < current bandwidth ("+v+" < "+m+")";if(l){g+=" and forwardBuffer < bufferHighWaterLine ("+h+" < "+o+")"}d(g);return true}if((!l||v>m)&&h>=s){var y=f+" as forwardBuffer >= bufferLowWaterLine ("+h+" >= "+s+")";if(l){y+=" and next bandwidth > current bandwidth ("+v+" > "+m+")"}d(y);return true}d("not "+f+" as no switching criteria met");return false};var Jl=function(e){p()(t,e);function t(t){var r;r=e.call(this)||this;var i=t.src,a=t.handleManifestRedirects,s=t.withCredentials,o=t.tech,u=t.bandwidth,l=t.externVhs,d=t.useCueTags,f=t.blacklistDuration,h=t.enableLowInitialPlaylist,p=t.sourceType,v=t.cacheEncryptionKeys,m=t.experimentalBufferBasedABR,g=t.experimentalLeastPixelDiffSelector,y=t.captionServices;if(!i){throw new Error("A non-empty playlist URL or JSON manifest string is required")}var _=t.maxPlaylistRetries;if(_===null||typeof _==="undefined"){_=Infinity}Xl=l;r.experimentalBufferBasedABR=Boolean(m);r.experimentalLeastPixelDiffSelector=Boolean(g);r.withCredentials=s;r.tech_=o;r.vhs_=o.vhs;r.sourceType_=p;r.useCueTags_=d;r.blacklistDuration=f;r.maxPlaylistRetries=_;r.enableLowInitialPlaylist=h;if(r.useCueTags_){r.cueTagsTrack_=r.tech_.addTextTrack("metadata","ad-cues");r.cueTagsTrack_.inBandMetadataTrackDispatchType=""}r.requestOptions_={withCredentials:s,handleManifestRedirects:a,maxPlaylistRetries:_,timeout:null};r.on("error",r.pauseLoading);r.mediaTypes_=zl();r.mediaSource=new n.a.MediaSource;r.handleDurationChange_=r.handleDurationChange_.bind(c()(r));r.handleSourceOpen_=r.handleSourceOpen_.bind(c()(r));r.handleSourceEnded_=r.handleSourceEnded_.bind(c()(r));r.mediaSource.addEventListener("durationchange",r.handleDurationChange_);r.mediaSource.addEventListener("sourceopen",r.handleSourceOpen_);r.mediaSource.addEventListener("sourceended",r.handleSourceEnded_);r.seekable_=Ba.createTimeRanges();r.hasPlayed_=false;r.syncController_=new Il(t);r.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},false).track;r.decrypter_=new Ll;r.sourceUpdater_=new bl(r.mediaSource);r.inbandTextTracks_={};r.timelineChangeController_=new Dl;var b={vhs:r.vhs_,parse708captions:t.parse708captions,captionServices:y,mediaSource:r.mediaSource,currentTime:r.tech_.currentTime.bind(r.tech_),seekable:function e(){return r.seekable()},seeking:function e(){return r.tech_.seeking()},duration:function e(){return r.duration()},hasPlayed:function e(){return r.hasPlayed_},goalBufferLength:function e(){return r.goalBufferLength()},bandwidth:u,syncController:r.syncController_,decrypter:r.decrypter_,sourceType:r.sourceType_,inbandTextTracks:r.inbandTextTracks_,cacheEncryptionKeys:v,sourceUpdater:r.sourceUpdater_,timelineChangeController:r.timelineChangeController_,experimentalExactManifestTimings:t.experimentalExactManifestTimings};r.masterPlaylistLoader_=r.sourceType_==="dash"?new Lo(i,r.vhs_,r.requestOptions_):new Xs(i,r.vhs_,r.requestOptions_);r.setupMasterPlaylistLoaderListeners_();r.mainSegmentLoader_=new ul(Ba.mergeOptions(b,{segmentMetadataTrack:r.segmentMetadataTrack_,loaderType:"main"}),t);r.audioSegmentLoader_=new ul(Ba.mergeOptions(b,{loaderType:"audio"}),t);r.subtitleSegmentLoader_=new wl(Ba.mergeOptions(b,{loaderType:"vtt",featuresNativeTextTracks:r.tech_.featuresNativeTextTracks}),t);r.setupSegmentLoaderListeners_();if(r.experimentalBufferBasedABR){r.masterPlaylistLoader_.one("loadedplaylist",(function(){return r.startABRTimer_()}));r.tech_.on("pause",(function(){return r.stopABRTimer_()}));r.tech_.on("play",(function(){return r.startABRTimer_()}))}Yl.forEach((function(e){r[e+"_"]=Ql.bind(c()(r),e)}));r.logger_=Ga("MPC");r.triggeredFmp4Usage=false;if(r.tech_.preload()==="none"){r.loadOnPlay_=function(){r.loadOnPlay_=null;r.masterPlaylistLoader_.load()};r.tech_.one("play",r.loadOnPlay_)}else{r.masterPlaylistLoader_.load()}r.timeToLoadedData__=-1;r.mainAppendsToLoadedData__=-1;r.audioAppendsToLoadedData__=-1;var T=r.tech_.preload()==="none"?"play":"loadstart";r.tech_.one(T,(function(){var e=Date.now();r.tech_.one("loadeddata",(function(){r.timeToLoadedData__=Date.now()-e;r.mainAppendsToLoadedData__=r.mainSegmentLoader_.mediaAppends;r.audioAppendsToLoadedData__=r.audioSegmentLoader_.mediaAppends}))}));return r}var r=t.prototype;r.mainAppendsToLoadedData_=function e(){return this.mainAppendsToLoadedData__};r.audioAppendsToLoadedData_=function e(){return this.audioAppendsToLoadedData__};r.appendsToLoadedData_=function e(){var t=this.mainAppendsToLoadedData_();var r=this.audioAppendsToLoadedData_();if(t===-1||r===-1){return-1}return t+r};r.timeToLoadedData_=function e(){return this.timeToLoadedData__};r.checkABR_=function e(){var t=this.selectPlaylist();if(t&&this.shouldSwitchToMedia_(t)){this.switchMedia_(t,"abr")}};r.switchMedia_=function e(t,r,i){var n=this.media();var a=n&&(n.id||n.uri);var s=t.id||t.uri;if(a&&a!==s){this.logger_("switch media "+a+" -> "+s+" from "+r);this.tech_.trigger({type:"usage",name:"vhs-rendition-change-"+r})}this.masterPlaylistLoader_.media(t,i)};r.startABRTimer_=function e(){var t=this;this.stopABRTimer_();this.abrTimer_=n.a.setInterval((function(){return t.checkABR_()}),250)};r.stopABRTimer_=function e(){if(this.tech_.scrubbing&&this.tech_.scrubbing()){return}n.a.clearInterval(this.abrTimer_);this.abrTimer_=null};r.getAudioTrackPlaylists_=function e(){var t=this.master();var r=t&&t.playlists||[];if(!t||!t.mediaGroups||!t.mediaGroups.AUDIO){return r}var i=t.mediaGroups.AUDIO;var n=Object.keys(i);var a;if(Object.keys(this.mediaTypes_.AUDIO.groups).length){a=this.mediaTypes_.AUDIO.activeTrack()}else{var s=i.main||n.length&&i[n[0]];for(var o in s){if(s[o]["default"]){a={label:o};break}}}if(!a){return r}var u=[];for(var l in i){if(i[l][a.label]){var d=i[l][a.label];if(d.playlists&&d.playlists.length){u.push.apply(u,d.playlists)}else if(d.uri){u.push(d)}else if(t.playlists.length){for(var f=0;f<t.playlists.length;f++){var c=t.playlists[f];if(c.attributes&&c.attributes.AUDIO&&c.attributes.AUDIO===l){u.push(c)}}}}}if(!u.length){return r}return u};r.setupMasterPlaylistLoaderListeners_=function e(){var t=this;this.masterPlaylistLoader_.on("loadedmetadata",(function(){var e=t.masterPlaylistLoader_.media();var r=e.targetDuration*1.5*1e3;if(Es(t.masterPlaylistLoader_.master,t.masterPlaylistLoader_.media())){t.requestOptions_.timeout=0}else{t.requestOptions_.timeout=r}if(e.endList&&t.tech_.preload()!=="none"){t.mainSegmentLoader_.playlist(e,t.requestOptions_);t.mainSegmentLoader_.load()}Wl({sourceType:t.sourceType_,segmentLoaders:{AUDIO:t.audioSegmentLoader_,SUBTITLES:t.subtitleSegmentLoader_,main:t.mainSegmentLoader_},tech:t.tech_,requestOptions:t.requestOptions_,masterPlaylistLoader:t.masterPlaylistLoader_,vhs:t.vhs_,master:t.master(),mediaTypes:t.mediaTypes_,blacklistCurrentPlaylist:t.blacklistCurrentPlaylist.bind(t)});t.triggerPresenceUsage_(t.master(),e);t.setupFirstPlay();if(!t.mediaTypes_.AUDIO.activePlaylistLoader||t.mediaTypes_.AUDIO.activePlaylistLoader.media()){t.trigger("selectedinitialmedia")}else{t.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",(function(){t.trigger("selectedinitialmedia")}))}}));this.masterPlaylistLoader_.on("loadedplaylist",(function(){if(t.loadOnPlay_){t.tech_.off("play",t.loadOnPlay_)}var e=t.masterPlaylistLoader_.media();if(!e){t.excludeUnsupportedVariants_();var r;if(t.enableLowInitialPlaylist){r=t.selectInitialPlaylist()}if(!r){r=t.selectPlaylist()}if(!r||!t.shouldSwitchToMedia_(r)){return}t.initialMedia_=r;t.switchMedia_(t.initialMedia_,"initial");var i=t.sourceType_==="vhs-json"&&t.initialMedia_.segments;if(!i){return}e=t.initialMedia_}t.handleUpdatedMediaPlaylist(e)}));this.masterPlaylistLoader_.on("error",(function(){t.blacklistCurrentPlaylist(t.masterPlaylistLoader_.error)}));this.masterPlaylistLoader_.on("mediachanging",(function(){t.mainSegmentLoader_.abort();t.mainSegmentLoader_.pause()}));this.masterPlaylistLoader_.on("mediachange",(function(){var e=t.masterPlaylistLoader_.media();var r=e.targetDuration*1.5*1e3;if(Es(t.masterPlaylistLoader_.master,t.masterPlaylistLoader_.media())){t.requestOptions_.timeout=0}else{t.requestOptions_.timeout=r}t.mainSegmentLoader_.playlist(e,t.requestOptions_);t.mainSegmentLoader_.load();t.tech_.trigger({type:"mediachange",bubbles:true})}));this.masterPlaylistLoader_.on("playlistunchanged",(function(){var e=t.masterPlaylistLoader_.media();if(e.lastExcludeReason_==="playlist-unchanged"){return}var r=t.stuckAtPlaylistEnd_(e);if(r){t.blacklistCurrentPlaylist({message:"Playlist no longer updating.",reason:"playlist-unchanged"});t.tech_.trigger("playliststuck")}}));this.masterPlaylistLoader_.on("renditiondisabled",(function(){t.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"});t.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}));this.masterPlaylistLoader_.on("renditionenabled",(function(){t.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"});t.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})}))};r.handleUpdatedMediaPlaylist=function e(t){if(this.useCueTags_){this.updateAdCues_(t)}this.mainSegmentLoader_.playlist(t,this.requestOptions_);this.updateDuration(!t.endList);if(!this.tech_.paused()){this.mainSegmentLoader_.load();if(this.audioSegmentLoader_){this.audioSegmentLoader_.load()}}};r.triggerPresenceUsage_=function e(t,r){var i=t.mediaGroups||{};var n=true;var a=Object.keys(i.AUDIO);for(var s in i.AUDIO){for(var o in i.AUDIO[s]){var u=i.AUDIO[s][o];if(!u.uri){n=false}}}if(n){this.tech_.trigger({type:"usage",name:"vhs-demuxed"});this.tech_.trigger({type:"usage",name:"hls-demuxed"})}if(Object.keys(i.SUBTITLES).length){this.tech_.trigger({type:"usage",name:"vhs-webvtt"});this.tech_.trigger({type:"usage",name:"hls-webvtt"})}if(Xl.Playlist.isAes(r)){this.tech_.trigger({type:"usage",name:"vhs-aes"});this.tech_.trigger({type:"usage",name:"hls-aes"})}if(a.length&&Object.keys(i.AUDIO[a[0]]).length>1){this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"});this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})}if(this.useCueTags_){this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"});this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}};r.shouldSwitchToMedia_=function e(t){var r=this.masterPlaylistLoader_.media()||this.masterPlaylistLoader_.pendingMedia_;var i=this.tech_.currentTime();var n=this.bufferLowWaterLine();var a=this.bufferHighWaterLine();var s=this.tech_.buffered();return $l({buffered:s,currentTime:i,currentPlaylist:r,nextPlaylist:t,bufferLowWaterLine:n,bufferHighWaterLine:a,duration:this.duration(),experimentalBufferBasedABR:this.experimentalBufferBasedABR,log:this.logger_})};r.setupSegmentLoaderListeners_=function e(){var t=this;if(!this.experimentalBufferBasedABR){this.mainSegmentLoader_.on("bandwidthupdate",(function(){var e=t.selectPlaylist();if(t.shouldSwitchToMedia_(e)){t.switchMedia_(e,"bandwidthupdate")}t.tech_.trigger("bandwidthupdate")}));this.mainSegmentLoader_.on("progress",(function(){t.trigger("progress")}))}this.mainSegmentLoader_.on("error",(function(){t.blacklistCurrentPlaylist(t.mainSegmentLoader_.error())}));this.mainSegmentLoader_.on("appenderror",(function(){t.error=t.mainSegmentLoader_.error_;t.trigger("error")}));this.mainSegmentLoader_.on("syncinfoupdate",(function(){t.onSyncInfoUpdate_()}));this.mainSegmentLoader_.on("timestampoffset",(function(){t.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"});t.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}));this.audioSegmentLoader_.on("syncinfoupdate",(function(){t.onSyncInfoUpdate_()}));this.audioSegmentLoader_.on("appenderror",(function(){t.error=t.audioSegmentLoader_.error_;t.trigger("error")}));this.mainSegmentLoader_.on("ended",(function(){t.logger_("main segment loader ended");t.onEndOfStream()}));this.mainSegmentLoader_.on("earlyabort",(function(e){if(t.experimentalBufferBasedABR){return}t.delegateLoaders_("all",["abort"]);t.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the "+"request without rebuffering."},Kl)}));var r=function e(){if(!t.sourceUpdater_.hasCreatedSourceBuffers()){return t.tryToCreateSourceBuffers_()}var r=t.getCodecsOrExclude_();if(!r){return}t.sourceUpdater_.addOrChangeSourceBuffers(r)};this.mainSegmentLoader_.on("trackinfo",r);this.audioSegmentLoader_.on("trackinfo",r);this.mainSegmentLoader_.on("fmp4",(function(){if(!t.triggeredFmp4Usage){t.tech_.trigger({type:"usage",name:"vhs-fmp4"});t.tech_.trigger({type:"usage",name:"hls-fmp4"});t.triggeredFmp4Usage=true}}));this.audioSegmentLoader_.on("fmp4",(function(){if(!t.triggeredFmp4Usage){t.tech_.trigger({type:"usage",name:"vhs-fmp4"});t.tech_.trigger({type:"usage",name:"hls-fmp4"});t.triggeredFmp4Usage=true}}));this.audioSegmentLoader_.on("ended",(function(){t.logger_("audioSegmentLoader ended");t.onEndOfStream()}))};r.mediaSecondsLoaded_=function e(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)};r.load=function e(){this.mainSegmentLoader_.load();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.load()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.load()}};r.smoothQualityChange_=function e(t){if(t===void 0){t=this.selectPlaylist()}this.fastQualityChange_(t)};r.fastQualityChange_=function e(t){var r=this;if(t===void 0){t=this.selectPlaylist()}if(t===this.masterPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(t,"fast-quality");this.mainSegmentLoader_.resetEverything((function(){if(Ba.browser.IE_VERSION||Ba.browser.IS_EDGE){r.tech_.setCurrentTime(r.tech_.currentTime()+.04)}else{r.tech_.setCurrentTime(r.tech_.currentTime())}}))};r.play=function e(){if(this.setupFirstPlay()){return}if(this.tech_.ended()){this.tech_.setCurrentTime(0)}if(this.hasPlayed_){this.load()}var t=this.tech_.seekable();if(this.tech_.duration()===Infinity){if(this.tech_.currentTime()<t.start(0)){return this.tech_.setCurrentTime(t.end(t.length-1))}}};r.setupFirstPlay=function e(){var t=this;var r=this.masterPlaylistLoader_.media();if(!r||this.tech_.paused()||this.hasPlayed_){return false}if(!r.endList){var i=this.seekable();if(!i.length){return false}if(Ba.browser.IE_VERSION&&this.tech_.readyState()===0){this.tech_.one("loadedmetadata",(function(){t.trigger("firstplay");t.tech_.setCurrentTime(i.end(0));t.hasPlayed_=true}));return false}this.trigger("firstplay");this.tech_.setCurrentTime(i.end(0))}this.hasPlayed_=true;this.load();return true};r.handleSourceOpen_=function e(){this.tryToCreateSourceBuffers_();if(this.tech_.autoplay()){var t=this.tech_.play();if(typeof t!=="undefined"&&typeof t.then==="function"){t.then(null,(function(e){}))}}this.trigger("sourceopen")};r.handleSourceEnded_=function e(){if(!this.inbandTextTracks_.metadataTrack_){return}var t=this.inbandTextTracks_.metadataTrack_.cues;if(!t||!t.length){return}var r=this.duration();t[t.length-1].endTime=isNaN(r)||Math.abs(r)===Infinity?Number.MAX_VALUE:r};r.handleDurationChange_=function e(){this.tech_.trigger("durationchange")};r.onEndOfStream=function e(){var t=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){var r=this.mainSegmentLoader_.getCurrentMediaInfo_();if(!r||r.hasVideo){t=t&&this.audioSegmentLoader_.ended_}else{t=this.audioSegmentLoader_.ended_}}if(!t){return}this.stopABRTimer_();this.sourceUpdater_.endOfStream()};r.stuckAtPlaylistEnd_=function e(t){var r=this.seekable();if(!r.length){return false}var i=this.syncController_.getExpiredTime(t,this.duration());if(i===null){return false}var n=Xl.Playlist.playlistEnd(t,i);var a=this.tech_.currentTime();var s=this.tech_.buffered();if(!s.length){return n-a<=Wa}var o=s.end(s.length-1);return o-a<=Wa&&n-o<=Wa};r.blacklistCurrentPlaylist=function e(t,r){if(t===void 0){t={}}var i=t.playlist||this.masterPlaylistLoader_.media();r=r||t.blacklistDuration||this.blacklistDuration;if(!i){this.error=t;if(this.mediaSource.readyState!=="open"){this.trigger("error")}else{this.sourceUpdater_.endOfStream("network")}return}i.playlistErrors_++;var n=this.masterPlaylistLoader_.master.playlists;var a=n.filter(_s);var s=a.length===1&&a[0]===i;if(n.length===1&&r!==Infinity){Ba.log.warn("Problem encountered with playlist "+i.id+". "+"Trying again since it is the only playlist.");this.tech_.trigger("retryplaylist");return this.masterPlaylistLoader_.load(s)}if(s){var o=false;n.forEach((function(e){if(e===i){return}var t=e.excludeUntil;if(typeof t!=="undefined"&&t!==Infinity){o=true;delete e.excludeUntil}}));if(o){Ba.log.warn("Removing other playlists from the exclusion list because the last "+"rendition is about to be excluded.");this.tech_.trigger("retryplaylist")}}var u;if(i.playlistErrors_>this.maxPlaylistRetries){u=Infinity}else{u=Date.now()+r*1e3}i.excludeUntil=u;if(t.reason){i.lastExcludeReason_=t.reason}this.tech_.trigger("blacklistplaylist");this.tech_.trigger({type:"usage",name:"vhs-rendition-blacklisted"});this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});var l=this.selectPlaylist();if(!l){this.error="Playback cannot continue. No available working or supported playlists.";this.trigger("error");return}var d=t.internal?this.logger_:Ba.log.warn;var f=t.message?" "+t.message:"";d((t.internal?"Internal problem":"Problem")+" encountered with playlist "+i.id+"."+(f+" Switching to playlist "+l.id+"."));if(l.attributes.AUDIO!==i.attributes.AUDIO){this.delegateLoaders_("audio",["abort","pause"])}if(l.attributes.SUBTITLES!==i.attributes.SUBTITLES){this.delegateLoaders_("subtitle",["abort","pause"])}this.delegateLoaders_("main",["abort","pause"]);var c=l.targetDuration/2*1e3||5*1e3;var h=typeof l.lastRequest==="number"&&Date.now()-l.lastRequest<=c;return this.switchMedia_(l,"exclude",s||h)};r.pauseLoading=function e(){this.delegateLoaders_("all",["abort","pause"]);this.stopABRTimer_()};r.delegateLoaders_=function e(t,r){var i=this;var n=[];var a=t==="all";if(a||t==="main"){n.push(this.masterPlaylistLoader_)}var s=[];if(a||t==="audio"){s.push("AUDIO")}if(a||t==="subtitle"){s.push("CLOSED-CAPTIONS");s.push("SUBTITLES")}s.forEach((function(e){var t=i.mediaTypes_[e]&&i.mediaTypes_[e].activePlaylistLoader;if(t){n.push(t)}}));["main","audio","subtitle"].forEach((function(e){var r=i[e+"SegmentLoader_"];if(r&&(t===e||t==="all")){n.push(r)}}));n.forEach((function(e){return r.forEach((function(t){if(typeof e[t]==="function"){e[t]()}}))}))};r.setCurrentTime=function e(t){var r=Ka(this.tech_.buffered(),t);if(!(this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media())){return 0}if(!this.masterPlaylistLoader_.media().segments){return 0}if(r&&r.length){return t}this.mainSegmentLoader_.resetEverything();this.mainSegmentLoader_.abort();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.resetEverything();this.audioSegmentLoader_.abort()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.resetEverything();this.subtitleSegmentLoader_.abort()}this.load()};r.duration=function e(){if(!this.masterPlaylistLoader_){return 0}var t=this.masterPlaylistLoader_.media();if(!t){return 0}if(!t.endList){return Infinity}if(this.mediaSource){return this.mediaSource.duration}return Xl.Playlist.duration(t)};r.seekable=function e(){return this.seekable_};r.onSyncInfoUpdate_=function e(){var t;if(!this.masterPlaylistLoader_){return}var r=this.masterPlaylistLoader_.media();if(!r){return}var i=this.syncController_.getExpiredTime(r,this.duration());if(i===null){return}var n=this.masterPlaylistLoader_.master;var a=Xl.Playlist.seekable(r,i,Xl.Playlist.liveEdgeDelay(n,r));if(a.length===0){return}if(this.mediaTypes_.AUDIO.activePlaylistLoader){r=this.mediaTypes_.AUDIO.activePlaylistLoader.media();i=this.syncController_.getExpiredTime(r,this.duration());if(i===null){return}t=Xl.Playlist.seekable(r,i,Xl.Playlist.liveEdgeDelay(n,r));if(t.length===0){return}}var s;var o;if(this.seekable_&&this.seekable_.length){s=this.seekable_.end(0);o=this.seekable_.start(0)}if(!t){this.seekable_=a}else if(t.start(0)>a.end(0)||a.start(0)>t.end(0)){this.seekable_=a}else{this.seekable_=Ba.createTimeRanges([[t.start(0)>a.start(0)?t.start(0):a.start(0),t.end(0)<a.end(0)?t.end(0):a.end(0)]])}if(this.seekable_&&this.seekable_.length){if(this.seekable_.end(0)===s&&this.seekable_.start(0)===o){return}}this.logger_("seekable updated ["+$a(this.seekable_)+"]");this.tech_.trigger("seekablechanged")};r.updateDuration=function e(t){if(this.updateDuration_){this.mediaSource.removeEventListener("sourceopen",this.updateDuration_);this.updateDuration_=null}if(this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,t);this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(t){var r=this.seekable();if(!r.length){return}if(isNaN(this.mediaSource.duration)||this.mediaSource.duration<r.end(r.length-1)){this.sourceUpdater_.setDuration(r.end(r.length-1))}return}var i=this.tech_.buffered();var n=Xl.Playlist.duration(this.masterPlaylistLoader_.media());if(i.length>0){n=Math.max(n,i.end(i.length-1))}if(this.mediaSource.duration!==n){this.sourceUpdater_.setDuration(n)}};r.dispose=function e(){var t=this;this.trigger("dispose");this.decrypter_.terminate();this.masterPlaylistLoader_.dispose();this.mainSegmentLoader_.dispose();if(this.loadOnPlay_){this.tech_.off("play",this.loadOnPlay_)}["AUDIO","SUBTITLES"].forEach((function(e){var r=t.mediaTypes_[e].groups;for(var i in r){r[i].forEach((function(e){if(e.playlistLoader){e.playlistLoader.dispose()}}))}}));this.audioSegmentLoader_.dispose();this.subtitleSegmentLoader_.dispose();this.sourceUpdater_.dispose();this.timelineChangeController_.dispose();this.stopABRTimer_();if(this.updateDuration_){this.mediaSource.removeEventListener("sourceopen",this.updateDuration_)}this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_);this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_);this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_);this.off()};r.master=function e(){return this.masterPlaylistLoader_.master};r.media=function e(){return this.masterPlaylistLoader_.media()||this.initialMedia_};r.areMediaTypesKnown_=function e(){var t=!!this.mediaTypes_.AUDIO.activePlaylistLoader;var r=!!this.mainSegmentLoader_.getCurrentMediaInfo_();var i=!t?true:!!this.audioSegmentLoader_.getCurrentMediaInfo_();if(!r||!i){return false}return true};r.getCodecsOrExclude_=function e(){var t=this;var r={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}};r.video=r.main;var i=wu(this.master(),this.media());var n={};var a=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(r.main.hasVideo){n.video=i.video||r.main.videoCodec||C["b"]}if(r.main.isMuxed){n.video+=","+(i.audio||r.main.audioCodec||C["a"])}if(r.main.hasAudio&&!r.main.isMuxed||r.audio.hasAudio||a){n.audio=i.audio||r.main.audioCodec||r.audio.audioCodec||C["a"];r.audio.isFmp4=r.main.hasAudio&&!r.main.isMuxed?r.main.isFmp4:r.audio.isFmp4}if(!n.audio&&!n.video){this.blacklistCurrentPlaylist({playlist:this.media(),message:"Could not determine codecs for playlist.",blacklistDuration:Infinity});return}var s=function e(t,r){return t?Object(C["c"])(r):Object(C["g"])(r)};var o={};var u;["video","audio"].forEach((function(e){if(n.hasOwnProperty(e)&&!s(r[e].isFmp4,n[e])){var t=r[e].isFmp4?"browser":"muxer";o[t]=o[t]||[];o[t].push(n[e]);if(e==="audio"){u=t}}}));if(a&&u&&this.media().attributes.AUDIO){var l=this.media().attributes.AUDIO;this.master().playlists.forEach((function(e){var r=e.attributes&&e.attributes.AUDIO;if(r===l&&e!==t.media()){e.excludeUntil=Infinity}}));this.logger_("excluding audio group "+l+" as "+u+' does not support codec(s): "'+n.audio+'"')}if(Object.keys(o).length){var d=Object.keys(o).reduce((function(e,t){if(e){e+=", "}e+=t+' does not support codec(s): "'+o[t].join(",")+'"';return e}),"")+".";this.blacklistCurrentPlaylist({playlist:this.media(),internal:true,message:d,blacklistDuration:Infinity});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){var f=[];["video","audio"].forEach((function(e){var r=(Object(C["h"])(t.sourceUpdater_.codecs[e]||"")[0]||{}).type;var i=(Object(C["h"])(n[e]||"")[0]||{}).type;if(r&&i&&r.toLowerCase()!==i.toLowerCase()){f.push('"'+t.sourceUpdater_.codecs[e]+'" -> "'+n[e]+'"')}}));if(f.length){this.blacklistCurrentPlaylist({playlist:this.media(),message:"Codec switching not supported: "+f.join(", ")+".",blacklistDuration:Infinity,internal:true});return}}return n};r.tryToCreateSourceBuffers_=function e(){if(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()){return}if(!this.areMediaTypesKnown_()){return}var t=this.getCodecsOrExclude_();if(!t){return}this.sourceUpdater_.createSourceBuffers(t);var r=[t.video,t.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(r)};r.excludeUnsupportedVariants_=function e(){var t=this;var r=this.master().playlists;var i=[];Object.keys(r).forEach((function(e){var n=r[e];if(i.indexOf(n.id)!==-1){return}i.push(n.id);var a=wu(t.master,n);var s=[];if(a.audio&&!Object(C["g"])(a.audio)&&!Object(C["c"])(a.audio)){s.push("audio codec "+a.audio)}if(a.video&&!Object(C["g"])(a.video)&&!Object(C["c"])(a.video)){s.push("video codec "+a.video)}if(a.text&&a.text==="stpp.ttml.im1t"){s.push("text codec "+a.text)}if(s.length){n.excludeUntil=Infinity;t.logger_("excluding "+n.id+" for unsupported: "+s.join(", "))}}))};r.excludeIncompatibleVariants_=function e(t){var r=this;var i=[];var n=this.master().playlists;var a=Tu(Object(C["h"])(t));var s=Su(a);var o=a.video&&Object(C["h"])(a.video)[0]||null;var u=a.audio&&Object(C["h"])(a.audio)[0]||null;Object.keys(n).forEach((function(e){var t=n[e];if(i.indexOf(t.id)!==-1||t.excludeUntil===Infinity){return}i.push(t.id);var a=[];var l=wu(r.masterPlaylistLoader_.master,t);var d=Su(l);if(!l.audio&&!l.video){return}if(d!==s){a.push('codec count "'+d+'" !== "'+s+'"')}if(!r.sourceUpdater_.canChangeType()){var f=l.video&&Object(C["h"])(l.video)[0]||null;var c=l.audio&&Object(C["h"])(l.audio)[0]||null;if(f&&o&&f.type.toLowerCase()!==o.type.toLowerCase()){a.push('video codec "'+f.type+'" !== "'+o.type+'"')}if(c&&u&&c.type.toLowerCase()!==u.type.toLowerCase()){a.push('audio codec "'+c.type+'" !== "'+u.type+'"')}}if(a.length){t.excludeUntil=Infinity;r.logger_("blacklisting "+t.id+": "+a.join(" && "))}}))};r.updateAdCues_=function e(t){var r=0;var i=this.seekable();if(i.length){r=i.start(0)}kl(t,this.cueTagsTrack_,r)};r.goalBufferLength=function e(){var t=this.tech_.currentTime();var r=Oo.GOAL_BUFFER_LENGTH;var i=Oo.GOAL_BUFFER_LENGTH_RATE;var n=Math.max(r,Oo.MAX_GOAL_BUFFER_LENGTH);return Math.min(r+t*i,n)};r.bufferLowWaterLine=function e(){var t=this.tech_.currentTime();var r=Oo.BUFFER_LOW_WATER_LINE;var i=Oo.BUFFER_LOW_WATER_LINE_RATE;var n=Math.max(r,Oo.MAX_BUFFER_LOW_WATER_LINE);var a=Math.max(r,Oo.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(r+t*i,this.experimentalBufferBasedABR?a:n)};r.bufferHighWaterLine=function e(){return Oo.BUFFER_HIGH_WATER_LINE};return t}(Ba.EventTarget);var Zl=function e(t,r,i){return function(e){var n=t.master.playlists[r];var a=ys(n);var s=_s(n);if(typeof e==="undefined"){return s}if(e){delete n.disabled}else{n.disabled=true}if(e!==s&&!a){i();if(e){t.trigger("renditionenabled")}else{t.trigger("renditiondisabled")}}return e}};var ed=function e(t,r,i){var n=t.masterPlaylistController_,a=t.options_.smoothQualityChange;var s=a?"smooth":"fast";var o=n[s+"QualityChange_"].bind(n);if(r.attributes){var u=r.attributes.RESOLUTION;this.width=u&&u.width;this.height=u&&u.height;this.bandwidth=r.attributes.BANDWIDTH}this.codecs=wu(n.master(),r);this.playlist=r;this.id=i;this.enabled=Zl(t.playlists,r.id,o)};var td=function e(t){t.representations=function(){var e=t.masterPlaylistController_.master();var r=Cs(e)?t.masterPlaylistController_.getAudioTrackPlaylists_():e.playlists;if(!r){return[]}return r.filter((function(e){return!ys(e)})).map((function(e,r){return new ed(t,e,e.id)}))}};var rd=["seeking","seeked","pause","playing","error"];var id=function(){function e(e){var t=this;this.masterPlaylistController_=e.masterPlaylistController;this.tech_=e.tech;this.seekable=e.seekable;this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow;this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta;this.media=e.media;this.consecutiveUpdates=0;this.lastRecordedTime=null;this.timer_=null;this.checkCurrentTimeTimeout_=null;this.logger_=Ga("PlaybackWatcher");this.logger_("initialize");var r=function e(){return t.monitorCurrentTime_()};var i=function e(){return t.monitorCurrentTime_()};var a=function e(){return t.techWaiting_()};var s=function e(){return t.cancelTimer_()};var o=this.masterPlaylistController_;var u=["main","subtitle","audio"];var l={};u.forEach((function(e){l[e]={reset:function r(){return t.resetSegmentDownloads_(e)},updateend:function r(){return t.checkSegmentDownloads_(e)}};o[e+"SegmentLoader_"].on("appendsdone",l[e].updateend);o[e+"SegmentLoader_"].on("playlistupdate",l[e].reset);t.tech_.on(["seeked","seeking"],l[e].reset)}));var d=function e(r){["main","audio"].forEach((function(e){o[e+"SegmentLoader_"][r]("appended",t.seekingAppendCheck_)}))};this.seekingAppendCheck_=function(){if(t.fixesBadSeeks_()){t.consecutiveUpdates=0;t.lastRecordedTime=t.tech_.currentTime();d("off")}};this.clearSeekingAppendCheck_=function(){return d("off")};this.watchForBadSeeking_=function(){t.clearSeekingAppendCheck_();d("on")};this.tech_.on("seeked",this.clearSeekingAppendCheck_);this.tech_.on("seeking",this.watchForBadSeeking_);this.tech_.on("waiting",a);this.tech_.on(rd,s);this.tech_.on("canplay",i);this.tech_.one("play",r);this.dispose=function(){t.clearSeekingAppendCheck_();t.logger_("dispose");t.tech_.off("waiting",a);t.tech_.off(rd,s);t.tech_.off("canplay",i);t.tech_.off("play",r);t.tech_.off("seeking",t.watchForBadSeeking_);t.tech_.off("seeked",t.clearSeekingAppendCheck_);u.forEach((function(e){o[e+"SegmentLoader_"].off("appendsdone",l[e].updateend);o[e+"SegmentLoader_"].off("playlistupdate",l[e].reset);t.tech_.off(["seeked","seeking"],l[e].reset)}));if(t.checkCurrentTimeTimeout_){n.a.clearTimeout(t.checkCurrentTimeTimeout_)}t.cancelTimer_()}}var t=e.prototype;t.monitorCurrentTime_=function e(){this.checkCurrentTime_();if(this.checkCurrentTimeTimeout_){n.a.clearTimeout(this.checkCurrentTimeTimeout_)}this.checkCurrentTimeTimeout_=n.a.setTimeout(this.monitorCurrentTime_.bind(this),250)};t.resetSegmentDownloads_=function e(t){var r=this.masterPlaylistController_[t+"SegmentLoader_"];if(this[t+"StalledDownloads_"]>0){this.logger_("resetting possible stalled download count for "+t+" loader")}this[t+"StalledDownloads_"]=0;this[t+"Buffered_"]=r.buffered_()};t.checkSegmentDownloads_=function e(t){var r=this.masterPlaylistController_;var i=r[t+"SegmentLoader_"];var n=i.buffered_();var a=es(this[t+"Buffered_"],n);this[t+"Buffered_"]=n;if(a){this.resetSegmentDownloads_(t);return}this[t+"StalledDownloads_"]++;this.logger_("found #"+this[t+"StalledDownloads_"]+" "+t+" appends that did not increase buffer (possible stalled download)",{playlistId:i.playlist_&&i.playlist_.id,buffered:Za(n)});if(this[t+"StalledDownloads_"]<10){return}this.logger_(t+" loader stalled download exclusion");this.resetSegmentDownloads_(t);this.tech_.trigger({type:"usage",name:"vhs-"+t+"-download-exclusion"});if(t==="subtitle"){return}r.blacklistCurrentPlaylist({message:"Excessive "+t+" segment downloading detected."},Infinity)};t.checkCurrentTime_=function e(){if(this.tech_.paused()||this.tech_.seeking()){return}var t=this.tech_.currentTime();var r=this.tech_.buffered();if(this.lastRecordedTime===t&&(!r.length||t+Wa>=r.end(r.length-1))){return this.techWaiting_()}if(this.consecutiveUpdates>=5&&t===this.lastRecordedTime){this.consecutiveUpdates++;this.waiting_()}else if(t===this.lastRecordedTime){this.consecutiveUpdates++}else{this.consecutiveUpdates=0;this.lastRecordedTime=t}};t.cancelTimer_=function e(){this.consecutiveUpdates=0;if(this.timer_){this.logger_("cancelTimer_");clearTimeout(this.timer_)}this.timer_=null};t.fixesBadSeeks_=function e(){var t=this.tech_.seeking();if(!t){return false}var r=this.seekable();var i=this.tech_.currentTime();var n=this.afterSeekableWindow_(r,i,this.media(),this.allowSeeksWithinUnsafeLiveWindow);var a;if(n){var s=r.end(r.length-1);a=s}if(this.beforeSeekableWindow_(r,i)){var o=r.start(0);a=o+(o===r.end(0)?0:Wa)}if(typeof a!=="undefined"){this.logger_("Trying to seek outside of seekable at time "+i+" with "+("seekable range "+$a(r)+". Seeking to ")+(a+"."));this.tech_.setCurrentTime(a);return true}var u=this.masterPlaylistController_.sourceUpdater_;var l=this.tech_.buffered();var d=u.audioBuffer?u.audioBuffered():null;var f=u.videoBuffer?u.videoBuffered():null;var c=this.media();var h=c.partTargetDuration?c.partTargetDuration:(c.targetDuration-Va)*2;var p=[d,f];for(var v=0;v<p.length;v++){if(!p[v]){continue}var m=rs(p[v],i);if(m<h){return false}}var g=Xa(l,i);if(g.length===0){return false}a=g.start(0)+Wa;this.logger_("Buffered region starts ("+g.start(0)+") "+(" just beyond seek point ("+i+"). Seeking to "+a+"."));this.tech_.setCurrentTime(a);return true};t.waiting_=function e(){if(this.techWaiting_()){return}var t=this.tech_.currentTime();var r=this.tech_.buffered();var i=Ka(r,t);if(i.length&&t+3<=i.end(0)){this.cancelTimer_();this.tech_.setCurrentTime(t);this.logger_("Stopped at "+t+" while inside a buffered region "+("["+i.start(0)+" -> "+i.end(0)+"]. Attempting to resume ")+"playback by seeking to the current time.");this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"});return}};t.techWaiting_=function e(){var t=this.seekable();var r=this.tech_.currentTime();if(this.tech_.seeking()||this.timer_!==null){return true}if(this.beforeSeekableWindow_(t,r)){var i=t.end(t.length-1);this.logger_("Fell out of live window at time "+r+". Seeking to "+("live point (seekable end) "+i));this.cancelTimer_();this.tech_.setCurrentTime(i);this.tech_.trigger({type:"usage",name:"vhs-live-resync"});this.tech_.trigger({type:"usage",name:"hls-live-resync"});return true}var n=this.tech_.vhs.masterPlaylistController_.sourceUpdater_;var a=this.tech_.buffered();var s=this.videoUnderflow_({audioBuffered:n.audioBuffered(),videoBuffered:n.videoBuffered(),currentTime:r});if(s){this.cancelTimer_();this.tech_.setCurrentTime(r);this.tech_.trigger({type:"usage",name:"vhs-video-underflow"});this.tech_.trigger({type:"usage",name:"hls-video-underflow"});return true}var o=Xa(a,r);if(o.length>0){var u=o.start(0)-r;this.logger_("Stopped at "+r+", setting timer for "+u+", seeking "+("to "+o.start(0)));this.cancelTimer_();this.timer_=setTimeout(this.skipTheGap_.bind(this),u*1e3,r);return true}return false};t.afterSeekableWindow_=function e(t,r,i,n){if(n===void 0){n=false}if(!t.length){return false}var a=t.end(t.length-1)+Wa;var s=!i.endList;if(s&&n){a=t.end(t.length-1)+i.targetDuration*3}if(r>a){return true}return false};t.beforeSeekableWindow_=function e(t,r){if(t.length&&t.start(0)>0&&r<t.start(0)-this.liveRangeSafeTimeDelta){return true}return false};t.videoUnderflow_=function e(t){var r=t.videoBuffered,i=t.audioBuffered,n=t.currentTime;if(!r){return}var a;if(r.length&&i.length){var s=Ka(r,n-3);var o=Ka(r,n);var u=Ka(i,n);if(u.length&&!o.length&&s.length){a={start:s.end(0),end:u.end(0)}}}else{var l=Xa(r,n);if(!l.length){a=this.gapFromVideoUnderflow_(r,n)}}if(a){this.logger_("Encountered a gap in video from "+a.start+" to "+a.end+". "+("Seeking to current time "+n));return true}return false};t.skipTheGap_=function e(t){var r=this.tech_.buffered();var i=this.tech_.currentTime();var n=Xa(r,i);this.cancelTimer_();if(n.length===0||i!==t){return}this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",t,"nextRange start:",n.start(0));this.tech_.setCurrentTime(n.start(0)+Va);this.tech_.trigger({type:"usage",name:"vhs-gap-skip"});this.tech_.trigger({type:"usage",name:"hls-gap-skip"})};t.gapFromVideoUnderflow_=function e(t,r){var i=Ya(t);for(var n=0;n<i.length;n++){var a=i.start(n);var s=i.end(n);if(r-a<4&&r-a>2){return{start:a,end:s}}}return null};return e}();var nd={errorInterval:30,getSource:function e(t){var r=this.tech({IWillNotUseThisInPlugins:true});var i=r.currentSource_||this.currentSource();return t(i)}};var ad=function e(t,r){var i=0;var n=0;var a=Ba.mergeOptions(nd,r);t.ready((function(){t.trigger({type:"usage",name:"vhs-error-reload-initialized"});t.trigger({type:"usage",name:"hls-error-reload-initialized"})}));var s=function e(){if(n){t.currentTime(n)}};var o=function e(r){if(r===null||r===undefined){return}n=t.duration()!==Infinity&&t.currentTime()||0;t.one("loadedmetadata",s);t.src(r);t.trigger({type:"usage",name:"vhs-error-reload"});t.trigger({type:"usage",name:"hls-error-reload"});t.play()};var u=function e(){if(Date.now()-i<a.errorInterval*1e3){t.trigger({type:"usage",name:"vhs-error-reload-canceled"});t.trigger({type:"usage",name:"hls-error-reload-canceled"});return}if(!a.getSource||typeof a.getSource!=="function"){Ba.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}i=Date.now();return a.getSource.call(t,o)};var l=function e(){t.off("loadedmetadata",s);t.off("error",u);t.off("dispose",e)};var d=function r(i){l();e(t,i)};t.on("error",u);t.on("dispose",l);t.reloadSourceOnError=d};var sd=function e(t){ad(this,t)};var od="2.13.1";var ud="6.0.1";var ld="0.21.0";var dd="4.7.0";var fd="3.1.2";var cd={PlaylistLoader:Xs,Playlist:Is,utils:fo,STANDARD_PLAYLIST_SELECTOR:Lu,INITIAL_PLAYLIST_SELECTOR:Ru,lastBandwidthSelector:Lu,movingAverageBandwidthSelector:Ou,comparePlaylistBandwidth:Iu,comparePlaylistResolution:Du,xhr:Js()};Object.keys(Oo).forEach((function(e){Object.defineProperty(cd,e,{get:function t(){Ba.log.warn("using Vhs."+e+" is UNSAFE be sure you know what you are doing");return Oo[e]},set:function t(r){Ba.log.warn("using Vhs."+e+" is UNSAFE be sure you know what you are doing");if(typeof r!=="number"||r<0){Ba.log.warn("value of Vhs."+e+" must be greater than or equal to 0");return}Oo[e]=r}})}));var hd="videojs-vhs";var pd=function e(t,r){var i=r.media();var n=-1;for(var a=0;a<t.length;a++){if(t[a].id===i.id){n=a;break}}t.selectedIndex_=n;t.trigger({selectedIndex:n,type:"change"})};var vd=function e(t,r){r.representations().forEach((function(e){t.addQualityLevel(e)}));pd(t,r.playlists)};cd.canPlaySource=function(){return Ba.log.warn("HLS is no longer a tech. Please remove it from "+"your player's techOrder.")};var md=function e(t,r,i){if(!t){return t}var n={};if(r&&r.attributes&&r.attributes.CODECS){n=Tu(Object(C["h"])(r.attributes.CODECS))}if(i&&i.attributes&&i.attributes.CODECS){n.audio=i.attributes.CODECS}var a=Object(C["e"])(n.video);var s=Object(C["e"])(n.audio);var o={};for(var u in t){o[u]={};if(s){o[u].audioContentType=s}if(a){o[u].videoContentType=a}if(r.contentProtection&&r.contentProtection[u]&&r.contentProtection[u].pssh){o[u].pssh=r.contentProtection[u].pssh}if(typeof t[u]==="string"){o[u].url=t[u]}}return Ba.mergeOptions(t,o)};var gd=function e(t,r){return t.reduce((function(e,t){if(!t.contentProtection){return e}var i=r.reduce((function(e,r){var i=t.contentProtection[r];if(i&&i.pssh){e[r]={pssh:i.pssh}}return e}),{});if(Object.keys(i).length){e.push(i)}return e}),[])};var yd=function e(t){var r=t.player,i=t.sourceKeySystems,n=t.audioMedia,a=t.mainPlaylists;if(!r.eme.initializeMediaKeys){return Promise.resolve()}var s=n?a.concat([n]):a;var o=gd(s,Object.keys(i));var u=[];var l=[];o.forEach((function(e){l.push(new Promise((function(e,t){r.tech_.one("keysessioncreated",e)})));u.push(new Promise((function(t,i){r.eme.initializeMediaKeys({keySystems:e},(function(e){if(e){i(e);return}t()}))})))}));return Promise.race([Promise.all(u),Promise.race(l)])};var _d=function e(t){var r=t.player,i=t.sourceKeySystems,n=t.media,a=t.audioMedia;var s=md(i,n,a);if(!s){return false}r.currentSource().keySystems=s;if(s&&!r.eme){Ba.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin");return false}return true};var bd=function e(){if(!n.a.localStorage){return null}var t=n.a.localStorage.getItem(hd);if(!t){return null}try{return JSON.parse(t)}catch(e){return null}};var Td=function e(t){if(!n.a.localStorage){return false}var r=bd();r=r?Ba.mergeOptions(r,t):t;try{n.a.localStorage.setItem(hd,JSON.stringify(r))}catch(e){return false}return r};var Sd=function e(t){if(t.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0){return JSON.parse(t.substring(t.indexOf(",")+1))}return t};cd.supportsNativeHls=function(){if(!s.a||!s.a.createElement){return false}var e=s.a.createElement("video");if(!Ba.getTech("Html5").isSupported()){return false}var t=["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"];return t.some((function(t){return/maybe|probably/i.test(e.canPlayType(t))}))}();cd.supportsNativeDash=function(){if(!s.a||!s.a.createElement||!Ba.getTech("Html5").isSupported()){return false}return/maybe|probably/i.test(s.a.createElement("video").canPlayType("application/dash+xml"))}();cd.supportsTypeNatively=function(e){if(e==="hls"){return cd.supportsNativeHls}if(e==="dash"){return cd.supportsNativeDash}return false};cd.isSupported=function(){return Ba.log.warn("HLS is no longer a tech. Please remove it from "+"your player's techOrder.")};var wd=Ba.getComponent("Component");var Ed=function(e){p()(t,e);function t(t,r,i){var n;n=e.call(this,r,Ba.mergeOptions(i.hls,i.vhs))||this;if(i.hls&&Object.keys(i.hls).length){Ba.log.warn("Using hls options is deprecated. Use vhs instead.")}if(typeof i.initialBandwidth==="number"){n.options_.bandwidth=i.initialBandwidth}n.logger_=Ga("VhsHandler");if(r.options_&&r.options_.playerId){var a=Ba(r.options_.playerId);if(!a.hasOwnProperty("hls")){Object.defineProperty(a,"hls",{get:function e(){Ba.log.warn("player.hls is deprecated. Use player.tech().vhs instead.");r.trigger({type:"usage",name:"hls-player-access"});return c()(n)},configurable:true})}if(!a.hasOwnProperty("vhs")){Object.defineProperty(a,"vhs",{get:function e(){Ba.log.warn("player.vhs is deprecated. Use player.tech().vhs instead.");r.trigger({type:"usage",name:"vhs-player-access"});return c()(n)},configurable:true})}if(!a.hasOwnProperty("dash")){Object.defineProperty(a,"dash",{get:function e(){Ba.log.warn("player.dash is deprecated. Use player.tech().vhs instead.");return c()(n)},configurable:true})}n.player_=a}n.tech_=r;n.source_=t;n.stats={};n.ignoreNextSeekingEvent_=false;n.setOptions_();if(n.options_.overrideNative&&r.overrideNativeAudioTracks&&r.overrideNativeVideoTracks){r.overrideNativeAudioTracks(true);r.overrideNativeVideoTracks(true)}else if(n.options_.overrideNative&&(r.featuresNativeVideoTracks||r.featuresNativeAudioTracks)){throw new Error("Overriding native HLS requires emulated tracks. "+"See https://git.io/vMpjB")}n.on(s.a,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],(function(e){var t=s.a.fullscreenElement||s.a.webkitFullscreenElement||s.a.mozFullScreenElement||s.a.msFullscreenElement;if(t&&t.contains(n.tech_.el())){n.masterPlaylistController_.fastQualityChange_()}else{n.masterPlaylistController_.checkABR_()}}));n.on(n.tech_,"seeking",(function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=false;return}this.setCurrentTime(this.tech_.currentTime())}));n.on(n.tech_,"error",(function(){if(this.tech_.error()&&this.masterPlaylistController_){this.masterPlaylistController_.pauseLoading()}}));n.on(n.tech_,"play",n.play);return n}var r=t.prototype;r.setOptions_=function e(){var t=this;this.options_.withCredentials=this.options_.withCredentials||false;this.options_.handleManifestRedirects=this.options_.handleManifestRedirects===false?false:true;this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions===false?false:true;this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||false;this.options_.smoothQualityChange=this.options_.smoothQualityChange||false;this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage!=="undefined"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||false;this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||false;this.options_.customTagParsers=this.options_.customTagParsers||[];this.options_.customTagMappers=this.options_.customTagMappers||[];this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||false;if(typeof this.options_.blacklistDuration!=="number"){this.options_.blacklistDuration=5*60}if(typeof this.options_.bandwidth!=="number"){if(this.options_.useBandwidthFromLocalStorage){var r=bd();if(r&&r.bandwidth){this.options_.bandwidth=r.bandwidth;this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"});this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})}if(r&&r.throughput){this.options_.throughput=r.throughput;this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"});this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"})}}}if(typeof this.options_.bandwidth!=="number"){this.options_.bandwidth=Oo.INITIAL_BANDWIDTH}this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Oo.INITIAL_BANDWIDTH;["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","experimentalBufferBasedABR","liveRangeSafeTimeDelta","experimentalLLHLS","useNetworkInformationApi","experimentalExactManifestTimings","experimentalLeastPixelDiffSelector"].forEach((function(e){if(typeof t.source_[e]!=="undefined"){t.options_[e]=t.source_[e]}}));this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions;this.useDevicePixelRatio=this.options_.useDevicePixelRatio};r.src=function e(t,r){var i=this;if(!t){return}this.setOptions_();this.options_.src=Sd(this.source_.src);this.options_.tech=this.tech_;this.options_.externVhs=cd;this.options_.sourceType=Object(I["a"])(r);this.options_.seekTo=function(e){i.tech_.setCurrentTime(e)};if(this.options_.smoothQualityChange){Ba.log.warn("smoothQualityChange is deprecated and will be removed in the next major version")}this.masterPlaylistController_=new Jl(this.options_);var a=Ba.mergeOptions({liveRangeSafeTimeDelta:Wa},this.options_,{seekable:function e(){return i.seekable()},media:function e(){return i.masterPlaylistController_.media()},masterPlaylistController:this.masterPlaylistController_});this.playbackWatcher_=new id(a);this.masterPlaylistController_.on("error",(function(){var e=Ba.players[i.tech_.options_.playerId];var t=i.masterPlaylistController_.error;if(typeof t==="object"&&!t.code){t.code=3}else if(typeof t==="string"){t={message:t,code:3}}e.error(t)}));var s=this.options_.experimentalBufferBasedABR?cd.movingAverageBandwidthSelector(.55):cd.STANDARD_PLAYLIST_SELECTOR;this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):s.bind(this);this.masterPlaylistController_.selectInitialPlaylist=cd.INITIAL_PLAYLIST_SELECTOR.bind(this);this.playlists=this.masterPlaylistController_.masterPlaylistLoader_;this.mediaSource=this.masterPlaylistController_.mediaSource;Object.defineProperties(this,{selectPlaylist:{get:function e(){return this.masterPlaylistController_.selectPlaylist},set:function e(t){this.masterPlaylistController_.selectPlaylist=t.bind(this)}},throughput:{get:function e(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function e(t){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=t;this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function e(){var t=this.masterPlaylistController_.mainSegmentLoader_.bandwidth;var r=n.a.navigator.connection||n.a.navigator.mozConnection||n.a.navigator.webkitConnection;var i=1e7;if(this.options_.useNetworkInformationApi&&r){var a=r.downlink*1e3*1e3;if(a>=i&&t>=i){t=Math.max(t,a)}else{t=a}}return t},set:function e(t){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=t;this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function e(){var t=1/(this.bandwidth||1);var r;if(this.throughput>0){r=1/this.throughput}else{r=0}var i=Math.floor(1/(t+r));return i},set:function e(){Ba.log.error('The "systemBandwidth" property is read-only')}}});if(this.options_.bandwidth){this.bandwidth=this.options_.bandwidth}if(this.options_.throughput){this.throughput=this.options_.throughput}Object.defineProperties(this.stats,{bandwidth:{get:function e(){return i.bandwidth||0},enumerable:true},mediaRequests:{get:function e(){return i.masterPlaylistController_.mediaRequests_()||0},enumerable:true},mediaRequestsAborted:{get:function e(){return i.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:true},mediaRequestsTimedout:{get:function e(){return i.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:true},mediaRequestsErrored:{get:function e(){return i.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:true},mediaTransferDuration:{get:function e(){return i.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:true},mediaBytesTransferred:{get:function e(){return i.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:true},mediaSecondsLoaded:{get:function e(){return i.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:true},mediaAppends:{get:function e(){return i.masterPlaylistController_.mediaAppends_()||0},enumerable:true},mainAppendsToLoadedData:{get:function e(){return i.masterPlaylistController_.mainAppendsToLoadedData_()||0},enumerable:true},audioAppendsToLoadedData:{get:function e(){return i.masterPlaylistController_.audioAppendsToLoadedData_()||0},enumerable:true},appendsToLoadedData:{get:function e(){return i.masterPlaylistController_.appendsToLoadedData_()||0},enumerable:true},timeToLoadedData:{get:function e(){return i.masterPlaylistController_.timeToLoadedData_()||0},enumerable:true},buffered:{get:function e(){return Za(i.tech_.buffered())},enumerable:true},currentTime:{get:function e(){return i.tech_.currentTime()},enumerable:true},currentSource:{get:function e(){return i.tech_.currentSource_},enumerable:true},currentTech:{get:function e(){return i.tech_.name_},enumerable:true},duration:{get:function e(){return i.tech_.duration()},enumerable:true},master:{get:function e(){return i.playlists.master},enumerable:true},playerDimensions:{get:function e(){return i.tech_.currentDimensions()},enumerable:true},seekable:{get:function e(){return Za(i.tech_.seekable())},enumerable:true},timestamp:{get:function e(){return Date.now()},enumerable:true},videoPlaybackQuality:{get:function e(){return i.tech_.getVideoPlaybackQuality()},enumerable:true}});this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_));this.tech_.on("bandwidthupdate",(function(){if(i.options_.useBandwidthFromLocalStorage){Td({bandwidth:i.bandwidth,throughput:Math.round(i.throughput)})}}));this.masterPlaylistController_.on("selectedinitialmedia",(function(){td(i)}));this.masterPlaylistController_.sourceUpdater_.on("createdsourcebuffers",(function(){i.setupEme_()}));this.on(this.masterPlaylistController_,"progress",(function(){this.tech_.trigger("progress")}));this.on(this.masterPlaylistController_,"firstplay",(function(){this.ignoreNextSeekingEvent_=true}));this.setupQualityLevels_();if(!this.tech_.el()){return}this.mediaSourceUrl_=n.a.URL.createObjectURL(this.masterPlaylistController_.mediaSource);this.tech_.src(this.mediaSourceUrl_)};r.createKeySessions_=function e(){var t=this;var r=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation");yd({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:r&&r.media(),mainPlaylists:this.playlists.master.playlists}).then((function(){t.logger_("created EME key session");t.masterPlaylistController_.sourceUpdater_.initializedEme()}))["catch"]((function(e){t.logger_("error while creating EME key session",e);t.player_.error({message:"Failed to initialize media keys for EME",code:3})}))};r.handleWaitingForKey_=function e(){this.logger_("waitingforkey fired, attempting to create any new key sessions");this.createKeySessions_()};r.setupEme_=function e(){var t=this;var r=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader;var i=_d({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:r&&r.media()});this.player_.tech_.on("keystatuschange",(function(e){if(e.status==="output-restricted"){t.masterPlaylistController_.blacklistCurrentPlaylist({playlist:t.masterPlaylistController_.media(),message:"DRM keystatus changed to "+e.status+". Playlist will fail to play. Check for HDCP content.",blacklistDuration:Infinity})}}));this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this);this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_);if(Ba.browser.IE_VERSION===11||!i){this.masterPlaylistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()};r.setupQualityLevels_=function e(){var t=this;var r=Ba.players[this.tech_.options_.playerId];if(!r||!r.qualityLevels||this.qualityLevels_){return}this.qualityLevels_=r.qualityLevels();this.masterPlaylistController_.on("selectedinitialmedia",(function(){vd(t.qualityLevels_,t)}));this.playlists.on("mediachange",(function(){pd(t.qualityLevels_,t.playlists)}))};t.version=function e(){return{"@videojs/http-streaming":od,"mux.js":ud,"mpd-parser":ld,"m3u8-parser":dd,"aes-decrypter":fd}};r.version=function e(){return this.constructor.version()};r.canChangeType=function e(){return bl.canChangeType()};r.play=function e(){this.masterPlaylistController_.play()};r.setCurrentTime=function e(t){this.masterPlaylistController_.setCurrentTime(t)};r.duration=function e(){return this.masterPlaylistController_.duration()};r.seekable=function e(){return this.masterPlaylistController_.seekable()};r.dispose=function t(){if(this.playbackWatcher_){this.playbackWatcher_.dispose()}if(this.masterPlaylistController_){this.masterPlaylistController_.dispose()}if(this.qualityLevels_){this.qualityLevels_.dispose()}if(this.player_){delete this.player_.vhs;delete this.player_.dash;delete this.player_.hls}if(this.tech_&&this.tech_.vhs){delete this.tech_.vhs}if(this.tech_){delete this.tech_.hls}if(this.mediaSourceUrl_&&n.a.URL.revokeObjectURL){n.a.URL.revokeObjectURL(this.mediaSourceUrl_);this.mediaSourceUrl_=null}if(this.tech_){this.tech_.off("waitingforkey",this.handleWaitingForKey_)}e.prototype.dispose.call(this)};r.convertToProgramTime=function e(t,r){return _o({playlist:this.masterPlaylistController_.media(),time:t,callback:r})};r.seekToProgramTime=function e(t,r,i,n){if(i===void 0){i=true}if(n===void 0){n=2}return bo({programTime:t,playlist:this.masterPlaylistController_.media(),retryCount:n,pauseAfterSeek:i,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:r})};return t}(wd);var kd={name:"videojs-http-streaming",VERSION:od,canHandleSource:function e(t,r){if(r===void 0){r={}}var i=Ba.mergeOptions(Ba.options,r);return kd.canPlayType(t.type,i)},handleSource:function e(t,r,i){if(i===void 0){i={}}var n=Ba.mergeOptions(Ba.options,i);r.vhs=new Ed(t,r,n);if(!Ba.hasOwnProperty("hls")){Object.defineProperty(r,"hls",{get:function e(){Ba.log.warn("player.tech().hls is deprecated. Use player.tech().vhs instead.");return r.vhs},configurable:true})}r.vhs.xhr=Js();r.vhs.src(t.src,t.type);return r.vhs},canPlayType:function e(t,r){if(r===void 0){r={}}var i=Ba.mergeOptions(Ba.options,r),n=i.vhs;n=n===void 0?{}:n;var a=n.overrideNative,s=a===void 0?!Ba.browser.IS_ANY_SAFARI:a,o=i.hls;o=o===void 0?{}:o;var u=o.overrideNative,l=u===void 0?false:u;var d=Object(I["a"])(t);var f=d&&(!cd.supportsTypeNatively(d)||l||s);return f?"maybe":""}};var Ad=function e(){return Object(C["c"])("avc1.4d400d,mp4a.40.2")};if(Ad()){Ba.getTech("Html5").registerSourceHandler(kd,0)}Ba.VhsHandler=Ed;Object.defineProperty(Ba,"HlsHandler",{get:function e(){Ba.log.warn("videojs.HlsHandler is deprecated. Use videojs.VhsHandler instead.");return Ed},configurable:true});Ba.VhsSourceHandler=kd;Object.defineProperty(Ba,"HlsSourceHandler",{get:function e(){Ba.log.warn("videojs.HlsSourceHandler is deprecated. "+"Use videojs.VhsSourceHandler instead.");return kd},configurable:true});Ba.Vhs=cd;Object.defineProperty(Ba,"Hls",{get:function e(){Ba.log.warn("videojs.Hls is deprecated. Use videojs.Vhs instead.");return cd},configurable:true});if(!Ba.use){Ba.registerComponent("Hls",cd);Ba.registerComponent("Vhs",cd)}Ba.options.vhs=Ba.options.vhs||{};Ba.options.hls=Ba.options.hls||{};if(!Ba.getPlugin||!Ba.getPlugin("reloadSourceOnError")){var Cd=Ba.registerPlugin||Ba.plugin;Cd("reloadSourceOnError",sd)}t["default"]=Ba}).call(this,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/video.js/node_modules/mux.js/lib/tools/parse-sidx.js":function(e,t,r){var i=r("./node_modules/video.js/node_modules/mux.js/lib/utils/numbers.js").getUint64;var n=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:t.getUint32(4),timescale:t.getUint32(8)},n=12;if(r.version===0){r.earliestPresentationTime=t.getUint32(n);r.firstOffset=t.getUint32(n+4);n+=8}else{r.earliestPresentationTime=i(e.subarray(n));r.firstOffset=i(e.subarray(n+8));n+=16}n+=2;var a=t.getUint16(n);n+=2;for(;a>0;n+=12,a--){r.references.push({referenceType:(e[n]&128)>>>7,referencedSize:t.getUint32(n)&2147483647,subsegmentDuration:t.getUint32(n+4),startsWithSap:!!(e[n+8]&128),sapType:(e[n+8]&112)>>>4,sapDeltaTime:t.getUint32(n+8)&268435455})}return r};e.exports=n},"./node_modules/video.js/node_modules/mux.js/lib/utils/clock.js":function(e,t){var r=9e4,i,n,a,s,o,u,l;i=function(e){return e*r};n=function(e,t){return e*t};a=function(e){return e/r};s=function(e,t){return e/t};o=function(e,t){return i(s(e,t))};u=function(e,t){return n(a(e),t)};l=function(e,t,r){return a(r?e:e-t)};e.exports={ONE_SECOND_IN_TS:r,secondsToVideoTs:i,secondsToAudioTs:n,videoTsToSeconds:a,audioTsToSeconds:s,audioTsToVideoTs:o,videoTsToAudioTs:u,metadataTsToSeconds:l}},"./node_modules/video.js/node_modules/mux.js/lib/utils/numbers.js":function(e,t){var r=Math.pow(2,32);var i=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);var i;if(t.getBigUint64){i=t.getBigUint64(0);if(i<Number.MAX_SAFE_INTEGER){return Number(i)}return i}return t.getUint32(0)*r+t.getUint32(4)};e.exports={getUint64:i,MAX_UINT32:r}},"./node_modules/videojs-contrib-eme/dist/videojs-contrib-eme.es.js":function(e,t,r){"use strict";var i=r("./node_modules/global/document.js");var n=r.n(i);var a=r("./node_modules/video.js/dist/video.es.js");var s=r("./node_modules/global/window.js");var o=r.n(s);function u(){u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r){if(Object.prototype.hasOwnProperty.call(r,i)){e[i]=r[i]}}}return e};return u.apply(this,arguments)}var l=function e(t){var r=new ArrayBuffer(t.length*2);var i=new Uint16Array(r);for(var n=0;n<t.length;n++){i[n]=t.charCodeAt(n)}return i};var d=function e(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};var f=function e(t){var r=n.a.createElement("a");r.href=t;return r.hostname};var c=function e(t,r){if(t===r){return true}if(t.byteLength!==r.byteLength){return false}var i=new DataView(t);var n=new DataView(r);for(var a=0;a<i.byteLength;a++){if(i.getUint8(a)!==n.getUint8(a)){return false}}return true};var h=function e(t){if(t instanceof Uint8Array||t instanceof Uint16Array){return t.buffer}return t};var p=function e(){var t=a["default"].mergeOptions.apply(a["default"],arguments);Object.keys(t).forEach((function(e){if(t[e]===null){delete t[e]}}));return t};var v=function e(t){var r=(new o.a.DOMParser).parseFromString(String.fromCharCode.apply(null,new Uint16Array(t)),"application/xml");var i=r.getElementsByTagName("HttpHeaders")[0];var n={};if(i){var a=i.getElementsByTagName("name");var s=i.getElementsByTagName("value");for(var u=0;u<a.length;u++){n[a[u].childNodes[0].nodeValue]=s[u].childNodes[0].nodeValue}}var l=r.getElementsByTagName("Challenge")[0];var d;if(l){d=o.a.atob(l.childNodes[0].nodeValue)}return{headers:n,message:d}};var m=function e(t,r,i,n){var s=v(r);var o=s.message;var u=p(s.headers,i.emeHeaders,t.licenseHeaders);a["default"].xhr({uri:t.url,method:"post",headers:u,body:o,responseType:"arraybuffer"},(function(e,t,r){if(e){n(e);return}if(t.statusCode>=400&&t.statusCode<=599){n({});return}n(null,r)}))};var g=function e(t){if(t.supportedConfigurations){return t.supportedConfigurations}var r={};var i=t.audioContentType;var n=t.audioRobustness;var a=t.videoContentType;var s=t.videoRobustness;var o=t.persistentState;if(i||n){r.audioCapabilities=[u({},i?{contentType:i}:{},n?{robustness:n}:{})]}if(a||s){r.videoCapabilities=[u({},a?{contentType:a}:{},s?{robustness:s}:{})]}if(o){r.persistentState=o}return[r]};var y=function e(t){var r;Object.keys(t).forEach((function(e){var i=g(t[e]);if(!r){r=o.a.navigator.requestMediaKeySystemAccess(e,i)}else{r=r.catch((function(t){return o.a.navigator.requestMediaKeySystemAccess(e,i)}))}}));return r};var _=function e(t){var r=t.mediaKeys,i=t.initDataType,n=t.initData,s=t.options,o=t.getLicense,u=t.removeSession,l=t.eventBus;var d=r.createSession();l.trigger("keysessioncreated");return new Promise((function(r,f){d.addEventListener("message",(function(e){if(e.messageType!=="license-request"&&e.messageType!=="license-renewal"){return}o(s,e.message).then((function(e){r(d.update(e))})).catch((function(e){f(e)}))}),false);d.addEventListener("keystatuseschange",(function(r){var i=false;d.keyStatuses.forEach((function(e,t){l.trigger({keyId:t,status:e,target:d,type:"keystatuschange"});switch(e){case"expired":i=true;break;case"internal-error":a["default"].log.warn('Key status reported as "internal-error." Leaving the session open since we '+"don't have enough details to know if this error is fatal.",r);break}}));if(i){d.close().then((function(){u(n);e(t)}))}}),false);d.generateRequest(i,n).catch((function(){f("Unable to create or initialize key session")}))}))};var b=function e(t){var r=t.video,i=t.initDataType,n=t.initData,a=t.options,s=t.getLicense,o=t.removeSession,u=t.eventBus;if(r.mediaKeysObject){return _({mediaKeys:r.mediaKeysObject,initDataType:i,initData:n,options:a,getLicense:s,removeSession:o,eventBus:u})}r.pendingSessionData.push({initDataType:i,initData:n,options:a,getLicense:s,removeSession:o,eventBus:u});return Promise.resolve()};var T=function e(t){var r=t.video,i=t.certificate,n=t.createdMediaKeys;r.mediaKeysObject=n;var a=[];if(i){a.push(n.setServerCertificate(i))}for(var s=0;s<r.pendingSessionData.length;s++){var o=r.pendingSessionData[s];a.push(_({mediaKeys:r.mediaKeysObject,initDataType:o.initDataType,initData:o.initData,options:o.options,getLicense:o.getLicense,removeSession:o.removeSession,eventBus:o.eventBus}))}r.pendingSessionData=[];a.push(r.setMediaKeys(n));return Promise.all(a)};var S=function e(t){return function(e,r,i){m(t,r,e,i)}};var w=function e(t){return function(e,r,i){var n=p({"Content-type":"application/octet-stream"},e.emeHeaders,t.licenseHeaders);a["default"].xhr({uri:t.url,method:"POST",responseType:"arraybuffer",body:r,headers:n},(function(e,t,r){if(e){i(e);return}if(t.statusCode>=400&&t.statusCode<=599){i({});return}i(null,r)}))}};var E=function e(t,r){return function(e,i){return new Promise((function(n,a){t(e,i,(function(e,t){if(r){r.trigger("licenserequestattempted")}if(e){a(e);return}n(t)}))}))}};var k=function e(t,r){if(typeof r==="string"){r={url:r}}if(!r.url&&!r.getLicense){throw new Error("Neither URL nor getLicense function provided to get license")}if(r.url&&!r.getLicense){r.getLicense=t==="com.microsoft.playready"?S(r):w(r)}return r};var A=function e(t){var r=t.video,i=t.initDataType,n=t.initData,a=t.keySystemAccess,s=t.options,o=t.removeSession,u=t.eventBus;var l=Promise.resolve();if(typeof r.mediaKeysObject==="undefined"){r.mediaKeysObject=null;r.pendingSessionData=[];var d;var f;l=new Promise((function(e,t){r.keySystem=a.keySystem;f=k(a.keySystem,s.keySystems[a.keySystem]);if(!f.getCertificate){e(a);return}f.getCertificate(s,(function(r,i){if(r){t(r);return}d=i;e()}))})).then((function(){return a.createMediaKeys()})).then((function(e){return T({video:r,certificate:d,createdMediaKeys:e})})).catch((function(e){if(e){return Promise.reject(e)}return Promise.reject("Failed to create and initialize a MediaKeys object")}))}return l.then((function(){return b({video:r,initDataType:i,initData:n,options:s,getLicense:r.keySystem?E(k(r.keySystem,s.keySystems[r.keySystem]).getLicense,u):null,removeSession:o,eventBus:u})}))};var C="com.apple.fps.1_0";var I=function e(t){var r=t.initData,i=t.id,n=t.cert;if(typeof i==="string"){i=l(i)}var a=0;var s=new ArrayBuffer(r.byteLength+4+i.byteLength+4+n.byteLength);var o=new DataView(s);var u=new Uint8Array(s,a,r.byteLength);u.set(r);a+=r.byteLength;o.setUint32(a,i.byteLength,true);a+=4;var d=new Uint16Array(s,a,i.length);d.set(i);a+=d.byteLength;o.setUint32(a,n.byteLength,true);a+=4;var f=new Uint8Array(s,a,n.byteLength);f.set(n);return new Uint8Array(s,0,s.byteLength)};var D=function e(t){var r=t.video,i=t.contentId,n=t.initData,a=t.cert,s=t.options,u=t.getLicense,l=t.eventBus;return new Promise((function(e,t){if(!r.webkitKeys){try{r.webkitSetMediaKeys(new o.a.WebKitMediaKeys(C))}catch(e){t("Could not create MediaKeys");return}}var d;try{d=r.webkitKeys.createSession("video/mp4",I({id:i,initData:n,cert:a}))}catch(e){t("Could not create key session");return}l.trigger("keysessioncreated");d.contentId=i;d.addEventListener("webkitkeymessage",(function(e){u(s,i,e.message,(function(e,r){if(l){l.trigger("licenserequestattempted")}if(e){t(e);return}d.update(new Uint8Array(r))}))}));d.addEventListener("webkitkeyadded",(function(){e()}));d.addEventListener("webkitkeyerror",(function(){var e=d.error;t("KeySession error: code "+e.code+", systemCode "+e.systemCode)}))}))};var x=function e(t){return function(e,r){var i=p(e.emeHeaders,t.certificateHeaders);a["default"].xhr({uri:t.certificateUri,responseType:"arraybuffer",headers:i},(function(e,t,i){if(e){r(e);return}r(null,new Uint8Array(i))}))}};var L=function e(t,r){return f(d(r))};var O=function e(t){return function(e,r,i,n){var s=p({"Content-type":"application/octet-stream"},e.emeHeaders,t.licenseHeaders);a["default"].xhr({uri:t.licenseUri,method:"POST",responseType:"arraybuffer",body:i,headers:s},(function(e,t,r){if(e){n(e);return}if(t.statusCode>=400&&t.statusCode<=599){n({});return}n(null,r)}))}};var P=function e(t){var r=t.video,i=t.initData,n=t.options,a=t.eventBus;var s=n.keySystems[C];var o=s.getCertificate||x(s);var u=s.getContentId||L;var l=s.getLicense||O(s);return new Promise((function(e,t){o(n,(function(r,i){if(r){t(r);return}e(i)}))})).then((function(e){return D({video:r,cert:e,initData:i,getLicense:l,options:n,contentId:u(n,i),eventBus:a})}))};var R="com.microsoft.playready";var U=function e(t,r,i,n){var a=t.keySystems[R];if(typeof a.getKey==="function"){a.getKey(t,i.destinationURL,i.message.buffer,(function(e,t){if(e){n.trigger({message:"Unable to get key: "+e,target:r,type:"mskeyerror"});return}r.update(t)}));return}if(typeof a==="string"){a={url:a}}else if(typeof a==="boolean"){a={}}if(!a.url){a.url=i.destinationURL}var s=function e(t,i){if(n){n.trigger("licenserequestattempted")}if(t){n.trigger({message:"Unable to request key from url: "+a.url,target:r,type:"mskeyerror"});return}r.update(new Uint8Array(i))};if(a.getLicense){a.getLicense(t,i.message.buffer,s)}else{m(a,i.message.buffer,t,s)}};var M=function e(t,r,i,n){var a=t.msKeys.createSession("video/mp4",r);if(!a){throw new Error("Could not create key session.")}n.trigger("keysessioncreated");a.addEventListener("mskeymessage",(function(e){U(i,a,e,n)}));a.addEventListener("mskeyerror",(function(e){n.trigger({message:"Unexpected key error from key session with "+("code: "+a.error.code+" and systemCode: "+a.error.systemCode),target:a,type:"mskeyerror"})}));a.addEventListener("mskeyadded",(function(){n.trigger({target:a,type:"mskeyadded"})}))};var N=function(e){var t=e.video,r=e.initData,i=e.options,n=e.eventBus;if(t.msKeys){delete t.msKeys}try{t.msSetMediaKeys(new o.a.MSMediaKeys(R))}catch(e){throw new Error("Unable to create media keys for PlayReady key system. "+"Error: "+e.message)}M(t,r,i,n)};var B=function e(t,r){for(var i=0;i<t.length;i++){if(!t[i].initData){continue}var n=h(t[i].initData);var a=h(r);if(c(n,a)){return true}}return false};var F=function e(t,r){for(var i=0;i<t.length;i++){if(t[i].initData===r){t.splice(i,1);return}}};var j=function e(t,r,i,n){if(!r||!r.keySystems){return Promise.resolve()}var a=t.initData;return y(r.keySystems).then((function(e){var s=e.keySystem;if(r.keySystems[s]&&r.keySystems[s].pssh){a=r.keySystems[s].pssh}if(B(i,a)||!a){return Promise.resolve()}i.push({initData:a});return A({video:t.target,initDataType:t.initDataType,initData:a,keySystemAccess:e,options:r,removeSession:F.bind(null,i),eventBus:n})}))};var q=function e(t,r,i){if(!r.keySystems||!r.keySystems[C]||!t.initData){return Promise.resolve()}return P({video:t.target,initData:t.initData,options:r,eventBus:i})};var H=function e(t,r,i,n){if(!r.keySystems||!r.keySystems[R]){return}if(i.reduce((function(e,t){return e||t.playready}),false)){return}var a=t.initData;if(r.keySystems[R]&&r.keySystems[R].pssh){a=r.keySystems[R].pssh}if(!a){return}i.push({playready:true,initData:a});N({video:t.target,initData:a,options:r,eventBus:n})};var G=function e(t){return a["default"].mergeOptions(t.currentSource(),t.eme.options)};var V=function e(t){var r=t.src();if(r!==t.eme.activeSrc){t.eme.activeSrc=r;t.eme.sessions=[]}};var W=function e(t){return function(e){var r=typeof e==="string"?e:e&&e.message||null;t.error({code:5,message:r})}};var z=function e(t,r){if(t.$(".vjs-tech").tagName.toLowerCase()!=="video"){return}V(t);if(o.a.WebKitMediaKeys){t.tech_.el_.addEventListener("webkitneedkey",(function(e){V(t);q(e,G(t),t.tech_).catch(r)}))}else if(o.a.MediaKeys){t.tech_.el_.addEventListener("encrypted",(function(e){V(t);j(e,G(t),t.eme.sessions,t.tech_).catch(r)}))}else if(o.a.MSMediaKeys){t.tech_.el_.addEventListener("msneedkey",(function(e){V(t);try{H(e,G(t),t.eme.sessions,t.tech_)}catch(e){r(e)}}));t.tech_.on("mskeyerror",r);t.on("dispose",(function(){t.tech_.off("mskeyerror",r)}))}};var K=function e(t){if(t===void 0){t={}}var r=this;var i=W(r);r.ready((function(){return z(r,i)}));r.eme={initializeMediaKeys:function e(n,s,o){if(n===void 0){n={}}if(s===void 0){s=function e(){}}if(o===void 0){o=false}var u=a["default"].mergeOptions(r.currentSource(),t,n);var l={initDataType:"cenc",initData:null,target:r.tech_.el_};V(r);if(r.tech_.el_.setMediaKeys){j(l,u,r.eme.sessions,r.tech_).then((function(){return s()})).catch((function(e){s(e);if(!o){i(e)}}))}else if(r.tech_.el_.msSetMediaKeys){var d=function e(t){r.tech_.off("mskeyadded",e);r.tech_.off("mskeyerror",e);if(t.type==="mskeyerror"){s(t.target.error);if(!o){i(t.message)}}else{s()}};r.tech_.one("mskeyadded",d);r.tech_.one("mskeyerror",d);try{H(l,u,r.eme.sessions,r.tech_)}catch(e){r.tech_.off("mskeyadded",d);r.tech_.off("mskeyerror",d);s(e);if(!o){i(e)}}}},options:t}};var X=a["default"].registerPlugin||a["default"].plugin;X("eme",K);var Y=K},"./node_modules/videojs-contrib-quality-levels/dist/videojs-contrib-quality-levels.es.js":function(e,t,r){"use strict";var i=r("./node_modules/video.js/dist/video.es.js");var n=r("./node_modules/global/document.js");var a=r.n(n);function s(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}function o(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}var u=function e(t){var r=this;if(i["default"].browser.IS_IE8){r=a.a.createElement("custom");for(var n in e.prototype){if(n!=="constructor"){r[n]=e.prototype[n]}}}r.id=t.id;r.label=r.id;r.width=t.width;r.height=t.height;r.bitrate=t.bandwidth;r.enabled_=t.enabled;Object.defineProperty(r,"enabled",{get:function e(){return r.enabled_()},set:function e(t){r.enabled_(t)}});return r};var l=function(e){s(t,e);function t(){var r;r=e.call(this)||this;var n=o(o(r));if(i["default"].browser.IS_IE8){n=a.a.createElement("custom");for(var s in t.prototype){if(s!=="constructor"){n[s]=t.prototype[s]}}}n.levels_=[];n.selectedIndex_=-1;Object.defineProperty(n,"selectedIndex",{get:function e(){return n.selectedIndex_}});Object.defineProperty(n,"length",{get:function e(){return n.levels_.length}});return n||o(r)}var r=t.prototype;r.addQualityLevel=function e(t){var r=this.getQualityLevelById(t.id);if(r){return r}var i=this.levels_.length;r=new u(t);if(!(""+i in this)){Object.defineProperty(this,i,{get:function e(){return this.levels_[i]}})}this.levels_.push(r);this.trigger({qualityLevel:r,type:"addqualitylevel"});return r};r.removeQualityLevel=function e(t){var r=null;for(var i=0,n=this.length;i<n;i++){if(this[i]===t){r=this.levels_.splice(i,1)[0];if(this.selectedIndex_===i){this.selectedIndex_=-1}else if(this.selectedIndex_>i){this.selectedIndex_--}break}}if(r){this.trigger({qualityLevel:t,type:"removequalitylevel"})}return r};r.getQualityLevelById=function e(t){for(var r=0,i=this.length;r<i;r++){var n=this[r];if(n.id===t){return n}}return null};r.dispose=function e(){this.selectedIndex_=-1;this.levels_.length=0};return t}(i["default"].EventTarget);l.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(var d in l.prototype.allowedEvents_){l.prototype["on"+d]=null}var f="2.1.0";var c=i["default"].registerPlugin||i["default"].plugin;var h=function e(t,r){var i=t.qualityLevels;var n=new l;var a=function e(){n.dispose();t.qualityLevels=i;t.off("dispose",e)};t.on("dispose",a);t.qualityLevels=function(){return n};t.qualityLevels.VERSION=f;return n};var p=function e(t){return h(this,i["default"].mergeOptions({},t))};c("qualityLevels",p);p.VERSION=f;var v=p},"./node_modules/videojs-mux/dist/videojs-mux.js":function(e,t,r){var i=i||{};i.js=r("./node_modules/video.js/dist/video.es.js");!function(){!function(t,i){if(true)e.exports=i(r("./node_modules/video.js/dist/video.es.js"));else{var n,a}}(this,(function(e){return function(){var t={48:function(e,t,r){var i;i="undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{},e.exports=i},961:function(e){var t;t=function(){return function(){var e={80:function(e,t,r){e.exports=r(728).default},728:function(e,t,r){"use strict";r.d(t,{default:function(){return Ut}});var i=r(48),n=r.n(i),a=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},s=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)},o=function(e){return e&&void 0!==e.nodeName?(e.muxId||(e.muxId=e.id||s()),e.muxId):e},u=function(e){var t;e&&void 0!==e.nodeName?e=o(t=e):t=document.querySelector(e);var r=t&&t.nodeName?t.nodeName.toLowerCase():"";return[t,e,r]},l=r(640),d=r.n(l),f=d().methodFactory;d().methodFactory=function(e,t,r){var i=f(e,t,r);return function(){for(var e=["[mux]"],t=0;t<arguments.length;t++)e.push(arguments[t]);i.apply(void 0,e)}},d().setLevel(d().getLevel());var c=d();function h(){return"1"===(n().doNotTrack||n().navigator&&n().navigator.doNotTrack)}var p={now:function(){var e=n().performance,t=e&&e.timing,r=t&&t.navigationStart,i="number"==typeof r&&"function"==typeof e.now?r+e.now():Date.now();return Math.round(i)}},v=function(e){return m(e)[0]},m=function(e){if("string"!=typeof e||""===e)return["localhost"];var t,r=(e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/)||[])[4];return r&&(t=(r.match(/[^\.]+\.[^\.]+$/)||[])[0]),[r,t]},g=function(){var e=n().performance;return void 0!==(e&&e.timing)},y=function(){var e=n().performance,t=e&&e.timing;return t&&t.domContentLoadedEventEnd},_=function(){var e=n().performance,t=e&&e.timing;return t&&t.navigationStart};function b(e,t,r){r=void 0===r?1:r,e[t]=e[t]||0,e[t]+=r}var T=["x-request-id","cf-ray","x-amz-cf-id","x-akamai-request-id"],S=["x-cdn","content-type"].concat(T);function w(e){var t={};return(e=e||"").trim().split(/[\r\n]+/).forEach((function(e){if(e){var r=e.split(": "),i=r.shift();i&&(S.indexOf(i.toLowerCase())>=0||0===i.toLowerCase().indexOf("x-litix-"))&&(t[i]=r.join(": "))}})),t}function E(e){if(e){var t=T.find((function(t){return void 0!==e[t]}));return t?e[t]:void 0}}var k=function(e){var t={};for(var r in e){var i=e[r];-1!==i["DATA-ID"].search("io.litix.data.")&&(t[i["DATA-ID"].replace("io.litix.data.","")]=i.VALUE)}return t};function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){I(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var D=function(e){if(!e)return{};var t=_(),r=e.loading,i=r?r.start:e.trequest,n=r?r.first:e.tfirst,a=r?r.end:e.tload;return{bytesLoaded:e.total,requestStart:Math.round(t+i),responseStart:Math.round(t+n),responseEnd:Math.round(t+a)}},x=function(e){if(e&&"function"==typeof e.getAllResponseHeaders)return w(e.getAllResponseHeaders())};function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){P(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var R=function(e,t){if(!e||"function"!=typeof e.getRequests)return{};var r=e.getRequests({state:"executed"});if(0===r.length)return{};var i,n=r[r.length-1],a=v(n.url),s=n.url,o=n.bytesLoaded,u=new Date(n.requestStartDate).getTime(),l=new Date(n.firstByteDate).getTime(),d=new Date(n.requestEndDate).getTime(),f=isNaN(n.duration)?0:n.duration,c="function"==typeof t.getMetricsFor?t.getMetricsFor(n.mediaType).HttpList:t.getDashMetrics().getHttpRequests(n.mediaType);return c.length>0&&(i=w(c[c.length-1]._responseHeaders||"")),{requestStart:u,requestResponseStart:l,requestResponseEnd:d,requestBytesLoaded:o,requestResponseHeaders:i,requestMediaDuration:f,requestHostname:a,requestUrl:s,requestId:i?E(i):void 0}},U=function(e){var t;return null===(t=e.match(/.*codecs\*?="(.*)"/))||void 0===t?void 0:t[1]};function M(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var N=0,B=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"on",value:function(e,t,r){return t._eventEmitterGuid=t._eventEmitterGuid||++N,this._listeners=this._listeners||{},this._listeners[e]=this._listeners[e]||[],r&&(t=t.bind(r)),this._listeners[e].push(t),t}},{key:"off",value:function(e,t){var r=this._listeners&&this._listeners[e];r&&r.forEach((function(e,i){e._eventEmitterGuid===t._eventEmitterGuid&&r.splice(i,1)}))}},{key:"one",value:function(e,t,r){var i=this;t._eventEmitterGuid=t._eventEmitterGuid||++N;var n=function n(){i.off(e,n),t.apply(r||this,arguments)};n._eventEmitterGuid=t._eventEmitterGuid,this.on(e,n)}},{key:"emit",value:function(e,t){var r=this;if(this._listeners){t=t||{};var i=this._listeners["before*"]||[],n=this._listeners[e]||[],a=this._listeners["after"+e]||[],s=function(t,i){(t=t.slice()).forEach((function(t){t.call(r,{type:e},i)}))};s(i,t),s(n,t),s(a,t)}}}],r&&M(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),F=B;function j(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var q=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pm=t,this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,t.on("playing",(function(){r._playheadShouldBeProgressing=!0})),t.on("play",this._startPlaybackHeartbeatInterval.bind(this)),t.on("playing",this._startPlaybackHeartbeatInterval.bind(this)),t.on("adbreakstart",this._startPlaybackHeartbeatInterval.bind(this)),t.on("adplay",this._startPlaybackHeartbeatInterval.bind(this)),t.on("adplaying",this._startPlaybackHeartbeatInterval.bind(this)),t.on("seeking",this._startPlaybackHeartbeatInterval.bind(this)),t.on("devicewake",this._startPlaybackHeartbeatInterval.bind(this)),t.on("viewstart",this._startPlaybackHeartbeatInterval.bind(this)),t.on("rebufferstart",this._startPlaybackHeartbeatInterval.bind(this)),t.on("pause",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("ended",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("viewend",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("error",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("aderror",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("adpause",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("adended",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("adbreakend",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("seeked",(function(){t.data.player_is_paused?r._stopPlaybackHeartbeatInterval():r._startPlaybackHeartbeatInterval()})),t.on("timeupdate",(function(){null!==r._playbackHeartbeatInterval&&t.emit("playbackheartbeat")})),t.on("devicesleep",(function(e,i){null!==r._playbackHeartbeatInterval&&(n().clearInterval(r._playbackHeartbeatInterval),t.emit("playbackheartbeatend",{viewer_time:i.viewer_time}),r._playbackHeartbeatInterval=null)}))}var t,r;return t=e,(r=[{key:"_startPlaybackHeartbeatInterval",value:function(){var e=this;null===this._playbackHeartbeatInterval&&(this.pm.emit("playbackheartbeat"),this._playbackHeartbeatInterval=n().setInterval((function(){e.pm.emit("playbackheartbeat")}),this.pm.playbackHeartbeatTime))}},{key:"_stopPlaybackHeartbeatInterval",value:function(){this._playheadShouldBeProgressing=!1,null!==this._playbackHeartbeatInterval&&(n().clearInterval(this._playbackHeartbeatInterval),this.pm.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)}}])&&j(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function H(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var G=function(e,t,r){return t&&H(e.prototype,t),r&&H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.on("viewinit",(function(){r.viewErrored=!1})),t.on("error",(function(e,i){try{var n=t.errorTranslator({player_error_code:i.player_error_code,player_error_message:i.player_error_message,player_error_context:i.player_error_context});n?(t.data.player_error_code=n.player_error_code||i.player_error_code,t.data.player_error_message=n.player_error_message||i.player_error_message,t.data.player_error_context=n.player_error_context||i.player_error_context,r.viewErrored=!0):(delete t.data.player_error_code,delete t.data.player_error_message,delete t.data.player_error_context)}catch(e){t.mux.log.warn("Exception in error translator callback.",e),r.viewErrored=!0}}))}));function V(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var W=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pm=t,this._watchTimeTrackerLastCheckedTime=null,t.on("playbackheartbeat",this._updateWatchTime.bind(this)),t.on("playbackheartbeatend",this._clearWatchTimeState.bind(this))}var t,r;return t=e,(r=[{key:"_updateWatchTime",value:function(e,t){var r=t.viewer_time;null===this._watchTimeTrackerLastCheckedTime&&(this._watchTimeTrackerLastCheckedTime=r),b(this.pm.data,"view_watch_time",r-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=r}},{key:"_clearWatchTimeState",value:function(e,t){this._updateWatchTime(e,t),this._watchTimeTrackerLastCheckedTime=null}}])&&V(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function z(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var K=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pm=t,this._playbackTimeTrackerLastPlayheadPosition=-1,this._lastTime=p.now(),this._isAdPlaying=!1,this._callbackUpdatePlaybackTime=null;var i=this._startPlaybackTimeTracking.bind(this);t.on("playing",i),t.on("adplaying",i),t.on("seeked",i);var n=this._stopPlaybackTimeTracking.bind(this);t.on("playbackheartbeatend",n),t.on("seeking",n),t.on("adplaying",(function(){r._isAdPlaying=!0})),t.on("adended",(function(){r._isAdPlaying=!1})),t.on("adpause",(function(){r._isAdPlaying=!1})),t.on("adbreakstart",(function(){r._isAdPlaying=!1})),t.on("adbreakend",(function(){r._isAdPlaying=!1})),t.on("adplay",(function(){r._isAdPlaying=!1})),t.on("viewinit",(function(){r._playbackTimeTrackerLastPlayheadPosition=-1,r._lastTime=p.now(),r._isAdPlaying=!1,r._callbackUpdatePlaybackTime=null}))}var t,r;return t=e,(r=[{key:"_startPlaybackTimeTracking",value:function(){null===this._callbackUpdatePlaybackTime&&(this._callbackUpdatePlaybackTime=this._updatePlaybackTime.bind(this),this._playbackTimeTrackerLastPlayheadPosition=this.pm.data.player_playhead_time,this.pm.on("playbackheartbeat",this._callbackUpdatePlaybackTime))}},{key:"_stopPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime&&(this._updatePlaybackTime(),this.pm.off("playbackheartbeat",this._callbackUpdatePlaybackTime),this._callbackUpdatePlaybackTime=null,this._playbackTimeTrackerLastPlayheadPosition=-1)}},{key:"_updatePlaybackTime",value:function(){var e=this.pm.data.player_playhead_time,t=p.now(),r=-1;this._playbackTimeTrackerLastPlayheadPosition>=0&&e>this._playbackTimeTrackerLastPlayheadPosition?r=e-this._playbackTimeTrackerLastPlayheadPosition:this._isAdPlaying&&(r=t-this._lastTime),r>0&&r<=1e3&&b(this.pm.data,"view_content_playback_time",r),this._playbackTimeTrackerLastPlayheadPosition=e,this._lastTime=t}}])&&z(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function X(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pm=t;var r=this._updatePlayheadTime.bind(this);t.on("playbackheartbeat",r),t.on("playbackheartbeatend",r),t.on("timeupdate",r),t.on("destroy",(function(){t.off("timeupdate",r)}))}var t,r;return t=e,(r=[{key:"_updateMaxPlayheadPosition",value:function(){this.pm.data.view_max_playhead_position=void 0===this.pm.data.view_max_playhead_position?this.pm.data.player_playhead_time:Math.max(this.pm.data.view_max_playhead_position,this.pm.data.player_playhead_time)}},{key:"_updatePlayheadTime",value:function(e,t){var r=this,i=function(){r.pm.currentFragmentPDT&&r.pm.currentFragmentStart&&(r.pm.data.player_program_time=r.pm.currentFragmentPDT+r.pm.data.player_playhead_time-r.pm.currentFragmentStart)};if(t&&t.player_playhead_time)this.pm.data.player_playhead_time=t.player_playhead_time,i(),this._updateMaxPlayheadPosition();else if(this.pm.getPlayheadTime){var n=this.pm.getPlayheadTime();void 0!==n&&(this.pm.data.player_playhead_time=n,i(),this._updateMaxPlayheadPosition())}}}])&&X(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Q(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var $=3e5,J=function(e,t,r){return t&&Q(e.prototype,t),r&&Q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t.disableRebufferTracking){var r,i=function(e,t){n(t),r=void 0},n=function(e){if(r){var i=e.viewer_time-r;b(t.data,"view_rebuffer_duration",i),r=e.viewer_time,t.data.view_rebuffer_duration>$&&(t.emit("viewend"),t.send("viewend"),t.mux.log.warn("Ending view after rebuffering for longer than ".concat($,"ms, future events will be ignored unless a programchange or videochange occurs.")))}t.data.view_watch_time>=0&&t.data.view_rebuffer_count>0&&(t.data.view_rebuffer_frequency=t.data.view_rebuffer_count/t.data.view_watch_time,t.data.view_rebuffer_percentage=t.data.view_rebuffer_duration/t.data.view_watch_time)};t.on("playbackheartbeat",(function(e,t){return n(t)})),t.on("rebufferstart",(function(e,n){r||(b(t.data,"view_rebuffer_count",1),r=n.viewer_time,t.one("rebufferend",i))})),t.on("viewinit",(function(){r=void 0,t.off("rebufferend",i)}))}}));function Z(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ee=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pm=t,t.disableRebufferTracking||t.disablePlayheadRebufferTracking||(this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,t.on("playbackheartbeat",this._checkIfRebuffering.bind(this)),t.on("playbackheartbeatend",this._cleanupRebufferTracker.bind(this)),t.on("seeking",(function(){r._cleanupRebufferTracker(null,{viewer_time:p.now()})})))}var t,r;return t=e,r=[{key:"_checkIfRebuffering",value:function(e,t){if(this.pm.seekingTracker.isSeeking||this.pm.adTracker.isAdBreak||!this.pm.playbackHeartbeat._playheadShouldBeProgressing)this._cleanupRebufferTracker(e,t);else if(null!==this._lastCheckedTime)if(this._lastPlayheadTime===this.pm.data.player_playhead_time){var r=t.viewer_time-this._lastPlayheadTimeUpdatedTime;"number"==typeof this.pm.sustainedRebufferThreshold&&r>=this.pm.sustainedRebufferThreshold&&(this._rebuffering||(this._rebuffering=!0,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}))),this._lastCheckedTime=t.viewer_time}else this._cleanupRebufferTracker(e,t,!0);else this._prepareRebufferTrackerState(t.viewer_time)}},{key:"_clearRebufferTrackerState",value:function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null}},{key:"_prepareRebufferTrackerState",value:function(e){this._lastCheckedTime=e,this._lastPlayheadTime=this.pm.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=e}},{key:"_cleanupRebufferTracker",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._rebuffering)this._rebuffering=!1,this.pm.emit("rebufferend",{viewer_time:t.viewer_time});else{if(null===this._lastCheckedTime)return;var i=this.pm.data.player_playhead_time-this._lastPlayheadTime,n=t.viewer_time-this._lastPlayheadTimeUpdatedTime;"number"==typeof this.pm.minimumRebufferDuration&&i>0&&n-i>this.pm.minimumRebufferDuration&&(this._lastCheckedTime=null,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.pm.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+n-i}))}r?this._prepareRebufferTrackerState(t.viewer_time):this._clearRebufferTrackerState()}}],r&&Z(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),te=ee;function re(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ie=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pm=t,t.on("viewinit",(function(){var e=t.data,i=e.view_id;if(!e.view_program_changed){var n=function(e,n){var a=n.viewer_time;"playing"===e.type&&void 0===t.data.view_time_to_first_frame?r.calculateTimeToFirstFrame(a||p.now(),i):"adplaying"!==e.type||void 0!==t.data.view_time_to_first_frame&&!r._inPrerollPosition()||r.calculateTimeToFirstFrame(a||p.now(),i)};t.one("playing",n),t.one("adplaying",n),t.one("viewend",(function(){t.off("playing",n),t.off("adplaying",n)}))}}))}var t,r;return t=e,(r=[{key:"_inPrerollPosition",value:function(){return void 0===this.pm.data.view_content_playback_time||this.pm.data.view_content_playback_time<=1e3}},{key:"calculateTimeToFirstFrame",value:function(e,t){t===this.pm.data.view_id&&(this.pm.watchTimeTracker._updateWatchTime(null,{viewer_time:e}),this.pm.data.view_time_to_first_frame=this.pm.data.view_watch_time,(this.pm.data.player_autoplay_on||this.pm.data.video_is_autoplay)&&this.NAVIGATION_START&&(this.pm.data.view_aggregate_startup_time=this.pm.data.view_start+this.pm.data.view_watch_time-this.NAVIGATION_START))}}])&&re(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ne(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ae=function(e,t,r){return t&&ne(e.prototype,t),r&&ne(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.on("viewinit",(function(){r._lastPlayheadPosition=-1})),["pause","rebufferstart","seeking","error","adbreakstart","hb"].forEach((function(e){t.on(e,(function(){if(r._lastPlayheadPosition>=0&&t.data.player_playhead_time>=0&&r._lastPlayerWidth>=0&&r._lastSourceWidth>0&&r._lastPlayerHeight>=0&&r._lastSourceHeight>0){var e=t.data.player_playhead_time-r._lastPlayheadPosition;if(e<0)return void(r._lastPlayheadPosition=-1);var i=Math.min(r._lastPlayerWidth/r._lastSourceWidth,r._lastPlayerHeight/r._lastSourceHeight),n=Math.max(0,i-1),a=Math.max(0,1-i);t.data.view_max_upscale_percentage=Math.max(t.data.view_max_upscale_percentage||0,n),t.data.view_max_downscale_percentage=Math.max(t.data.view_max_downscale_percentage||0,a),b(t.data,"view_total_content_playback_time",e),b(t.data,"view_total_upscaling",n*e),b(t.data,"view_total_downscaling",a*e)}r._lastPlayheadPosition=-1}))})),["playing","hb"].forEach((function(e){t.on(e,(function(){r._lastPlayheadPosition=t.data.player_playhead_time,r._lastPlayerWidth=t.data.player_width,r._lastPlayerHeight=t.data.player_height,r._lastSourceWidth=t.data.video_source_width,r._lastSourceHeight=t.data.video_source_height}))}))}));function se(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var oe=function(e,t,r){return t&&se(e.prototype,t),r&&se(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isSeeking=!1;var i=-1,n=function(){var e=p.now(),n=(t.data.viewer_time||e)-(i||e);b(t.data,"view_seek_duration",n),t.data.view_max_seek_time=Math.max(t.data.view_max_seek_time||0,n),r.isSeeking=!1,i=-1};t.on("seeking",(function(e,a){Object.assign(t.data,a),r.isSeeking&&a.viewer_time-i<=2e3?i=a.viewer_time:(r.isSeeking&&n(),r.isSeeking=!0,i=a.viewer_time,b(t.data,"view_seek_count",1),t.send("seeking"))})),t.on("seeked",(function(){n()})),t.on("viewend",(function(){r.isSeeking&&(n(),t.send("seeked")),r.isSeeking=!1,i=-1}))}));function ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,a=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(a.push(i.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==r.return||r.return()}finally{if(o)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return le(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?le(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function de(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var fe=function(e,t){e.push(t),e.sort((function(e,t){return e.viewer_time-t.viewer_time}))},ce=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror","adclicked","adskipped"],he=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pm=t,t.on("viewinit",(function(){r.isAdBreak=!1,r._currentAdRequestNumber=0,r._currentAdResponseNumber=0,r._adRequests=[],r._adResponses=[],r._adHasPlayed=!1,r._wouldBeNewAdPlay=!0,r._prerollPlayTime=void 0})),ce.forEach((function(e){return t.on(e,r._updateAdData.bind(r))}));var i=function(){r.isAdBreak=!1};t.on("adbreakstart",(function(){r.isAdBreak=!0})),t.on("play",i),t.on("playing",i),t.on("viewend",i),t.on("adrequest",(function(e,i){i=Object.assign({ad_request_id:"generatedAdRequestId"+r._currentAdRequestNumber++},i),fe(r._adRequests,i),b(t.data,"view_ad_request_count"),r.inPrerollPosition()&&(t.data.view_preroll_requested=!0,r._adHasPlayed||b(t.data,"view_preroll_request_count"))})),t.on("adresponse",(function(e,i){i=Object.assign({ad_request_id:"generatedAdRequestId"+r._currentAdResponseNumber++},i),fe(r._adResponses,i);var n=r.findAdRequest(i.ad_request_id);n&&b(t.data,"view_ad_request_time",Math.max(0,i.viewer_time-n.viewer_time))})),t.on("adplay",(function(e,i){r._adHasPlayed=!0,r._wouldBeNewAdPlay&&(r._wouldBeNewAdPlay=!1,b(t.data,"view_ad_played_count")),r.inPrerollPosition()&&!t.data.view_preroll_played&&(t.data.view_preroll_played=!0,r._adRequests.length>0&&(t.data.view_preroll_request_time=Math.max(0,i.viewer_time-r._adRequests[0].viewer_time)),t.data.view_start&&(t.data.view_startup_preroll_request_time=Math.max(0,i.viewer_time-t.data.view_start)),r._prerollPlayTime=i.viewer_time)})),t.on("adplaying",(function(e,i){r.inPrerollPosition()&&void 0===t.data.view_preroll_load_time&&void 0!==r._prerollPlayTime&&(t.data.view_preroll_load_time=i.viewer_time-r._prerollPlayTime,t.data.view_startup_preroll_load_time=i.viewer_time-r._prerollPlayTime)})),t.on("adclicked",(function(e,i){r._wouldBeNewAdPlay||b(t.data,"view_ad_clicked_count")})),t.on("adskipped",(function(e,i){r._wouldBeNewAdPlay||b(t.data,"view_ad_skipped_count")})),t.on("adended",(function(){r._wouldBeNewAdPlay=!0})),t.on("aderror",(function(){r._wouldBeNewAdPlay=!0}))}var t,r;return t=e,(r=[{key:"inPrerollPosition",value:function(){return void 0===this.pm.data.view_content_playback_time||this.pm.data.view_content_playback_time<=1e3}},{key:"findAdRequest",value:function(e){for(var t=0;t<this._adRequests.length;t++)if(this._adRequests[t].ad_request_id===e)return this._adRequests[t]}},{key:"_updateAdData",value:function(e,t){if(this.inPrerollPosition()){if(!this.pm.data.view_preroll_ad_tag_hostname&&t.ad_tag_url){var r=ue(m(t.ad_tag_url),2),i=r[0],n=r[1];this.pm.data.view_preroll_ad_tag_domain=n,this.pm.data.view_preroll_ad_tag_hostname=i}if(!this.pm.data.view_preroll_ad_asset_hostname&&t.ad_asset_url){var a=ue(m(t.ad_asset_url),2),s=a[0],o=a[1];this.pm.data.view_preroll_ad_asset_domain=o,this.pm.data.view_preroll_ad_asset_hostname=s}}this.pm.data.ad_asset_url=null==t?void 0:t.ad_asset_url,this.pm.data.ad_tag_url=null==t?void 0:t.ad_tag_url,this.pm.data.ad_creative_id=null==t?void 0:t.ad_creative_id,this.pm.data.ad_id=null==t?void 0:t.ad_id,this.pm.data.ad_universal_id=null==t?void 0:t.ad_universal_id}}])&&de(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function pe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ve=function(e,t,r){return t&&pe(e.prototype,t),r&&pe(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t){var r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(){t.disableRebufferTracking||r&&(b(t.data,"view_waiting_rebuffer_duration",p.now()-r),r=!1,n().clearInterval(i))},s=!1,o=function(){s=!1,a()};t.on("waiting",(function(){s&&(t.disableRebufferTracking||(b(t.data,"view_waiting_rebuffer_count",1),r=p.now(),i=n().setInterval((function(){if(r){var e=p.now();b(t.data,"view_waiting_rebuffer_duration",e-r),r=e}}),250)))})),t.on("playing",(function(){a(),s=!0})),t.on("pause",o),t.on("seeking",o)}));function me(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ge=function(e,t,r){return t&&me(e.prototype,t),r&&me(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(){r.lastWallClockTime=p.now(),t.on("before*",n)},n=function(e){var i=p.now(),n=r.lastWallClockTime;r.lastWallClockTime=i,i-n>3e4&&(t.emit("devicesleep",{viewer_time:n}),Object.assign(t.data,{viewer_time:n}),t.send("devicesleep"),t.emit("devicewake",{viewer_time:i}),Object.assign(t.data,{viewer_time:i}),t.send("devicewake"))};t.one("playbackheartbeat",i),t.on("playbackheartbeatend",(function(){t.off("before*",n),t.one("playbackheartbeat",i)}))})),ye=r(375),_e=r(655),be=r.n(_e),Te="muxData",Se=function(){var e;try{e=ye.parse(be().get(Te)||"")}catch(t){e={}}return e},we=function(e){try{be().set(Te,ye.stringify(e),{expires:365})}catch(e){}},Ee=function(){var e=Se();return e.mux_viewer_id=e.mux_viewer_id||a(),e.msn=e.msn||Math.random(),we(e),{mux_viewer_id:e.mux_viewer_id,mux_sample_number:e.msn}};function ke(e,t){var r=t.beaconCollectionDomain,i=t.beaconDomain;if(r)return"https://"+r;var n=i||"litix.io";return(e=e||"inferred").match(/^[a-z0-9]+$/)?"https://"+e+"."+n:"https://img.litix.io/a.gif"}var Ae=function(){var e;switch(Ce()){case"cellular":e="cellular";break;case"ethernet":e="wired";break;case"wifi":e="wifi";break;case void 0:break;default:e="other"}return e},Ce=function(){var e=n().navigator,t=e&&(e.connection||e.mozConnection||e.webkitConnection);return t&&t.type};Ae.getConnectionFromAPI=Ce;var Ie=Ae,De=Le({a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",i:"internal",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"}),xe=Le({ad:"ad",ag:"aggregate",ap:"api",al:"application",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",br:"break",bw:"browser",by:"bytes",ca:"cached",cb:"cancel",cc:"codec",cd:"code",cg:"category",ch:"changed",ck:"clicked",cl:"canceled",cn:"config",co:"count",ce:"counter",cp:"complete",cr:"creative",ct:"content",cu:"current",cx:"connection",cz:"context",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",dr:"drm",dp:"dropped",du:"duration",dv:"device",ec:"encoding",ed:"edge",en:"end",eg:"engine",em:"embed",er:"error",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",ep:"experiments",fa:"failed",fi:"first",fm:"family",ft:"format",fp:"fps",fq:"frequency",fr:"frame",fs:"fullscreen",ha:"has",hb:"holdback",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mf:"manifest",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mx:"mux",ne:"newest",nm:"name",no:"number",on:"on",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pr:"preload",ps:"position",pt:"part",py:"property",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",sd:"skipped",se:"session",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",st:"start",su:"startup",sv:"server",sw:"software",ta:"tag",tc:"tech",te:"text",tg:"target",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",un:"universal",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"});function Le(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t}function Oe(e){var t={},r={};return Object.keys(e).forEach((function(i){var n=!1;if(e.hasOwnProperty(i)&&void 0!==e[i]){var a=i.split("_"),s=a[0],o=De[s];o||(c.info("Data key word `"+a[0]+"` not expected in "+i),o=s+"_"),a.splice(1).forEach((function(e){"url"===e&&(n=!0),xe[e]?o+=xe[e]:Number(e)&&Math.floor(Number(e))===Number(e)?o+=e:(c.info("Data key word `"+e+"` not expected in "+i),o+="_"+e+"_")})),n?r[o]=e[i]:t[o]=e[i]}})),Object.assign(t,r)}var Pe={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:1e4,maxPayloadKBSize:500},Re=["hb","requestcompleted","requestfailed","requestcanceled"],Ue="https://img.litix.io",Me=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._beaconUrl=e||Ue,this._eventQueue=[],this._postInFlight=!1,this._failureCount=0,this._sendTimeout=!1,this._options=Object.assign({},Pe,t)};Me.prototype.queueEvent=function(e,t){var r=Object.assign({},t);return(this._eventQueue.length<=this._options.maxQueueLength||"eventrateexceeded"===e)&&(this._eventQueue.push(r),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength)},Me.prototype.flushEvents=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&1===this._eventQueue.length?this._eventQueue.pop():(this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending())},Me.prototype.destroy=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.destroyed=!0,e?this._clearBeaconQueue():this.flushEvents(),n().clearTimeout(this._sendTimeout)},Me.prototype._clearBeaconQueue=function(){var e=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,t=this._eventQueue.slice(e);e>0&&Object.assign(t[t.length-1],Oe({mux_view_message:"event queue truncated"}));var r=this._createPayload(t);Be(this._beaconUrl,r,!0,(function(){}))},Me.prototype._sendBeaconQueue=function(){var e=this;if(!this._postInFlight){var t=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0;var r=this._createPayload(t),i=p.now();Be(this._beaconUrl,r,!1,(function(r,n){n?(e._eventQueue=t.concat(e._eventQueue),e._failureCount+=1,c.info("Error sending beacon: "+n)):e._failureCount=0,e._roundTripTime=p.now()-i,e._postInFlight=!1}))}},Me.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var e=Math.pow(2,this._failureCount-1);return(1+(e*=Math.random()))*this._options.baseTimeBetweenBeacons},Me.prototype._startBeaconSending=function(){var e=this;n().clearTimeout(this._sendTimeout),this.destroyed||(this._sendTimeout=n().setTimeout((function(){e._eventQueue.length&&e._sendBeaconQueue(),e._startBeaconSending()}),this._getNextBeaconTime()))},Me.prototype._createPayload=function(e){var t,r,i,n=this,a={transmission_timestamp:Math.round(p.now())};this._roundTripTime&&(a.rtt_ms=Math.round(this._roundTripTime));var s=function(){t=JSON.stringify({metadata:a,events:r||e}),i=t.length/1024},o=function(){return i<=n._options.maxPayloadKBSize};return s(),o()||(c.info("Payload size is too big ("+i+" kb). Removing unnecessary events."),r=e.filter((function(e){return-1===Re.indexOf(e.e)})),s()),o()||(c.info("Payload size still too big ("+i+" kb). Cropping fields.."),r.forEach((function(e){for(var t in e){var r=e[t];"string"==typeof r&&r.length>51200&&(e[t]=r.substring(0,51200))}})),s()),t};var Ne=function(e){return e.length<=57344},Be=function(e,t,r,i){if(r&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(e,t))i();else if(n().fetch)n().fetch(e,{method:"POST",body:t,headers:{"Content-Type":"text/plain"},keepalive:Ne(t)}).then((function(e){return i(null,e.ok?null:"Error")})).catch((function(e){return i(null,e)}));else{if(n().XMLHttpRequest){var a=new(n().XMLHttpRequest);return a.onreadystatechange=function(){if(4===a.readyState)return i(null,200!==a.status?"error":void 0)},a.open("POST",e),a.setRequestHeader("Content-Type","text/plain"),void a.send(t)}i()}},Fe=Me;function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function He(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(r),!0).forEach((function(t){ze(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ge(e){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ge(e)}function Ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function We(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ze(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ke=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id"],Xe=["adplay","adplaying","adpause","adfirstquartile","admidpoint","adthirdquartile","adended","adresponse","adrequest"],Ye=["ad_id","ad_creative_id","ad_universal_id"],Qe=["viewstart","error","ended","viewend"],$e=function(){function e(t,r){var i,a,s,o,u,l,d,f,c,h,p,v,m,g,y,_=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Ve(this,e),ze(this,"previousBeaconData",null),ze(this,"lastEventTime",0),ze(this,"rateLimited",!1),this.mux=t,this.envKey=r,this.options=_,this.eventQueue=new Fe(ke(this.envKey,this.options)),this.sampleRate=null!==(i=this.options.sampleRate)&&void 0!==i?i:1,this.disableCookies=null!==(a=this.options.disableCookies)&&void 0!==a&&a,this.respectDoNotTrack=null!==(s=this.options.respectDoNotTrack)&&void 0!==s&&s,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:null===(o=this.options.platform)||void 0===o?void 0:o.name,viewer_application_version:null===(u=this.options.platform)||void 0===u?void 0:u.version,viewer_application_engine:null===(l=this.options.platform)||void 0===l?void 0:l.layout,viewer_device_name:null===(d=this.options.platform)||void 0===d?void 0:d.product,viewer_device_category:"",viewer_device_manufacturer:null===(f=this.options.platform)||void 0===f?void 0:f.manufacturer,viewer_os_family:null===(c=this.options.platform)||void 0===c||null===(h=c.os)||void 0===h?void 0:h.family,viewer_os_architecture:null===(p=this.options.platform)||void 0===p||null===(v=p.os)||void 0===v?void 0:v.architecture,viewer_os_version:null===(m=this.options.platform)||void 0===m||null===(g=m.os)||void 0===g?void 0:g.version,viewer_connection_type:Ie(),page_url:null===n()||void 0===n()||null===(y=n().location)||void 0===y?void 0:y.href},this.viewerData=this.disableCookies?{}:Ee()}var t,r;return t=e,(r=[{key:"send",value:function(e,t){var r;if(e&&null!=t&&t.view_id){if(this.respectDoNotTrack&&h())return c.info("Not sending `"+e+"` because Do Not Track is enabled");if(!t||"object"!==Ge(t))return c.error("A data object was expected in send() but was not provided");var i,n,s=this.disableCookies?{}:(i=Se(),n=p.now(),i.session_start&&(i.sst=i.session_start,delete i.session_start),i.session_id&&(i.sid=i.session_id,delete i.session_id),i.session_expires&&(i.sex=i.session_expires,delete i.session_expires),(!i.sex||i.sex<n)&&(i.sid=a(),i.sst=n),i.sex=n+15e5,we(i),{session_id:i.sid,session_start:i.sst,session_expires:i.sex}),o=He(He(He(He(He({},this.pageLevelData),t),s),this.viewerData),{},{event:e,env_key:this.envKey});o.user_id&&(o.viewer_user_id=o.user_id,delete o.user_id);var u=(null!==(r=o.mux_sample_number)&&void 0!==r?r:0)>=this.sampleRate,l=Oe(this._deduplicateBeaconData(e,o));if(this.lastEventTime=this.mux.utils.now(),u)return c.info("Not sending event due to sample rate restriction",e,o,l);if(this.envKey||c.info("Missing environment key (envKey) - beacons will be dropped if the video source is not a valid mux video URL",e,o,l),!this.rateLimited)if(c.info("Sending event",e,o,l),this.rateLimited=!this.eventQueue.queueEvent(e,l),this.mux.WINDOW_UNLOADING&&"viewend"===e)this.eventQueue.destroy(!0);else if(this.mux.WINDOW_HIDDEN&&"hb"===e?this.eventQueue.flushEvents(!0):Qe.indexOf(e)>=0&&this.eventQueue.flushEvents(),this.rateLimited)return o.event="eventrateexceeded",l=Oe(o),this.eventQueue.queueEvent(o.event,l),c.error("Beaconing disabled due to rate limit.")}}},{key:"destroy",value:function(){this.eventQueue.destroy(!1)}},{key:"_deduplicateBeaconData",value:function(e,t){var r=this,i={},n=t.view_id;if("-1"===n||"viewstart"===e||"viewend"===e||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=6e5)i=He({},t),n&&(this.previousBeaconData=i),n&&"viewend"===e&&(this.previousBeaconData=null);else{var a=0===e.indexOf("request");Object.entries(t).forEach((function(t){var n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,a=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(a.push(i.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==r.return||r.return()}finally{if(o)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return je(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?je(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),s=n[0],o=n[1];r.previousBeaconData&&(o!==r.previousBeaconData[s]||Ke.indexOf(s)>-1||r.objectHasChanged(a,s,o,r.previousBeaconData[s])||r.eventRequiresKey(e,s))&&(i[s]=o,r.previousBeaconData[s]=o)}))}return i}},{key:"objectHasChanged",value:function(e,t,r,i){return!(!e||0!==t.indexOf("request_")||"request_response_headers"!==t&&"object"===Ge(r)&&"object"===Ge(i)&&Object.keys(r||{}).length===Object.keys(i||{}).length)}},{key:"eventRequiresKey",value:function(e,t){return"renditionchange"===e&&0===t.indexOf("video_source_")||!(!Ye.includes(t)||!Xe.includes(e))}}])&&We(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Je(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ze=function(e,t,r){return t&&Je(e.prototype,t),r&&Je(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=0,i=0,n=0,a=0,s=0,o=0,u=0;t.on("requestcompleted",(function(e,o){var u,l,d=o.request_start,f=o.request_response_start,c=o.request_response_end,h=o.request_bytes_loaded;if(a++,f?(u=f-(null!=d?d:0),l=(null!=c?c:0)-f):l=(null!=c?c:0)-(null!=d?d:0),l>0&&h&&h>0){var p=h/l*8e3;s++,i+=h,n+=l,t.data.view_min_request_throughput=Math.min(t.data.view_min_request_throughput||1/0,p),t.data.view_average_request_throughput=i/n*8e3,t.data.view_request_count=a,u>0&&(r+=u,t.data.view_max_request_latency=Math.max(t.data.view_max_request_latency||0,u),t.data.view_average_request_latency=r/s)}})),t.on("requestfailed",(function(e,r){a++,o++,t.data.view_request_count=a,t.data.view_request_failed_count=o})),t.on("requestcanceled",(function(e,r){a++,u++,t.data.view_request_count=a,t.data.view_request_canceled_count=u}))}));function et(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var tt=function(e,t,r){return t&&et(e.prototype,t),r&&et(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.on("before*",(function(e,i){var n=i.viewer_time,a=p.now(),s=r._lastEventTime;if(r._lastEventTime=a,s&&a-s>36e5){var o=Object.keys(t.data).reduce((function(e,r){return 0===r.indexOf("video_")?Object.assign(e,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},r,t.data[r])):e}),{});t.mux.log.info("Received event after at least an hour inactivity, creating a new view"),t.emit("viewinit",Object.assign({viewer_time:n},o)),t.playbackHeartbeat._playheadShouldBeProgressing&&"play"!==e.type&&"adbreakstart"!==e.type&&(t.emit("play",{viewer_time:n}),"playing"!==e.type&&t.emit("playing",{viewer_time:n}))}}))}));function rt(e){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rt(e)}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function nt(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function at(e,t){return at=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},at(e,t)}function st(e,t){if(t&&("object"===rt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ot(e)}function ot(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ut(e){return ut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ut(e)}var lt=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange"],dt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&at(e,t)}(n,e);var t,r,i=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=ut(e);if(t){var n=ut(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return st(this,r)}}(n);function n(e,t,r){var s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(s=i.call(this)).DOM_CONTENT_LOADED_EVENT_END=y(),s.NAVIGATION_START=_(),s.mux=e,s.id=t,(r=Object.assign({debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,disablePlayheadRebufferTracking:!1,errorTranslator:function(e){return e}},r)).data=r.data||{},r.data.property_key&&(r.data.env_key=r.data.property_key,delete r.data.property_key),c.setLevel(r.debug?"debug":"warn"),s.getPlayheadTime=r.getPlayheadTime,s.getStateData=r.getStateData||function(){return{}},s.getAdData=r.getAdData||function(){},s.minimumRebufferDuration=r.minimumRebufferDuration,s.sustainedRebufferThreshold=r.sustainedRebufferThreshold,s.playbackHeartbeatTime=r.playbackHeartbeatTime,s.disableRebufferTracking=r.disableRebufferTracking,s.disableRebufferTracking&&s.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),s.disablePlayheadRebufferTracking=r.disablePlayheadRebufferTracking,s.errorTranslator=r.errorTranslator,s.playbackEventDispatcher=new $e(e,r.data.env_key,r),s.data={player_instance_id:a(),mux_sample_rate:r.sampleRate,beacon_domain:r.beaconCollectionDomain?r.beaconCollectionDomain:r.beaconDomain},s.data.view_sequence_number=1,s.data.player_sequence_number=1,s.oldEmit=s.emit,s.emit=function(e,t){t=Object.assign({viewer_time:this.mux.utils.now()},t),this.oldEmit(e,t)};var o=function(){void 0===this.data.view_start&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"))}.bind(ot(s));s.on("viewinit",(function(e,t){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),Object.assign(this.data,t),this._initializeViewData(),this.one("play",o),this.one("adbreakstart",o)}));var u=function(e){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",e)}.bind(ot(s));if(s.on("videochange",(function(e,t){u(t)})),s.on("programchange",(function(e,t){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),u(Object.assign(t,{view_program_changed:!0})),o(),this.emit("play"),this.emit("playing")})),s.on("fragmentchange",(function(e,t){this.currentFragmentPDT=t.currentFragmentPDT,this.currentFragmentStart=t.currentFragmentStart})),s.on("destroy",s.destroy),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&"function"==typeof window.removeEventListener){var l=function(){var e=void 0!==s.data.view_start;s.mux.WINDOW_HIDDEN="hidden"===document.visibilityState,e&&s.mux.WINDOW_HIDDEN&&(s.data.player_is_paused||s.emit("hb"))};window.addEventListener("visibilitychange",l,!1);var d=function(e){e.persisted||s.destroy()};window.addEventListener("pagehide",d,!1),s.on("destroy",(function(){window.removeEventListener("visibilitychange",l),window.removeEventListener("pagehide",d)}))}return s.on("playerready",(function(e,t){Object.assign(this.data,t)})),lt.forEach((function(e){s.on(e,(function(t,r){0!==e.indexOf("ad")&&this._updateStateData(),Object.assign(this.data,r),this._sanitizeData()})),s.on("after"+e,(function(){("error"!==e||this.errorTracker.viewErrored)&&this.send(e)}))})),s.on("viewend",(function(e,t){Object.assign(s.data,t)})),s.one("playerready",(function(e){var t=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=t-this.data.player_init_time),!this.mux.PLAYER_TRACKED&&this.NAVIGATION_START&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.DOM_CONTENT_LOADED_EVENT_END)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.DOM_CONTENT_LOADED_EVENT_END||1/0)-this.NAVIGATION_START)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time})),s.longResumeTracker=new tt(ot(s)),s.errorTracker=new G(ot(s)),new ge(ot(s)),s.seekingTracker=new oe(ot(s)),s.playheadTime=new Y(ot(s)),s.playbackHeartbeat=new q(ot(s)),new ae(ot(s)),s.watchTimeTracker=new W(ot(s)),new K(ot(s)),s.adTracker=new he(ot(s)),new te(ot(s)),new J(ot(s)),new ie(ot(s)),new ve(ot(s)),new Ze(ot(s)),r.hlsjs&&s.addHLSJS(r),r.dashjs&&s.addDashJS(r),s.emit("viewinit",r.data),s}return t=n,r=[{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,void 0!==this.data.view_start&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),window.clearTimeout(this._heartBeatTimeout))}},{key:"send",value:function(e){if(this.data.view_id){var t=Object.assign({},this.data);if(void 0===t.video_source_is_live&&(t.player_source_duration===1/0||t.video_source_duration===1/0?t.video_source_is_live=!0:(t.player_source_duration>0||t.video_source_duration>0)&&(t.video_source_is_live=!1)),t.video_source_is_live||["player_program_time","player_manifest_newest_program_time","player_live_edge_program_time","player_program_time","video_holdback","video_part_holdback","video_target_duration","video_part_target_duration"].forEach((function(e){t[e]=void 0})),t.video_source_url=t.video_source_url||t.player_source_url,t.video_source_url){var r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,a=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(a.push(i.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==r.return||r.return()}finally{if(o)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return it(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?it(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(m(t.video_source_url),2),i=r[0],n=r[1];t.video_source_domain=n,t.video_source_hostname=i}delete t.ad_request_id,this.playbackEventDispatcher.send(e,t),this.data.view_sequence_number++,this.data.player_sequence_number++,this._restartHeartBeat(),"viewend"===e&&delete this.data.view_id}}},{key:"_updateStateData",value:function(){Object.assign(this.data,this.getStateData()),this.playheadTime._updatePlayheadTime(),this._sanitizeData()}},{key:"_sanitizeData",value:function(){var e=this;["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"].forEach((function(t){var r=parseInt(e.data[t],10);e.data[t]=isNaN(r)?void 0:r})),["player_source_url","video_source_url"].forEach((function(t){if(e.data[t]){var r=e.data[t].toLowerCase();0!==r.indexOf("data:")&&0!==r.indexOf("blob:")||(e.data[t]="MSE style URL")}}))}},{key:"_resetVideoData",value:function(e,t){var r=this;Object.keys(this.data).forEach((function(e){0===e.indexOf("video_")&&delete r.data[e]}))}},{key:"_resetViewData",value:function(){var e=this;Object.keys(this.data).forEach((function(t){0===t.indexOf("view_")&&delete e.data[t]})),this.data.view_sequence_number=1}},{key:"_resetErrorData",value:function(e,t){delete this.data.player_error_code,delete this.data.player_error_message}},{key:"_initializeViewData",value:function(){var e=this,t=this.data.view_id=a(),r=function(){t===e.data.view_id&&b(e.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",r):r()}},{key:"_restartHeartBeat",value:function(){var e=this;window.clearTimeout(this._heartBeatTimeout),this.errorTracker.viewErrored||(this._heartBeatTimeout=window.setTimeout((function(){e.data.player_is_paused||e.emit("hb")}),1e4))}},{key:"addHLSJS",value:function(e){e.hlsjs?this.hlsjs?this.mux.log.warn("An instance of HLS.js is already being monitored for this player."):(this.hlsjs=e.hlsjs,function(e,t,r){var i=arguments.length>4?arguments[4]:void 0,n=e.log,a=e.utils.secondsToMs,s=function(e){var t,r=parseInt(i.version);return 1===r&&null!==e.programDateTime&&(t=e.programDateTime),0===r&&null!==e.pdt&&(t=e.pdt),t};if(g()){var o=function(r,i){return e.emit(t,r,i)},u=function(e,t){var r=t.levels,i=t.audioTracks,n=t.url,a=t.stats,s=t.networkDetails,u=t.sessionData,l={},d={};r.forEach((function(e,t){l[t]={width:e.width,height:e.height,bitrate:e.bitrate,attrs:e.attrs}})),i.forEach((function(e,t){d[t]={name:e.name,language:e.lang,bitrate:e.bitrate}}));var f=D(a),c=f.bytesLoaded,h=f.requestStart,p=f.responseStart,m=f.responseEnd;o("requestcompleted",C(C({},k(u)),{},{request_event_type:e,request_bytes_loaded:c,request_start:h,request_response_start:p,request_response_end:m,request_type:"manifest",request_hostname:v(n),request_response_headers:x(s),request_rendition_lists:{media:l,audio:d,video:{}}}))};r.on(i.Events.MANIFEST_LOADED,u);var l=function(e,t){var r=t.details,i=t.level,n=t.networkDetails,u=t.stats,l=D(u),d=l.bytesLoaded,f=l.requestStart,c=l.responseStart,h=l.responseEnd,p=r.fragments[r.fragments.length-1],m=s(p)+a(p.duration);o("requestcompleted",{request_event_type:e,request_bytes_loaded:d,request_start:f,request_response_start:c,request_response_end:h,request_current_level:i,request_type:"manifest",request_hostname:v(r.url),request_response_headers:x(n),video_holdback:r.holdBack&&a(r.holdBack),video_part_holdback:r.partHoldBack&&a(r.partHoldBack),video_part_target_duration:r.partTarget&&a(r.partTarget),video_target_duration:r.targetduration&&a(r.targetduration),video_source_is_live:r.live,player_manifest_newest_program_time:isNaN(m)?void 0:m})};r.on(i.Events.LEVEL_LOADED,l);var d=function(e,t){var r=t.details,i=t.networkDetails,n=t.stats,a=D(n),s=a.bytesLoaded,u=a.requestStart,l=a.responseStart,d=a.responseEnd;o("requestcompleted",{request_event_type:e,request_bytes_loaded:s,request_start:u,request_response_start:l,request_response_end:d,request_type:"manifest",request_hostname:v(r.url),request_response_headers:x(i)})};r.on(i.Events.AUDIO_TRACK_LOADED,d);var f=function(e,t){var i=t.stats,n=t.networkDetails,a=t.frag;i=i||a.stats;var s=D(i),u=s.bytesLoaded,l=s.requestStart,d=s.responseStart,f=s.responseEnd,c=n?x(n):void 0,h={request_event_type:e,request_bytes_loaded:u,request_start:l,request_response_start:d,request_response_end:f,request_hostname:n?v(n.responseURL):void 0,request_id:c?E(c):void 0,request_response_headers:c,request_media_duration:a.duration,request_url:null==n?void 0:n.responseURL};"main"===a.type?(h.request_type="media",h.request_current_level=a.level,h.request_video_width=(r.levels[a.level]||{}).width,h.request_video_height=(r.levels[a.level]||{}).height,h.request_labeled_bitrate=(r.levels[a.level]||{}).bitrate):h.request_type=a.type,o("requestcompleted",h)};r.on(i.Events.FRAG_LOADED,f);var c=function(e,t){var r=t.frag,i=r.start,n={currentFragmentPDT:s(r),currentFragmentStart:a(i)};o("fragmentchange",n)};r.on(i.Events.FRAG_CHANGED,c);var h=function(e,t){var r=t.type,n=t.details,a=t.response,s=t.fatal,u=t.frag,l=t.networkDetails,d=(null==u?void 0:u.url)||t.url||"",f=l?x(l):void 0;if(n!==i.ErrorDetails.MANIFEST_LOAD_ERROR&&n!==i.ErrorDetails.MANIFEST_LOAD_TIMEOUT&&n!==i.ErrorDetails.FRAG_LOAD_ERROR&&n!==i.ErrorDetails.FRAG_LOAD_TIMEOUT&&n!==i.ErrorDetails.LEVEL_LOAD_ERROR&&n!==i.ErrorDetails.LEVEL_LOAD_TIMEOUT&&n!==i.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&n!==i.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT&&n!==i.ErrorDetails.SUBTITLE_LOAD_ERROR&&n!==i.ErrorDetails.SUBTITLE_LOAD_TIMEOUT&&n!==i.ErrorDetails.KEY_LOAD_ERROR&&n!==i.ErrorDetails.KEY_LOAD_TIMEOUT||o("requestfailed",{request_error:n,request_url:d,request_hostname:v(d),request_id:f?E(f):void 0,request_type:n===i.ErrorDetails.FRAG_LOAD_ERROR||n===i.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":n===i.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||n===i.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT?"audio":n===i.ErrorDetails.SUBTITLE_LOAD_ERROR||n===i.ErrorDetails.SUBTITLE_LOAD_TIMEOUT?"subtitle":n===i.ErrorDetails.KEY_LOAD_ERROR||n===i.ErrorDetails.KEY_LOAD_TIMEOUT?"encryption":"manifest",request_error_code:null==a?void 0:a.code,request_error_text:null==a?void 0:a.text}),s){var c,h="".concat(d?"url: ".concat(d,"\n"):"")+"".concat(a&&(a.code||a.text)?"response: ".concat(a.code,", ").concat(a.text,"\n"):"")+"".concat(t.reason?"failure reason: ".concat(t.reason,"\n"):"")+"".concat(t.level?"level: ".concat(t.level,"\n"):"")+"".concat(t.parent?"parent stream controller: ".concat(t.parent,"\n"):"")+"".concat(t.buffer?"buffer length: ".concat(t.buffer,"\n"):"")+"".concat(t.error?"error: ".concat(t.error,"\n"):"")+"".concat(t.event?"event: ".concat(t.event,"\n"):"")+"".concat(t.err?"error message: ".concat(null===(c=t.err)||void 0===c?void 0:c.message,"\n"):"");o("error",{player_error_code:r,player_error_message:n,player_error_context:h})}};r.on(i.Events.ERROR,h);var p=function(e,t){var r=t.frag,i=r&&r._url||"";o("requestcanceled",{request_event_type:e,request_url:i,request_type:"media",request_hostname:v(i)})};r.on(i.Events.FRAG_LOAD_EMERGENCY_ABORTED,p);var m=function(e,t){var i=t.level,a=r.levels[i];if(a&&a.attrs&&a.attrs.BANDWIDTH){var s,u=a.attrs.BANDWIDTH,l=parseFloat(a.attrs["FRAME-RATE"]);isNaN(l)||(s=l),u?o("renditionchange",{video_source_fps:s,video_source_bitrate:u,video_source_width:a.width,video_source_height:a.height,video_source_rendition_name:a.name,video_source_codec:null==a?void 0:a.videoCodec}):n.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};r.on(i.Events.LEVEL_SWITCHED,m),r._stopMuxMonitor=function(){r.off(i.Events.MANIFEST_LOADED,u),r.off(i.Events.LEVEL_LOADED,l),r.off(i.Events.AUDIO_TRACK_LOADED,d),r.off(i.Events.FRAG_LOADED,f),r.off(i.Events.FRAG_CHANGED,c),r.off(i.Events.ERROR,h),r.off(i.Events.FRAG_LOAD_EMERGENCY_ABORTED,p),r.off(i.Events.LEVEL_SWITCHED,m),r.off(i.Events.DESTROYING,r._stopMuxMonitor),delete r._stopMuxMonitor},r.on(i.Events.DESTROYING,r._stopMuxMonitor)}else n.warn("performance timing not supported. Not tracking HLS.js.")}(this.mux,this.id,e.hlsjs,{},e.Hls||window.Hls)):this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.")}},{key:"removeHLSJS",value:function(){var e;this.hlsjs&&((e=this.hlsjs)&&"function"==typeof e._stopMuxMonitor&&e._stopMuxMonitor(),this.hlsjs=void 0)}},{key:"addDashJS",value:function(e){e.dashjs?this.dashjs?this.mux.log.warn("An instance of Dash.js is already being monitored for this player."):(this.dashjs=e.dashjs,function(e,t,r){var i=e.log;if(r&&r.on){var n=function(r,i){return e.emit(t,r,i)},a=function(e){var t=e.type,r=(e.data||{}).url;n("requestcompleted",{request_event_type:t,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:v(r),request_url:r})};r.on("manifestLoaded",a);var s={},o=function(e){var t=e.type,i=e.fragmentModel,a=(e.chunk||{}).mediaInfo||{},o=a.type,u=a.bitrateList,l={};(u=u||[]).forEach((function(e,t){l[t]={},l[t].width=e.width,l[t].height=e.height,l[t].bitrate=e.bandwidth,l[t].attrs={}})),"video"===o?s.video=l:"audio"===o?s.audio=l:s.media=l;var d=R(i,r),f=d.requestStart,c=d.requestResponseStart,h=d.requestResponseEnd,p=d.requestResponseHeaders,v=d.requestMediaDuration,m=d.requestHostname,g=d.requestUrl,y=d.requestId;n("requestcompleted",{request_event_type:t,request_start:f,request_response_start:c,request_response_end:h,request_bytes_loaded:-1,request_type:o+"_init",request_response_headers:p,request_hostname:m,request_id:y,request_url:g,request_media_duration:v,request_rendition_lists:s})};r.on("initFragmentLoaded",o);var u=function(e){var t=e.type,i=e.fragmentModel,a=e.chunk||{},s=a.mediaInfo,o=a.start,u=(s||{}).type,l=R(i,r),d=l.requestStart,f=l.requestResponseStart,c=l.requestResponseEnd,h=l.requestBytesLoaded,p=l.requestResponseHeaders,v=l.requestMediaDuration,m=l.requestHostname,g=l.requestUrl,y=l.requestId,_=function(e,t){var r=t.getQualityFor(e),i=t.getCurrentTrackFor(e).bitrateList;return i?{currentLevel:r,renditionWidth:i[r].width||null,renditionHeight:i[r].height||null,renditionBitrate:i[r].bandwidth}:{}}(u,r),b=_.currentLevel,T=_.renditionWidth,S=_.renditionHeight,w=_.renditionBitrate;n("requestcompleted",{request_event_type:t,request_start:d,request_response_start:f,request_response_end:c,request_bytes_loaded:h,request_type:u,request_response_headers:p,request_hostname:m,request_id:y,request_url:g,request_media_start_time:o,request_media_duration:v,request_current_level:b,request_labeled_bitrate:w,request_video_width:T,request_video_height:S})};r.on("mediaFragmentLoaded",u);var l={video:void 0,audio:void 0,totalBitrate:void 0},d=function(e,t,a){if("number"==typeof e.newQuality){var s=e.mediaType;if("audio"===s||"video"===s){var o=r.getBitrateInfoListFor(s).find((function(t){return t.qualityIndex===e.newQuality}));if(o&&"number"==typeof o.bitrate){l[s]=O(O({},o),{},{codec:r.getCurrentTrackFor(s).codec});var u=function(){if(l.video&&"number"==typeof l.video.bitrate){if(l.video.width&&l.video.height){var e=l.video.bitrate;return l.audio&&"number"==typeof l.audio.bitrate&&(e+=l.audio.bitrate),e!==l.totalBitrate?(l.totalBitrate=e,{video_source_bitrate:e,video_source_height:l.video.height,video_source_width:l.video.width,video_source_codec:U(l.video.codec)}):void 0}i.warn("have bitrate info for video but missing width/height")}}();u&&n("renditionchange",u)}else i.warn("missing bitrate info for ".concat(s))}}else i.warn("missing evt.newQuality in qualityChangeRendered event",e)};r.on("qualityChangeRendered",d);var f=function(e){var t=e.request,r=e.mediaType;n("requestcanceled",{request_event_type:(t=t||{}).type+"_"+t.action,request_url:t.url,request_type:r,request_hostname:v(t.url)})};r.on("fragmentLoadingAbandoned",f);var c=function(e){var t,r,i=e.error,a=(null==i||null===(t=i.data)||void 0===t?void 0:t.request)||{},s=(null==i||null===(r=i.data)||void 0===r?void 0:r.response)||{};27===(null==i?void 0:i.code)&&n("requestfailed",{request_error:a.type+"_"+a.action,request_url:a.url,request_hostname:v(a.url),request_type:a.mediaType,request_error_code:s.status,request_error_text:s.statusText});var o="".concat(null!=a&&a.url?"url: ".concat(a.url,"\n"):"")+"".concat(null!=s&&s.status||null!=s&&s.statusText?"response: ".concat(null==s?void 0:s.status,", ").concat(null==s?void 0:s.statusText,"\n"):"");n("error",{player_error_code:null==i?void 0:i.code,player_error_message:null==i?void 0:i.message,player_error_context:o})};r.on("error",c),r._stopMuxMonitor=function(){r.off("manifestLoaded",a),r.off("initFragmentLoaded",o),r.off("mediaFragmentLoaded",u),r.off("qualityChangeRendered",d),r.off("error",c),r.off("fragmentLoadingAbandoned",f),delete r._stopMuxMonitor}}else i.warn("Invalid dash.js player reference. Monitoring blocked.")}(this.mux,this.id,e.dashjs)):this.mux.log.warn("You must pass a valid dashjs instance in order to track it.")}},{key:"removeDashJS",value:function(){var e;this.dashjs&&((e=this.dashjs)&&"function"==typeof e._stopMuxMonitor&&e._stopMuxMonitor(),this.dashjs=void 0)}}],r&&nt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),n}(F),ft=dt,ct=r(153),ht=r.n(ct);function pt(e){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pt(e)}function vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,a=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(a.push(i.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==r.return||r.return()}finally{if(o)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return mt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var gt,yt=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],_t={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"};n()&&n().WeakMap&&(gt=new WeakMap);var bt=function(e){return this.buffer="",this.manifest={segments:[],serverControl:{},sessionData:{}},this.currentUri={},this.process(e),this.manifest};bt.prototype.process=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.processLine(this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},bt.prototype.processLine=function(e){var t=e.indexOf(":"),r=Ct(e,t),i=r[0],n=2===r.length?wt(r[1]):void 0;if("#"!==i[0])this.currentUri.uri=i,this.manifest.segments.push(this.currentUri),this.manifest.targetDuration&&!("duration"in this.currentUri)&&(this.currentUri.duration=this.manifest.targetDuration),this.currentUri={};else switch(i){case"#EXT-X-TARGETDURATION":if(!isFinite(n)||n<0)return;this.manifest.targetDuration=n,this.setHoldBack();break;case"#EXT-X-PART-INF":Tt(this.manifest,r),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),this.setHoldBack();break;case"#EXT-X-SERVER-CONTROL":Tt(this.manifest,r),this.setHoldBack();break;case"#EXTINF":0===n?this.currentUri.duration=.01:n>0&&(this.currentUri.duration=n);break;case"#EXT-X-PROGRAM-DATE-TIME":var a=n,s=new Date(a);this.manifest.dateTimeString||(this.manifest.dateTimeString=a,this.manifest.dateTimeObject=s),this.currentUri.dateTimeString=a,this.currentUri.dateTimeObject=s;break;case"#EXT-X-VERSION":Tt(this.manifest,r);break;case"#EXT-X-SESSION-DATA":var o=It(r[1]),u=k(o);Object.assign(this.manifest.sessionData,u)}},bt.prototype.setHoldBack=function(){var e=this.manifest,t=e.serverControl,r=e.targetDuration,i=e.partTargetDuration;if(t){var n="holdBack",a="partHoldBack",s=r&&3*r,o=i&&2*i;r&&!t.hasOwnProperty(n)&&(t[n]=s),s&&t[n]<s&&(t[n]=s),i&&!t.hasOwnProperty(a)&&(t[a]=3*i),i&&t[a]<o&&(t[a]=o)}};var Tt=function(e,t){var r,i=St(t[0].replace("#EXT-X-",""));At(t[1])?(r={},r=Object.assign(kt(t[1]),r)):r=wt(t[1]),e[i]=r},St=function(e){return e.toLowerCase().replace(/-(\w)/g,(function(e){return e[1].toUpperCase()}))},wt=function(e){if("yes"===e.toLowerCase()||"no"===e.toLowerCase())return"yes"===e.toLowerCase();var t=-1!==e.indexOf(":")?e:parseFloat(e);return isNaN(t)?e:t},Et=function(e){var t={},r=e.split("=");return r.length>1&&(t[St(r[0])]=wt(r[1])),t},kt=function(e){for(var t=e.split(","),r={},i=0;t.length>i;i++){var n=t[i],a=Et(n);r=Object.assign(a,r)}return r},At=function(e){return e.indexOf("=")>-1},Ct=function(e,t){return-1===t?[e]:[e.substring(0,t),e.substring(t+1)]},It=function(e){var t={};if(e){var r=e.search(",");return[e.slice(0,r),e.slice(r+1)].forEach((function(e,r){for(var i=e.replace(/['"]+/g,"").split("="),n=0;n<i.length;n++)"DATA-ID"===i[n]&&(t["DATA-ID"]=i[1-n]),"VALUE"===i[n]&&(t.VALUE=i[1-n])})),{data:t}}},Dt=bt,xt={safeCall:function(e,t,r,i){var n=i;if(e&&"function"==typeof e[t])try{n=e[t].apply(e,r)}catch(e){c.info("safeCall error",e)}return n},safeIncrement:b,getComputedStyle:function(e,t){var r;if(e&&t&&n()&&"function"==typeof n().getComputedStyle)return gt&&gt.has(e)&&(r=gt.get(e)),r||(r=n().getComputedStyle(e,null),gt&&gt.set(e,r)),r.getPropertyValue(t)},secondsToMs:function(e){return Math.floor(1e3*e)},assign:Object.assign,headersStringToObject:w,cdnHeadersToRequestId:E,extractHostnameAndDomain:m,extractHostname:v,manifestParser:Dt,generateShortID:s,generateUUID:a,now:p.now};function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var Ot={},Pt=function e(t){var r=arguments;"string"==typeof t?e.hasOwnProperty(t)?n().setTimeout((function(){r=Array.prototype.splice.call(r,1),e[t].apply(null,r)}),0):c.warn("`"+t+"` is an unknown task"):"function"==typeof t?n().setTimeout((function(){t(e)}),0):c.warn("`"+t+"` is invalid.")},Rt={loaded:p.now(),NAME:"mux-embed",VERSION:"4.27.0",API_VERSION:"2.1",PLAYER_TRACKED:!1,monitor:function(e,t){return function(e,t,r){var i=vt(u(t),3),n=i[0],a=i[1],s=i[2],o=e.log,l=e.utils.getComputedStyle,d=e.utils.secondsToMs;if(!n)return o.error("No element was found with the `"+a+"` query selector.");if("video"!==s&&"audio"!==s)return o.error("The element of `"+a+"` was not a media element.");n.mux&&(n.mux.destroy(),delete n.mux,o.warn("Already monitoring this video element, replacing existing event listeners")),(r=Object.assign({automaticErrorTracking:!0},r)).data=Object.assign({player_software:"HTML5 Video Element",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:e.VERSION},r.data),r.getPlayheadTime=function(){return d(n.currentTime)},r.getStateData=function(){var e,t,i=this.hlsjs&&this.hlsjs.url,a=this.dashjs&&pt("function"===this.dashjs.getSource)&&this.dashjs.getSource(),s={player_is_paused:n.paused,player_playhead_time:d(n.currentTime),player_width:parseInt(l(n,"width")),player_height:parseInt(l(n,"height")),player_autoplay_on:n.autoplay,player_preload_on:n.preload,player_language_code:n.lang,player_is_fullscreen:ht()&&!!(ht().fullscreenElement||ht().webkitFullscreenElement||ht().mozFullScreenElement||ht().msFullscreenElement),video_poster_url:n.poster,video_source_url:i||a||n.currentSrc,video_source_duration:d(n.duration),video_source_height:n.videoHeight,video_source_width:n.videoWidth,view_dropped_frame_count:null===(e=n)||void 0===e||null===(t=e.getVideoPlaybackQuality)||void 0===t?void 0:t.call(e).droppedVideoFrames},o=r.getPlayheadTime();if(n.getStartDate&&o>0){var u=n.getStartDate();if(u&&"function"==typeof u.getTime&&u.getTime()){var f=u.getTime();if(s.player_program_time=f+o,n.seekable.length>0){var c=f+n.seekable.end(n.seekable.length-1);s.player_live_edge_program_time=c}}}return s},n.mux=n.mux||{},n.mux.deleted=!1,n.mux.emit=function(t,r){e.emit(a,t,r)};var f=function(){o.error("The monitor for this video element has already been destroyed.")};n.mux.destroy=function(){Object.keys(n.mux.listeners).forEach((function(e){n.removeEventListener(e,n.mux.listeners[e],!1)})),delete n.mux.listeners,n.mux.destroy=f,n.mux.swapElement=f,n.mux.emit=f,n.mux.addHLSJS=f,n.mux.addDashJS=f,n.mux.removeHLSJS=f,n.mux.removeDashJS=f,n.mux.deleted=!0,e.emit(a,"destroy")},n.mux.swapElement=function(t){var r=vt(u(t),3),i=r[0],a=r[1],s=r[2];return i?"video"!==s&&"audio"!==s?e.log.error("The element of `"+a+"` was not a media element."):(i.muxId=n.muxId,delete n.muxId,i.mux=i.mux||{},i.mux.listeners=Object.assign({},n.mux.listeners),delete n.mux.listeners,Object.keys(i.mux.listeners).forEach((function(e){n.removeEventListener(e,i.mux.listeners[e],!1),i.addEventListener(e,i.mux.listeners[e],!1)})),i.mux.swapElement=n.mux.swapElement,i.mux.destroy=n.mux.destroy,delete n.mux,void(n=i)):e.log.error("No element was found with the `"+a+"` query selector.")},n.mux.addHLSJS=function(t){e.addHLSJS(a,t)},n.mux.addDashJS=function(t){e.addDashJS(a,t)},n.mux.removeHLSJS=function(){e.removeHLSJS(a)},n.mux.removeDashJS=function(){e.removeDashJS(a)},e.init(a,r),e.emit(a,"playerready"),n.paused||(e.emit(a,"play"),n.readyState>2&&e.emit(a,"playing")),n.mux.listeners={},yt.forEach((function(t){("error"!==t||r.automaticErrorTracking)&&(n.mux.listeners[t]=function(){var r={};if("error"===t){if(!n.error)return;if(1===n.error.code)return;r.player_error_code=n.error.code,r.player_error_message=_t[n.error.code]||n.error.message}e.emit(a,t,r)},n.addEventListener(t,n.mux.listeners[t],!1))}))}(Pt,e,t)},destroyMonitor:function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,a=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(a.push(i.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==r.return||r.return()}finally{if(o)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Lt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(u(e),1)[0];t&&t.mux&&"function"==typeof t.mux.destroy?t.mux.destroy():c.error("A video element monitor for `"+e+"` has not been initialized via `mux.monitor`.")},addHLSJS:function(e,t){var r=o(e);Ot[r]?Ot[r].addHLSJS(t):c.error("A monitor for `"+r+"` has not been initialized.")},addDashJS:function(e,t){var r=o(e);Ot[r]?Ot[r].addDashJS(t):c.error("A monitor for `"+r+"` has not been initialized.")},removeHLSJS:function(e){var t=o(e);Ot[t]?Ot[t].removeHLSJS():c.error("A monitor for `"+t+"` has not been initialized.")},removeDashJS:function(e){var t=o(e);Ot[t]?Ot[t].removeDashJS():c.error("A monitor for `"+t+"` has not been initialized.")},init:function(e,t){h()&&t&&t.respectDoNotTrack&&c.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var r=o(e);Ot[r]=new ft(Pt,r,t)},emit:function(e,t,r){var i=o(e);Ot[i]?(Ot[i].emit(t,r),"destroy"===t&&delete Ot[i]):c.error("A monitor for `"+i+"` has not been initialized.")},checkDoNotTrack:h,log:c,utils:xt,events:{PLAYER_READY:"playerready",VIEW_INIT:"viewinit",VIDEO_CHANGE:"videochange",PLAY:"play",PAUSE:"pause",PLAYING:"playing",TIME_UPDATE:"timeupdate",SEEKING:"seeking",SEEKED:"seeked",REBUFFER_START:"rebufferstart",REBUFFER_END:"rebufferend",ERROR:"error",ENDED:"ended",RENDITION_CHANGE:"renditionchange",ORIENTATION_CHANGE:"orientationchange",AD_REQUEST:"adrequest",AD_RESPONSE:"adresponse",AD_BREAK_START:"adbreakstart",AD_PLAY:"adplay",AD_PLAYING:"adplaying",AD_PAUSE:"adpause",AD_FIRST_QUARTILE:"adfirstquartile",AD_MID_POINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",AD_ENDED:"adended",AD_BREAK_END:"adbreakend",AD_ERROR:"aderror",REQUEST_COMPLETED:"requestcompleted",REQUEST_FAILED:"requestfailed",REQUEST_CANCELLED:"requestcanceled"},WINDOW_HIDDEN:!1,WINDOW_UNLOADING:!1};Object.assign(Pt,Rt),void 0!==n()&&"function"==typeof n().addEventListener&&n().addEventListener("pagehide",(function(e){e.persisted||(Pt.WINDOW_UNLOADING=!0)}),!1);var Ut=Pt},655:function(e,t,r){var i,n;function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}!function(s){var o=!1;if(void 0===(n="function"==typeof(i=s)?i.call(t,r,t,e):i)||(e.exports=n),o=!0,"object"===a(t)&&(e.exports=s(),o=!0),!o){var u=window.Cookies,l=window.Cookies=s();l.noConflict=function(){return window.Cookies=u,l}}}((function(){var e=function(){for(var e=0,t={};e<arguments.length;e++){var r=arguments[e];for(var i in r)t[i]=r[i]}return t};return function t(r){function i(t,n,a){var s;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(a=e({path:"/"},i.defaults,a)).expires){var o=new Date;o.setMilliseconds(o.getMilliseconds()+864e5*a.expires),a.expires=o}try{s=JSON.stringify(n),/^[\{\[]/.test(s)&&(n=s)}catch(e){}return n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[t,"=",n,a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}t||(s={});for(var u=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,d=0;d<u.length;d++){var f=u[d].split("="),c=f.slice(1).join("=");'"'===c.charAt(0)&&(c=c.slice(1,-1));try{var h=f[0].replace(l,decodeURIComponent);if(c=r.read?r.read(c,h):r(c,h)||c.replace(l,decodeURIComponent),this.json)try{c=JSON.parse(c)}catch(e){}if(t===h){s=c;break}t||(s[h]=c)}catch(e){}}return s}}return i.set=i,i.get=function(e){return i.call(i,e)},i.getJSON=function(){return i.apply({json:!0},[].slice.call(arguments))},i.defaults={},i.remove=function(t,r){i(t,"",e(r,{expires:-1}))},i.withConverter=t,i}((function(){}))}))},153:function(e,t,r){var i,n=void 0!==r.g?r.g:"undefined"!=typeof window?window:{},a=r(558);"undefined"!=typeof document?i=document:(i=n["__GLOBAL_DOCUMENT_CACHE@4"])||(i=n["__GLOBAL_DOCUMENT_CACHE@4"]=a),e.exports=i},48:function(e,t,r){var i;i="undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{},e.exports=i},640:function(e,t,r){var i,n;!function(a,s){"use strict";i=function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function n(e,t){var r=e[t];if("function"==typeof r.bind)return r.bind(e);try{return Function.prototype.bind.call(r,e)}catch(t){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&r?a:void 0!==console[i]?n(console,i):void 0!==console.log?n(console,"log"):e)}function o(t,r){for(var n=0;n<i.length;n++){var a=i[n];this[a]=n<t?e:this.methodFactory(a,t,r)}this.log=this.debug}function u(e,r,i){return function(){typeof console!==t&&(o.call(this,r,i),this[e].apply(this,arguments))}}function l(e,t,r){return s(e)||u.apply(this,arguments)}function d(e,r,n){var a,s=this;r=null==r?"WARN":r;var u="loglevel";function d(e){var r=(i[e]||"silent").toUpperCase();if(typeof window!==t&&u){try{return void(window.localStorage[u]=r)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+r+";"}catch(e){}}}function f(){var e;if(typeof window!==t&&u){try{e=window.localStorage[u]}catch(e){}if(typeof e===t)try{var r=window.document.cookie,i=r.indexOf(encodeURIComponent(u)+"=");-1!==i&&(e=/^([^;]+)/.exec(r.slice(i))[1])}catch(e){}return void 0===s.levels[e]&&(e=void 0),e}}"string"==typeof e?u+=":"+e:"symbol"==typeof e&&(u=void 0),s.name=e,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=n||l,s.getLevel=function(){return a},s.setLevel=function(r,i){if("string"==typeof r&&void 0!==s.levels[r.toUpperCase()]&&(r=s.levels[r.toUpperCase()]),!("number"==typeof r&&r>=0&&r<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+r;if(a=r,!1!==i&&d(r),o.call(s,r,e),typeof console===t&&r<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){r=e,f()||s.setLevel(e,!1)},s.resetLevel=function(){s.setLevel(r,!1),function(){if(typeof window!==t&&u){try{return void window.localStorage.removeItem(u)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var c=f();null==c&&(c=r),s.setLevel(c,!1)}var f=new d,c={};f.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=c[e];return t||(t=c[e]=new d(e,f.getLevel(),f.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return f.noConflict=function(){return typeof window!==t&&window.log===f&&(window.log=h),f},f.getLoggers=function(){return c},f.default=f,f},void 0===(n=i.call(t,r,t,e))||(e.exports=n)}()},375:function(e,t){"use strict";var r=Object.prototype.hasOwnProperty;function i(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function n(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var i,a,s=[];for(a in"string"!=typeof t&&(t="?"),e)if(r.call(e,a)){if((i=e[a])||null!=i&&!isNaN(i)||(i=""),a=n(a),i=n(i),null===a||null===i)continue;s.push(a+"="+i)}return s.length?t+s.join("&"):""},t.parse=function(e){for(var t,r=/([^=?#&]+)=?([^&]*)/g,n={};t=r.exec(e);){var a=i(t[1]),s=i(t[2]);null===a||null===s||a in n||(n[a]=s)}return n}},558:function(){}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={exports:{}};return e[i].call(a.exports,a,a.exports,r),a.exports}return r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r(80)}()},e.exports=t()},855:function(t){"use strict";t.exports=e}},r={};function i(e){var n=r[e];if(void 0!==n)return n.exports;var a=r[e]={exports:{}};return t[e](a,a.exports,i),a.exports}i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return function(){"use strict";i.r(n),i.d(n,{register:function(){return L}});var e=i(48),t=i.n(e),r=i(855),a=i.n(r),s=i(961),o=i.n(s);var u=o().utils.secondsToMs;function l(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return{}},a=!1;e.on("adstart",(function(){a=!0})),e.on("adend",(function(){a=!1})),e.on("adserror",(function(){a=!1}));var s=function(){var i=u(t.currentTime()),s=function r(){var s=o().utils.now(),l=u(t.currentTime());if(a){if(l>i){var d=n();d.viewer_time=s-Math.max(0,l-i),t.off("timeupdate",r),e.mux.emit("adplaying",d)}}else t.off("timeupdate",r)};t.on("timeupdate",s);var l=function e(){t.off("timeupdate",s),r.forEach((function(r){t.off(r,e)}))};r.forEach((function(e){t.on(e,l)}))};i.forEach((function(e){t.on(e,s)}))}function d(e){if("string"!=typeof e)return!1;var t=e.split(".").map((function(e){return parseInt(e)})),r=t[0],i=t[1];return r>2||2===r&&i>=3}var f=o().utils.manifestParser;function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var i,n,a=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(a.push(i.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==r.return||r.return()}finally{if(o)throw n}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var p=o().utils,v=p.assign,m=p.secondsToMs;function g(e,t,r){var i=0;return function(){var n,a=t.readyState;if(a>=2){if(i=i||o().utils.now(),4!==a)return;var s=e(),u=s.mux.utils.extractHostnameAndDomain,l=s.mux.utils.headersStringToObject,d=o().utils.now(),h=c(u(t.responseURL),1)[0],p="arraybuffer"===t.responseType?t.response.byteLength:t.responseText.length,g=l(t.getAllResponseHeaders?t.getAllResponseHeaders():""),y=function(e){var t=e["content-type"];return t?t.match(/^audio\/mpegurl/i)?"manifest":t.match(/^audio.*/i)?"audio":t.match(/^video.*/)?"video":t.match(/^application\/x-mpegurl/i)||t.match(/^application\/vnd.apple.mpegurl/i)||t.match(/^application\/dash+xml/i)?"manifest":"unknown":"unknown"}(g);if(t.status>=200&&t.status<300){var _={request_start:r,request_response_start:i,request_response_end:d,request_bytes_loaded:p,request_hostname:h,request_url:t.responseURL,request_response_headers:g,request_type:y};if("manifest"===y){var b,T,S,w,E,k,A,C=(n=t.responseText,new f(n));if(C){b=C.partTargetDuration,T=C.targetDuration,S=C.segments;var I=C.serverControl;w=I.partHoldBack,E=I.holdBack,A=C.sessionData;var D=S[S.length-1];D&&D.dateTimeObject&&(k=D.dateTimeObject.getTime()+m(D.duration)),_=v(_,{video_holdback:E&&m(E),video_part_holdback:w&&m(w),video_part_target_duration:b&&m(b),video_target_duration:T&&m(T),player_manifest_newest_program_time:k}),A&&(_=v(_,A))}}s.mux.emit("requestcompleted",_)}else{var x={request_hostname:c(u(t.responseURL),1)[0],request_url:t.responseURL,request_type:y};s.mux.emit("requestfailed",x)}}}}function y(e,t){var r,i=function(t){return function(r){var i=o().utils.now();try{t(r)}catch(e){}try{r.onreadystatechange=function(t,r,i){var n=g(e,t,r);return function(){try{n()}catch(e){}try{i()}catch(e){}}}(r,i,r.onreadystatechange||function(){})}catch(e){}}};t.beforeRequest=(r=t.beforeRequest||function(e){return e},function(e){var t=r(e);return t?(t.beforeSend=i(t.beforeSend||function(){}),t):e})}var _=function(e){var t,r=function(e){for(var t,r=e.textTracks(),i=0;i<r.length;i++)"segment-metadata"===r[i].label&&(t=r[i]);return t}(e);r&&r.on&&r.on("cuechange",(function(){try{var r=e.tech({IWillNotUseThisInPlugins:!0}),i=(r.vhs||r.hls).playlists.media().attributes.BANDWIDTH;t!==i&&e.mux.emit("renditionchange",{video_source_bitrate:i}),t=i}catch(t){e.mux&&e.mux.log&&e.mux.log.warn&&e.mux.log.warn("Cannot retrieve BANDWIDTH information from player: ".concat(t))}}))};function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var i,n,a=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(a.push(i.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==r.return||r.return()}finally{if(o)throw n}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var S=new Map;var w,E=o().log,k=o().utils.assign,A=o().utils.safeCall,C=o().utils.getComputedStyle,I=o().utils.secondsToMs,D=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"];function x(e){var r=e;return function(e){var i,n;if(r.IS_IE8)return!1;var a=this,s=a.id(),u=(null===(i=a.tech)||void 0===i||null===(n=i.call(a,!0))||void 0===n?void 0:n.el())||a.tag,f=w&&(w.get(u)||w.get(a.el()));(e=k({automaticErrorTracking:!0},e)).data=k({player_software_name:"Video.js",player_software_version:r.VERSION||"< 4.11",player_mux_plugin_name:"videojs-mux",player_mux_plugin_version:"4.16.0",player_init_time:f},e.data),e.getPlayheadTime=function(){return I(a.currentTime())},e.getStateData=function(){var e=A(a,"videoHeight"),t=A(a,"videoWidth");if(void 0===t||void 0===e){var r=a.el().firstChild;r&&"VIDEO"===r.nodeName.toUpperCase()&&(e=r.videoHeight,t=r.videoWidth)}return{player_is_paused:A(a,"paused"),player_is_fullscreen:A(a,"isFullscreen"),player_autoplay_on:!!A(a,"autoplay"),player_preload_on:A(a,"preload"),player_width:C(a.el(),"width"),player_height:C(a.el(),"height"),player_language_code:A(a,"language"),video_poster_url:A(a,"poster"),video_source_url:A(a,"currentSrc"),video_source_mime_type:A(a,"currentType")&&A(a,"currentType").toLowerCase(),video_source_duration:I(A(a,"duration")||0),video_source_is_live:a.duration()===1/0,video_source_height:e,video_source_width:t}},a.mux=function(){E.error("[videojs-mux] The plugin was initialized more than once.")},a.mux.emit=function(e,t){o().emit(s,e,t)},a.mux.addHLSJS=function(e){o().addHLSJS(s,e)},a.mux.log=E,a.mux.utils=o().utils,o().init(s,e);var c=!1,h=function(){c||a.mux.emit("playerready"),c=!0};a.ready((function(){a.addClass("vjs-mux"),t().setTimeout(h,0)}));var p=!1;a.one("play",h),D.forEach((function(t){("error"!==t||e.automaticErrorTracking)&&a.on(t,(function(){if(!p){var e={};if("error"===t){var r=A(a,"error");if(r){if(1===r.code)return;e={player_error_code:r.code,player_error_message:r.message,player_error_context:r.status}}}a.mux.emit(t,e)}}))}));var v=!1;a.on("play",(function(){v=!0})),a.on("pause",(function(){v=!1})),a.on("adstart",(function(){p=!0,v&&a.mux.emit("pause"),a.mux.emit("adbreakstart")})),a.on("adend",(function(){a.mux.emit("adbreakend"),p=!1,A(a,"paused")||(a.mux.emit("play"),v=!0,a.onceux&&a.mux.emit("playing"))})),a.ima&&function(e){var t,r,i,n,a,s,o=function(t){var r="function"==typeof(t=t||{}).getAdData?t.getAdData():{},i="function"==typeof t.getAd?t.getAd():{},n="function"==typeof i.getMediaUrl?i.getMediaUrl():r.mediaUrl,a=null==r?void 0:r.adId,s=null==r?void 0:r.creativeId,o=null==r?void 0:r.universalAdIdValue,u=e.ima.settings||{},l={};return n&&(l.ad_asset_url=n),u.adTagUrl&&(l.ad_tag_url=u.adTagUrl),a&&(l.ad_id=a),s&&(l.ad_creative_id=s),o&&(l.ad_universal_id=o),l};try{var u=window.google.ima.AdEvent.Type;t=u.LOADED,r=u.STARTED,i=u.COMPLETE,n=u.PAUSED,a=u.RESUMED,s=u.SKIPPED}catch(e){t="loaded",r="start",i="complete",n="pause",a="resume",s="skip"}var l=0;e.mux.triggerAdRequest=function(){l++,e.mux.emit("adrequest",o())},e.on("adsready",(function(){var u=e.ima.addEventListener||function(){};u(t,(function(t){var r=o(t);l>0&&(l--,e.mux.emit("adresponse",r)),e.mux.emit("adplay",r)})),u(r,(function(t){var r=o(t);e.mux.emit("adplaying",r)})),u(a,(function(t){var r=o(t);e.mux.emit("adplay",r),e.mux.emit("adplaying",r)})),u(n,(function(t){var r=o(t);e.mux.emit("adpause",r)})),u(i,(function(t){var r=o(t);e.mux.emit("adended",r)})),u(s,(function(t){var r=o(t);e.mux.emit("adended",r)})),e.on("adserror",(function(){l>0&&(l--,e.mux.emit("adresponse")),e.mux.emit("aderror")}))}))}(a),a.onceux&&function(e){l(e,e,["onceux-linearad-pause","onceux-linearad-skipped","onceux-linearad-complete","adserror"],["adstart","onceux-linearad-resume"]),e.on("adstart",(function(){e.mux.emit("adplay")})),e.on("onceux-linearad-start",(function(t){t.linearAd&&t.linearAd.index>0&&(e.mux.emit("adplay"),e.mux.emit("adplaying"))})),e.on("onceux-linearad-resume",(function(){e.mux.emit("adplay")})),e.on("onceux-linearad-pause",(function(){e.mux.emit("adpause")})),e.on("onceux-linearad-complete",(function(){e.mux.emit("adended")})),e.on("onceux-linearad-skipped",(function(){e.mux.emit("adended")}))}(a),a.ima3&&"function"==typeof a.ima3.ready&&function(e){var t=function(){var t=e.ima3.currentAd,r=e.ima3.settings,i={};return t&&(i.ad_asset_url=t.mediaUrl),r&&(i.ad_tag_url=r.serverUrl),i};if(d(e.ima3.version)){var r=0,i=function(){r>0&&(r--,e.mux.emit("adresponse",t()))};e.on("ads-request",(function(){r++,e.mux.emit("adrequest",t())})),e.on("ads-load",(function(){i(),e.mux.emit("adplay",t())})),e.on("adserror",(function(){i(),e.mux.emit("aderror")})),e.on("ads-play",(function(){e.mux.emit("adplay",t())})),e.on("ads-pause",(function(){e.mux.emit("adpause",t())})),e.on("ads-ad-ended",(function(){e.mux.emit("adended",t())}))}e.ima3.ready((function(){e.ima3.adPlayer?(d(e.ima3.version)||(e.ima3.adPlayer.on("play",(function(){e.mux.emit("adplay")})),e.ima3.adPlayer.on("pause",(function(){e.mux.emit("adpause")})),e.ima3.adPlayer.on("ended",(function(){e.mux.emit("adended")}))),l(e,e.ima3.adPlayer,["pause","ended","adserror"],["play"],t)):(e.mux.log("Legacy IMA3 plugin found, ad events may not track correctly."),e.on("ads-ad-started",(function(){e.mux.emit("adplaying",t())})),e.on("ads-play",(function(){e.mux.emit("adplaying",t())})))}))}(a),a.FreeWheelPlugin&&a.FreeWheelPlugin.VERSION&&function(e){var t=function(t){var r=e.FreeWheelPlugin,i={};switch(t){case"adplay":case"adplaying":case"adpause":i.ad_asset_url=e.currentSrc()}return r&&(i.ad_tag_url="html5"===r.tech.toLowerCase()?r.settings.Html5.serverUrl:r.settings.Flash.serverUrl),i};e.on("ads-request",(function(){e.mux.emit("adrequest",t("adrequest"))})),e.on("ads-load",(function(){e.mux.emit("adresponse",t("adresponse"))})),e.on("adserror",(function(){e.mux.emit("aderror")})),e.on("ads-ad-started",(function(){e.mux.emit("adplay",t("adplay")),e.mux.emit("adplaying",t("adplaying"))})),e.on("ads-play",(function(){e.mux.emit("adplay",t("adplay")),e.mux.emit("adplaying",t("adplaying"))})),e.on("ads-pause",(function(){e.mux.emit("adpause",t("adpause"))})),e.on("ads-ad-ended",(function(){e.mux.emit("adended",t("adended"))})),e.on("adend",(function(){e.mux.emit("play")}))}(a),a.on("dispose",(function(){a.mux.emit("destroy"),w.delete(a)}))}}function L(e){(e.registerPlugin||e.plugin||function(){o().log.error("No valid method to register videojs plugin available.")})("mux",x(e)),function(e){if(!S.get(e)&&(S.set(e,"video.js ".concat(e.VERSION," initialized")),"function"==typeof e.getTech))for(var t=(e.getTech("Html5")||{}).sourceHandlers,r=e.Vhs||e.Hls,i=function(i){var n=t[i],a=n.handleSource;n.handleSource=function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r&&r.xhr&&y((function(){return e(i.el())}),r.xhr);var s=a(t,i,n);if(s&&"function"==typeof s.xhr)try{var o=b(e.VERSION.split("."),2),u=o[0],l=o[1];u=parseInt(u),l=parseInt(l);var d=u>=7&&l>=4?s.player().id():s.player_.el_.parentNode.id;_(e(d))}catch(e){}return s}},n=0;n<t.length;n++)i(n)}(e)}w="undefined"!=typeof WeakMap?new WeakMap:new Map,a().hook&&a().hook("beforesetup",(function(e,t){return w.set(e,o().utils.now()),t})),L(a())}(),n}()}))}()},"./node_modules/videojs-vtt.js/lib/browser-index.js":function(e,t,r){var i=r("./node_modules/global/window.js");var n=e.exports={WebVTT:r("./node_modules/videojs-vtt.js/lib/vtt.js"),VTTCue:r("./node_modules/videojs-vtt.js/lib/vttcue.js"),VTTRegion:r("./node_modules/videojs-vtt.js/lib/vttregion.js")};i.vttjs=n;i.WebVTT=n.WebVTT;var a=n.VTTCue;var s=n.VTTRegion;var o=i.VTTCue;var u=i.VTTRegion;n.shim=function(){i.VTTCue=a;i.VTTRegion=s};n.restore=function(){i.VTTCue=o;i.VTTRegion=u};if(!i.VTTCue){n.shim()}},"./node_modules/videojs-vtt.js/lib/vtt.js":function(e,t,r){var i=r("./node_modules/global/document.js");var n=Object.create||function(){function e(){}return function(t){if(arguments.length!==1){throw new Error("Object.create shim only accepts one parameter.")}e.prototype=t;return new e}}();function a(e,t){this.name="ParsingError";this.code=e.code;this.message=t||e.message}a.prototype=n(Error.prototype);a.prototype.constructor=a;a.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function s(e){function t(e,t,r,i){return(e|0)*3600+(t|0)*60+(r|0)+(i|0)/1e3}var r=e.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);if(!r){return null}if(r[3]){return t(r[1],r[2],r[3].replace(":",""),r[4])}else if(r[1]>59){return t(r[1],r[2],0,r[4])}else{return t(0,r[1],r[2],r[4])}}function o(){this.values=n(null)}o.prototype={set:function(e,t){if(!this.get(e)&&t!==""){this.values[e]=t}},get:function(e,t,r){if(r){return this.has(e)?this.values[e]:t[r]}return this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var i=0;i<r.length;++i){if(t===r[i]){this.set(e,t);break}}},integer:function(e,t){if(/^-?\d+$/.test(t)){this.set(e,parseInt(t,10))}},percent:function(e,t){var r;if(r=t.match(/^([\d]{1,3})(\.[\d]*)?%$/)){t=parseFloat(t);if(t>=0&&t<=100){this.set(e,t);return true}}return false}};function u(e,t,r,i){var n=i?e.split(i):[e];for(var a in n){if(typeof n[a]!=="string"){continue}var s=n[a].split(r);if(s.length!==2){continue}var o=s[0].trim();var u=s[1].trim();t(o,u)}}function l(e,t,r){var i=e;function n(){var t=s(e);if(t===null){throw new a(a.Errors.BadTimeStamp,"Malformed timestamp: "+i)}e=e.replace(/^[^\sa-zA-Z-]+/,"");return t}function l(e,t){var i=new o;u(e,(function(e,t){switch(e){case"region":for(var n=r.length-1;n>=0;n--){if(r[n].id===t){i.set(e,r[n].region);break}}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),s=a[0];i.integer(e,s);i.percent(e,s)?i.set("snapToLines",false):null;i.alt(e,s,["auto"]);if(a.length===2){i.alt("lineAlign",a[1],["start","center","end"])}break;case"position":a=t.split(",");i.percent(e,a[0]);if(a.length===2){i.alt("positionAlign",a[1],["start","center","end"])}break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start","center","end","left","right"]);break}}),/:/,/\s/);t.region=i.get("region",null);t.vertical=i.get("vertical","");try{t.line=i.get("line","auto")}catch(e){}t.lineAlign=i.get("lineAlign","start");t.snapToLines=i.get("snapToLines",true);t.size=i.get("size",100);try{t.align=i.get("align","center")}catch(e){t.align=i.get("align","middle")}try{t.position=i.get("position","auto")}catch(e){t.position=i.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},t.align)}t.positionAlign=i.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}function d(){e=e.replace(/^\s+/,"")}d();t.startTime=n();d();if(e.substr(0,3)!=="--\x3e"){throw new a(a.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+i)}e=e.substr(3);d();t.endTime=n();d();l(e,t)}var d=i.createElement&&i.createElement("textarea");var f={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"};var c={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"};var h={v:"title",lang:"lang"};var p={rt:"ruby"};function v(e,t){function r(){if(!t){return null}function e(e){t=t.substr(e.length);return e}var r=t.match(/^([^<]*)(<[^>]*>?)?/);return e(r[1]?r[1]:r[2])}function i(e){d.innerHTML=e;e=d.textContent;d.textContent="";return e}function n(e,t){return!p[t.localName]||p[t.localName]===e.localName}function a(t,r){var i=f[t];if(!i){return null}var n=e.document.createElement(i);var a=h[t];if(a&&r){n[a]=r.trim()}return n}var o=e.document.createElement("div"),u=o,l,v=[];while((l=r())!==null){if(l[0]==="<"){if(l[1]==="/"){if(v.length&&v[v.length-1]===l.substr(2).replace(">","")){v.pop();u=u.parentNode}continue}var m=s(l.substr(1,l.length-2));var g;if(m){g=e.document.createProcessingInstruction("timestamp",m);u.appendChild(g);continue}var y=l.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!y){continue}g=a(y[1],y[3]);if(!g){continue}if(!n(u,g)){continue}if(y[2]){var _=y[2].split(".");_.forEach((function(e){var t=/^bg_/.test(e);var r=t?e.slice(3):e;if(c.hasOwnProperty(r)){var i=t?"background-color":"color";var n=c[r];g.style[i]=n}}));g.className=_.join(" ")}v.push(y[1]);u.appendChild(g);u=g;continue}u.appendChild(e.document.createTextNode(i(l)))}return o}var m=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function g(e){for(var t=0;t<m.length;t++){var r=m[t];if(e>=r[0]&&e<=r[1]){return true}}return false}function y(e){var t=[],r="",i;if(!e||!e.childNodes){return"ltr"}function n(e,t){for(var r=t.childNodes.length-1;r>=0;r--){e.push(t.childNodes[r])}}function a(e){if(!e||!e.length){return null}var t=e.pop(),r=t.textContent||t.innerText;if(r){var i=r.match(/^.*(\n|\r)/);if(i){e.length=0;return i[0]}return r}if(t.tagName==="ruby"){return a(e)}if(t.childNodes){n(e,t);return a(e)}}n(t,e);while(r=a(t)){for(var s=0;s<r.length;s++){i=r.charCodeAt(s);if(g(i)){return"rtl"}}}return"ltr"}function _(e){if(typeof e.line==="number"&&(e.snapToLines||e.line>=0&&e.line<=100)){return e.line}if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement){return-1}var t=e.track,r=t.textTrackList,i=0;for(var n=0;n<r.length&&r[n]!==t;n++){if(r[n].mode==="showing"){i++}}return++i*-1}function b(){}b.prototype.applyStyles=function(e,t){t=t||this.div;for(var r in e){if(e.hasOwnProperty(r)){t.style[r]=e[r]}}};b.prototype.formatStyle=function(e,t){return e===0?0:e+t};function T(e,t,r){b.call(this);this.cue=t;this.cueDiv=v(e,t.text);var i={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(i,this.cueDiv);this.div=e.document.createElement("div");i={direction:y(this.cueDiv),writingMode:t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:t.align==="middle"?"center":t.align,font:r.font,whiteSpace:"pre-line",position:"absolute"};this.applyStyles(i);this.div.appendChild(this.cueDiv);var n=0;switch(t.positionAlign){case"start":n=t.position;break;case"center":n=t.position-t.size/2;break;case"end":n=t.position-t.size;break}if(t.vertical===""){this.applyStyles({left:this.formatStyle(n,"%"),width:this.formatStyle(t.size,"%")})}else{this.applyStyles({top:this.formatStyle(n,"%"),height:this.formatStyle(t.size,"%")})}this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}T.prototype=n(b.prototype);T.prototype.constructor=T;function S(e){var t,r,i,n;if(e.div){r=e.div.offsetHeight;i=e.div.offsetWidth;n=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect();t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left;this.right=e.right;this.top=e.top||n;this.height=e.height||r;this.bottom=e.bottom||n+(e.height||r);this.width=e.width||i;this.lineHeight=t!==undefined?t:e.lineHeight}S.prototype.move=function(e,t){t=t!==undefined?t:this.lineHeight;switch(e){case"+x":this.left+=t;this.right+=t;break;case"-x":this.left-=t;this.right-=t;break;case"+y":this.top+=t;this.bottom+=t;break;case"-y":this.top-=t;this.bottom-=t;break}};S.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top};S.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++){if(this.overlaps(e[t])){return true}}return false};S.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right};S.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}};S.prototype.intersectPercentage=function(e){var t=Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left)),r=Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top)),i=t*r;return i/(this.height*this.width)};S.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}};S.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0;var r=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0;var i=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e;var n={left:e.left,right:e.right,top:e.top||i,height:e.height||t,bottom:e.bottom||i+(e.height||t),width:e.width||r};return n};function w(e,t,r,i){function n(e,t){var n,a=new S(e),s=1;for(var o=0;o<t.length;o++){while(e.overlapsOppositeAxis(r,t[o])||e.within(r)&&e.overlapsAny(i)){e.move(t[o])}if(e.within(r)){return e}var u=e.intersectPercentage(r);if(s>u){n=new S(e);s=u}e=new S(a)}return n||a}var a=new S(t),s=t.cue,o=_(s),u=[];if(s.snapToLines){var l;switch(s.vertical){case"":u=["+y","-y"];l="height";break;case"rl":u=["+x","-x"];l="width";break;case"lr":u=["-x","+x"];l="width";break}var d=a.lineHeight,f=d*Math.round(o),c=r[l]+d,h=u[0];if(Math.abs(f)>c){f=f<0?-1:1;f*=Math.ceil(c/d)*d}if(o<0){f+=s.vertical===""?r.height:r.width;u=u.reverse()}a.move(h,f)}else{var p=a.lineHeight/r.height*100;switch(s.lineAlign){case"center":o-=p/2;break;case"end":o-=p;break}switch(s.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")});break}u=["+y","-x","+x","-y"];a=new S(t)}var v=n(a,u);t.move(v.toCSSCompatValues(r))}function E(){}E.StringDecoder=function(){return{decode:function(e){if(!e){return""}if(typeof e!=="string"){throw new Error("Error - expected string data.")}return decodeURIComponent(encodeURIComponent(e))}}};E.convertCueToDOMTree=function(e,t){if(!e||!t){return null}return v(e,t)};var k=.05;var A="sans-serif";var C="1.5%";E.processCues=function(e,t,r){if(!e||!t||!r){return null}while(r.firstChild){r.removeChild(r.firstChild)}var i=e.document.createElement("div");i.style.position="absolute";i.style.left="0";i.style.right="0";i.style.top="0";i.style.bottom="0";i.style.margin=C;r.appendChild(i);function n(e){for(var t=0;t<e.length;t++){if(e[t].hasBeenReset||!e[t].displayState){return true}}return false}if(!n(t)){for(var a=0;a<t.length;a++){i.appendChild(t[a].displayState)}return}var s=[],o=S.getSimpleBoxPosition(i),u=Math.round(o.height*k*100)/100;var l={font:u+"px "+A};(function(){var r,n;for(var a=0;a<t.length;a++){n=t[a];r=new T(e,n,l);i.appendChild(r.div);w(e,r,o,s);n.displayState=r.div;s.push(S.getSimpleBoxPosition(r))}})()};E.Parser=function(e,t,r){if(!r){r=t;t={}}if(!t){t={}}this.window=e;this.vttjs=t;this.state="INITIAL";this.buffer="";this.decoder=r||new TextDecoder("utf8");this.regionList=[]};E.Parser.prototype={reportOrThrowError:function(e){if(e instanceof a){this.onparsingerror&&this.onparsingerror(e)}else{throw e}},parse:function(e){var t=this;if(e){t.buffer+=t.decoder.decode(e,{stream:true})}function r(){var e=t.buffer;var r=0;while(r<e.length&&e[r]!=="\r"&&e[r]!=="\n"){++r}var i=e.substr(0,r);if(e[r]==="\r"){++r}if(e[r]==="\n"){++r}t.buffer=e.substr(r);return i}function i(e){var r=new o;u(e,(function(e,t){switch(e){case"id":r.set(e,t);break;case"width":r.percent(e,t);break;case"lines":r.integer(e,t);break;case"regionanchor":case"viewportanchor":var i=t.split(",");if(i.length!==2){break}var n=new o;n.percent("x",i[0]);n.percent("y",i[1]);if(!n.has("x")||!n.has("y")){break}r.set(e+"X",n.get("x"));r.set(e+"Y",n.get("y"));break;case"scroll":r.alt(e,t,["up"]);break}}),/=/,/\s/);if(r.has("id")){var i=new(t.vttjs.VTTRegion||t.window.VTTRegion);i.width=r.get("width",100);i.lines=r.get("lines",3);i.regionAnchorX=r.get("regionanchorX",0);i.regionAnchorY=r.get("regionanchorY",100);i.viewportAnchorX=r.get("viewportanchorX",0);i.viewportAnchorY=r.get("viewportanchorY",100);i.scroll=r.get("scroll","");t.onregion&&t.onregion(i);t.regionList.push({id:r.get("id"),region:i})}}function n(e){var r=new o;u(e,(function(e,t){switch(e){case"MPEGT":r.integer(e+"S",t);break;case"LOCA":r.set(e+"L",s(t));break}}),/[^\d]:/,/,/);t.ontimestampmap&&t.ontimestampmap({MPEGTS:r.get("MPEGTS"),LOCAL:r.get("LOCAL")})}function d(e){if(e.match(/X-TIMESTAMP-MAP/)){u(e,(function(e,t){switch(e){case"X-TIMESTAMP-MAP":n(t);break}}),/=/)}else{u(e,(function(e,t){switch(e){case"Region":i(t);break}}),/:/)}}try{var f;if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer)){return this}f=r();var c=f.match(/^WEBVTT([ \t].*)?$/);if(!c||!c[0]){throw new a(a.Errors.BadSignature)}t.state="HEADER"}var h=false;while(t.buffer){if(!/\r\n|\n/.test(t.buffer)){return this}if(!h){f=r()}else{h=false}switch(t.state){case"HEADER":if(/:/.test(f)){d(f)}else if(!f){t.state="ID"}continue;case"NOTE":if(!f){t.state="ID"}continue;case"ID":if(/^NOTE($|[ \t])/.test(f)){t.state="NOTE";break}if(!f){continue}t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,"");try{t.cue.align="center"}catch(e){t.cue.align="middle"}t.state="CUE";if(f.indexOf("--\x3e")===-1){t.cue.id=f;continue}case"CUE":try{l(f,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e);t.cue=null;t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var p=f.indexOf("--\x3e")!==-1;if(!f||p&&(h=true)){t.oncue&&t.oncue(t.cue);t.cue=null;t.state="ID";continue}if(t.cue.text){t.cue.text+="\n"}t.cue.text+=f.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":if(!f){t.state="ID"}continue}}}catch(e){t.reportOrThrowError(e);if(t.state==="CUETEXT"&&t.cue&&t.oncue){t.oncue(t.cue)}t.cue=null;t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{e.buffer+=e.decoder.decode();if(e.cue||e.state==="HEADER"){e.buffer+="\n\n";e.parse()}if(e.state==="INITIAL"){throw new a(a.Errors.BadSignature)}}catch(t){e.reportOrThrowError(t)}e.onflush&&e.onflush();return this}};e.exports=E},"./node_modules/videojs-vtt.js/lib/vttcue.js":function(e,t){var r="auto";var i={"":1,lr:1,rl:1};var n={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function a(e){if(typeof e!=="string"){return false}var t=i[e.toLowerCase()];return t?e.toLowerCase():false}function s(e){if(typeof e!=="string"){return false}var t=n[e.toLowerCase()];return t?e.toLowerCase():false}function o(e,t,i){this.hasBeenReset=false;var n="";var o=false;var u=e;var l=t;var d=i;var f=null;var c="";var h=true;var p="auto";var v="start";var m="auto";var g="auto";var y=100;var _="center";Object.defineProperties(this,{id:{enumerable:true,get:function(){return n},set:function(e){n=""+e}},pauseOnExit:{enumerable:true,get:function(){return o},set:function(e){o=!!e}},startTime:{enumerable:true,get:function(){return u},set:function(e){if(typeof e!=="number"){throw new TypeError("Start time must be set to a number.")}u=e;this.hasBeenReset=true}},endTime:{enumerable:true,get:function(){return l},set:function(e){if(typeof e!=="number"){throw new TypeError("End time must be set to a number.")}l=e;this.hasBeenReset=true}},text:{enumerable:true,get:function(){return d},set:function(e){d=""+e;this.hasBeenReset=true}},region:{enumerable:true,get:function(){return f},set:function(e){f=e;this.hasBeenReset=true}},vertical:{enumerable:true,get:function(){return c},set:function(e){var t=a(e);if(t===false){throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.")}c=t;this.hasBeenReset=true}},snapToLines:{enumerable:true,get:function(){return h},set:function(e){h=!!e;this.hasBeenReset=true}},line:{enumerable:true,get:function(){return p},set:function(e){if(typeof e!=="number"&&e!==r){throw new SyntaxError("Line: an invalid number or illegal string was specified.")}p=e;this.hasBeenReset=true}},lineAlign:{enumerable:true,get:function(){return v},set:function(e){var t=s(e);if(!t){console.warn("lineAlign: an invalid or illegal string was specified.")}else{v=t;this.hasBeenReset=true}}},position:{enumerable:true,get:function(){return m},set:function(e){if(e<0||e>100){throw new Error("Position must be between 0 and 100.")}m=e;this.hasBeenReset=true}},positionAlign:{enumerable:true,get:function(){return g},set:function(e){var t=s(e);if(!t){console.warn("positionAlign: an invalid or illegal string was specified.")}else{g=t;this.hasBeenReset=true}}},size:{enumerable:true,get:function(){return y},set:function(e){if(e<0||e>100){throw new Error("Size must be between 0 and 100.")}y=e;this.hasBeenReset=true}},align:{enumerable:true,get:function(){return _},set:function(e){var t=s(e);if(!t){throw new SyntaxError("align: an invalid or illegal alignment string was specified.")}_=t;this.hasBeenReset=true}}});this.displayState=undefined}o.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};e.exports=o},"./node_modules/videojs-vtt.js/lib/vttregion.js":function(e,t){var r={"":true,up:true};function i(e){if(typeof e!=="string"){return false}var t=r[e.toLowerCase()];return t?e.toLowerCase():false}function n(e){return typeof e==="number"&&(e>=0&&e<=100)}function a(){var e=100;var t=3;var r=0;var a=100;var s=0;var o=100;var u="";Object.defineProperties(this,{width:{enumerable:true,get:function(){return e},set:function(t){if(!n(t)){throw new Error("Width must be between 0 and 100.")}e=t}},lines:{enumerable:true,get:function(){return t},set:function(e){if(typeof e!=="number"){throw new TypeError("Lines must be set to a number.")}t=e}},regionAnchorY:{enumerable:true,get:function(){return a},set:function(e){if(!n(e)){throw new Error("RegionAnchorX must be between 0 and 100.")}a=e}},regionAnchorX:{enumerable:true,get:function(){return r},set:function(e){if(!n(e)){throw new Error("RegionAnchorY must be between 0 and 100.")}r=e}},viewportAnchorY:{enumerable:true,get:function(){return o},set:function(e){if(!n(e)){throw new Error("ViewportAnchorY must be between 0 and 100.")}o=e}},viewportAnchorX:{enumerable:true,get:function(){return s},set:function(e){if(!n(e)){throw new Error("ViewportAnchorX must be between 0 and 100.")}s=e}},scroll:{enumerable:true,get:function(){return u},set:function(e){var t=i(e);if(t===false){console.warn("Scroll: an invalid or illegal string was specified.")}else{u=t}}}})}e.exports=a}}]);
//# sourceMappingURL=vendor-videojs.677aa90f813073b4f731.js.map